/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/var S1=function(e,t){return S1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(i[r]=s[r])},S1(e,t)};export function __extends(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");S1(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}export var __assign=function(){return __assign=Object.assign||function(t){for(var i,s=1,r=arguments.length;s<r;s++){i=arguments[s];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},__assign.apply(this,arguments)};export function __rest(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(i[s[r]]=e[s[r]]);return i}export function __decorate(e,t,i,s){var r=arguments.length,n=r<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,i):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(t,i,n):o(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n}export function __param(e,t){return function(i,s){t(i,s,e)}}export function __esDecorate(e,t,i,s,r,n){function o(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var a=s.kind,c=a==="getter"?"get":a==="setter"?"set":"value",l=!t&&e?s.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,s.name):{}),h,f=!1,p=i.length-1;p>=0;p--){var g={};for(var v in s)g[v]=v==="access"?{}:s[v];for(var v in s.access)g.access[v]=s.access[v];g.addInitializer=function(S){if(f)throw new TypeError("Cannot add initializers after decoration has completed");n.push(o(S||null))};var b=(0,i[p])(a==="accessor"?{get:u.get,set:u.set}:u[c],g);if(a==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(h=o(b.get))&&(u.get=h),(h=o(b.set))&&(u.set=h),(h=o(b.init))&&r.unshift(h)}else(h=o(b))&&(a==="field"?r.unshift(h):u[c]=h)}l&&Object.defineProperty(l,s.name,u),f=!0}export function __runInitializers(e,t,i){for(var s=arguments.length>2,r=0;r<t.length;r++)i=s?t[r].call(e,i):t[r].call(e);return s?i:void 0}export function __propKey(e){return typeof e=="symbol"?e:"".concat(e)}export function __setFunctionName(e,t,i){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}export function __metadata(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}export function __awaiter(e,t,i,s){function r(n){return n instanceof i?n:new i(function(o){o(n)})}return new(i||(i=Promise))(function(n,o){function a(u){try{l(s.next(u))}catch(h){o(h)}}function c(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?n(u.value):r(u.value).then(a,c)}l((s=s.apply(e,t||[])).next())})}export function __generator(e,t){var i={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},s,r,n,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(s=1,r&&(n=l[0]&2?r.return:l[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,l[1])).done)return n;switch(r=0,n&&(l=[l[0]&2,n.value]),l[0]){case 0:case 1:n=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(n=i.trys,!(n=n.length>0&&n[n.length-1])&&(l[0]===6||l[0]===2)){i=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){i.label=l[1];break}if(l[0]===6&&i.label<n[1]){i.label=n[1],n=l;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(l);break}n[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(u){l=[6,u],r=0}finally{s=n=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}export var __createBinding=Object.create?(function(e,t,i,s){s===void 0&&(s=i);var r=Object.getOwnPropertyDescriptor(t,i);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,s,r)}):(function(e,t,i,s){s===void 0&&(s=i),e[s]=t[i]});export function __exportStar(e,t){for(var i in e)i!=="default"&&!Object.prototype.hasOwnProperty.call(t,i)&&__createBinding(t,e,i)}export function __values(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],s=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}export function __read(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var s=i.call(e),r,n=[],o;try{for(;(t===void 0||t-- >0)&&!(r=s.next()).done;)n.push(r.value)}catch(a){o={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}return n}export function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}export function __spreadArrays(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var s=Array(e),r=0,t=0;t<i;t++)for(var n=arguments[t],o=0,a=n.length;o<a;o++,r++)s[r]=n[o];return s}export function __spreadArray(e,t,i){if(i||arguments.length===2)for(var s=0,r=t.length,n;s<r;s++)(n||!(s in t))&&(n||(n=Array.prototype.slice.call(t,0,s)),n[s]=t[s]);return e.concat(n||Array.prototype.slice.call(t))}export function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}export function __asyncGenerator(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=i.apply(e,t||[]),r,n=[];return r={},a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(p){return function(g){return Promise.resolve(g).then(p,h)}}function a(p,g){s[p]&&(r[p]=function(v){return new Promise(function(b,S){n.push([p,v,b,S])>1||c(p,v)})},g&&(r[p]=g(r[p])))}function c(p,g){try{l(s[p](g))}catch(v){f(n[0][3],v)}}function l(p){p.value instanceof __await?Promise.resolve(p.value.v).then(u,h):f(n[0][2],p)}function u(p){c("next",p)}function h(p){c("throw",p)}function f(p,g){p(g),n.shift(),n.length&&c(n[0][0],n[0][1])}}export function __asyncDelegator(e){var t,i;return t={},s("next"),s("throw",function(r){throw r}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(r,n){t[r]=e[r]?function(o){return(i=!i)?{value:__await(e[r](o)),done:!1}:n?n(o):o}:n}}export function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(n){i[n]=e[n]&&function(o){return new Promise(function(a,c){o=e[n](o),r(a,c,o.done,o.value)})}}function r(n,o,a,c){Promise.resolve(c).then(function(l){n({value:l,done:a})},o)}}export function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var sL=Object.create?(function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}):function(e,t){e.default=t};export function __importStar(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return sL(t,e),t}export function __importDefault(e){return e&&e.__esModule?e:{default:e}}export function __classPrivateFieldGet(e,t,i,s){if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?s:i==="a"?s.call(e):s?s.value:t.get(e)}export function __classPrivateFieldSet(e,t,i,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,i):r?r.value=i:t.set(e,i),i}export function __classPrivateFieldIn(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}export function __addDisposableResource(e,t,i){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,r;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],i&&(r=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");r&&(s=function(){try{r.call(this)}catch(n){return Promise.reject(n)}}),e.stack.push({value:t,dispose:s,async:i})}else i&&e.stack.push({async:!0});return t}var rL=typeof SuppressedError=="function"?SuppressedError:function(e,t,i){var s=new Error(i);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};export function __disposeResources(e){function t(s){e.error=e.hasError?new rL(s,e.error,"An error was suppressed during disposal."):s,e.hasError=!0}function i(){for(;e.stack.length;){var s=e.stack.pop();try{var r=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(r).then(i,function(n){return t(n),i()})}catch(n){t(n)}}if(e.hasError)throw e.error}return i()}export default{__extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__createBinding,__exportStar,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet,__classPrivateFieldIn,__addDisposableResource,__disposeResources};var nL=Object.create,E1=Object.defineProperty,oL=Object.getOwnPropertyDescriptor,lx=Object.getOwnPropertyNames,aL=Object.getPrototypeOf,cL=Object.prototype.hasOwnProperty,lL=(e,t)=>function(){return t||(0,e[lx(e)[0]])((t={exports:{}}).exports,t),t.exports},uL=(e,t)=>{for(var i in t)E1(e,i,{get:t[i],enumerable:!0})},hL=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of lx(t))!cL.call(e,r)&&r!==i&&E1(e,r,{get:()=>t[r],enumerable:!(s=oL(t,r))||s.enumerable});return e},ux=(e,t,i)=>(i=e!=null?nL(aL(e)):{},hL(t||!e||!e.__esModule?E1(i,"default",{value:e,enumerable:!0}):i,e)),hx=lL({"node_modules/minimist/index.js"(e,t){"use strict";function i(n,o){var a=n;o.slice(0,-1).forEach(function(l){a=a[l]||{}});var c=o[o.length-1];return c in a}function s(n){return typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}function r(n,o){return o==="constructor"&&typeof n[o]=="function"||o==="__proto__"}t.exports=function(n,o){o||(o={});var a={bools:{},strings:{},unknownFn:null};typeof o.unknown=="function"&&(a.unknownFn=o.unknown),typeof o.boolean=="boolean"&&o.boolean?a.allBools=!0:[].concat(o.boolean).filter(Boolean).forEach(function(H){a.bools[H]=!0});var c={};function l(H){return c[H].some(function(ie){return a.bools[ie]})}Object.keys(o.alias||{}).forEach(function(H){c[H]=[].concat(o.alias[H]),c[H].forEach(function(ie){c[ie]=[H].concat(c[H].filter(function(Ae){return ie!==Ae}))})}),[].concat(o.string).filter(Boolean).forEach(function(H){a.strings[H]=!0,c[H]&&[].concat(c[H]).forEach(function(ie){a.strings[ie]=!0})});var u=o.default||{},h={_:[]};function f(H,ie){return a.allBools&&/^--[^=]+$/.test(ie)||a.strings[H]||a.bools[H]||c[H]}function p(H,ie,Ae){for(var re=H,$e=0;$e<ie.length-1;$e++){var Z=ie[$e];if(r(re,Z))return;re[Z]===void 0&&(re[Z]={}),(re[Z]===Object.prototype||re[Z]===Number.prototype||re[Z]===String.prototype)&&(re[Z]={}),re[Z]===Array.prototype&&(re[Z]=[]),re=re[Z]}var z=ie[ie.length-1];r(re,z)||((re===Object.prototype||re===Number.prototype||re===String.prototype)&&(re={}),re===Array.prototype&&(re=[]),re[z]===void 0||a.bools[z]||typeof re[z]=="boolean"?re[z]=Ae:Array.isArray(re[z])?re[z].push(Ae):re[z]=[re[z],Ae])}function g(H,ie,Ae){if(!(Ae&&a.unknownFn&&!f(H,Ae)&&a.unknownFn(Ae)===!1)){var re=!a.strings[H]&&s(ie)?Number(ie):ie;p(h,H.split("."),re),(c[H]||[]).forEach(function($e){p(h,$e.split("."),re)})}}Object.keys(a.bools).forEach(function(H){g(H,u[H]===void 0?!1:u[H])});var v=[];n.indexOf("--")!==-1&&(v=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--")));for(var b=0;b<n.length;b++){var S=n[b],E,k;if(/^--.+=/.test(S)){var O=S.match(/^--([^=]+)=([\s\S]*)$/);E=O[1];var F=O[2];a.bools[E]&&(F=F!=="false"),g(E,F,S)}else if(/^--no-.+/.test(S))E=S.match(/^--no-(.+)/)[1],g(E,!1,S);else if(/^--.+/.test(S))E=S.match(/^--(.+)/)[1],k=n[b+1],k!==void 0&&!/^(-|--)[^-]/.test(k)&&!a.bools[E]&&!a.allBools&&(!c[E]||!l(E))?(g(E,k,S),b+=1):/^(true|false)$/.test(k)?(g(E,k==="true",S),b+=1):g(E,a.strings[E]?"":!0,S);else if(/^-[^-]+/.test(S)){for(var G=S.slice(1,-1).split(""),j=!1,B=0;B<G.length;B++){if(k=S.slice(B+2),k==="-"){g(G[B],k,S);continue}if(/[A-Za-z]/.test(G[B])&&k[0]==="="){g(G[B],k.slice(1),S),j=!0;break}if(/[A-Za-z]/.test(G[B])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(k)){g(G[B],k,S),j=!0;break}if(G[B+1]&&G[B+1].match(/\W/)){g(G[B],S.slice(B+2),S),j=!0;break}else g(G[B],a.strings[G[B]]?"":!0,S)}E=S.slice(-1)[0],!j&&E!=="-"&&(n[b+1]&&!/^(-|--)[^-]/.test(n[b+1])&&!a.bools[E]&&(!c[E]||!l(E))?(g(E,n[b+1],S),b+=1):n[b+1]&&/^(true|false)$/.test(n[b+1])?(g(E,n[b+1]==="true",S),b+=1):g(E,a.strings[E]?"":!0,S))}else if((!a.unknownFn||a.unknownFn(S)!==!1)&&h._.push(a.strings._||!s(S)?S:Number(S)),o.stopEarly){h._.push.apply(h._,n.slice(b+1));break}}return Object.keys(u).forEach(function(H){i(h,H.split("."))||(p(h,H.split("."),u[H]),(c[H]||[]).forEach(function(ie){p(h,ie.split("."),u[H])}))}),o["--"]?h["--"]=v.slice():v.forEach(function(H){h._.push(H)}),h}}}),dL=ux(hx(),1);import*as fL from"net";var dx;function x1(e,t){const i=Object.create(null);for(const s of e){const r=t(s);let n=i[r];n||(n=i[r]=[]),n.push(s)}return i}function pL(e,t){const i=[],s=[];for(const r of e)t.has(r)||i.push(r);for(const r of t)e.has(r)||s.push(r);return{removed:i,added:s}}var jte=class{static{dx=Symbol.toStringTag}constructor(e,t){this.b=t,this.a=new Map,this[dx]="SetWithKey";for(const i of e)this.add(i)}get size(){return this.a.size}add(e){const t=this.b(e);return this.a.set(t,e),this}delete(e){return this.a.delete(this.b(e))}has(e){return this.a.has(this.b(e))}*entries(){for(const e of this.a.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this.a.values())yield e}clear(){this.a.clear()}forEach(e,t){this.a.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}},gL=class{constructor(){this.b=[],this.a=function(e){setTimeout(()=>{throw e.stack?zs.isErrorNoTelemetry(e)?new zs(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.b.push(e),()=>{this.d(e)}}c(e){this.b.forEach(t=>{t(e)})}d(e){this.b.splice(this.b.indexOf(e),1)}setUnexpectedErrorHandler(e){this.a=e}getUnexpectedErrorHandler(){return this.a}onUnexpectedError(e){this.a(e),this.c(e)}onUnexpectedExternalError(e){this.a(e)}},ru=new gL;function C1(e){ru.setUnexpectedErrorHandler(e)}function mL(e){if(!e||typeof e!="object")return!1;const t=e;return t.code==="EPIPE"&&t.syscall?.toUpperCase()==="WRITE"}function nu(e){ru.onUnexpectedError(e)}function pt(e){ki(e)||ru.onUnexpectedError(e)}function Yd(e){ki(e)||ru.onUnexpectedExternalError(e)}function tc(e){if(e instanceof Error){const{name:t,message:i,cause:s}=e,r=e.stacktrace||e.stack;return{$isError:!0,name:t,message:i,stack:r,noTelemetry:zs.isErrorNoTelemetry(e),cause:s?tc(s):void 0,code:e.code}}return e}function fx(e){let t;return e.noTelemetry?t=new zs:(t=new Error,t.name=e.name),t.message=e.message,t.stack=e.stack,e.code&&(t.code=e.code),e.cause&&(t.cause=fx(e.cause)),t}var Qd="Canceled";function ki(e){return e instanceof dt?!0:e instanceof Error&&e.name===Qd&&e.message===Qd}var dt=class extends Error{constructor(){super(Qd),this.name=this.message}},k1=class t1 extends Error{static{this.a="PendingMigrationError"}static is(t){return t instanceof t1||t instanceof Error&&t.name===t1.a}constructor(t){super(t),this.name=t1.a}};function ou(){const e=new Error(Qd);return e.name=e.message,e}function Me(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}function $1(e){return e?new Error(`Illegal state: ${e}`):new Error("Illegal state")}var No=class extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}};function Xd(e){return e?e.message?e.message:e.stack?e.stack.split(`
`)[0]:String(e):"Error"}var vL=class extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}},I1=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}},zs=class ME extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof ME)return t;const i=new ME;return i.message=t.message,i.stack=t.stack,i}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},Jt=class vN extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,vN.prototype)}};function D1(e,t){const i=this;let s=!1,r;return function(){if(s)return r;if(s=!0,t)try{r=e.apply(i,arguments)}finally{t()}else r=e.apply(i,arguments);return r}}function wL(e,t,i=e.length-1){const s=bL(e,t,i);if(s!==-1)return e[s]}function bL(e,t,i=e.length-1){for(let s=i;s>=0;s--){const r=e[s];if(t(r,s))return s}return-1}function yL(e,t,i=0,s=e.length){let r=i,n=s;for(;r<n;){const o=Math.floor((r+n)/2);t(e[o])?r=o+1:n=o}return r-1}function AL(e,t,i=0,s=e.length){let r=i,n=s;for(;r<n;){const o=Math.floor((r+n)/2);t(e[o])?n=o:r=o+1}return r}var Ute=class wN{static{this.assertInvariants=!1}constructor(t){this.e=t,this.c=0}findLastMonotonous(t){if(wN.assertInvariants){if(this.d){for(const s of this.e)if(this.d(s)&&!t(s))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this.d=t}const i=yL(this.e,t,this.c);return this.c=i+1,i===-1?void 0:this.e[i]}};function $i(e,t,i=(s,r)=>s===r){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let s=0,r=e.length;s<r;s++)if(!i(e[s],t[s]))return!1;return!0}function SL(e,t){const i=[];let s;for(const r of e.slice(0).sort(t))!s||t(s[0],r)!==0?(s=[r],i.push(s)):s.push(r);return i}function px(e,t,i){const s=[];function r(a,c,l){if(c===0&&l.length===0)return;const u=s[s.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=c,u.toInsert.push(...l)):s.push({start:a,deleteCount:c,toInsert:l})}let n=0,o=0;for(;;){if(n===e.length){r(n,0,t.slice(o));break}if(o===t.length){r(n,e.length-n,[]);break}const a=e[n],c=t[o],l=i(a,c);l===0?(n+=1,o+=1):l<0?(r(n,1,[]),n+=1):l>0&&(r(n,0,[c]),o+=1)}return s}function EL(e,t,i){const s=px(e,t,i),r=[],n=[];for(const o of s)r.push(...e.slice(o.start,o.start+o.deleteCount)),n.push(...o.toInsert);return{removed:r,added:n}}function xL(e,t,i,s,r){return i===0?Promise.resolve([]):new Promise((n,o)=>{(async()=>{const a=e.length,c=e.slice(0,i).sort(t);for(let l=i,u=Math.min(i+s,a);l<a;l=u,u=Math.min(u+s,a)){if(l>i&&await new Promise(h=>setTimeout(h)),r&&r.isCancellationRequested)throw new dt;CL(e,t,c,l,u)}return c})().then(n,o)})}function CL(e,t,i,s,r){for(const n=i.length;s<r;s++){const o=e[s];if(t(o,i[n-1])<0){i.pop();const a=AL(i,c=>t(o,c)<0);i.splice(a,0,o)}}}function yt(e){return e.filter(t=>!!t)}function kL(e){let t=0;for(let i=0;i<e.length;i++)e[i]&&(e[t]=e[i],t+=1);e.length=t}function P1(e){return!Array.isArray(e)||e.length===0}function au(e){return Array.isArray(e)&&e.length>0}function Ro(e,t=i=>i){const i=new Set;return e.filter(s=>{const r=t(s);return i.has(r)?!1:(i.add(r),!0)})}function gx(e,t){return e.push(t),()=>$L(e,t)}function $L(e,t){const i=e.indexOf(t);if(i>-1)return e.splice(i,1),t}function mx(e,t){let i;if(typeof t=="number"){let s=t;i=()=>{const r=Math.sin(s++)*179426549;return r-Math.floor(r)}}else i=Math.random;for(let s=e.length-1;s>0;s-=1){const r=Math.floor(i()*(s+1)),n=e[s];e[s]=e[r],e[r]=n}}function Kd(e,t){return Array.isArray(e)?e.map(t):t(e)}function Es(e){return Array.isArray(e)?e:[e]}var T1;(function(e){function t(n){return n<0}e.isLessThan=t;function i(n){return n<=0}e.isLessThanOrEqual=i;function s(n){return n>0}e.isGreaterThan=s;function r(n){return n===0}e.isNeitherLessOrGreaterThan=r,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(T1||(T1={}));function IL(e,t){return(i,s)=>t(e(i),e(s))}var DL=(e,t)=>e-t,zte=class i1{static{this.empty=new i1(t=>{})}constructor(t){this.iterate=t}forEach(t){this.iterate(i=>(t(i),!0))}toArray(){const t=[];return this.iterate(i=>(t.push(i),!0)),t}filter(t){return new i1(i=>this.iterate(s=>t(s)?i(s):!0))}map(t){return new i1(i=>this.iterate(s=>i(t(s))))}some(t){let i=!1;return this.iterate(s=>(i=t(s),!i)),i}findFirst(t){let i;return this.iterate(s=>t(s)?(i=s,!1):!0),i}findLast(t){let i;return this.iterate(s=>(t(s)&&(i=s),!0)),i}findLastMaxBy(t){let i,s=!0;return this.iterate(r=>((s||T1.isGreaterThan(t(r,i)))&&(s=!1,i=r),!0)),i}},vx,wx,bx;function PL(e,t,i){let s=e.get(t);return s===void 0&&(s=i,e.set(t,s)),s}var TL=class{constructor(e,t){this.uri=e,this.value=t}};function ML(e){return Array.isArray(e)}var Ct=class Od{static{this.c=t=>t.toString()}constructor(t,i){if(this[vx]="ResourceMap",t instanceof Od)this.d=new Map(t.d),this.e=i??Od.c;else if(ML(t)){this.d=new Map,this.e=i??Od.c;for(const[s,r]of t)this.set(s,r)}else this.d=new Map,this.e=t??Od.c}set(t,i){return this.d.set(this.e(t),new TL(t,i)),this}get(t){return this.d.get(this.e(t))?.value}has(t){return this.d.has(this.e(t))}get size(){return this.d.size}clear(){this.d.clear()}delete(t){return this.d.delete(this.e(t))}forEach(t,i){typeof i<"u"&&(t=t.bind(i));for(const[s,r]of this.d)t(r.value,r.uri,this)}*values(){for(const t of this.d.values())yield t.value}*keys(){for(const t of this.d.values())yield t.uri}*entries(){for(const t of this.d.values())yield[t.uri,t.value]}*[(vx=Symbol.toStringTag,Symbol.iterator)](){for(const[,t]of this.d)yield[t.uri,t.value]}},cu=class{constructor(e,t){this[wx]="ResourceSet",!e||typeof e=="function"?this.c=new Ct(e):(this.c=new Ct(t),e.forEach(this.add,this))}get size(){return this.c.size}add(e){return this.c.set(e,e),this}clear(){this.c.clear()}delete(e){return this.c.delete(e)}forEach(e,t){this.c.forEach((i,s)=>e.call(t,s,s,this))}has(e){return this.c.has(e)}entries(){return this.c.entries()}keys(){return this.c.keys()}values(){return this.c.keys()}[(wx=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}},yx;(function(e){e[e.None=0]="None",e[e.AsOld=1]="AsOld",e[e.AsNew=2]="AsNew"})(yx||(yx={}));var NL=class{constructor(){this[bx]="LinkedMap",this.c=new Map,this.d=void 0,this.e=void 0,this.f=0,this.g=0}clear(){this.c.clear(),this.d=void 0,this.e=void 0,this.f=0,this.g++}isEmpty(){return!this.d&&!this.e}get size(){return this.f}get first(){return this.d?.value}get last(){return this.e?.value}has(e){return this.c.has(e)}get(e,t=0){const i=this.c.get(e);if(i)return t!==0&&this.n(i,t),i.value}set(e,t,i=0){let s=this.c.get(e);if(s)s.value=t,i!==0&&this.n(s,i);else{switch(s={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.l(s);break;case 1:this.k(s);break;case 2:this.l(s);break;default:this.l(s);break}this.c.set(e,s),this.f++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this.c.get(e);if(t)return this.c.delete(e),this.m(t),this.f--,t.value}shift(){if(!this.d&&!this.e)return;if(!this.d||!this.e)throw new Error("Invalid list");const e=this.d;return this.c.delete(e.key),this.m(e),this.f--,e.value}forEach(e,t){const i=this.g;let s=this.d;for(;s;){if(t?e.bind(t)(s.value,s.key,this):e(s.value,s.key,this),this.g!==i)throw new Error("LinkedMap got modified during iteration.");s=s.next}}keys(){const e=this,t=this.g;let i=this.d;const s={[Symbol.iterator](){return s},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}values(){const e=this,t=this.g;let i=this.d;const s={[Symbol.iterator](){return s},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}entries(){const e=this,t=this.g;let i=this.d;const s={[Symbol.iterator](){return s},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return s}[(bx=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}h(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this.d,i=this.size;for(;t&&i>e;)this.c.delete(t.key),t=t.next,i--;this.d=t,this.f=i,t&&(t.previous=void 0),this.g++}j(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this.e,i=this.size;for(;t&&i>e;)this.c.delete(t.key),t=t.previous,i--;this.e=t,this.f=i,t&&(t.next=void 0),this.g++}k(e){if(!this.d&&!this.e)this.e=e;else if(this.d)e.next=this.d,this.d.previous=e;else throw new Error("Invalid list");this.d=e,this.g++}l(e){if(!this.d&&!this.e)this.d=e;else if(this.e)e.previous=this.e,this.e.next=e;else throw new Error("Invalid list");this.e=e,this.g++}m(e){if(e===this.d&&e===this.e)this.d=void 0,this.e=void 0;else if(e===this.d){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this.d=e.next}else if(e===this.e){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this.e=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this.g++}n(e,t){if(!this.d||!this.e)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this.d)return;const i=e.next,s=e.previous;e===this.e?(s.next=void 0,this.e=s):(i.previous=s,s.next=i),e.previous=void 0,e.next=this.d,this.d.previous=e,this.d=e,this.g++}else if(t===2){if(e===this.e)return;const i=e.next,s=e.previous;e===this.d?(i.previous=void 0,this.d=i):(i.previous=s,s.next=i),e.next=void 0,e.previous=this.e,this.e.next=e,this.e=e,this.g++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}},RL=class extends NL{constructor(e,t=1){super(),this.o=e,this.p=Math.min(Math.max(0,t),1)}get limit(){return this.o}set limit(e){this.o=e,this.q()}get ratio(){return this.p}set ratio(e){this.p=Math.min(Math.max(0,e),1),this.q()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}q(){this.size>this.o&&this.r(Math.round(this.o*this.p))}},ic=class extends RL{constructor(e,t=1){super(e,t)}r(e){this.h(e)}set(e,t){return super.set(e,t),this.q(),this}},LL=class{constructor(e){if(this.c=new Map,this.d=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this.c.clear(),this.d.clear()}set(e,t){this.c.set(e,t),this.d.set(t,e)}get(e){return this.c.get(e)}getKey(e){return this.d.get(e)}delete(e){const t=this.c.get(e);return t===void 0?!1:(this.c.delete(e),this.d.delete(t),!0)}forEach(e,t){this.c.forEach((i,s)=>{e.call(t,i,s,this)})}keys(){return this.c.keys()}values(){return this.c.values()}},Ax=class{constructor(){this.c=new Map}add(e,t){let i=this.c.get(e);i||(i=new Set,this.c.set(e,i)),i.add(t)}delete(e,t){const i=this.c.get(e);i&&(i.delete(t),i.size===0&&this.c.delete(e))}forEach(e,t){const i=this.c.get(e);i&&i.forEach(t)}get(e){const t=this.c.get(e);return t||new Set}};function Ii(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function M1(e,t="Unreachable"){throw new Error(t)}function N1(e,t="unexpected state"){if(!e)throw typeof t=="string"?new Jt(`Assertion Failed: ${t}`):t}function Sx(e){if(!e()){debugger;e(),pt(new Jt("Assertion Failed"))}}function Oe(e){return typeof e=="string"}function OL(e){return FL(e,Oe)}function FL(e,t){return Array.isArray(e)&&e.every(t)}function kt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}function jL(e){const t=Object.getPrototypeOf(Uint8Array);return typeof e=="object"&&e instanceof t}function xs(e){return typeof e=="number"&&!isNaN(e)}function UL(e){return!!e&&typeof e[Symbol.iterator]=="function"}function Ex(e){return e===!0||e===!1}function lu(e){return typeof e>"u"}function ps(e){return!qt(e)}function qt(e){return lu(e)||e===null}function R1(e,t){if(!e)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function sc(e){return N1(e!=null,"Argument is `undefined` or `null`."),e}var zL=Object.prototype.hasOwnProperty;function L1(e){if(!kt(e))return!1;for(const t in e)if(zL.call(e,t))return!1;return!0}function xx(e){return typeof e=="function"}function HL(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++)Cx(e[s],t[s])}function Cx(e,t){if(Oe(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(xx(t)){try{if(e instanceof t)return}catch{}if(!qt(e)&&e.constructor===t||t.length===1&&t.call(void 0,e)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function Dn(e,t){for(const i in t)if(!(i in e))return!1;return!0}var ai;(function(e){function t(j){return!!j&&typeof j=="object"&&typeof j[Symbol.iterator]=="function"}e.is=t;const i=Object.freeze([]);function s(){return i}e.empty=s;function*r(j){yield j}e.single=r;function n(j){return t(j)?j:r(j)}e.wrap=n;function o(j){return j??i}e.from=o;function*a(j){for(let B=j.length-1;B>=0;B--)yield j[B]}e.reverse=a;function c(j){return!j||j[Symbol.iterator]().next().done===!0}e.isEmpty=c;function l(j){return j[Symbol.iterator]().next().value}e.first=l;function u(j,B){let H=0;for(const ie of j)if(B(ie,H++))return!0;return!1}e.some=u;function h(j,B){let H=0;for(const ie of j)if(!B(ie,H++))return!1;return!0}e.every=h;function f(j,B){for(const H of j)if(B(H))return H}e.find=f;function*p(j,B){for(const H of j)B(H)&&(yield H)}e.filter=p;function*g(j,B){let H=0;for(const ie of j)yield B(ie,H++)}e.map=g;function*v(j,B){let H=0;for(const ie of j)yield*B(ie,H++)}e.flatMap=v;function*b(...j){for(const B of j)UL(B)?yield*B:yield B}e.concat=b;function S(j,B,H){let ie=H;for(const Ae of j)ie=B(ie,Ae);return ie}e.reduce=S;function E(j){let B=0;for(const H of j)B++;return B}e.length=E;function*k(j,B,H=j.length){for(B<-j.length&&(B=0),B<0&&(B+=j.length),H<0?H+=j.length:H>j.length&&(H=j.length);B<H;B++)yield j[B]}e.slice=k;function O(j,B=Number.POSITIVE_INFINITY){const H=[];if(B===0)return[H,j];const ie=j[Symbol.iterator]();for(let Ae=0;Ae<B;Ae++){const re=ie.next();if(re.done)return[H,e.empty()];H.push(re.value)}return[H,{[Symbol.iterator](){return ie}}]}e.consume=O;async function F(j){const B=[];for await(const H of j)B.push(H);return B}e.asyncToArray=F;async function G(j){let B=[];for await(const H of j)B=B.concat(H);return B}e.asyncToArrayFlat=G})(ai||(ai={}));var WL=!1,Lo=null,Hte=class bN{constructor(){this.b=new Map}static{this.a=0}c(t){let i=this.b.get(t);return i||(i={parent:null,source:null,isSingleton:!1,value:t,idx:bN.a++},this.b.set(t,i)),i}trackDisposable(t){const i=this.c(t);i.source||(i.source=new Error().stack)}setParent(t,i){const s=this.c(t);s.parent=i}markAsDisposed(t){this.b.delete(t)}markAsSingleton(t){this.c(t).isSingleton=!0}f(t,i){const s=i.get(t);if(s)return s;const r=t.parent?this.f(this.c(t.parent),i):t;return i.set(t,r),r}getTrackedDisposables(){const t=new Map;return[...this.b.entries()].filter(([,s])=>s.source!==null&&!this.f(s,t).isSingleton).flatMap(([s])=>s)}computeLeakingDisposables(t=10,i){let s;if(i)s=i;else{const c=new Map,l=[...this.b.values()].filter(h=>h.source!==null&&!this.f(h,c).isSingleton);if(l.length===0)return;const u=new Set(l.map(h=>h.value));if(s=l.filter(h=>!(h.parent&&u.has(h.parent))),s.length===0)throw new Error("There are cyclic diposable chains!")}if(!s)return;function r(c){function l(h,f){for(;h.length>0&&f.some(p=>typeof p=="string"?p===h[0]:h[0].match(p));)h.shift()}const u=c.source.split(`
`).map(h=>h.trim().replace("at ","")).filter(h=>h!=="");return l(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const n=new Ax;for(const c of s){const l=r(c);for(let u=0;u<=l.length;u++)n.add(l.slice(0,u).join(`
`),c)}s.sort(IL(c=>c.idx,DL));let o="",a=0;for(const c of s.slice(0,t)){a++;const l=r(c),u=[];for(let h=0;h<l.length;h++){let f=l[h];f=`(shared with ${n.get(l.slice(0,h+1).join(`
`)).size}/${s.length} leaks) at ${f}`;const g=n.get(l.slice(0,h).join(`
`)),v=x1([...g].map(b=>r(b)[h]),b=>b);delete v[l[h]];for(const[b,S]of Object.entries(v))S&&u.unshift(`    - stacktraces of ${S.length} other leaks continue with ${b}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${s.length}: ${c.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return s.length>t&&(o+=`


... and ${s.length-t} more leaking disposables

`),{leaks:s,details:o}}};function _L(e){Lo=e}if(WL){const e="__is_disposable_tracked__";_L(new class{trackDisposable(t){const i=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[e]||console.log(i)},3e3)}setParent(t,i){if(t&&t!==J.None)try{t[e]=!0}catch{}}markAsDisposed(t){if(t&&t!==J.None)try{t[e]=!0}catch{}}markAsSingleton(t){}})}function rc(e){return Lo?.trackDisposable(e),e}function nc(e){Lo?.markAsDisposed(e)}function Oo(e,t){Lo?.setParent(e,t)}function BL(e,t){if(Lo)for(const i of e)Lo.setParent(i,t)}function O1(e){return Lo?.markAsSingleton(e),e}function kx(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"&&e.dispose.length===0}function Yi(e){if(ai.is(e)){const t=[];for(const i of e)if(i)try{i.dispose()}catch(s){t.push(s)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function F1(...e){const t=se(()=>Yi(e));return BL(e,t),t}var qL=class{constructor(e){this.a=!1,this.b=e,rc(this)}dispose(){if(!this.a){if(!this.b)throw new Error("Unbound disposable context: Need to use an arrow function to preserve the value of this");this.a=!0,nc(this),this.b()}}};function se(e){return new qL(e)}var X=class yN{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this.f=new Set,this.g=!1,rc(this)}dispose(){this.g||(nc(this),this.g=!0,this.clear())}get isDisposed(){return this.g}clear(){if(this.f.size!==0)try{Yi(this.f)}finally{this.f.clear()}}add(t){if(!t||t===J.None)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return Oo(t,this),this.g?yN.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this.f.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this.f.delete(t),t.dispose()}}deleteAndLeak(t){t&&this.f.delete(t)&&Oo(t,null)}assertNotDisposed(){this.g&&pt(new Jt("Object disposed"))}},J=class{static{this.None=Object.freeze({dispose(){}})}constructor(){this.B=new X,rc(this),Oo(this.B,this)}dispose(){nc(this),this.B.dispose()}D(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this.B.add(e)}},Hs=class{constructor(){this.b=!1,rc(this)}get value(){return this.b?void 0:this.a}set value(e){this.b||e===this.a||(this.a?.dispose(),e&&Oo(e,this),this.a=e)}clear(){this.value=void 0}dispose(){this.b=!0,nc(this),this.a?.dispose(),this.a=void 0}clearAndLeak(){const e=this.a;return this.a=void 0,e&&Oo(e,null),e}},Fo=class{constructor(e=new Map){this.b=!1,this.a=e,rc(this)}dispose(){nc(this),this.b=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this.a.size)try{Yi(this.a.values())}finally{this.a.clear()}}has(e){return this.a.has(e)}get size(){return this.a.size}get(e){return this.a.get(e)}set(e,t,i=!1){this.b&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this.a.get(e)?.dispose(),this.a.set(e,t),Oo(t,this)}deleteAndDispose(e){this.a.get(e)?.dispose(),this.a.delete(e)}deleteAndLeak(e){const t=this.a.get(e);return t&&Oo(t,null),this.a.delete(e),t}keys(){return this.a.keys()}values(){return this.a.values()}[Symbol.iterator](){return this.a[Symbol.iterator]()}};function VL(e,t){return e.then(i=>(t.isDisposed?i.dispose():t.add(i),i))}var GL=class extends Fo{constructor(){super(new Ct)}},zt=class s1{static{this.Undefined=new s1(void 0)}constructor(t){this.element=t,this.next=s1.Undefined,this.prev=s1.Undefined}},Pn=class{constructor(){this.a=zt.Undefined,this.b=zt.Undefined,this.c=0}get size(){return this.c}isEmpty(){return this.a===zt.Undefined}clear(){let e=this.a;for(;e!==zt.Undefined;){const t=e.next;e.prev=zt.Undefined,e.next=zt.Undefined,e=t}this.a=zt.Undefined,this.b=zt.Undefined,this.c=0}unshift(e){return this.d(e,!1)}push(e){return this.d(e,!0)}d(e,t){const i=new zt(e);if(this.a===zt.Undefined)this.a=i,this.b=i;else if(t){const r=this.b;this.b=i,i.prev=r,r.next=i}else{const r=this.a;this.a=i,i.next=r,r.prev=i}this.c+=1;let s=!1;return()=>{s||(s=!0,this.e(i))}}shift(){if(this.a!==zt.Undefined){const e=this.a.element;return this.e(this.a),e}}pop(){if(this.b!==zt.Undefined){const e=this.b.element;return this.e(this.b),e}}peek(){if(this.b!==zt.Undefined)return this.b.element}e(e){if(e.prev!==zt.Undefined&&e.next!==zt.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===zt.Undefined&&e.next===zt.Undefined?(this.a=zt.Undefined,this.b=zt.Undefined):e.next===zt.Undefined?(this.b=this.b.prev,this.b.next=zt.Undefined):e.prev===zt.Undefined&&(this.a=this.a.next,this.a.prev=zt.Undefined);this.c-=1}*[Symbol.iterator](){let e=this.a;for(;e!==zt.Undefined;)yield e.element,e=e.next}},JL=globalThis.performance.now.bind(globalThis.performance),Qi=class AN{static create(t){return new AN(t)}constructor(t){this.c=t===!1?Date.now:JL,this.a=this.c(),this.b=-1}stop(){this.b=this.c()}reset(){this.a=this.c(),this.b=-1}elapsed(){return this.b!==-1?this.b-this.a:this.c()-this.a}},$x=!1,ZL=!1,Ie;(function(e){e.None=()=>J.None;function t(Z){if(ZL){const{onDidAddListener:z}=Z,ee=j1.create();let Y=0;Z.onDidAddListener=()=>{++Y===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),ee.print()),z?.()}}}function i(Z,z,ee){return p(Z,()=>{},0,void 0,z??!0,void 0,ee)}e.defer=i;function s(Z){return(z,ee=null,Y)=>{let ae=!1,ge;return ge=Z(we=>{if(!ae)return ge?ge.dispose():ae=!0,z.call(ee,we)},null,Y),ae&&ge.dispose(),ge}}e.once=s;function r(Z,z){return e.once(e.filter(Z,z))}e.onceIf=r;function n(Z,z,ee){return h((Y,ae=null,ge)=>Z(we=>Y.call(ae,z(we)),null,ge),ee)}e.map=n;function o(Z,z,ee){return h((Y,ae=null,ge)=>Z(we=>{z(we),Y.call(ae,we)},null,ge),ee)}e.forEach=o;function a(Z,z,ee){return h((Y,ae=null,ge)=>Z(we=>z(we)&&Y.call(ae,we),null,ge),ee)}e.filter=a;function c(Z){return Z}e.signal=c;function l(...Z){return(z,ee=null,Y)=>{const ae=F1(...Z.map(ge=>ge(we=>z.call(ee,we))));return f(ae,Y)}}e.any=l;function u(Z,z,ee,Y){let ae=ee;return n(Z,ge=>(ae=z(ae,ge),ae),Y)}e.reduce=u;function h(Z,z){let ee;const Y={onWillAddFirstListener(){ee=Z(ae.fire,ae)},onDidRemoveLastListener(){ee?.dispose()}};z||t(Y);const ae=new I(Y);return z?.add(ae),ae.event}function f(Z,z){return z instanceof Array?z.push(Z):z&&z.add(Z),Z}function p(Z,z,ee=100,Y=!1,ae=!1,ge,we){let ht,We,Le,vt=0,Gt;const jt={leakWarningThreshold:ge,onWillAddFirstListener(){ht=Z($n=>{vt++,We=z(We,$n),Y&&!Le&&(yi.fire(We),We=void 0),Gt=()=>{const ui=We;We=void 0,Le=void 0,(!Y||vt>1)&&yi.fire(ui),vt=0},typeof ee=="number"?(Le&&clearTimeout(Le),Le=setTimeout(Gt,ee)):Le===void 0&&(Le=null,queueMicrotask(Gt))})},onWillRemoveListener(){ae&&vt>0&&Gt?.()},onDidRemoveLastListener(){Gt=void 0,ht.dispose()}};we||t(jt);const yi=new I(jt);return we?.add(yi),yi.event}e.debounce=p;function g(Z,z=0,ee,Y){return e.debounce(Z,(ae,ge)=>ae?(ae.push(ge),ae):[ge],z,void 0,ee??!0,void 0,Y)}e.accumulate=g;function v(Z,z,ee=100,Y=!0,ae=!0,ge,we){let ht,We,Le,vt=0;const Gt={leakWarningThreshold:ge,onWillAddFirstListener(){ht=Z(yi=>{vt++,We=z(We,yi),Le===void 0&&(Y&&(jt.fire(We),We=void 0,vt=0),typeof ee=="number"?Le=setTimeout(()=>{ae&&vt>0&&jt.fire(We),We=void 0,Le=void 0,vt=0},ee):(Le=0,queueMicrotask(()=>{ae&&vt>0&&jt.fire(We),We=void 0,Le=void 0,vt=0})))})},onDidRemoveLastListener(){ht.dispose()}};we||t(Gt);const jt=new I(Gt);return we?.add(jt),jt.event}e.throttle=v;function b(Z,z=(Y,ae)=>Y===ae,ee){let Y=!0,ae;return a(Z,ge=>{const we=Y||!z(ge,ae);return Y=!1,ae=ge,we},ee)}e.latch=b;function S(Z,z,ee){return[e.filter(Z,z,ee),e.filter(Z,Y=>!z(Y),ee)]}e.split=S;function E(Z,z=!1,ee=[],Y){let ae=ee.slice(),ge=Z(We=>{ae?ae.push(We):ht.fire(We)});Y&&Y.add(ge);const we=()=>{ae?.forEach(We=>ht.fire(We)),ae=null},ht=new I({onWillAddFirstListener(){ge||(ge=Z(We=>ht.fire(We)),Y&&Y.add(ge))},onDidAddFirstListener(){ae&&(z?setTimeout(we):we())},onDidRemoveLastListener(){ge&&ge.dispose(),ge=null}});return Y&&Y.add(ht),ht.event}e.buffer=E;function k(Z,z){return(Y,ae,ge)=>{const we=z(new F);return Z(function(ht){const We=we.evaluate(ht);We!==O&&Y.call(ae,We)},void 0,ge)}}e.chain=k;const O=Symbol("HaltChainable");class F{constructor(){this.f=[]}map(z){return this.f.push(z),this}forEach(z){return this.f.push(ee=>(z(ee),ee)),this}filter(z){return this.f.push(ee=>z(ee)?ee:O),this}reduce(z,ee){let Y=ee;return this.f.push(ae=>(Y=z(Y,ae),Y)),this}latch(z=(ee,Y)=>ee===Y){let ee=!0,Y;return this.f.push(ae=>{const ge=ee||!z(ae,Y);return ee=!1,Y=ae,ge?ae:O}),this}evaluate(z){for(const ee of this.f)if(z=ee(z),z===O)break;return z}}function G(Z,z,ee=Y=>Y){const Y=(...ht)=>we.fire(ee(...ht)),ae=()=>Z.on(z,Y),ge=()=>Z.removeListener(z,Y),we=new I({onWillAddFirstListener:ae,onDidRemoveLastListener:ge});return we.event}e.fromNodeEventEmitter=G;function j(Z,z,ee=Y=>Y){const Y=(...ht)=>we.fire(ee(...ht)),ae=()=>Z.addEventListener(z,Y),ge=()=>Z.removeEventListener(z,Y),we=new I({onWillAddFirstListener:ae,onDidRemoveLastListener:ge});return we.event}e.fromDOMEventEmitter=j;function B(Z,z){let ee,Y;const ae=new Promise(ge=>{Y=s(Z)(ge),U1(Y,z),ee=()=>{Px(Y,z)}});return ae.cancel=ee,z&&ae.finally(()=>Px(Y,z)),ae}e.toPromise=B;function H(Z,z){return Z(ee=>z.fire(ee))}e.forward=H;function ie(Z,z,ee){return z(ee),Z(Y=>z(Y))}e.runAndSubscribe=ie;class Ae{constructor(z,ee){this._observable=z,this.f=0,this.g=!1;const Y={onWillAddFirstListener:()=>{z.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{z.removeObserver(this)}};ee||t(Y),this.emitter=new I(Y),ee&&ee.add(this.emitter)}beginUpdate(z){this.f++}handlePossibleChange(z){}handleChange(z,ee){this.g=!0}endUpdate(z){this.f--,this.f===0&&(this._observable.reportChanges(),this.g&&(this.g=!1,this.emitter.fire(this._observable.get())))}}function re(Z,z){return new Ae(Z,z).emitter.event}e.fromObservable=re;function $e(Z){return(z,ee,Y)=>{let ae=0,ge=!1;const we={beginUpdate(){ae++},endUpdate(){ae--,ae===0&&(Z.reportChanges(),ge&&(ge=!1,z.call(ee)))},handlePossibleChange(){},handleChange(){ge=!0}};Z.addObserver(we),Z.reportChanges();const ht={dispose(){Z.removeObserver(we)}};return U1(ht,Y),ht}}e.fromObservableLight=$e})(Ie||(Ie={}));var YL=class NE{static{this.all=new Set}static{this.f=0}constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${NE.f++}`,NE.all.add(this)}start(t){this.g=new Qi,this.listenerCount=t}stop(){if(this.g){const t=this.g.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this.g=void 0}}},Ix=-1,QL=class SN{static{this.f=1}constructor(t,i,s=(SN.f++).toString(16).padStart(3,"0")){this.j=t,this.threshold=i,this.name=s,this.h=0}dispose(){this.g?.clear()}check(t,i){const s=this.threshold;if(s<=0||i<s)return;this.g||(this.g=new Map);const r=this.g.get(t.value)||0;if(this.g.set(t.value,r+1),this.h-=1,this.h<=0){this.h=s*.5;const[n,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(n);const c=new XL(a,n);this.j(c)}return()=>{const n=this.g.get(t.value)||0;this.g.set(t.value,n-1)}}getMostFrequentStack(){if(!this.g)return;let t,i=0;for(const[s,r]of this.g)(!t||i<r)&&(t=[s,r],i=r);return t}},j1=class EN{static create(){const t=new Error;return new EN(t.stack??"")}constructor(t){this.value=t}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},XL=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},KL=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},e2=0,ef=class{constructor(e){this.value=e,this.id=e2++}},t2=2,Dx=(e,t)=>{if(e instanceof ef)t(e);else for(let i=0;i<e.length;i++){const s=e[i];s&&t(s)}},I=class{constructor(e){this.A=0,this.g=e,this.j=Ix>0||this.g?.leakWarningThreshold?new QL(e?.onListenerError??pt,this.g?.leakWarningThreshold??Ix):void 0,this.m=this.g?._profName?new YL(this.g._profName):void 0,this.z=this.g?.deliveryQueue}dispose(){if(!this.q){if(this.q=!0,this.z?.current===this&&this.z.reset(),this.w){if($x){const e=this.w;queueMicrotask(()=>{Dx(e,t=>t.stack?.print())})}this.w=void 0,this.A=0}this.g?.onDidRemoveLastListener?.(),this.j?.dispose()}}get event(){return this.u??=(e,t,i)=>{if(this.j&&this.A>this.j.threshold**2){const a=`[${this.j.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this.A} vs ${this.j.threshold})`;console.warn(a);const c=this.j.getMostFrequentStack()??["UNKNOWN stack",-1],l=new KL(`${a}. HINT: Stack shows most frequent listener (${c[1]}-times)`,c[0]);return(this.g?.onListenerError||pt)(l),J.None}if(this.q)return J.None;t&&(e=e.bind(t));const s=new ef(e);let r,n;this.j&&this.A>=Math.ceil(this.j.threshold*.2)&&(s.stack=j1.create(),r=this.j.check(s.stack,this.A+1)),$x&&(s.stack=n??j1.create()),this.w?this.w instanceof ef?(this.z??=new i2,this.w=[this.w,s]):this.w.push(s):(this.g?.onWillAddFirstListener?.(this),this.w=s,this.g?.onDidAddFirstListener?.(this)),this.g?.onDidAddListener?.(this),this.A++;const o=se(()=>{r?.(),this.B(s)});return U1(o,i),o},this.u}B(e){if(this.g?.onWillRemoveListener?.(this),!this.w)return;if(this.A===1){this.w=void 0,this.g?.onDidRemoveLastListener?.(this),this.A=0;return}const t=this.w,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this.q),console.log("size?",this.A),console.log("arr?",JSON.stringify(this.w)),new Error("Attempted to dispose unknown listener");this.A--,t[i]=void 0;const s=this.z.current===this;if(this.A*t2<=t.length){let r=0;for(let n=0;n<t.length;n++)t[n]?t[r++]=t[n]:s&&r<this.z.end&&(this.z.end--,r<this.z.i&&this.z.i--);t.length=r}}C(e,t){if(!e)return;const i=this.g?.onListenerError||pt;if(!i){e.value(t);return}try{e.value(t)}catch(s){i(s)}}D(e){const t=e.current.w;for(;e.i<e.end;)this.C(t[e.i++],e.value);e.reset()}fire(e){if(this.z?.current&&(this.D(this.z),this.m?.stop()),this.m?.start(this.A),this.w)if(this.w instanceof ef)this.C(this.w,e);else{const t=this.z;t.enqueue(this,e,this.w.length),this.D(t)}this.m?.stop()}hasListeners(){return this.A>0}},i2=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},uu=class extends I{async fireAsync(e,t,i){if(this.w)for(this.f||(this.f=new Pn),Dx(this.w,s=>this.f.push([s.value,e]));this.f.size>0&&!t.isCancellationRequested;){const[s,r]=this.f.shift(),n=[],o={...r,token:t,waitUntil:a=>{if(Object.isFrozen(n))throw new Error("waitUntil can NOT be called asynchronous");i&&(a=i(a,s)),n.push(a)}};try{s(o)}catch(a){pt(a);continue}Object.freeze(n),await Promise.allSettled(n).then(a=>{for(const c of a)c.status==="rejected"&&pt(c.reason)})}}},hu=class extends I{get isPaused(){return this.f!==0}constructor(e){super(e),this.f=0,this.h=new Pn,this.s=e?.merge}pause(){this.f++}resume(){if(this.f!==0&&--this.f===0)if(this.s){if(this.h.size>0){const e=Array.from(this.h);this.h.clear(),super.fire(this.s(e))}}else for(;!this.f&&this.h.size!==0;)super.fire(this.h.shift())}fire(e){this.A&&(this.f!==0?this.h.push(e):super.fire(e))}},s2=class extends hu{constructor(e){super(e),this.k=e.delay??100}fire(e){this.o||(this.pause(),this.o=setTimeout(()=>{this.o=void 0,this.resume()},this.k)),super.fire(e)}},r2=class extends I{constructor(e){super(e),this.f=[],this.h=e?.merge}fire(e){this.hasListeners()&&(this.f.push(e),this.f.length===1&&queueMicrotask(()=>{this.h?super.fire(this.h(this.f)):this.f.forEach(t=>super.fire(t)),this.f=[]}))}},n2=class{constructor(){this.f=!1,this.g=Ie.None,this.h=J.None,this.j=new I({onDidAddFirstListener:()=>{this.f=!0,this.h=this.g(this.j.fire,this.j)},onDidRemoveLastListener:()=>{this.f=!1,this.h.dispose()}}),this.event=this.j.event}set input(e){this.g=e,this.f&&(this.h.dispose(),this.h=e(this.j.fire,this.j))}dispose(){this.h.dispose(),this.j.dispose()}};function U1(e,t){t instanceof X?t.add(e):Array.isArray(t)&&t.push(e)}function Px(e,t){if(t instanceof X)t.delete(e);else if(Array.isArray(t)){const i=t.indexOf(e);i!==-1&&t.splice(i,1)}e.dispose()}var Tx=Object.freeze(function(e,t){const i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}),De;(function(e){function t(i){return i===e.None||i===e.Cancelled||i instanceof tf?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ie.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Tx})})(De||(De={}));var tf=class{constructor(){this.a=!1,this.b=null}cancel(){this.a||(this.a=!0,this.b&&(this.b.fire(void 0),this.dispose()))}get isCancellationRequested(){return this.a}get onCancellationRequested(){return this.a?Tx:(this.b||(this.b=new I),this.b.event)}dispose(){this.b&&(this.b.dispose(),this.b=null)}},Ke=class{constructor(e){this.f=void 0,this.g=void 0,this.g=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this.f||(this.f=new tf),this.f}cancel(){this.f?this.f instanceof tf&&this.f.cancel():this.f=De.Cancelled}dispose(e=!1){e&&this.cancel(),this.g?.dispose(),this.f?this.f instanceof tf&&this.f.dispose():this.f=De.None}};function o2(){return globalThis._VSCODE_NLS_MESSAGES}function Mx(){return globalThis._VSCODE_NLS_LANGUAGE}var a2=Mx()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function sf(e,t){let i;return t.length===0?i=e:i=e.replace(/\{(\d+)\}/g,(s,r)=>{const n=r[0],o=t[n];let a=s;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),a2&&(i="\uFF3B"+i.replace(/[aouei]/g,"$&$&")+"\uFF3D"),i}function d(e,t,...i){return sf(typeof e=="number"?Nx(e,t):t,i)}function Nx(e,t){const i=o2()?.[e];if(typeof i!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${e} !!!`)}return i}function rf(e,t,...i){let s;typeof e=="number"?s=Nx(e,t):s=t;const r=sf(s,i);return{value:r,original:t===s?r:sf(t,i)}}var Tn="en",du=!1,fu=!1,pu=!1,c2=!1,Rx=!1,z1=!1,l2=!1,H1=!1,Lx=!1,Ox=!1,nf=void 0,of=Tn,Fx=Tn,u2=void 0,Vr=void 0,Gr=globalThis,Xi=void 0;typeof Gr.vscode<"u"&&typeof Gr.vscode.process<"u"?Xi=Gr.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Xi=process);var jx=typeof Xi?.versions?.electron=="string",h2=jx&&Xi?.type==="renderer";if(typeof Xi=="object"){du=Xi.platform==="win32",fu=Xi.platform==="darwin",pu=Xi.platform==="linux",c2=pu&&!!Xi.env.SNAP&&!!Xi.env.SNAP_REVISION,l2=jx,Lx=!!Xi.env.CI||!!Xi.env.BUILD_ARTIFACTSTAGINGDIRECTORY||!!Xi.env.GITHUB_WORKSPACE,nf=Tn,of=Tn;const e=Xi.env.VSCODE_NLS_CONFIG;if(e)try{const t=JSON.parse(e);nf=t.userLocale,Fx=t.osLocale,of=t.resolvedLanguage||Tn,u2=t.languagePack?.translationsConfigFile}catch{}Rx=!0}else typeof navigator=="object"&&!h2?(Vr=navigator.userAgent,du=Vr.indexOf("Windows")>=0,fu=Vr.indexOf("Macintosh")>=0,H1=(Vr.indexOf("Macintosh")>=0||Vr.indexOf("iPad")>=0||Vr.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,pu=Vr.indexOf("Linux")>=0,Ox=Vr?.indexOf("Mobi")>=0,z1=!0,of=Mx()||Tn,nf=navigator.language.toLowerCase(),Fx=nf):console.error("Unable to resolve platform.");var Ux;(function(e){e[e.Web=0]="Web",e[e.Mac=1]="Mac",e[e.Linux=2]="Linux",e[e.Windows=3]="Windows"})(Ux||(Ux={}));function d2(e){switch(e){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var af=0;fu?af=1:du?af=3:pu&&(af=2);var ze=du,Nt=fu,Mt=pu,zx=Rx,jo=z1,f2=z1&&typeof Gr.importScripts=="function",p2=f2?Gr.origin:void 0,g2=H1,m2=Ox,Uo=Lx,v2=af,mr=Vr,Mn=of,Hx;(function(e){function t(){return Mn}e.value=t;function i(){return Mn.length===2?Mn==="en":Mn.length>=3?Mn[0]==="e"&&Mn[1]==="n"&&Mn[2]==="-":!1}e.isDefaultVariant=i;function s(){return Mn==="en"}e.isDefault=s})(Hx||(Hx={}));var w2=typeof Gr.postMessage=="function"&&!Gr.importScripts,Wx=(()=>{if(w2){const e=[];Gr.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork)for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n.id===i.data.vscodeScheduleAsyncWork){e.splice(s,1),n.callback();return}}});let t=0;return i=>{const s=++t;e.push({id:s,callback:i}),Gr.postMessage({vscodeScheduleAsyncWork:s},"*")}}return e=>setTimeout(e)})(),_x;(function(e){e[e.Windows=1]="Windows",e[e.Macintosh=2]="Macintosh",e[e.Linux=3]="Linux"})(_x||(_x={}));var Nn=fu||H1?2:du?1:3,Bx=!0,qx=!1;function Vx(){if(!qx){qx=!0;const e=new Uint8Array(2);e[0]=1,e[1]=2,Bx=new Uint16Array(e.buffer)[0]===513}return Bx}var W1=!!(mr&&mr.indexOf("Chrome")>=0),b2=!!(mr&&mr.indexOf("Firefox")>=0),y2=!!(!W1&&mr&&mr.indexOf("Safari")>=0),Gx=!!(mr&&mr.indexOf("Edg/")>=0),Wte=!!(mr&&mr.indexOf("Android")>=0),zo,_1=globalThis.vscode;if(typeof _1<"u"&&typeof _1.process<"u"){const e=_1.process;zo={get platform(){return e.platform},get arch(){return e.arch},get env(){return e.env},cwd(){return e.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?zo={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:zo={get platform(){return ze?"win32":Nt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Ho=zo.cwd,Rn=zo.env,A2=zo.platform,_te=zo.arch,S2=65,E2=97,x2=90,C2=122,Wo=46,vi=47,Ki=92,Jr=58,k2=63,Jx=class extends Error{constructor(e,t,i){let s;typeof t=="string"&&t.indexOf("not ")===0?(s="must not be",t=t.replace(/^not /,"")):s="must be";const r=e.indexOf(".")!==-1?"property":"argument";let n=`The "${e}" ${r} ${s} of type ${t}`;n+=`. Received type ${typeof i}`,super(n),this.code="ERR_INVALID_ARG_TYPE"}};function $2(e,t){if(e===null||typeof e!="object")throw new Jx(t,"Object",e)}function Zt(e,t){if(typeof e!="string")throw new Jx(t,"string",e)}var es=A2==="win32";function je(e){return e===vi||e===Ki}function B1(e){return e===vi}function Zr(e){return e>=S2&&e<=x2||e>=E2&&e<=C2}function cf(e,t,i,s){let r="",n=0,o=-1,a=0,c=0;for(let l=0;l<=e.length;++l){if(l<e.length)c=e.charCodeAt(l);else{if(s(c))break;c=vi}if(s(c)){if(!(o===l-1||a===1))if(a===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==Wo||r.charCodeAt(r.length-2)!==Wo){if(r.length>2){const u=r.lastIndexOf(i);u===-1?(r="",n=0):(r=r.slice(0,u),n=r.length-1-r.lastIndexOf(i)),o=l,a=0;continue}else if(r.length!==0){r="",n=0,o=l,a=0;continue}}t&&(r+=r.length>0?`${i}..`:"..",n=2)}else r.length>0?r+=`${i}${e.slice(o+1,l)}`:r=e.slice(o+1,l),n=l-o-1;o=l,a=0}else c===Wo&&a!==-1?++a:a=-1}return r}function I2(e){return e?`${e[0]==="."?"":"."}${e}`:""}function Zx(e,t){$2(t,"pathObject");const i=t.dir||t.root,s=t.base||`${t.name||""}${I2(t.ext)}`;return i?i===t.root?`${i}${s}`:`${i}${e}${s}`:s}var Yt={resolve(...e){let t="",i="",s=!1;for(let r=e.length-1;r>=-1;r--){let n;if(r>=0){if(n=e[r],Zt(n,`paths[${r}]`),n.length===0)continue}else t.length===0?n=Ho():(n=Rn[`=${t}`]||Ho(),(n===void 0||n.slice(0,2).toLowerCase()!==t.toLowerCase()&&n.charCodeAt(2)===Ki)&&(n=`${t}\\`));const o=n.length;let a=0,c="",l=!1;const u=n.charCodeAt(0);if(o===1)je(u)&&(a=1,l=!0);else if(je(u))if(l=!0,je(n.charCodeAt(1))){let h=2,f=h;for(;h<o&&!je(n.charCodeAt(h));)h++;if(h<o&&h!==f){const p=n.slice(f,h);for(f=h;h<o&&je(n.charCodeAt(h));)h++;if(h<o&&h!==f){for(f=h;h<o&&!je(n.charCodeAt(h));)h++;(h===o||h!==f)&&(c=`\\\\${p}\\${n.slice(f,h)}`,a=h)}}}else a=1;else Zr(u)&&n.charCodeAt(1)===Jr&&(c=n.slice(0,2),a=2,o>2&&je(n.charCodeAt(2))&&(l=!0,a=3));if(c.length>0)if(t.length>0){if(c.toLowerCase()!==t.toLowerCase())continue}else t=c;if(s){if(t.length>0)break}else if(i=`${n.slice(a)}\\${i}`,s=l,l&&t.length>0)break}return i=cf(i,!s,"\\",je),s?`${t}\\${i}`:`${t}${i}`||"."},normalize(e){Zt(e,"path");const t=e.length;if(t===0)return".";let i=0,s,r=!1;const n=e.charCodeAt(0);if(t===1)return B1(n)?"\\":e;if(je(n))if(r=!0,je(e.charCodeAt(1))){let a=2,c=a;for(;a<t&&!je(e.charCodeAt(a));)a++;if(a<t&&a!==c){const l=e.slice(c,a);for(c=a;a<t&&je(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&!je(e.charCodeAt(a));)a++;if(a===t)return`\\\\${l}\\${e.slice(c)}\\`;a!==c&&(s=`\\\\${l}\\${e.slice(c,a)}`,i=a)}}}else i=1;else Zr(n)&&e.charCodeAt(1)===Jr&&(s=e.slice(0,2),i=2,t>2&&je(e.charCodeAt(2))&&(r=!0,i=3));let o=i<t?cf(e.slice(i),!r,"\\",je):"";if(o.length===0&&!r&&(o="."),o.length>0&&je(e.charCodeAt(t-1))&&(o+="\\"),!r&&s===void 0&&e.includes(":")){if(o.length>=2&&Zr(o.charCodeAt(0))&&o.charCodeAt(1)===Jr)return`.\\${o}`;let a=e.indexOf(":");do if(a===t-1||je(e.charCodeAt(a+1)))return`.\\${o}`;while((a=e.indexOf(":",a+1))!==-1)}return s===void 0?r?`\\${o}`:o:r?`${s}\\${o}`:`${s}${o}`},isAbsolute(e){Zt(e,"path");const t=e.length;if(t===0)return!1;const i=e.charCodeAt(0);return je(i)||t>2&&Zr(i)&&e.charCodeAt(1)===Jr&&je(e.charCodeAt(2))},join(...e){if(e.length===0)return".";let t,i;for(let n=0;n<e.length;++n){const o=e[n];Zt(o,"path"),o.length>0&&(t===void 0?t=i=o:t+=`\\${o}`)}if(t===void 0)return".";let s=!0,r=0;if(typeof i=="string"&&je(i.charCodeAt(0))){++r;const n=i.length;n>1&&je(i.charCodeAt(1))&&(++r,n>2&&(je(i.charCodeAt(2))?++r:s=!1))}if(s){for(;r<t.length&&je(t.charCodeAt(r));)r++;r>=2&&(t=`\\${t.slice(r)}`)}return Yt.normalize(t)},relative(e,t){if(Zt(e,"from"),Zt(t,"to"),e===t)return"";const i=Yt.resolve(e),s=Yt.resolve(t);if(i===s||(e=i.toLowerCase(),t=s.toLowerCase(),e===t))return"";if(i.length!==e.length||s.length!==t.length){const g=i.split("\\"),v=s.split("\\");g[g.length-1]===""&&g.pop(),v[v.length-1]===""&&v.pop();const b=g.length,S=v.length,E=b<S?b:S;let k;for(k=0;k<E&&g[k].toLowerCase()===v[k].toLowerCase();k++);return k===0?s:k===E?S>E?v.slice(k).join("\\"):b>E?"..\\".repeat(b-1-k)+"..":"":"..\\".repeat(b-k)+v.slice(k).join("\\")}let r=0;for(;r<e.length&&e.charCodeAt(r)===Ki;)r++;let n=e.length;for(;n-1>r&&e.charCodeAt(n-1)===Ki;)n--;const o=n-r;let a=0;for(;a<t.length&&t.charCodeAt(a)===Ki;)a++;let c=t.length;for(;c-1>a&&t.charCodeAt(c-1)===Ki;)c--;const l=c-a,u=o<l?o:l;let h=-1,f=0;for(;f<u;f++){const g=e.charCodeAt(r+f);if(g!==t.charCodeAt(a+f))break;g===Ki&&(h=f)}if(f!==u){if(h===-1)return s}else{if(l>u){if(t.charCodeAt(a+f)===Ki)return s.slice(a+f+1);if(f===2)return s.slice(a+f)}o>u&&(e.charCodeAt(r+f)===Ki?h=f:f===2&&(h=3)),h===-1&&(h=0)}let p="";for(f=r+h+1;f<=n;++f)(f===n||e.charCodeAt(f)===Ki)&&(p+=p.length===0?"..":"\\..");return a+=h,p.length>0?`${p}${s.slice(a,c)}`:(s.charCodeAt(a)===Ki&&++a,s.slice(a,c))},toNamespacedPath(e){if(typeof e!="string"||e.length===0)return e;const t=Yt.resolve(e);if(t.length<=2)return e;if(t.charCodeAt(0)===Ki){if(t.charCodeAt(1)===Ki){const i=t.charCodeAt(2);if(i!==k2&&i!==Wo)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(Zr(t.charCodeAt(0))&&t.charCodeAt(1)===Jr&&t.charCodeAt(2)===Ki)return`\\\\?\\${t}`;return t},dirname(e){Zt(e,"path");const t=e.length;if(t===0)return".";let i=-1,s=0;const r=e.charCodeAt(0);if(t===1)return je(r)?e:".";if(je(r)){if(i=s=1,je(e.charCodeAt(1))){let a=2,c=a;for(;a<t&&!je(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&je(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&!je(e.charCodeAt(a));)a++;if(a===t)return e;a!==c&&(i=s=a+1)}}}}else Zr(r)&&e.charCodeAt(1)===Jr&&(i=t>2&&je(e.charCodeAt(2))?3:2,s=i);let n=-1,o=!0;for(let a=t-1;a>=s;--a)if(je(e.charCodeAt(a))){if(!o){n=a;break}}else o=!1;if(n===-1){if(i===-1)return".";n=i}return e.slice(0,n)},basename(e,t){t!==void 0&&Zt(t,"suffix"),Zt(e,"path");let i=0,s=-1,r=!0,n;if(e.length>=2&&Zr(e.charCodeAt(0))&&e.charCodeAt(1)===Jr&&(i=2),t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=i;--n){const c=e.charCodeAt(n);if(je(c)){if(!r){i=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return i===s?s=a:s===-1&&(s=e.length),e.slice(i,s)}for(n=e.length-1;n>=i;--n)if(je(e.charCodeAt(n))){if(!r){i=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":e.slice(i,s)},extname(e){Zt(e,"path");let t=0,i=-1,s=0,r=-1,n=!0,o=0;e.length>=2&&e.charCodeAt(1)===Jr&&Zr(e.charCodeAt(0))&&(t=s=2);for(let a=e.length-1;a>=t;--a){const c=e.charCodeAt(a);if(je(c)){if(!n){s=a+1;break}continue}r===-1&&(n=!1,r=a+1),c===Wo?i===-1?i=a:o!==1&&(o=1):i!==-1&&(o=-1)}return i===-1||r===-1||o===0||o===1&&i===r-1&&i===s+1?"":e.slice(i,r)},format:Zx.bind(null,"\\"),parse(e){Zt(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.length;let s=0,r=e.charCodeAt(0);if(i===1)return je(r)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(je(r)){if(s=1,je(e.charCodeAt(1))){let h=2,f=h;for(;h<i&&!je(e.charCodeAt(h));)h++;if(h<i&&h!==f){for(f=h;h<i&&je(e.charCodeAt(h));)h++;if(h<i&&h!==f){for(f=h;h<i&&!je(e.charCodeAt(h));)h++;h===i?s=h:h!==f&&(s=h+1)}}}}else if(Zr(r)&&e.charCodeAt(1)===Jr){if(i<=2)return t.root=t.dir=e,t;if(s=2,je(e.charCodeAt(2))){if(i===3)return t.root=t.dir=e,t;s=3}}s>0&&(t.root=e.slice(0,s));let n=-1,o=s,a=-1,c=!0,l=e.length-1,u=0;for(;l>=s;--l){if(r=e.charCodeAt(l),je(r)){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),r===Wo?n===-1?n=l:u!==1&&(u=1):n!==-1&&(u=-1)}return a!==-1&&(n===-1||u===0||u===1&&n===a-1&&n===o+1?t.base=t.name=e.slice(o,a):(t.name=e.slice(o,n),t.base=e.slice(o,a),t.ext=e.slice(n,a))),o>0&&o!==s?t.dir=e.slice(0,o-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},D2=(()=>{if(es){const e=/\\/g;return()=>{const t=Ho().replace(e,"/");return t.slice(t.indexOf("/"))}}return()=>Ho()})(),_e={resolve(...e){let t="",i=!1;for(let s=e.length-1;s>=0&&!i;s--){const r=e[s];Zt(r,`paths[${s}]`),r.length!==0&&(t=`${r}/${t}`,i=r.charCodeAt(0)===vi)}if(!i){const s=D2();t=`${s}/${t}`,i=s.charCodeAt(0)===vi}return t=cf(t,!i,"/",B1),i?`/${t}`:t.length>0?t:"."},normalize(e){if(Zt(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===vi,i=e.charCodeAt(e.length-1)===vi;return e=cf(e,!t,"/",B1),e.length===0?t?"/":i?"./":".":(i&&(e+="/"),t?`/${e}`:e)},isAbsolute(e){return Zt(e,"path"),e.length>0&&e.charCodeAt(0)===vi},join(...e){if(e.length===0)return".";const t=[];for(let i=0;i<e.length;++i){const s=e[i];Zt(s,"path"),s.length>0&&t.push(s)}return t.length===0?".":_e.normalize(t.join("/"))},relative(e,t){if(Zt(e,"from"),Zt(t,"to"),e===t||(e=_e.resolve(e),t=_e.resolve(t),e===t))return"";const i=1,s=e.length,r=s-i,n=1,o=t.length-n,a=r<o?r:o;let c=-1,l=0;for(;l<a;l++){const h=e.charCodeAt(i+l);if(h!==t.charCodeAt(n+l))break;h===vi&&(c=l)}if(l===a)if(o>a){if(t.charCodeAt(n+l)===vi)return t.slice(n+l+1);if(l===0)return t.slice(n+l)}else r>a&&(e.charCodeAt(i+l)===vi?c=l:l===0&&(c=0));let u="";for(l=i+c+1;l<=s;++l)(l===s||e.charCodeAt(l)===vi)&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(n+c)}`},toNamespacedPath(e){return e},dirname(e){if(Zt(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===vi;let i=-1,s=!0;for(let r=e.length-1;r>=1;--r)if(e.charCodeAt(r)===vi){if(!s){i=r;break}}else s=!1;return i===-1?t?"/":".":t&&i===1?"//":e.slice(0,i)},basename(e,t){t!==void 0&&Zt(t,"suffix"),Zt(e,"path");let i=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const c=e.charCodeAt(n);if(c===vi){if(!r){i=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return i===s?s=a:s===-1&&(s=e.length),e.slice(i,s)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===vi){if(!r){i=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":e.slice(i,s)},extname(e){Zt(e,"path");let t=-1,i=0,s=-1,r=!0,n=0;for(let o=e.length-1;o>=0;--o){const a=e[o];if(a==="/"){if(!r){i=o+1;break}continue}s===-1&&(r=!1,s=o+1),a==="."?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===i+1?"":e.slice(t,s)},format:Zx.bind(null,"/"),parse(e){Zt(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.charCodeAt(0)===vi;let s;i?(t.root="/",s=1):s=0;let r=-1,n=0,o=-1,a=!0,c=e.length-1,l=0;for(;c>=s;--c){const u=e.charCodeAt(c);if(u===vi){if(!a){n=c+1;break}continue}o===-1&&(a=!1,o=c+1),u===Wo?r===-1?r=c:l!==1&&(l=1):r!==-1&&(l=-1)}if(o!==-1){const u=n===0&&i?1:n;r===-1||l===0||l===1&&r===o-1&&r===n+1?t.base=t.name=e.slice(u,o):(t.name=e.slice(u,r),t.base=e.slice(u,o),t.ext=e.slice(r,o))}return n>0?t.dir=e.slice(0,n-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};_e.win32=Yt.win32=Yt,_e.posix=Yt.posix=_e;var Yr=es?Yt.normalize:_e.normalize,Cs=es?Yt.isAbsolute:_e.isAbsolute,Ge=es?Yt.join:_e.join,P2=es?Yt.resolve:_e.resolve,oc=es?Yt.relative:_e.relative,Fi=es?Yt.dirname:_e.dirname,$t=es?Yt.basename:_e.basename,lf=es?Yt.extname:_e.extname,Bte=es?Yt.format:_e.format,qte=es?Yt.parse:_e.parse,Vte=es?Yt.toNamespacedPath:_e.toNamespacedPath,It=es?Yt.sep:_e.sep,Yx=es?Yt.delimiter:_e.delimiter;function T2(e){return e}var M2=class{constructor(e,t){this.a=void 0,this.b=void 0,typeof e=="function"?(this.c=e,this.d=T2):(this.c=t,this.d=e.getCacheKey)}get(e){const t=this.d(e);return this.b!==t&&(this.b=t,this.a=this.c(e)),this.a}},Ln;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Completed=2]="Completed"})(Ln||(Ln={}));var Rt=class{constructor(e){this.d=e,this.a=Ln.Uninitialized}get hasValue(){return this.a===Ln.Completed}get value(){if(this.a===Ln.Uninitialized){this.a=Ln.Running;try{this.b=this.d()}catch(e){this.c=e}finally{this.a=Ln.Completed}}else if(this.a===Ln.Running)throw new Error("Cannot read the value of a lazy that is being initialized");if(this.c)throw this.c;return this.b}get rawValue(){return this.b}};function ac(e){return!e||typeof e!="string"?!0:e.trim().length===0}var N2=/{(\d+)}/g;function R2(e,...t){return t.length===0?e:e.replace(N2,function(i,s){const r=parseInt(s,10);return isNaN(r)||r<0||r>=t.length?i:t[r]})}var L2=/{([^}]+)}/g;function Qx(e,t){return Object.keys(t).length===0?e:e.replace(L2,(i,s)=>t[s]??i)}function On(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function O2(e,t){let i=0,s=e.indexOf(t);for(;s!==-1;)i++,s=e.indexOf(t,s+t.length);return i}function F2(e,t){if(!e||!t)return e;const i=t.length;let s=0;if(i===1){const r=t.charCodeAt(0);for(;s<e.length&&e.charCodeAt(s)===r;)s++}else for(;e.startsWith(t,s);)s+=i;return e.substring(s)}function Fn(e,t){if(!e||!t)return e;const i=t.length,s=e.length;if(i===1){let n=s;const o=t.charCodeAt(0);for(;n>0&&e.charCodeAt(n-1)===o;)n--;return e.substring(0,n)}let r=s;for(;r>0&&e.endsWith(t,r);)r-=i;return e.substring(0,r)}function Xx(e,t,i={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=On(e)),i.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e=e+"\\b"));let s="";return i.global&&(s+="g"),i.matchCase||(s+="i"),i.multiline&&(s+="m"),i.unicode&&(s+="u"),new RegExp(e,s)}function Kx(e){return e.source==="^"||e.source==="^$"||e.source==="$"||e.source==="^\\s*$"?!1:!!(e.exec("")&&e.lastIndex===0)}function eC(e){return e.split(/\r\n|\r|\n/)}function q1(e){for(let t=0,i=e.length;t<i;t++){const s=e.charCodeAt(t);if(s!==32&&s!==9)return t}return-1}function j2(e,t=e.length-1){for(let i=t;i>=0;i--){const s=e.charCodeAt(i);if(s!==32&&s!==9)return i}return-1}function _o(e,t){return e<t?-1:e>t?1:0}function V1(e,t,i=0,s=e.length,r=0,n=t.length){for(;i<s&&r<n;i++,r++){const c=e.charCodeAt(i),l=t.charCodeAt(r);if(c<l)return-1;if(c>l)return 1}const o=s-i,a=n-r;return o<a?-1:o>a?1:0}function G1(e,t){return cc(e,t,0,e.length,0,t.length)}function cc(e,t,i=0,s=e.length,r=0,n=t.length){for(;i<s&&r<n;i++,r++){let c=e.charCodeAt(i),l=t.charCodeAt(r);if(c===l)continue;if(c>=128||l>=128)return V1(e.toLowerCase(),t.toLowerCase(),i,s,r,n);tC(c)&&(c-=32),tC(l)&&(l-=32);const u=c-l;if(u!==0)return u}const o=s-i,a=n-r;return o<a?-1:o>a?1:0}function tC(e){return e>=97&&e<=122}function iC(e){return e>=65&&e<=90}function gs(e,t){return e.length===t.length&&cc(e,t)===0}function jn(e,t,i){return e===t||!!i&&e!==void 0&&t!==void 0&&gs(e,t)}function uf(e,t){const i=t.length;return i<=e.length&&cc(e,t,0,i)===0}function U2(e,t){const i=e.length,s=i-t.length;return s>=0&&cc(e,t,s,i)===0}function z2(e,t){const i=Math.min(e.length,t.length);let s;for(s=0;s<i;s++)if(e.charCodeAt(s)!==t.charCodeAt(s))return s;return i}function hf(e){return 55296<=e&&e<=56319}function df(e){return 56320<=e&&e<=57343}function J1(e,t){return(e-55296<<10)+(t-56320)+65536}function sC(e,t,i){const s=e.charCodeAt(i);if(hf(s)&&i+1<t){const r=e.charCodeAt(i+1);if(df(r))return J1(s,r)}return s}function H2(e,t){const i=e.charCodeAt(t-1);if(df(i)&&t>1){const s=e.charCodeAt(t-2);if(hf(s))return J1(s,i)}return i}var W2=class{get offset(){return this.f}constructor(e,t=0){this.c=e,this.e=e.length,this.f=t}setOffset(e){this.f=e}prevCodePoint(){const e=H2(this.c,this.f);return this.f-=e>=65536?2:1,e}nextCodePoint(){const e=sC(this.c,this.e,this.f);return this.f+=e>=65536?2:1,e}eol(){return this.f>=this.e}},_2=class{get offset(){return this.c.offset}constructor(e,t=0){this.c=new W2(e,t)}nextGraphemeLength(){const e=uC.getInstance(),t=this.c,i=t.offset;let s=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const r=t.offset,n=e.getGraphemeBreakType(t.nextCodePoint());if(cC(s,n)){t.setOffset(r);break}s=n}return t.offset-i}prevGraphemeLength(){const e=uC.getInstance(),t=this.c,i=t.offset;let s=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const r=t.offset,n=e.getGraphemeBreakType(t.prevCodePoint());if(cC(n,s)){t.setOffset(r);break}s=n}return i-t.offset}eol(){return this.c.eol()}};function rC(e,t){return new _2(e,t).nextGraphemeLength()}var Z1=void 0;function B2(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function nC(e){return Z1||(Z1=B2()),Z1.test(e)}var q2=/^[\t\n\r\x20-\x7E]*$/;function V2(e){return q2.test(e)}var G2=/[\u2028\u2029]/;function oC(e){return G2.test(e)}var J2=/(?:\x1b\[|\x9b)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/,Z2=/(?:\x1b\]|\x9d).*?(?:\x1b\\|\x07|\x9c)/,Y2=/\x1b(?:[ #%\(\)\*\+\-\.\/]?[a-zA-Z0-9\|}~@])/,Gte=new RegExp("(?:"+[J2.source,Z2.source,Y2.source].join("|")+")","g"),Q2="\uFEFF";function X2(e){return!!(e&&e.length>0&&e.charCodeAt(0)===65279)}function K2(e,t){if(!e||!t||e.length<t.length)return!1;const i=t.length,s=e.toLowerCase();let r=0,n=-1;for(;r<i;){const o=s.indexOf(t[r],n+1);if(o<0)return!1;n=o,r++}return!0}function aC(e,t=!1){return e?(t&&(e=e.replace(/\\./g,"")),e.toLowerCase()!==e):!1}function eO(e){return e.charAt(0).toUpperCase()+e.slice(1)}function tO(e,t=1){if(t===0)return"";let i=-1;do i=e.indexOf(`
`,i+1),t--;while(t>0&&i>=0);return i===-1?e:(e[i-1]==="\r"&&i--,e.substr(0,i))}function cC(e,t){return e===0?t!==5&&t!==7:e===2&&t===3?!1:e===4||e===2||e===3||t===4||t===2||t===3?!0:!(e===8&&(t===8||t===9||t===11||t===12)||(e===11||e===9)&&(t===9||t===10)||(e===12||e===10)&&t===10||t===5||t===13||t===7||e===1||e===13&&t===14||e===6&&t===6)}var lC;(function(e){e[e.Other=0]="Other",e[e.Prepend=1]="Prepend",e[e.CR=2]="CR",e[e.LF=3]="LF",e[e.Control=4]="Control",e[e.Extend=5]="Extend",e[e.Regional_Indicator=6]="Regional_Indicator",e[e.SpacingMark=7]="SpacingMark",e[e.L=8]="L",e[e.V=9]="V",e[e.T=10]="T",e[e.LV=11]="LV",e[e.LVT=12]="LVT",e[e.ZWJ=13]="ZWJ",e[e.Extended_Pictographic=14]="Extended_Pictographic"})(lC||(lC={}));var uC=class Fd{static{this.c=null}static getInstance(){return Fd.c||(Fd.c=new Fd),Fd.c}constructor(){this.e=iO()}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;const i=this.e,s=i.length/3;let r=1;for(;r<=s;)if(t<i[3*r])r=2*r;else if(t>i[3*r+1])r=2*r+1;else return i[3*r+2];return 0}};function iO(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var hC;(function(e){e[e.zwj=8205]="zwj",e[e.emojiVariantSelector=65039]="emojiVariantSelector",e[e.enclosingKeyCap=8419]="enclosingKeyCap",e[e.space=32]="space"})(hC||(hC={}));var Jte=class jd{static{this.c=new Rt(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}'))}static{this.e=new M2(t=>{const i=t.split(",");function s(h){const f=new Map;for(let p=0;p<h.length;p+=2)f.set(h[p],h[p+1]);return f}function r(h,f){const p=new Map(h);for(const[g,v]of f)p.set(g,v);return p}function n(h,f){if(!h)return f;const p=new Map;for(const[g,v]of h)f.has(g)&&p.set(g,v);return p}const o=this.c.value;let a=i.filter(h=>!h.startsWith("_")&&Object.hasOwn(o,h));a.length===0&&(a=["_default"]);let c;for(const h of a){const f=s(o[h]);c=n(c,f)}const l=s(o._common),u=r(l,c);return new jd(u)})}static getInstance(t){return jd.e.get(Array.from(t).join(","))}static{this.f=new Rt(()=>Object.keys(jd.c.value).filter(t=>!t.startsWith("_")))}static getLocales(){return jd.f.value}constructor(t){this.g=t}isAmbiguous(t){return this.g.has(t)}containsAmbiguousCharacter(t){for(let i=0;i<t.length;i++){const s=t.codePointAt(i);if(typeof s=="number"&&this.isAmbiguous(s))return!0}return!1}getPrimaryConfusable(t){return this.g.get(t)}getConfusableCodePoints(){return new Set(this.g.keys())}},Zte=class Ud{static c(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static{this.e=void 0}static f(){return this.e||(this.e=new Set([...Object.values(Ud.c())].flat())),this.e}static isInvisibleCharacter(t){return Ud.f().has(t)}static containsInvisibleCharacter(t){for(let i=0;i<t.length;i++){const s=t.codePointAt(i);if(typeof s=="number"&&(Ud.isInvisibleCharacter(s)||s===32))return!0}return!1}static get codePoints(){return Ud.f()}},dC;(function(e){e[e.BASE=36]="BASE",e[e.TMIN=1]="TMIN",e[e.TMAX=26]="TMAX",e[e.SKEW=38]="SKEW",e[e.DAMP=700]="DAMP",e[e.INITIAL_BIAS=72]="INITIAL_BIAS",e[e.INITIAL_N=128]="INITIAL_N",e[e.DELIMITER=45]="DELIMITER"})(dC||(dC={}));function Un(e){return e===47||e===92}function fC(e){return e.replace(/[\\/]/g,_e.sep)}function sO(e){return e.indexOf("/")===-1&&(e=fC(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function Y1(e,t=_e.sep){if(!e)return"";const i=e.length,s=e.charCodeAt(0);if(Un(s)){if(Un(e.charCodeAt(1))&&!Un(e.charCodeAt(2))){let n=3;const o=n;for(;n<i&&!Un(e.charCodeAt(n));n++);if(o!==n&&!Un(e.charCodeAt(n+1))){for(n+=1;n<i;n++)if(Un(e.charCodeAt(n)))return e.slice(0,n+1).replace(/[\\/]/g,t)}}return t}else if(pC(s)&&e.charCodeAt(1)===58)return Un(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let r=e.indexOf("://");if(r!==-1){for(r+=3;r<i;r++)if(Un(e.charCodeAt(r)))return e.slice(0,r+1)}return""}var rO=/[\\/:\*\?"<>\|]/g,nO=/[/]/g,oO=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function aO(e,t=ze){const i=t?rO:nO;return!(!e||e.length===0||/^\s+$/.test(e)||(i.lastIndex=0,i.test(e))||t&&oO.test(e)||e==="."||e===".."||t&&e[e.length-1]==="."||t&&e.length!==e.trim().length||e.length>255)}function ff(e,t,i){const s=e===t;return!i||s?s:!e||!t?!1:gs(e,t)}function Bo(e,t,i,s=It){if(e===t)return!0;if(!e||!t||t.length>e.length)return!1;if(i){if(!uf(e,t))return!1;if(t.length===e.length)return!0;let n=t.length;return t.charAt(t.length-1)===s&&n--,e.charAt(n)===s}return t.charAt(t.length-1)!==s&&(t+=s),e.indexOf(t)===0}function pC(e){return e>=65&&e<=90||e>=97&&e<=122}function cO(e){return ze?(e=Fn(e,It),e.endsWith(":")&&(e+=It)):(e=Fn(e,It),e||(e=It)),e}function gC(e){const t=Yr(e);return ze?e.length>3?!1:Q1(t)&&(e.length===2||t.charCodeAt(2)===92):t===_e.sep}function Q1(e,t=ze){return t?pC(e.charCodeAt(0))&&e.charCodeAt(1)===58:!1}function mC(e,t=ze){return Q1(e,t)?e[0]:void 0}var lO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",uO="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function hO(e,t,i=8){let s="";for(let n=0;n<i;n++){let o;n===0&&ze&&!t&&(i===3||i===4)?o=uO:o=lO,s+=o.charAt(Math.floor(Math.random()*o.length))}let r;return t?r=`${t}-${s}`:r=s,e?Ge(e,r):r}var dO=/^\w[\w\d+.-]*$/,fO=/^\//,pO=/^\/\//;function gO(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!dO.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path){if(e.authority){if(!fO.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(pO.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function mO(e,t){return!e&&!t?"file":e}function vO(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==Ws&&(t=Ws+t):t=Ws;break}return t}var Dt="",Ws="/",wO=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,y=class r1{static isUri(t){return t instanceof r1?!0:!t||typeof t!="object"?!1:typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function"}constructor(t,i,s,r,n,o=!1){typeof t=="object"?(this.scheme=t.scheme||Dt,this.authority=t.authority||Dt,this.path=t.path||Dt,this.query=t.query||Dt,this.fragment=t.fragment||Dt):(this.scheme=mO(t,o),this.authority=i||Dt,this.path=vO(this.scheme,s||Dt),this.query=r||Dt,this.fragment=n||Dt,gO(this,o))}get fsPath(){return gf(this,!1)}with(t){if(!t)return this;let{scheme:i,authority:s,path:r,query:n,fragment:o}=t;return i===void 0?i=this.scheme:i===null&&(i=Dt),s===void 0?s=this.authority:s===null&&(s=Dt),r===void 0?r=this.path:r===null&&(r=Dt),n===void 0?n=this.query:n===null&&(n=Dt),o===void 0?o=this.fragment:o===null&&(o=Dt),i===this.scheme&&s===this.authority&&r===this.path&&n===this.query&&o===this.fragment?this:new lc(i,s,r,n,o)}static parse(t,i=!1){const s=wO.exec(t);return s?new lc(s[2]||Dt,mf(s[4]||Dt),mf(s[5]||Dt),mf(s[7]||Dt),mf(s[9]||Dt),i):new lc(Dt,Dt,Dt,Dt,Dt)}static file(t){let i=Dt;if(ze&&(t=t.replace(/\\/g,Ws)),t[0]===Ws&&t[1]===Ws){const s=t.indexOf(Ws,2);s===-1?(i=t.substring(2),t=Ws):(i=t.substring(2,s),t=t.substring(s)||Ws)}return new lc("file",i,t,Dt,Dt)}static from(t,i){return new lc(t.scheme,t.authority,t.path,t.query,t.fragment,i)}static joinPath(t,...i){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let s;return ze&&t.scheme==="file"?s=r1.file(Yt.join(gf(t,!0),...i)).path:s=_e.join(t.path,...i),t.with({path:s})}toString(t=!1){return X1(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof r1)return t;{const i=new lc(t);return i._formatted=t.external??null,i._fsPath=t._sep===vC?t.fsPath??null:null,i}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function pf(e){return!e||typeof e!="object"?!1:typeof e.scheme=="string"&&(typeof e.authority=="string"||typeof e.authority>"u")&&(typeof e.path=="string"||typeof e.path>"u")&&(typeof e.query=="string"||typeof e.query>"u")&&(typeof e.fragment=="string"||typeof e.fragment>"u")}var vC=ze?1:void 0,lc=class extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=gf(this,!1)),this._fsPath}toString(e=!1){return e?X1(this,!0):(this._formatted||(this._formatted=X1(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=vC),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},wC={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function bC(e,t,i){let s,r=-1;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||t&&o===47||i&&o===91||i&&o===93||i&&o===58)r!==-1&&(s+=encodeURIComponent(e.substring(r,n)),r=-1),s!==void 0&&(s+=e.charAt(n));else{s===void 0&&(s=e.substr(0,n));const a=wC[o];a!==void 0?(r!==-1&&(s+=encodeURIComponent(e.substring(r,n)),r=-1),s+=a):r===-1&&(r=n)}}return r!==-1&&(s+=encodeURIComponent(e.substring(r))),s!==void 0?s:e}function bO(e){let t;for(let i=0;i<e.length;i++){const s=e.charCodeAt(i);s===35||s===63?(t===void 0&&(t=e.substr(0,i)),t+=wC[s]):t!==void 0&&(t+=e[i])}return t!==void 0?t:e}function gf(e,t){let i;return e.authority&&e.path.length>1&&e.scheme==="file"?i=`//${e.authority}${e.path}`:e.path.charCodeAt(0)===47&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&e.path.charCodeAt(2)===58?t?i=e.path.substr(1):i=e.path[1].toLowerCase()+e.path.substr(2):i=e.path,ze&&(i=i.replace(/\//g,"\\")),i}function X1(e,t){const i=t?bO:bC;let s="",{scheme:r,authority:n,path:o,query:a,fragment:c}=e;if(r&&(s+=r,s+=":"),(n||r==="file")&&(s+=Ws,s+=Ws),n){let l=n.indexOf("@");if(l!==-1){const u=n.substr(0,l);n=n.substr(l+1),l=u.lastIndexOf(":"),l===-1?s+=i(u,!1,!1):(s+=i(u.substr(0,l),!1,!1),s+=":",s+=i(u.substr(l+1),!1,!0)),s+="@"}n=n.toLowerCase(),l=n.lastIndexOf(":"),l===-1?s+=i(n,!1,!0):(s+=i(n.substr(0,l),!1,!0),s+=n.substr(l))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const l=o.charCodeAt(1);l>=65&&l<=90&&(o=`/${String.fromCharCode(l+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const l=o.charCodeAt(0);l>=65&&l<=90&&(o=`${String.fromCharCode(l+32)}:${o.substr(2)}`)}s+=i(o,!0,!1)}return a&&(s+="?",s+=i(a,!1,!1)),c&&(s+="#",s+=t?c:bC(c,!1,!1)),s}function yC(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+yC(e.substr(3)):e}}var AC=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function mf(e){return e.match(AC)?e.replace(AC,t=>yC(t)):e}var V;(function(e){e.inMemory="inmemory",e.vscode="vscode",e.internal="private",e.walkThrough="walkThrough",e.walkThroughSnippet="walkThroughSnippet",e.http="http",e.https="https",e.file="file",e.mailto="mailto",e.untitled="untitled",e.data="data",e.command="command",e.vscodeRemote="vscode-remote",e.vscodeRemoteResource="vscode-remote-resource",e.vscodeManagedRemoteResource="vscode-managed-remote-resource",e.vscodeUserData="vscode-userdata",e.vscodeCustomEditor="vscode-custom-editor",e.vscodeNotebookCell="vscode-notebook-cell",e.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",e.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",e.vscodeNotebookCellOutput="vscode-notebook-cell-output",e.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",e.vscodeNotebookMetadata="vscode-notebook-metadata",e.vscodeInteractiveInput="vscode-interactive-input",e.vscodeSettings="vscode-settings",e.vscodeWorkspaceTrust="vscode-workspace-trust",e.vscodeTerminal="vscode-terminal",e.vscodeChatCodeBlock="vscode-chat-code-block",e.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",e.vscodeChatEditor="vscode-chat-editor",e.vscodeChatInput="chatSessionInput",e.vscodeLocalChatSession="vscode-chat-session",e.webviewPanel="webview-panel",e.vscodeWebview="vscode-webview",e.vscodeBrowser="vscode-browser",e.extension="extension",e.vscodeFileResource="vscode-file",e.tmp="tmp",e.vsls="vsls",e.vscodeSourceControl="vscode-scm",e.commentsInput="comment",e.codeSetting="code-setting",e.outputChannel="output",e.accessibleView="accessible-view",e.chatEditingSnapshotScheme="chat-editing-snapshot-text-model",e.chatEditingModel="chat-editing-text-model",e.copilotPr="copilot-pr"})(V||(V={}));function K1(e,t){return y.isUri(e)?gs(e.scheme,t):uf(e,t+":")}function yO(e,...t){return t.some(i=>K1(e,i))}var AO="tkn",SO=class{constructor(){this.a=Object.create(null),this.b=Object.create(null),this.c=Object.create(null),this.d="http",this.e=null,this.f="/"}setPreferredWebSchema(e){this.d=e}setDelegate(e){this.e=e}setServerRootPath(e,t){this.f=_e.join(t??"/",EO(e))}getServerRootPath(){return this.f}get g(){return _e.join(this.f,V.vscodeRemoteResource)}set(e,t,i){this.a[e]=t,this.b[e]=i}setConnectionToken(e,t){this.c[e]=t}getPreferredWebSchema(){return this.d}rewrite(e){if(this.e)try{return this.e(e)}catch(o){return pt(o),e}const t=e.authority;let i=this.a[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const s=this.b[t],r=this.c[t];let n=`path=${encodeURIComponent(e.path)}`;return typeof r=="string"&&(n+=`&${AO}=${encodeURIComponent(r)}`),y.from({scheme:jo?this.d:V.vscodeRemoteResource,authority:`${i}:${s}`,path:this.g,query:n})}},SC=new SO;function EO(e){return`${e.quality??"oss"}-${e.commit??"dev"}`}var xO="vs/../../node_modules",CO="vs/../../node_modules.asar",EC="vscode-app",kO=class n1{static{this.a=EC}asBrowserUri(t){const i=this.b(t);return this.uriToBrowserUri(i)}uriToBrowserUri(t){return t.scheme===V.vscodeRemote?SC.rewrite(t):t.scheme===V.file&&(zx||p2===`${V.vscodeFileResource}://${n1.a}`)?t.with({scheme:V.vscodeFileResource,authority:t.authority||n1.a,query:null,fragment:null}):t}asFileUri(t){const i=this.b(t);return this.uriToFileUri(i)}uriToFileUri(t){return t.scheme===V.vscodeFileResource?t.with({scheme:V.file,authority:t.authority!==n1.a?t.authority:null,query:null,fragment:null}):t}b(t){if(y.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return y.joinPath(y.parse(i,!0),t);const s=Ge(i,t);return y.file(s)}throw new Error("Cannot determine URI for module id!")}},vf=new kO,Yte=Object.freeze({"Cache-Control":"no-cache, no-store"}),Qte=Object.freeze({"Document-Policy":"include-js-call-stacks-in-crash-reports"}),xC;(function(e){const t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);e.CoopAndCoep=Object.freeze(t.get("3"));const i="vscode-coi";function s(n){let o;typeof n=="string"?o=new URL(n).searchParams:n instanceof URL?o=n.searchParams:y.isUri(n)&&(o=new URL(n.toString(!0)).searchParams);const a=o?.get(i);if(a)return t.get(a)}e.getHeadersFromQuery=s;function r(n,o,a){if(!globalThis.crossOriginIsolated)return;const c=o&&a?"3":a?"2":"1";n instanceof URLSearchParams?n.set(i,c):n[i]=c}e.addSearchParam=r})(xC||(xC={}));function _s(e){return gf(e,!0)}var uc=class{constructor(e){this.a=e}compare(e,t,i=!1){return e===t?0:_o(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this.a(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this.a(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===V.file)return Bo(_s(e),_s(t),this.a(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if($C(e.authority,t.authority))return Bo(e.path,t.path,this.a(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return ji(e)||e.authority}basename(e){return _e.basename(e.path)}extname(e){return _e.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===V.file?t=y.file(Fi(_s(e))).path:(t=_e.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===V.file?t=y.file(Yr(_s(e))).path:t=_e.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!$C(e.authority,t.authority))return;if(e.scheme===V.file){const r=oc(_s(e),_s(t));return ze?fC(r):r}let i=e.path||"/";const s=t.path||"/";if(this.a(e)){let r=0;for(const n=Math.min(i.length,s.length);r<n&&!(i.charCodeAt(r)!==s.charCodeAt(r)&&i.charAt(r).toLowerCase()!==s.charAt(r).toLowerCase());r++);i=s.substr(0,r)+i.substr(r)}return _e.relative(i,s)}resolvePath(e,t){if(e.scheme===V.file){const i=y.file(P2(_s(e),t));return e.with({authority:i.authority,path:i.path})}return t=sO(t),e.with({path:_e.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&gs(e,t)}hasTrailingPathSeparator(e,t=It){if(e.scheme===V.file){const i=_s(e);return i.length>Y1(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=It){return IC(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=It){let i=!1;if(e.scheme===V.file){const s=_s(e);i=s!==void 0&&s.length===Y1(s).length&&s[s.length-1]===t}else{t="/";const s=e.path;i=s.length===1&&s.charCodeAt(s.length-1)===47}return!i&&!IC(e,t)?e.with({path:e.path+"/"}):e}},tt=new uc(()=>!1),e0=new uc(e=>e.scheme===V.file?!Mt:!0),$O=new uc(e=>!0),hc=tt.isEqual.bind(tt),Xte=tt.isEqualOrParent.bind(tt),Kte=tt.getComparisonKey.bind(tt),t0=tt.basenameOrAuthority.bind(tt),ji=tt.basename.bind(tt),CC=tt.extname.bind(tt),dc=tt.dirname.bind(tt),Lt=tt.joinPath.bind(tt),eie=tt.normalizePath.bind(tt),kC=tt.relativePath.bind(tt),tie=tt.resolvePath.bind(tt),IO=tt.isAbsolutePath.bind(tt),$C=tt.isEqualAuthority.bind(tt),IC=tt.hasTrailingPathSeparator.bind(tt),iie=tt.removeTrailingPathSeparator.bind(tt),sie=tt.addTrailingPathSeparator.bind(tt),DC;(function(e){e.META_DATA_LABEL="label",e.META_DATA_DESCRIPTION="description",e.META_DATA_SIZE="size",e.META_DATA_MIME="mime";function t(i){const s=new Map;i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,c]=o.split(":");a&&c&&s.set(a,c)});const n=i.path.substring(0,i.path.indexOf(";"));return n&&s.set(e.META_DATA_MIME,n),s}e.parseMetaData=t})(DC||(DC={}));var DO=Symbol("MicrotaskDelay");function zn(e){return!!e&&typeof e.then=="function"}function Qr(e){const t=new Ke,i=e(t.token);let s=!1;const r=new Promise((n,o)=>{const a=t.token.onCancellationRequested(()=>{s=!0,a.dispose(),o(new dt)});Promise.resolve(i).then(c=>{a.dispose(),t.dispose(),s?kx(c)&&c.dispose():n(c)},c=>{a.dispose(),t.dispose(),o(c)})});return new class{cancel(){t.cancel(),t.dispose()}then(n,o){return r.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return r.finally(n)}}}function PC(e,t,i){return new Promise((s,r)=>{const n=t.onCancellationRequested(()=>{n.dispose(),s(i)});e.then(s,r).finally(()=>n.dispose())})}function wf(e,t){return new Promise((i,s)=>{const r=t.onCancellationRequested(()=>{r.dispose(),s(new dt)});e.then(i,s).finally(()=>r.dispose())})}function wi(e){return new Promise((t,i)=>{const s=e();zn(s)?s.then(t,i):t(s)})}function TC(){let e,t;return{promise:new Promise((s,r)=>{e=s,t=r}),resolve:e,reject:t}}var PO=class{constructor(){this.a=null,this.b=null,this.d=null,this.f=new Ke}queue(e){if(this.f.token.isCancellationRequested)return Promise.reject(new Error("Throttler is disposed"));if(this.a){if(this.d=e,!this.b){const t=()=>{if(this.b=null,this.f.token.isCancellationRequested)return;const i=this.queue(this.d);return this.d=null,i};this.b=new Promise(i=>{this.a.then(t,t).then(i)})}return new Promise((t,i)=>{this.b.then(t,i)})}return this.a=e(this.f.token),new Promise((t,i)=>{this.a.then(s=>{this.a=null,t(s)},s=>{this.a=null,i(s)})})}dispose(){this.f.cancel()}},TO=class{constructor(){this.a=Promise.resolve(null)}queue(e){return this.a=this.a.then(()=>e(),()=>e())}},i0=class{constructor(){this.a=new Map}queue(e,t){const s=(this.a.get(e)??Promise.resolve()).catch(()=>{}).then(t).finally(()=>{this.a.get(e)===s&&this.a.delete(e)});return this.a.set(e,s),s}peek(e){return this.a.get(e)||void 0}keys(){return this.a.keys()}},MO=(e,t)=>{let i=!0;const s=setTimeout(()=>{i=!1,t()},e);return{isTriggered:()=>i,dispose:()=>{clearTimeout(s),i=!1}}},NO=e=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,e())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},MC=class{constructor(e){this.defaultDelay=e,this.a=null,this.b=null,this.d=null,this.f=null,this.g=null}trigger(e,t=this.defaultDelay){this.g=e,this.h(),this.b||(this.b=new Promise((s,r)=>{this.d=s,this.f=r}).then(()=>{if(this.b=null,this.d=null,this.g){const s=this.g;return this.g=null,s()}}));const i=()=>{this.a=null,this.d?.(null)};return this.a=t===DO?NO(i):MO(t,i),this.b}isTriggered(){return!!this.a?.isTriggered()}cancel(){this.h(),this.b&&(this.f?.(new dt),this.b=null)}h(){this.a?.dispose(),this.a=null}dispose(){this.cancel()}},gu=class{constructor(e){this.a=new MC(e),this.b=new PO}trigger(e,t){return this.a.trigger(()=>this.b.queue(e),t)}isTriggered(){return this.a.isTriggered()}cancel(){this.a.cancel()}dispose(){this.a.dispose(),this.b.dispose()}},ms=class{constructor(){this.a=!1,this.b=new Promise((e,t)=>{this.d=e})}isOpen(){return this.a}open(){this.a=!0,this.d(!0)}wait(){return this.b}};function Kt(e,t){return t?new Promise((i,s)=>{const r=setTimeout(()=>{n.dispose(),i()},e),n=t.onCancellationRequested(()=>{clearTimeout(r),n.dispose(),s(new dt)})}):Qr(i=>Kt(e,i))}function s0(e,t=0,i){const s=setTimeout(()=>{e(),i&&r.dispose()},t),r=se(()=>{clearTimeout(s),i?.delete(r)});return i?.add(r),r}function RO(e,t=s=>!!s,i=null){if(e.length===0)return Promise.resolve(i);let s=e.length;const r=()=>{s=-1;for(const n of e)n.cancel?.()};return new Promise((n,o)=>{for(const a of e)a.then(c=>{--s>=0&&t(c)?(r(),n(c)):s===0&&n(i)}).catch(c=>{--s>=0&&(r(),o(c))})})}var LO=class{constructor(e){this.a=0,this.b=!1,this.f=e,this.g=[],this.d=0,this.h=new I}whenIdle(){return this.size>0?Ie.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this.h.event}get size(){return this.a}queue(e){if(this.b)throw new Error("Object has been disposed");return this.a++,new Promise((t,i)=>{this.g.push({factory:e,c:t,e:i}),this.j()})}j(){for(;this.g.length&&this.d<this.f;){const e=this.g.shift();this.d++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.k(),()=>this.k())}}k(){this.b||(this.d--,--this.a===0&&this.h.fire(),this.g.length>0&&this.j())}clear(){if(this.b)throw new Error("Object has been disposed");this.g.length=0,this.a=this.d}dispose(){this.b=!0,this.g.length=0,this.a=0,this.h.dispose()}},OO=class extends LO{constructor(){super(1)}},NC=class{constructor(){this.a=new Map,this.b=new Set,this.d=void 0,this.f=0}async whenDrained(){if(this.g())return;const e=new Di;return this.b.add(e),e.p}g(){for(const[,e]of this.a)if(e.size>0)return!1;return!0}queueSize(e,t=tt){const i=t.getComparisonKey(e);return this.a.get(i)?.size??0}queueFor(e,t,i=tt){const s=i.getComparisonKey(e);let r=this.a.get(s);if(!r){r=new OO;const n=this.f++,o=Ie.once(r.onDrained)(()=>{r?.dispose(),this.a.delete(s),this.h(),this.d?.deleteAndDispose(n),this.d?.size===0&&(this.d.dispose(),this.d=void 0)});this.d||(this.d=new Fo),this.d.set(n,o),this.a.set(s,r)}return r.queue(t)}h(){this.g()&&this.j()}j(){for(const e of this.b)e.complete();this.b.clear()}dispose(){for(const[,e]of this.a)e.dispose();this.a.clear(),this.j(),this.d?.dispose()}},RC=class{constructor(e,t){this.b=!1,this.a=void 0,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this.b=!0}cancel(){this.a!==void 0&&(clearTimeout(this.a),this.a=void 0)}cancelAndSet(e,t){if(this.b)throw new Jt("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this.a=setTimeout(()=>{this.a=void 0,e()},t)}setIfNotSet(e,t){if(this.b)throw new Jt("Calling 'setIfNotSet' on a disposed TimeoutTimer");this.a===void 0&&(this.a=setTimeout(()=>{this.a=void 0,e()},t))}},LC=class{constructor(){this.g=void 0,this.j=!1}cancel(){this.g?.dispose(),this.g=void 0}cancelAndSet(e,t,i=globalThis){if(this.j)throw new Jt("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const s=i.setInterval(()=>{e()},t);this.g=se(()=>{i.clearInterval(s),this.g=void 0})}dispose(){this.cancel(),this.j=!0}},vr=class{constructor(e,t){this.b=void 0,this.a=e,this.d=t,this.f=this.g.bind(this)}dispose(){this.cancel(),this.a=null}cancel(){this.isScheduled()&&(clearTimeout(this.b),this.b=void 0)}schedule(e=this.d){this.cancel(),this.b=setTimeout(this.f,e)}get delay(){return this.d}set delay(e){this.d=e}isScheduled(){return this.b!==void 0}flush(){this.isScheduled()&&(this.cancel(),this.h())}g(){this.b=void 0,this.a&&this.h()}h(){this.a?.()}},OC=class{constructor(e,t){t%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${t}ms is not a multiple of 1000ms.`),this.a=e,this.b=t,this.d=0,this.f=void 0,this.g=this.h.bind(this)}dispose(){this.cancel(),this.a=null}cancel(){this.isScheduled()&&(clearInterval(this.f),this.f=void 0)}schedule(e=this.b){e%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${e}ms is not a multiple of 1000ms.`),this.cancel(),this.d=Math.ceil(e/1e3),this.f=setInterval(this.g,1e3)}isScheduled(){return this.f!==void 0}h(){this.d--,!(this.d>0)&&(clearInterval(this.f),this.f=void 0,this.a?.())}},FO=class extends vr{constructor(e,t){super(e,t),this.j=[]}work(e){this.j.push(e),this.isScheduled()||this.schedule()}h(){const e=this.j;this.j=[],this.a?.(e)}dispose(){this.j=[],super.dispose()}},FC=class extends J{constructor(e,t){super(),this.h=e,this.j=t,this.a=[],this.b=this.D(new Hs),this.f=!1,this.g=0}get pending(){return this.a.length}work(e){if(this.f)return!1;if(typeof this.h.maxBufferedWork=="number"){if(this.b.value){if(this.pending+e.length>this.h.maxBufferedWork)return!1}else if(this.pending+e.length-this.h.maxWorkChunkSize>this.h.maxBufferedWork)return!1}for(const i of e)this.a.push(i);const t=Date.now()-this.g;return!this.b.value&&(!this.h.waitThrottleDelayBetweenWorkUnits||t>=this.h.throttleDelay)?this.m():!this.b.value&&this.h.waitThrottleDelayBetweenWorkUnits&&this.q(Math.max(this.h.throttleDelay-t,0)),!0}m(){this.g=Date.now(),this.j(this.a.splice(0,this.h.maxWorkChunkSize)),this.a.length>0&&this.q()}q(e=this.h.throttleDelay){this.b.value=new vr(()=>{this.b.clear(),this.m()},e),this.b.value.schedule()}dispose(){super.dispose(),this.a.length=0,this.f=!0}},jC,bf;(function(){const e=globalThis;typeof e.requestIdleCallback!="function"||typeof e.cancelIdleCallback!="function"?bf=(t,i,s)=>{Wx(()=>{if(r)return;const n=Date.now()+15;i(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let r=!1;return{dispose(){r||(r=!0)}}}:bf=(t,i,s)=>{const r=t.requestIdleCallback(i,typeof s=="number"?{timeout:s}:void 0);let n=!1;return{dispose(){n||(n=!0,t.cancelIdleCallback(r))}}},jC=(t,i)=>bf(globalThis,t,i)})();var jO=class{constructor(e,t){this.l=!1,this.g=()=>{try{this.m=t()}catch(i){this.o=i}finally{this.l=!0}},this.j=bf(e,()=>this.g())}dispose(){this.j.dispose()}get value(){if(this.l||(this.j.dispose(),this.g()),this.o)throw this.o;return this.m}get isInitialized(){return this.l}},UO=class extends jO{constructor(e){super(globalThis,e)}};async function zO(e,t,i){let s;for(let r=0;r<i;r++)try{return await e()}catch(n){s=n,await Kt(t)}throw s}var UC;(function(e){e[e.Resolved=0]="Resolved",e[e.Rejected=1]="Rejected"})(UC||(UC={}));var Di=class xN{static fromPromise(t){const i=new xN;return i.settleWith(t),i}get isRejected(){return this.d?.outcome===1}get isResolved(){return this.d?.outcome===0}get isSettled(){return!!this.d}get value(){return this.d?.outcome===0?this.d?.value:void 0}constructor(){this.p=new Promise((t,i)=>{this.a=t,this.b=i})}complete(t){return this.isSettled?Promise.resolve():new Promise(i=>{this.a(t),this.d={outcome:0,value:t},i()})}error(t){return this.isSettled?Promise.resolve():new Promise(i=>{this.b(t),this.d={outcome:1,value:t},i()})}settleWith(t){return t.then(i=>this.complete(i),i=>this.error(i))}cancel(){return this.error(new dt)}},Hn;(function(e){async function t(s){let r;const n=await Promise.all(s.map(o=>o.then(a=>a,a=>{r||(r=a)})));if(typeof r<"u")throw r;return n}e.settled=t;function i(s){return new Promise(async(r,n)=>{try{await s(r,n)}catch(o){n(o)}})}e.withAsyncBody=i})(Hn||(Hn={}));var zC;(function(e){e[e.Initial=0]="Initial",e[e.DoneOK=1]="DoneOK",e[e.DoneError=2]="DoneError"})(zC||(zC={}));var r0=class ys{static fromArray(t){return new ys(i=>{i.emitMany(t)})}static fromPromise(t){return new ys(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new ys(async i=>{await Promise.all(t.map(async s=>i.emitOne(await s)))})}static merge(t){return new ys(async i=>{await Promise.all(t.map(async s=>{for await(const r of s)i.emitOne(r)}))})}static{this.EMPTY=ys.fromArray([])}constructor(t,i){this.a=0,this.b=[],this.d=null,this.f=i,this.g=new I,queueMicrotask(async()=>{const s={emitOne:r=>this.h(r),emitMany:r=>this.j(r),reject:r=>this.l(r)};try{await Promise.resolve(t(s)),this.k()}catch(r){this.l(r)}finally{s.emitOne=void 0,s.emitMany=void 0,s.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this.a===2)throw this.d;if(t<this.b.length)return{done:!1,value:this.b[t++]};if(this.a===1)return{done:!0,value:void 0};await Ie.toPromise(this.g.event)}while(!0)},return:async()=>(this.f?.(),{done:!0,value:void 0})}}static map(t,i){return new ys(async s=>{for await(const r of t)s.emitOne(i(r))})}map(t){return ys.map(this,t)}static filter(t,i){return new ys(async s=>{for await(const r of t)i(r)&&s.emitOne(r)})}filter(t){return ys.filter(this,t)}static coalesce(t){return ys.filter(t,i=>!!i)}coalesce(){return ys.coalesce(this)}static async toPromise(t){const i=[];for await(const s of t)i.push(s);return i}toPromise(){return ys.toPromise(this)}h(t){this.a===0&&(this.b.push(t),this.g.fire())}j(t){this.a===0&&(this.b=this.b.concat(t),this.g.fire())}k(){this.a===0&&(this.a=1,this.g.fire())}l(t){this.a===0&&(this.a=2,this.d=t,this.g.fire())}},HO=class{constructor(e){this.a=new Di,this.b=new r0(s=>{if(t){s.reject(t);return}return i&&s.emitMany(i),this.d=r=>s.reject(r),this.f=r=>s.emitOne(r),this.g=r=>s.emitMany(r),this.a.p},e);let t,i;this.d=s=>{t||(t=s)},this.f=s=>{i||(i=[]),i.push(s)},this.g=s=>{i?s.forEach(r=>i.push(r)):i=s.slice()}}get asyncIterable(){return this.b}resolve(){this.a.complete()}reject(e){this.d(e),this.a.complete()}emitOne(e){this.f(e)}emitMany(e){this.g(e)}},WO=class{constructor(){this.a=[],this.b=[]}get hasFinalValue(){return!!this.d}produce(e){if(this.f(),this.a.length>0){const t=this.a.shift();this.g(t,e)}else this.b.push(e)}produceFinal(e){this.f(),this.d=e;for(const t of this.a)this.g(t,e);this.a.length=0}f(){if(this.d)throw new Jt("ProducerConsumer: cannot produce after final value has been set")}g(e,t){t.ok?e.complete(t.value):e.error(t.error)}consume(){if(this.b.length>0||this.d){const e=this.b.length>0?this.b.shift():this.d;return e.ok?Promise.resolve(e.value):Promise.reject(e.error)}else{const e=new Di;return this.a.push(e),e.p}}},HC=class ls{constructor(t,i){this.b=i,this.a=new WO,this.g={next:()=>this.a.consume(),return:()=>(this.b?.(),Promise.resolve({done:!0,value:void 0})),throw:async s=>(this.f(s),{done:!0,value:void 0})},queueMicrotask(async()=>{const s=t({emitOne:r=>this.a.produce({ok:!0,value:{done:!1,value:r}}),emitMany:r=>{for(const n of r)this.a.produce({ok:!0,value:{done:!1,value:n}})},reject:r=>this.f(r)});if(!this.a.hasFinalValue)try{await s,this.d()}catch(r){this.f(r)}})}static fromArray(t){return new ls(i=>{i.emitMany(t)})}static fromPromise(t){return new ls(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new ls(async i=>{await Promise.all(t.map(async s=>i.emitOne(await s)))})}static merge(t){return new ls(async i=>{await Promise.all(t.map(async s=>{for await(const r of s)i.emitOne(r)}))})}static{this.EMPTY=ls.fromArray([])}static map(t,i){return new ls(async s=>{for await(const r of t)s.emitOne(i(r))})}static tee(t){let i,s;const r=new Di,n=async()=>{if(!(!i||!s))try{for await(const c of t)i.emitOne(c),s.emitOne(c)}catch(c){i.reject(c),s.reject(c)}finally{r.complete()}},o=new ls(async c=>(i=c,n(),r.p)),a=new ls(async c=>(s=c,n(),r.p));return[o,a]}map(t){return ls.map(this,t)}static coalesce(t){return ls.filter(t,i=>!!i)}coalesce(){return ls.coalesce(this)}static filter(t,i){return new ls(async s=>{for await(const r of t)i(r)&&s.emitOne(r)})}filter(t){return ls.filter(this,t)}d(){this.a.hasFinalValue||this.a.produceFinal({ok:!0,value:{done:!0,value:void 0}})}f(t){this.a.hasFinalValue||this.a.produceFinal({ok:!1,error:t})}[Symbol.asyncIterator](){return this.g}};function yf(e,t){return new _O(e,t)}var _O=class{constructor(e,t){this.e=e,this.f=t,this.a={flowing:!1,ended:!1,destroyed:!1},this.b={data:[],error:[]},this.c={data:[],error:[],end:[]},this.d=[]}pause(){this.a.destroyed||(this.a.flowing=!1)}resume(){this.a.destroyed||this.a.flowing||(this.a.flowing=!0,this.j(),this.k(),this.l())}write(e){if(!this.a.destroyed){if(this.a.flowing)this.g(e);else if(this.b.data.push(e),typeof this.f?.highWaterMark=="number"&&this.b.data.length>this.f.highWaterMark)return new Promise(t=>this.d.push(t))}}error(e){this.a.destroyed||(this.a.flowing?this.h(e):this.b.error.push(e))}end(e){this.a.destroyed||(typeof e<"u"&&this.write(e),this.a.flowing?(this.i(),this.destroy()):this.a.ended=!0)}g(e){this.c.data.slice(0).forEach(t=>t(e))}h(e){this.c.error.length===0?pt(e):this.c.error.slice(0).forEach(t=>t(e))}i(){this.c.end.slice(0).forEach(e=>e())}on(e,t){if(!this.a.destroyed)switch(e){case"data":this.c.data.push(t),this.resume();break;case"end":this.c.end.push(t),this.a.flowing&&this.l()&&this.destroy();break;case"error":this.c.error.push(t),this.a.flowing&&this.k();break}}removeListener(e,t){if(this.a.destroyed)return;let i;switch(e){case"data":i=this.c.data;break;case"end":i=this.c.end;break;case"error":i=this.c.error;break}if(i){const s=i.indexOf(t);s>=0&&i.splice(s,1)}}j(){if(this.b.data.length===0)return;if(typeof this.e=="function"){const t=this.e(this.b.data);this.g(t)}else for(const t of this.b.data)this.g(t);this.b.data.length=0;const e=[...this.d];this.d.length=0,e.forEach(t=>t())}k(){if(this.c.error.length>0){for(const e of this.b.error)this.h(e);this.b.error.length=0}}l(){return this.a.ended?(this.i(),this.c.end.length>0):!1}destroy(){this.a.destroyed||(this.a.destroyed=!0,this.a.ended=!0,this.b.data.length=0,this.b.error.length=0,this.c.data.length=0,this.c.error.length=0,this.c.end.length=0,this.d.length=0)}};function BO(e,t){const i=[];let s;for(;(s=e.read())!==null;)i.push(s);return t(i)}function WC(e,t){return new Promise((i,s)=>{const r=[];n0(e,{onData:n=>{t&&r.push(n)},onError:n=>{t?s(n):i(void 0)},onEnd:()=>{i(t?t(r):void 0)}})})}function n0(e,t,i){e.on("error",s=>{i?.isCancellationRequested||t.onError(s)}),e.on("end",()=>{i?.isCancellationRequested||t.onEnd()}),e.on("data",s=>{i?.isCancellationRequested||t.onData(s)})}function qO(e,t){const i=yf(t);return i.end(e),i}function VO(e,t,i){const s=yf(i);return n0(e,{onData:r=>s.write(t.data(r)),onError:r=>s.error(t.error?t.error(r):r),onEnd:()=>s.end()}),s}var mu=typeof Buffer<"u",GO=new Rt(()=>new Uint8Array(256)),o0,a0,_=class Ls{static alloc(t){return mu?new Ls(Buffer.allocUnsafe(t)):new Ls(new Uint8Array(t))}static wrap(t){return mu&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new Ls(t)}static fromString(t,i){return!(i?.dontUseNodeBuffer||!1)&&mu?new Ls(Buffer.from(t)):(o0||(o0=new TextEncoder),new Ls(o0.encode(t)))}static fromByteArray(t){const i=Ls.alloc(t.length);for(let s=0,r=t.length;s<r;s++)i.buffer[s]=t[s];return i}static concat(t,i){if(typeof i>"u"){i=0;for(let n=0,o=t.length;n<o;n++)i+=t[n].byteLength}const s=Ls.alloc(i);let r=0;for(let n=0,o=t.length;n<o;n++){const a=t[n];s.set(a,r),r+=a.byteLength}return s}static isNativeBuffer(t){return mu&&Buffer.isBuffer(t)}constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){const t=Ls.alloc(this.byteLength);return t.set(this),t}toString(){return mu?this.buffer.toString():(a0||(a0=new TextDecoder(void 0,{ignoreBOM:!0})),a0.decode(this.buffer))}slice(t,i){return new Ls(this.buffer.subarray(t,i))}set(t,i){if(t instanceof Ls)this.buffer.set(t.buffer,i);else if(t instanceof Uint8Array)this.buffer.set(t,i);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),i);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return Af(this.buffer,t)}writeUInt32BE(t,i){Sf(this.buffer,t,i)}readUInt32LE(t){return YO(this.buffer,t)}writeUInt32LE(t,i){QO(this.buffer,t,i)}readUInt8(t){return XO(this.buffer,t)}writeUInt8(t,i){KO(this.buffer,t,i)}indexOf(t,i=0){return _C(this.buffer,t instanceof Ls?t.buffer:t,i)}equals(t){return this===t?!0:this.byteLength!==t.byteLength?!1:this.buffer.every((i,s)=>i===t.buffer[s])}};function _C(e,t,i=0){const s=t.byteLength,r=e.byteLength;if(s===0)return 0;if(s===1)return e.indexOf(t[0],i);if(s>r-i)return-1;const n=GO.value;n.fill(t.length);for(let l=0;l<t.length;l++)n[t[l]]=t.length-l-1;let o=i+t.length-1,a=o,c=-1;for(;o<r;)if(e[o]===t[a]){if(a===0){c=o;break}o--,a--}else o+=Math.max(t.length-a,n[e[o]]),a=t.length-1;return c}function JO(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function ZO(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255}function Af(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function Sf(e,t,i){e[i+3]=t,t=t>>>8,e[i+2]=t,t=t>>>8,e[i+1]=t,t=t>>>8,e[i]=t}function YO(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0|e[t+2]<<16>>>0|e[t+3]<<24>>>0}function QO(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255,t=t>>>8,e[i+2]=t&255,t=t>>>8,e[i+3]=t&255}function XO(e,t){return e[t]}function KO(e,t,i){e[i]=t}function eF(e){return BO(e,t=>_.concat(t))}function BC(e){return WC(e,t=>_.concat(t))}function tF(e){return qO(e,t=>_.concat(t))}function iF(e){return VO(e,{data:t=>typeof t=="string"?_.fromString(t):_.wrap(t)},t=>_.concat(t))}function Wn(e){let t=0,i=0,s=0;const r=new Uint8Array(Math.floor(e.length/4*3)),n=a=>{switch(i){case 3:r[s++]=t|a,i=0;break;case 2:r[s++]=t|a>>>2,t=a<<6,i=3;break;case 1:r[s++]=t|a>>>4,t=a<<4,i=2;break;default:t=a<<2,i=1}};for(let a=0;a<e.length;a++){const c=e.charCodeAt(a);if(c>=65&&c<=90)n(c-65);else if(c>=97&&c<=122)n(c-97+26);else if(c>=48&&c<=57)n(c-48+52);else if(c===43||c===45)n(62);else if(c===47||c===95)n(63);else{if(c===61)break;throw new SyntaxError(`Unexpected base64 character ${e[a]}`)}}const o=s;for(;i>0;)n(0);return _.wrap(r).slice(0,o)}var sF="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rF="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function _n({buffer:e},t=!0,i=!1){const s=i?rF:sF;let r="";const n=e.byteLength%3;let o=0;for(;o<e.byteLength-n;o+=3){const a=e[o+0],c=e[o+1],l=e[o+2];r+=s[a>>>2],r+=s[(a<<4|c>>>4)&63],r+=s[(c<<2|l>>>6)&63],r+=s[l&63]}if(n===1){const a=e[o+0];r+=s[a>>>2],r+=s[a<<4&63],t&&(r+="==")}else if(n===2){const a=e[o+0],c=e[o+1];r+=s[a>>>2],r+=s[(a<<4|c>>>4)&63],r+=s[c<<2&63],t&&(r+="=")}return r}var qC="0123456789abcdef";function c0({buffer:e}){let t="";for(let i=0;i<e.length;i++){const s=e[i];t+=qC[s>>>4],t+=qC[s&15]}return t}function nF(e){if(e.length%2!==0)throw new SyntaxError("Hex string must have an even length");const t=new Uint8Array(e.length>>1);for(let i=0;i<e.length;)t[i>>1]=VC(e,i++)<<4|VC(e,i++);return _.wrap(t)}function VC(e,t){const i=e.charCodeAt(t);if(i>=48&&i<=57)return i-48;if(i>=97&&i<=102)return i-87;if(i>=65&&i<=70)return i-55;throw new SyntaxError(`Invalid hex character at position ${t}`)}function l0(e){const t=[];typeof e=="number"&&t.push("code/timeOrigin",e);function i(r,n){t.push(r,n?.startTime??Date.now())}function s(){const r=[];for(let n=0;n<t.length;n+=2)r.push({name:t[n],startTime:t[n+1]});return r}return{mark:i,getMarks:s}}function oF(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?l0():{mark(e,t){performance.mark(e,t)},getMarks(){let e=performance.timeOrigin;typeof e!="number"&&(e=(performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart)??0);const t=[{name:"code/timeOrigin",startTime:Math.round(e)}];for(const i of performance.getEntriesByType("mark"))t.push({name:i.name,startTime:Math.round(e+i.startTime)});return t}};if(typeof process=="object"){const e=performance?.timeOrigin;return l0(e)}else return console.trace("perf-util loaded in UNKNOWN environment"),l0()}function aF(e){return e.MonacoPerformanceMarks||(e.MonacoPerformanceMarks=oF()),e.MonacoPerformanceMarks}var GC=aF(globalThis),Ht=GC.mark,cF=GC.getMarks,Ef={};uL(Ef,{Promises:()=>at,RimRafMode:()=>qo,SymlinkSupport:()=>Ui,configureFlushOnWrite:()=>f0,realcase:()=>p0,realpathSync:()=>ik,whenDeleted:()=>vF,writeFileSync:()=>AF});import*as He from"fs";import{tmpdir as lF}from"os";import{promisify as vu}from"util";var uF=new ic(1e4);function xf(e){return JC(e,"NFC",uF)}var hF=new ic(1e4);function u0(e){return JC(e,"NFD",hF)}var dF=/[^\u0000-\u0080]/;function JC(e,t,i){if(!e)return e;const s=i.get(e);if(s)return s;let r;return dF.test(e)?r=e.normalize(t):r=e,i.set(e,r),r}var oie=(function(){const e=new ic(1e4),t=/[\u0300-\u036f]/g;return function(i){const s=e.get(i);if(s)return s;const r=u0(i).replace(t,""),n=(r.length===i.length?r:i).toLowerCase();return e.set(i,n),n}})(),qo;(function(e){e[e.UNLINK=0]="UNLINK",e[e.MOVE=1]="MOVE"})(qo||(qo={}));async function ZC(e,t=qo.UNLINK,i){if(gC(e))throw new Error("rimraf - will refuse to recursively delete root");return t===qo.UNLINK?h0(e):fF(e,i)}async function fF(e,t=hO(lF())){try{try{await He.promises.rename(e,t)}catch(i){return i.code==="ENOENT"?void 0:h0(e)}h0(t).catch(()=>{})}catch(i){if(i.code!=="ENOENT")throw i}}async function h0(e){return He.promises.rm(e,{recursive:!0,force:!0,maxRetries:3})}async function Cf(e,t){try{return await YC(e,t)}catch(i){if(i.code==="ENOENT"&&ze&&gC(e))try{return await YC(`${e}.`,t)}catch{}throw i}}async function YC(e,t){return gF(await(t?pF(e):He.promises.readdir(e)))}async function pF(e){try{return await He.promises.readdir(e,{withFileTypes:!0})}catch(s){s.code!=="ENOENT"&&console.warn("[node.js fs] readdir with filetypes failed with error: ",s)}const t=[],i=await Cf(e);for(const s of i){let r=!1,n=!1,o=!1;try{const a=await He.promises.lstat(Ge(e,s));r=a.isFile(),n=a.isDirectory(),o=a.isSymbolicLink()}catch(a){a.code!=="ENOENT"&&console.warn("[node.js fs] unexpected error from lstat after readdir: ",a)}t.push({name:s,isFile:()=>r,isDirectory:()=>n,isSymbolicLink:()=>o})}return t}function gF(e){return e.map(t=>typeof t=="string"?Nt?xf(t):t:(t.name=Nt?xf(t.name):t.name,t))}async function mF(e){const t=await Cf(e),i=[];for(const s of t)await Ui.existsDirectory(Ge(e,s))&&i.push(s);return i}function vF(e,t=1e3){return new Promise(i=>{let s=!1;const r=setInterval(()=>{s||(s=!0,He.access(e,n=>{s=!1,n&&(clearInterval(r),i(void 0))}))},t)})}var Ui;(function(e){async function t(r){let n;try{if(n=await He.promises.lstat(r),!n.isSymbolicLink())return{stat:n}}catch{}try{return{stat:await He.promises.stat(r),symbolicLink:n?.isSymbolicLink()?{dangling:!1}:void 0}}catch(o){if(o.code==="ENOENT"&&n)return{stat:n,symbolicLink:{dangling:!0}};if(ze&&o.code==="EACCES")try{return{stat:await He.promises.stat(await He.promises.readlink(r)),symbolicLink:{dangling:!1}}}catch(a){if(a.code==="ENOENT"&&n)return{stat:n,symbolicLink:{dangling:!0}};throw a}throw o}}e.stat=t;async function i(r){try{const{stat:n,symbolicLink:o}=await e.stat(r);return n.isFile()&&o?.dangling!==!0}catch{}return!1}e.existsFile=i;async function s(r){try{const{stat:n,symbolicLink:o}=await e.stat(r);return n.isDirectory()&&o?.dangling!==!0}catch{}return!1}e.existsDirectory=s})(Ui||(Ui={}));var wF=new NC;function bF(e,t,i){return wF.queueFor(y.file(e),()=>{const s=QC(i);return new Promise((r,n)=>yF(e,t,s,o=>o?n(o):r()))},e0)}var d0=!0;function f0(e){d0=e}function yF(e,t,i,s){if(!d0)return He.writeFile(e,t,{mode:i.mode,flag:i.flag},s);He.open(e,i.flag,i.mode,(r,n)=>{if(r)return s(r);He.writeFile(n,t,o=>{if(o)return He.close(n,()=>s(o));He.fdatasync(n,a=>(a&&(console.warn("[node.js fs] fdatasync is now disabled for this session because it failed: ",a),f0(!1)),He.close(n,c=>s(c))))})})}function AF(e,t,i){const s=QC(i);if(!d0)return He.writeFileSync(e,t,{mode:s.mode,flag:s.flag});const r=He.openSync(e,s.flag,s.mode);try{He.writeFileSync(r,t);try{He.fdatasyncSync(r)}catch(n){console.warn("[node.js fs] fdatasyncSync is now disabled for this session because it failed: ",n),f0(!1)}}finally{He.closeSync(r)}}function QC(e){return e?{mode:typeof e.mode=="number"?e.mode:438,flag:typeof e.flag=="string"?e.flag:"w"}:{mode:438,flag:"w"}}async function SF(e,t,i=6e4){if(e!==t)try{ze&&typeof i=="number"?await XC(e,t,Date.now(),i):await He.promises.rename(e,t)}catch(s){if(e.toLowerCase()!==t.toLowerCase()&&s.code==="EXDEV"||e.endsWith("."))await KC(e,t,{preserveSymlinks:!1}),await ZC(e,qo.MOVE);else throw s}}async function XC(e,t,i,s,r=0){try{return await He.promises.rename(e,t)}catch(n){if(n.code!=="EACCES"&&n.code!=="EPERM"&&n.code!=="EBUSY")throw n;if(Date.now()-i>=s)throw console.error(`[node.js fs] rename failed after ${r} retries with error: ${n}`),n;if(r===0){let o=!1;try{const{stat:a}=await Ui.stat(t);a.isFile()||(o=!0)}catch{}if(o)throw n}return await Kt(Math.min(100,r*10)),XC(e,t,i,s,r+1)}}async function KC(e,t,i){return tk(e,t,{root:{source:e,target:t},options:i,handledSourcePaths:new Set})}var ek=511;async function tk(e,t,i){if(i.handledSourcePaths.has(e))return;i.handledSourcePaths.add(e);const{stat:s,symbolicLink:r}=await Ui.stat(e);if(r){if(i.options.preserveSymlinks)try{return await CF(e,t,i)}catch{}if(r.dangling)return}return s.isDirectory()?EF(e,t,s.mode&ek,i):xF(e,t,s.mode&ek)}async function EF(e,t,i,s){await He.promises.mkdir(t,{recursive:!0,mode:i});const r=await Cf(e);for(const n of r)await tk(Ge(e,n),Ge(t,n),s)}async function xF(e,t,i){await He.promises.copyFile(e,t),await He.promises.chmod(t,i)}async function CF(e,t,i){let s=await He.promises.readlink(e);Bo(s,i.root.source,!Mt)&&(s=Ge(i.root.target,s.substr(i.root.source.length+1))),await He.promises.symlink(s,t)}async function p0(e,t){if(Mt)return e;const i=Fi(e);if(e===i)return e;const s=($t(e)||e).toLowerCase();try{if(t?.isCancellationRequested)return null;const n=(await at.readdir(i)).filter(o=>o.toLowerCase()===s);if(n.length===1){const o=await p0(i,t);if(o)return Ge(o,n[0])}else if(n.length>1){const o=n.indexOf(s);if(o>=0){const a=await p0(i,t);if(a)return Ge(a,n[o])}}}catch{}return null}async function kF(e){try{return await vu(He.realpath)(e)}catch{const t=sk(e);return await He.promises.access(t,He.constants.R_OK),t}}function ik(e){try{return He.realpathSync(e)}catch{const t=sk(e);return He.accessSync(t,He.constants.R_OK),t}}function sk(e){return Fn(Yr(e),It)}var at=new class{get read(){return(e,t,i,s,r)=>new Promise((n,o)=>{He.read(e,t,i,s,r,(a,c,l)=>a?o(a):n({bytesRead:c,buffer:l}))})}get write(){return(e,t,i,s,r)=>new Promise((n,o)=>{He.write(e,t,i,s,r,(a,c,l)=>a?o(a):n({bytesWritten:c,buffer:l}))})}get fdatasync(){return vu(He.fdatasync)}get open(){return vu(He.open)}get close(){return vu(He.close)}get ftruncate(){return vu(He.ftruncate)}async exists(e){try{return await He.promises.access(e),!0}catch{return!1}}get readdir(){return Cf}get readDirsInDir(){return mF}get writeFile(){return bF}get rm(){return ZC}get rename(){return SF}get copy(){return KC}get realpath(){return kF}};function rk(e){return(t,i,s)=>{let r=null,n=null;if(typeof s.value=="function"?(r="value",n=s.value):typeof s.get=="function"&&(r="get",n=s.get),!n||typeof i=="symbol")throw new Error("not supported");s[r]=e(n,i)}}function nk(e,t,i){let s=null,r=null;if(typeof i.value=="function"?(s="value",r=i.value,r.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof i.get=="function"&&(s="get",r=i.get),!r)throw new Error("not supported");const n=`$memoize$${t}`;i[s]=function(...o){return this.hasOwnProperty(n)||Object.defineProperty(this,n,{configurable:!1,enumerable:!1,writable:!1,value:r.apply(this,o)}),this[n]}}function kf(e,t,i){return rk((s,r)=>{const n=`$debounce$${r}`,o=`$debounce$result$${r}`;return function(...a){this[o]||(this[o]=i?i():void 0),clearTimeout(this[n]),t&&(this[o]=t(this[o],...a),a=[this[o]]),this[n]=setTimeout(()=>{s.apply(this,a),this[o]=i?i():void 0},e)}})}function $F(e,t,i){return rk((s,r)=>{const n=`$throttle$timer$${r}`,o=`$throttle$result$${r}`,a=`$throttle$lastRun$${r}`,c=`$throttle$pending$${r}`;return function(...l){if(this[o]||(this[o]=i?i():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),t&&(this[o]=t(this[o],...l)),this[c])return;const u=this[a]+e;u<=Date.now()?(this[a]=Date.now(),s.apply(this,[this[o]]),this[o]=i?i():void 0):(this[c]=!0,this[n]=setTimeout(()=>{this[c]=!1,this[a]=Date.now(),s.apply(this,[this[o]]),this[o]=i?i():void 0},u-Date.now()))}})}function IF(e){return JSON.stringify(e,DF)}function ok(e){let t=JSON.parse(e);return t=ei(t),t}function DF(e,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:t.flags}:t}function ei(e,t=0){if(!e||t>200)return e;if(typeof e=="object"){switch(e.$mid){case 1:return y.revive(e);case 2:return new RegExp(e.source,e.flags);case 17:return new Date(e.source)}if(e instanceof _||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let i=0;i<e.length;++i)e[i]=ei(e[i],t+1);else for(const i in e)Object.hasOwnProperty.call(e,i)&&(e[i]=ei(e[i],t+1))}return e}var ak;(function(e){e[e.Promise=100]="Promise",e[e.PromiseCancel=101]="PromiseCancel",e[e.EventListen=102]="EventListen",e[e.EventDispose=103]="EventDispose"})(ak||(ak={}));function ck(e){switch(e){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}var lk;(function(e){e[e.Initialize=200]="Initialize",e[e.PromiseSuccess=201]="PromiseSuccess",e[e.PromiseError=202]="PromiseError",e[e.PromiseErrorObj=203]="PromiseErrorObj",e[e.EventFire=204]="EventFire"})(lk||(lk={}));function uk(e){switch(e){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}var Vo;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Idle=1]="Idle"})(Vo||(Vo={}));function fc(e){let t=0;for(let i=0;;i+=7){const s=e.read(1);if(t|=(s.buffer[0]&127)<<i,!(s.buffer[0]&128))return t}}var PF=Bn(0);function pc(e,t){if(t===0){e.write(PF);return}let i=0;for(let r=t;r!==0;r=r>>>7)i++;const s=_.alloc(i);for(let r=0;t!==0;r++)s.buffer[r]=t&127,t=t>>>7,t>0&&(s.buffer[r]|=128);e.write(s)}var TF=class{constructor(e){this.b=e,this.a=0}read(e){const t=this.b.slice(this.a,this.a+e);return this.a+=t.byteLength,t}},MF=class{constructor(){this.a=[]}get buffer(){return _.concat(this.a)}write(e){this.a.push(e)}},Pi;(function(e){e[e.Undefined=0]="Undefined",e[e.String=1]="String",e[e.Buffer=2]="Buffer",e[e.VSBuffer=3]="VSBuffer",e[e.Array=4]="Array",e[e.Object=5]="Object",e[e.Int=6]="Int"})(Pi||(Pi={}));function Bn(e){const t=_.alloc(1);return t.writeUInt8(e,0),t}var Go={Undefined:Bn(Pi.Undefined),String:Bn(Pi.String),Buffer:Bn(Pi.Buffer),VSBuffer:Bn(Pi.VSBuffer),Array:Bn(Pi.Array),Object:Bn(Pi.Object),Uint:Bn(Pi.Int)};function g0(e,t){if(typeof t>"u")e.write(Go.Undefined);else if(typeof t=="string"){const i=_.fromString(t);e.write(Go.String),pc(e,i.byteLength),e.write(i)}else if(_.isNativeBuffer(t)){const i=_.wrap(t);e.write(Go.Buffer),pc(e,i.byteLength),e.write(i)}else if(t instanceof _)e.write(Go.VSBuffer),pc(e,t.byteLength),e.write(t);else if(Array.isArray(t)){e.write(Go.Array),pc(e,t.length);for(const i of t)g0(e,i)}else if(typeof t=="number"&&(t|0)===t)e.write(Go.Uint),pc(e,t);else{const i=_.fromString(JSON.stringify(t));e.write(Go.Object),pc(e,i.byteLength),e.write(i)}}function m0(e){switch(e.read(1).readUInt8(0)){case Pi.Undefined:return;case Pi.String:return e.read(fc(e)).toString();case Pi.Buffer:return e.read(fc(e)).buffer;case Pi.VSBuffer:return e.read(fc(e));case Pi.Array:{const i=fc(e),s=[];for(let r=0;r<i;r++)s.push(m0(e));return s}case Pi.Object:return JSON.parse(e.read(fc(e)).toString());case Pi.Int:return fc(e)}}var hk;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(hk||(hk={}));var dk=class{constructor(e,t=null){this.l=e,this.a=!1,this.b=Vo.Uninitialized,this.d=new Set,this.f=new Map,this.g=0,this.k=new I,this.onDidInitialize=this.k.event,this.h=this.l.onMessage(i=>this.s(i)),this.j=t}getChannel(e){const t=this;return{call(i,s,r){return t.a?Promise.reject(new dt):t.m(e,i,s,r)},listen(i,s){return t.a?Ie.None:t.o(e,i,s)}}}m(e,t,i,s=De.None){const r=this.g++,o={id:r,type:100,channelName:e,name:t,arg:i};if(s.isCancellationRequested)return Promise.reject(new dt);let a,c;return new Promise((u,h)=>{if(s.isCancellationRequested)return h(new dt);const f=()=>{const v=b=>{switch(b.type){case 201:this.f.delete(r),u(b.data);break;case 202:{this.f.delete(r);const S=new Error(b.data.message);S.stack=Array.isArray(b.data.stack)?b.data.stack.join(`
`):b.data.stack,S.name=b.data.name,h(S);break}case 203:this.f.delete(r),h(b.data);break}};this.f.set(r,v),this.p(o)};let p=null;this.b===Vo.Idle?f():(p=Qr(v=>this.u()),p.then(()=>{p=null,f()}));const g=()=>{p?(p.cancel(),p=null):this.p({id:r,type:101}),h(new dt)};a=s.onCancellationRequested(g),c={dispose:D1(()=>{g(),a.dispose()})},this.d.add(c)}).finally(()=>{a?.dispose(),this.d.delete(c)})}o(e,t,i){const s=this.g++,n={id:s,type:102,channelName:e,name:t,arg:i};let o=null;const a=new I({onWillAddFirstListener:()=>{const l=()=>{this.d.add(a),this.p(n)};this.b===Vo.Idle?l():(o=Qr(u=>this.u()),o.then(()=>{o=null,l()}))},onDidRemoveLastListener:()=>{o?(o.cancel(),o=null):(this.d.delete(a),this.p({id:s,type:103})),this.f.delete(s)}}),c=l=>a.fire(l.data);return this.f.set(s,c),a.event}p(e){switch(e.type){case 100:case 102:{const t=this.q([e.type,e.id,e.channelName,e.name],e.arg);this.j?.logOutgoing(t,e.id,0,`${ck(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{const t=this.q([e.type,e.id]);this.j?.logOutgoing(t,e.id,0,ck(e.type));return}}}q(e,t=void 0){const i=new MF;return g0(i,e),g0(i,t),this.r(i.buffer)}r(e){try{return this.l.send(e),e.byteLength}catch{return 0}}s(e){const t=new TF(e),i=m0(t),s=m0(t),r=i[0];switch(r){case 200:return this.j?.logIncoming(e.byteLength,0,0,uk(r)),this.t({type:i[0]});case 201:case 202:case 204:case 203:return this.j?.logIncoming(e.byteLength,i[1],0,uk(r),s),this.t({type:i[0],id:i[1],data:s})}}t(e){if(e.type===200){this.b=Vo.Idle,this.k.fire();return}this.f.get(e.id)?.(e)}get onDidInitializePromise(){return Ie.toPromise(this.onDidInitialize)}u(){return this.b===Vo.Idle?Promise.resolve():this.onDidInitializePromise}dispose(){this.a=!0,this.h&&(this.h.dispose(),this.h=null),Yi(this.d.values()),this.d.clear()}};__decorate([nk],dk.prototype,"onDidInitializePromise",null);function NF(e){let t=!1;return{call(i,s,r){return t?e.call(i,s,r):Kt(0).then(()=>t=!0).then(()=>e.call(i,s,r))},listen(i,s){if(t)return e.listen(i,s);const r=new n2;return Kt(0).then(()=>t=!0).then(()=>r.input=e.listen(i,s)),r.event}}}var v0;(function(e){function t(n,o,a){const c=n,l=a?.disableMarshalling,u=new Map;for(const h in c)s(h)&&u.set(h,Ie.buffer(c[h],!0,void 0,o));return new class{listen(h,f,p){const g=u.get(f);if(g)return g;const v=c[f];if(typeof v=="function"){if(r(f))return v.call(c,p);if(s(f))return u.set(f,Ie.buffer(c[f],!0,void 0,o)),u.get(f)}throw new zs(`Event not found: ${f}`)}call(h,f,p){const g=c[f];if(typeof g=="function"){if(!l&&Array.isArray(p))for(let b=0;b<p.length;b++)p[b]=ei(p[b]);let v=g.apply(c,p);return v instanceof Promise||(v=Promise.resolve(v)),v}throw new zs(`Method not found: ${f}`)}}}e.fromService=t;function i(n,o){const a=o?.disableMarshalling;return new Proxy({},{get(c,l){if(typeof l=="string")return o?.properties?.has(l)?o.properties.get(l):r(l)?function(u){return n.listen(l,u)}:s(l)?n.listen(l):async function(...u){let h;o&&!qt(o.context)?h=[o.context,...u]:h=u;const f=await n.call(l,h);return a?f:ei(f)};throw new zs(`Property not found: ${String(l)}`)}})}e.toService=i;function s(n){return n[0]==="o"&&n[1]==="n"&&iC(n.charCodeAt(2))}function r(n){return/^onDynamic/.test(n)&&iC(n.charCodeAt(9))}})(v0||(v0={}));var fk;(function(e){e.Created="created",e.Read="read",e.Write="write",e.Open="open",e.Error="error",e.Close="close",e.BrowserWebSocketBlobReceived="browserWebSocketBlobReceived",e.NodeEndReceived="nodeEndReceived",e.NodeEndSent="nodeEndSent",e.NodeDrainBegin="nodeDrainBegin",e.NodeDrainEnd="nodeDrainEnd",e.zlibInflateError="zlibInflateError",e.zlibInflateData="zlibInflateData",e.zlibInflateInitialWrite="zlibInflateInitialWrite",e.zlibInflateInitialFlushFired="zlibInflateInitialFlushFired",e.zlibInflateWrite="zlibInflateWrite",e.zlibInflateFlushFired="zlibInflateFlushFired",e.zlibDeflateError="zlibDeflateError",e.zlibDeflateData="zlibDeflateData",e.zlibDeflateWrite="zlibDeflateWrite",e.zlibDeflateFlushFired="zlibDeflateFlushFired",e.WebSocketNodeSocketWrite="webSocketNodeSocketWrite",e.WebSocketNodeSocketPeekedHeader="webSocketNodeSocketPeekedHeader",e.WebSocketNodeSocketReadHeader="webSocketNodeSocketReadHeader",e.WebSocketNodeSocketReadData="webSocketNodeSocketReadData",e.WebSocketNodeSocketUnmaskedData="webSocketNodeSocketUnmaskedData",e.WebSocketNodeSocketDrainBegin="webSocketNodeSocketDrainBegin",e.WebSocketNodeSocketDrainEnd="webSocketNodeSocketDrainEnd",e.ProtocolHeaderRead="protocolHeaderRead",e.ProtocolMessageRead="protocolMessageRead",e.ProtocolHeaderWrite="protocolHeaderWrite",e.ProtocolMessageWrite="protocolMessageWrite",e.ProtocolWrite="protocolWrite"})(fk||(fk={}));var $f;(function(e){e.enableDiagnostics=!1,e.records=[];const t=new WeakMap;let i=0;function s(n,o){if(!t.has(n)){const a=String(++i);t.set(n,a)}return t.get(n)}function r(n,o,a,c){if(!e.enableDiagnostics)return;const l=s(n,o);if(c instanceof _||c instanceof Uint8Array||c instanceof ArrayBuffer||ArrayBuffer.isView(c)){const u=_.alloc(c.byteLength);u.set(c),e.records.push({timestamp:Date.now(),id:l,label:o,type:a,buff:u})}else e.records.push({timestamp:Date.now(),id:l,label:o,type:a,data:c})}e.traceSocketEvent=r})($f||($f={}));var pk;(function(e){e[e.NodeSocketCloseEvent=0]="NodeSocketCloseEvent",e[e.WebSocketCloseEvent=1]="WebSocketCloseEvent"})(pk||(pk={}));var w0=null;function qn(){return w0||(w0=_.alloc(0)),w0}var gk=class{get byteLength(){return this.b}constructor(){this.a=[],this.b=0}acceptChunk(e){this.a.push(e),this.b+=e.byteLength}read(e){return this.c(e,!0)}peek(e){return this.c(e,!1)}c(e,t){if(e===0)return qn();if(e>this.b)throw new Error("Cannot read so many bytes!");if(this.a[0].byteLength===e){const n=this.a[0];return t&&(this.a.shift(),this.b-=e),n}if(this.a[0].byteLength>e){const n=this.a[0].slice(0,e);return t&&(this.a[0]=this.a[0].slice(e),this.b-=e),n}const i=_.alloc(e);let s=0,r=0;for(;e>0;){const n=this.a[r];if(n.byteLength>e){const o=n.slice(0,e);i.set(o,s),s+=e,t&&(this.a[r]=n.slice(e),this.b-=e),e-=e}else i.set(n,s),s+=n.byteLength,t?(this.a.shift(),this.b-=n.byteLength):r++,e-=n.byteLength}return i}},mk;(function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.Control=2]="Control",e[e.Ack=3]="Ack",e[e.Disconnect=5]="Disconnect",e[e.ReplayRequest=6]="ReplayRequest",e[e.Pause=7]="Pause",e[e.Resume=8]="Resume",e[e.KeepAlive=9]="KeepAlive"})(mk||(mk={}));function vk(e){switch(e){case 0:return"None";case 1:return"Regular";case 2:return"Control";case 3:return"Ack";case 5:return"Disconnect";case 6:return"ReplayRequest";case 7:return"PauseWriting";case 8:return"ResumeWriting";case 9:return"KeepAlive"}}var wk;(function(e){e[e.HeaderLength=13]="HeaderLength",e[e.AcknowledgeTime=2e3]="AcknowledgeTime",e[e.TimeoutTime=2e4]="TimeoutTime",e[e.ReconnectionGraceTime=108e5]="ReconnectionGraceTime",e[e.ReconnectionShortGraceTime=3e5]="ReconnectionShortGraceTime",e[e.KeepAliveSendTime=5e3]="KeepAliveSendTime"})(wk||(wk={}));var wr=class{constructor(e,t,i,s){this.type=e,this.id=t,this.ack=i,this.data=s,this.writtenTime=0}get size(){return this.data.byteLength}},bk=class extends J{constructor(e){super(),this.f=this.D(new I),this.onMessage=this.f.event,this.g={readHead:!0,readLen:13,messageType:0,id:0,ack:0},this.a=e,this.b=!1,this.c=new gk,this.D(this.a.onData(t=>this.acceptChunk(t))),this.lastReadTime=Date.now()}acceptChunk(e){if(!(!e||e.byteLength===0))for(this.lastReadTime=Date.now(),this.c.acceptChunk(e);this.c.byteLength>=this.g.readLen;){const t=this.c.read(this.g.readLen);if(this.g.readHead)this.g.readHead=!1,this.g.readLen=t.readUInt32BE(9),this.g.messageType=t.readUInt8(0),this.g.id=t.readUInt32BE(1),this.g.ack=t.readUInt32BE(5),this.a.traceSocketEvent("protocolHeaderRead",{messageType:vk(this.g.messageType),id:this.g.id,ack:this.g.ack,messageSize:this.g.readLen});else{const i=this.g.messageType,s=this.g.id,r=this.g.ack;if(this.g.readHead=!0,this.g.readLen=13,this.g.messageType=0,this.g.id=0,this.g.ack=0,this.a.traceSocketEvent("protocolMessageRead",t),this.f.fire(new wr(i,s,r,t)),this.b)break}}}readEntireBuffer(){return this.c.read(this.c.byteLength)}dispose(){this.b=!0,super.dispose()}},yk=class{constructor(e){this.k=null,this.a=!1,this.b=!1,this.c=e,this.d=[],this.f=0,this.lastWriteTime=0}dispose(){try{this.flush()}catch{}this.a=!0}drain(){return this.flush(),this.c.drain()}flush(){this.m()}pause(){this.b=!0}resume(){this.b=!1,this.l()}write(e){if(this.a)return;e.writtenTime=Date.now(),this.lastWriteTime=Date.now();const t=_.alloc(13);t.writeUInt8(e.type,0),t.writeUInt32BE(e.id,1),t.writeUInt32BE(e.ack,5),t.writeUInt32BE(e.data.byteLength,9),this.c.traceSocketEvent("protocolHeaderWrite",{messageType:vk(e.type),id:e.id,ack:e.ack,messageSize:e.data.byteLength}),this.c.traceSocketEvent("protocolMessageWrite",e.data),this.j(t,e.data)}g(e,t){const i=this.f===0;return this.d.push(e,t),this.f+=e.byteLength+t.byteLength,i}h(){const e=_.concat(this.d,this.f);return this.d.length=0,this.f=0,e}j(e,t){this.g(e,t)&&this.l()}l(){this.k||(this.k=setTimeout(()=>{this.k=null,this.m()}))}m(){if(this.f===0||this.b)return;const e=this.h();this.c.traceSocketEvent("protocolWrite",{byteLength:e.byteLength}),this.c.write(e)}},Jo=class{constructor(){this.b=!1,this.c=!1,this.d=[],this.a=new I({onWillAddFirstListener:()=>{this.b=!0,queueMicrotask(()=>this.f())},onDidRemoveLastListener:()=>{this.b=!1}}),this.event=this.a.event}f(){if(!this.c){for(this.c=!0;this.b&&this.d.length>0;)this.a.fire(this.d.shift());this.c=!1}}fire(e){this.b?this.d.length>0?this.d.push(e):this.a.fire(e):this.d.push(e)}flushBuffer(){this.d=[]}},RF=class{constructor(e){this.data=e,this.next=null}},LF=class{constructor(){this.a=null,this.b=null}length(){let e=0,t=this.a;for(;t;)t=t.next,e++;return e}peek(){return this.a?this.a.data:null}toArray(){const e=[];let t=0,i=this.a;for(;i;)e[t++]=i.data,i=i.next;return e}pop(){if(this.a){if(this.a===this.b){this.a=null,this.b=null;return}this.a=this.a.next}}push(e){const t=new RF(e);if(!this.a){this.a=t,this.b=t;return}this.b.next=t,this.b=t}},OF=class Hr{static{this.a=10}static{this.b=null}static getInstance(){return Hr.b||(Hr.b=new Hr),Hr.b}constructor(){this.c=[];const t=Date.now();for(let i=0;i<Hr.a;i++)this.c[i]=t-1e3*i;setInterval(()=>{for(let i=Hr.a;i>=1;i--)this.c[i]=this.c[i-1];this.c[0]=Date.now()},1e3)}d(){const t=Date.now(),i=(1+Hr.a)*1e3;let s=0;for(let r=0;r<Hr.a;r++)t-this.c[r]<=i&&s++;return 1-s/Hr.a}hasHighLoad(){return this.d()>=.5}},b0=class{get unacknowledgedCount(){return this.d-this.f}constructor(e){this.v=new Jo,this.onControlMessage=this.v.event,this.w=new Jo,this.onMessage=this.w.event,this.x=new Jo,this.onDidDispose=this.x.event,this.y=new Jo,this.onSocketClose=this.y.event,this.z=new Jo,this.onSocketTimeout=this.z.event,this.t=e.loadEstimator??OF.getInstance(),this.u=e.sendKeepAlive??!0,this.a=!1,this.c=new LF,this.d=0,this.f=0,this.g=null,this.h=0,this.j=0,this.k=0,this.l=null,this.n=0,this.o=Date.now(),this.s=new X,this.p=e.socket,this.q=this.s.add(new yk(this.p)),this.r=this.s.add(new bk(this.p)),this.s.add(this.r.onMessage(t=>this.A(t))),this.s.add(this.p.onClose(t=>this.y.fire(t))),e.initialChunk&&this.r.acceptChunk(e.initialChunk),this.u?this.m=setInterval(()=>{this.E()},5e3):this.m=null}dispose(){this.g&&(clearTimeout(this.g),this.g=null),this.l&&(clearTimeout(this.l),this.l=null),this.m&&(clearInterval(this.m),this.m=null),this.s.dispose()}drain(){return this.q.drain()}sendDisconnect(){if(!this.b){this.b=!0;const e=new wr(5,0,0,qn());this.q.write(e),this.q.flush()}}sendPause(){const e=new wr(7,0,0,qn());this.q.write(e)}sendResume(){const e=new wr(8,0,0,qn());this.q.write(e)}pauseSocketWriting(){this.q.pause()}getSocket(){return this.p}getMillisSinceLastIncomingData(){return Date.now()-this.r.lastReadTime}beginAcceptReconnection(e,t){this.a=!0,this.s.dispose(),this.s=new X,this.v.flushBuffer(),this.y.flushBuffer(),this.z.flushBuffer(),this.p.dispose(),this.n=0,this.o=Date.now(),this.p=e,this.q=this.s.add(new yk(this.p)),this.r=this.s.add(new bk(this.p)),this.s.add(this.r.onMessage(i=>this.A(i))),this.s.add(this.p.onClose(i=>this.y.fire(i))),this.r.acceptChunk(t)}endAcceptReconnection(){this.a=!1,this.j=this.h;const e=new wr(3,0,this.j,qn());this.q.write(e);const t=this.c.toArray();for(let i=0,s=t.length;i<s;i++)this.q.write(t[i]);this.C()}acceptDisconnect(){this.x.fire()}A(e){if(e.ack>this.f){this.f=e.ack;do{const t=this.c.peek();if(t&&t.id<=e.ack)this.c.pop();else break}while(!0)}switch(e.type){case 0:break;case 1:{if(e.id>this.h)if(e.id!==this.h+1){const t=Date.now();t-this.n>1e4&&(this.n=t,this.q.write(new wr(6,0,0,qn())))}else this.h=e.id,this.k=Date.now(),this.B(),this.w.fire(e.data);break}case 2:{this.v.fire(e.data);break}case 3:break;case 5:{this.x.fire();break}case 6:{const t=this.c.toArray();for(let i=0,s=t.length;i<s;i++)this.q.write(t[i]);this.C();break}case 7:{this.q.pause();break}case 8:{this.q.resume();break}case 9:break}}readEntireBuffer(){return this.r.readEntireBuffer()}flush(){this.q.flush()}send(e){const t=++this.d;this.j=this.h;const i=new wr(1,t,this.j,e);this.c.push(i),this.a||(this.q.write(i),this.C())}sendControl(e){const t=new wr(2,0,0,e);this.q.write(t)}B(){if(this.h<=this.j||this.l)return;const e=Date.now()-this.k;if(e>=2e3){this.D();return}this.l=setTimeout(()=>{this.l=null,this.B()},2e3-e+5)}C(){if(this.d<=this.f||this.g||this.a)return;const e=this.c.peek(),t=Date.now()-e.writtenTime,i=Date.now()-this.r.lastReadTime,s=Date.now()-this.o;if(t>=2e4&&i>=2e4&&s>=2e4&&!this.t.hasHighLoad()){this.o=Date.now(),this.z.fire({unacknowledgedMsgCount:this.c.length(),timeSinceOldestUnacknowledgedMsg:t,timeSinceLastReceivedSomeData:i});return}const r=Math.max(2e4-t,2e4-i,2e4-s,500);this.g=setTimeout(()=>{this.g=null,this.C()},r)}D(){if(this.h<=this.j)return;this.j=this.h;const e=new wr(3,0,this.j,qn());this.q.write(e)}E(){this.j=this.h;const e=new wr(9,0,this.j,qn());this.q.write(e)}};import"crypto";import"net";import{tmpdir as FF}from"os";import{createDeflateRaw as jF,createInflateRaw as UF}from"zlib";var At=(function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let s=0,r="";return r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+="-",r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r+=t[e[s++]],r}})(),zF=3e4,wu=class{traceSocketEvent(e,t){$f.traceSocketEvent(this.socket,this.debugLabel,e,t)}constructor(e,t=""){this.d=!0,this.debugLabel=t,this.socket=e,this.traceSocketEvent("created",{type:"NodeSocket"}),this.a=s=>{if(this.traceSocketEvent("error",{code:s?.code,message:s?.message}),s){if(s.code==="EPIPE")return;pt(s)}},this.socket.on("error",this.a);let i;this.b=s=>{this.traceSocketEvent("close",{hadError:s}),this.d=!1,i&&clearTimeout(i)},this.socket.on("close",this.b),this.c=()=>{this.traceSocketEvent("nodeEndReceived"),this.d=!1,i=setTimeout(()=>e.destroy(),zF)},this.socket.on("end",this.c)}dispose(){this.socket.off("error",this.a),this.socket.off("close",this.b),this.socket.off("end",this.c),this.socket.destroy()}onData(e){const t=i=>{this.traceSocketEvent("read",i),e(_.wrap(i))};return this.socket.on("data",t),{dispose:()=>this.socket.off("data",t)}}onClose(e){const t=i=>{e({type:0,hadError:i,error:void 0})};return this.socket.on("close",t),{dispose:()=>this.socket.off("close",t)}}onEnd(e){const t=()=>{e()};return this.socket.on("end",t),{dispose:()=>this.socket.off("end",t)}}write(e){if(!(this.socket.destroyed||!this.d))try{this.traceSocketEvent("write",e),this.socket.write(e.buffer,t=>{if(t){if(t.code==="EPIPE")return;pt(t)}})}catch(t){if(t.code==="EPIPE")return;pt(t)}}end(){this.traceSocketEvent("nodeEndSent"),this.socket.end()}drain(){return this.traceSocketEvent("nodeDrainBegin"),new Promise((e,t)=>{if(this.socket.bufferSize===0){this.traceSocketEvent("nodeDrainEnd"),e();return}const i=()=>{this.socket.off("close",i),this.socket.off("end",i),this.socket.off("error",i),this.socket.off("timeout",i),this.socket.off("drain",i),this.traceSocketEvent("nodeDrainEnd"),e()};this.socket.on("close",i),this.socket.on("end",i),this.socket.on("error",i),this.socket.on("timeout",i),this.socket.on("drain",i)})}},Ak;(function(e){e[e.MinHeaderByteSize=2]="MinHeaderByteSize",e[e.MaxWebSocketMessageLength=262144]="MaxWebSocketMessageLength"})(Ak||(Ak={}));var Sk;(function(e){e[e.PeekHeader=1]="PeekHeader",e[e.ReadHeader=2]="ReadHeader",e[e.ReadBody=3]="ReadBody",e[e.Fin=4]="Fin"})(Sk||(Sk={}));var HF=class extends J{get permessageDeflate(){return this.a.permessageDeflate}get recordedInflateBytes(){return this.a.recordedInflateBytes}traceSocketEvent(e,t){this.socket.traceSocketEvent(e,t)}constructor(e,t,i,s,r=!0){super(),this.c=this.D(new I),this.f=this.D(new I),this.h=!1,this.j={state:1,readLen:2,fin:0,compressed:!1,firstFrameOfMessage:!0,mask:0,opcode:0},this.socket=e,this.g=r?262144:1/0,this.traceSocketEvent("created",{type:"WebSocketNodeSocket",permessageDeflate:t,inflateBytesLength:i?.byteLength||0,recordInflateBytes:s}),this.a=this.D(new WF(this,t,i,s,this.c,(n,o)=>this.m(n,o))),this.D(this.a.onError(n=>{console.error(n),pt(n),this.f.fire({type:0,hadError:!0,error:n})})),this.b=new gk,this.D(this.socket.onData(n=>this.n(n))),this.D(this.socket.onClose(async n=>{this.a.isProcessingReadQueue()&&await Ie.toPromise(this.a.onDidFinishProcessingReadQueue),this.f.fire(n)}))}dispose(){this.a.isProcessingWriteQueue()?this.D(this.a.onDidFinishProcessingWriteQueue(()=>{this.dispose()})):(this.socket.dispose(),super.dispose())}onData(e){return this.c.event(e)}onClose(e){return this.f.event(e)}onEnd(e){return this.socket.onEnd(e)}write(e){let t=0;for(;t<e.byteLength;)this.a.writeMessage(e.slice(t,Math.min(t+this.g,e.byteLength)),{compressed:!0,opcode:2}),t+=this.g}m(e,{compressed:t,opcode:i}){if(this.h)return;this.traceSocketEvent("webSocketNodeSocketWrite",e);let s=2;e.byteLength<126?s+=0:e.byteLength<2**16?s+=2:s+=8;const r=_.alloc(s),n=t?64:0,o=i&15;if(r.writeUInt8(128|n|o,0),e.byteLength<126)r.writeUInt8(e.byteLength,1);else if(e.byteLength<2**16){r.writeUInt8(126,1);let a=1;r.writeUInt8(e.byteLength>>>8&255,++a),r.writeUInt8(e.byteLength>>>0&255,++a)}else{r.writeUInt8(127,1);let a=1;r.writeUInt8(0,++a),r.writeUInt8(0,++a),r.writeUInt8(0,++a),r.writeUInt8(0,++a),r.writeUInt8(e.byteLength>>>24&255,++a),r.writeUInt8(e.byteLength>>>16&255,++a),r.writeUInt8(e.byteLength>>>8&255,++a),r.writeUInt8(e.byteLength>>>0&255,++a)}this.socket.write(_.concat([r,e]))}end(){this.h=!0,this.socket.end()}n(e){if(e.byteLength!==0){for(this.b.acceptChunk(e);this.b.byteLength>=this.j.readLen;)if(this.j.state===1){const t=this.b.peek(this.j.readLen),i=t.readUInt8(0),s=(i&128)>>>7,r=(i&64)>>>6,n=i&15,o=t.readUInt8(1),a=(o&128)>>>7,c=o&127;this.j.state=2,this.j.readLen=2+(a?4:0)+(c===126?2:0)+(c===127?8:0),this.j.fin=s,this.j.firstFrameOfMessage&&(this.j.compressed=!!r),this.j.firstFrameOfMessage=!!s,this.j.mask=0,this.j.opcode=n,this.traceSocketEvent("webSocketNodeSocketPeekedHeader",{headerSize:this.j.readLen,compressed:this.j.compressed,fin:this.j.fin,opcode:this.j.opcode})}else if(this.j.state===2){const t=this.b.read(this.j.readLen),i=t.readUInt8(1),s=(i&128)>>>7;let r=i&127,n=1;r===126?r=t.readUInt8(++n)*2**8+t.readUInt8(++n):r===127&&(r=t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*2**24+t.readUInt8(++n)*2**16+t.readUInt8(++n)*2**8+t.readUInt8(++n));let o=0;s&&(o=t.readUInt8(++n)*2**24+t.readUInt8(++n)*2**16+t.readUInt8(++n)*2**8+t.readUInt8(++n)),this.j.state=3,this.j.readLen=r,this.j.mask=o,this.traceSocketEvent("webSocketNodeSocketPeekedHeader",{bodySize:this.j.readLen,compressed:this.j.compressed,fin:this.j.fin,mask:this.j.mask,opcode:this.j.opcode})}else if(this.j.state===3){const t=this.b.read(this.j.readLen);this.traceSocketEvent("webSocketNodeSocketReadData",t),qF(t,this.j.mask),this.traceSocketEvent("webSocketNodeSocketUnmaskedData",t),this.j.state=1,this.j.readLen=2,this.j.mask=0,this.j.opcode<=2?this.a.acceptFrame(t,this.j.compressed,!!this.j.fin):this.j.opcode===9&&this.a.writeMessage(t,{compressed:!1,opcode:10})}}}async drain(){this.traceSocketEvent("webSocketNodeSocketDrainBegin"),this.a.isProcessingWriteQueue()&&await Ie.toPromise(this.a.onDidFinishProcessingWriteQueue),await this.socket.drain(),this.traceSocketEvent("webSocketNodeSocketDrainEnd")}},WF=class extends J{get permessageDeflate(){return!!(this.b&&this.c)}get recordedInflateBytes(){return this.b?this.b.recordedInflateBytes:_.alloc(0)}constructor(e,t,i,s,r,n){super(),this.m=e,this.n=r,this.q=n,this.a=this.D(new I),this.onError=this.a.event,this.f=[],this.g=[],this.h=this.D(new I),this.onDidFinishProcessingReadQueue=this.h.event,this.j=this.D(new I),this.onDidFinishProcessingWriteQueue=this.j.event,this.r=!1,this.u=!1,t?(this.b=this.D(new _F(this.m,s,i,{windowBits:15})),this.c=this.D(new BF(this.m,{windowBits:15})),this.D(this.b.onError(o=>this.a.fire(o))),this.D(this.c.onError(o=>this.a.fire(o)))):(this.b=null,this.c=null)}writeMessage(e,t){this.f.push({data:e,options:t}),this.s()}async s(){if(!this.r){for(this.r=!0;this.f.length>0;){const{data:e,options:t}=this.f.shift();if(this.c&&t.compressed){const i=await this.t(this.c,e);this.q(i,t)}else this.q(e,{...t,compressed:!1})}this.r=!1,this.j.fire()}}isProcessingWriteQueue(){return this.r}t(e,t){return new Promise((i,s)=>{e.write(t),e.flush(r=>i(r))})}acceptFrame(e,t,i){this.g.push({data:e,isCompressed:t,isLastFrameOfMessage:i}),this.w()}async w(){if(!this.u){for(this.u=!0;this.g.length>0;){const e=this.g.shift();if(this.b&&e.isCompressed){const t=await this.y(this.b,e.data,e.isLastFrameOfMessage);this.n.fire(t)}else this.n.fire(e.data)}this.u=!1,this.h.fire()}}isProcessingReadQueue(){return this.u}y(e,t,i){return new Promise((s,r)=>{e.write(t),i&&e.write(_.fromByteArray([0,0,255,255])),e.flush(n=>s(n))})}},_F=class extends J{get recordedInflateBytes(){return this.h?_.concat(this.c):_.alloc(0)}constructor(e,t,i,s){super(),this.g=e,this.h=t,this.a=this.D(new I),this.onError=this.a.event,this.c=[],this.f=[],this.b=UF(s),this.b.on("error",r=>{this.g.traceSocketEvent("zlibInflateError",{message:r?.message,code:r?.code}),this.a.fire(r)}),this.b.on("data",r=>{this.g.traceSocketEvent("zlibInflateData",r),this.f.push(_.wrap(r))}),i&&(this.g.traceSocketEvent("zlibInflateInitialWrite",i.buffer),this.b.write(i.buffer),this.b.flush(()=>{this.g.traceSocketEvent("zlibInflateInitialFlushFired"),this.f.length=0}))}write(e){this.h&&this.c.push(e.clone()),this.g.traceSocketEvent("zlibInflateWrite",e),this.b.write(e.buffer)}flush(e){this.b.flush(()=>{this.g.traceSocketEvent("zlibInflateFlushFired");const t=_.concat(this.f);this.f.length=0,e(t)})}},BF=class extends J{constructor(e,t){super(),this.f=e,this.a=this.D(new I),this.onError=this.a.event,this.c=[],this.b=jF({windowBits:15}),this.b.on("error",i=>{this.f.traceSocketEvent("zlibDeflateError",{message:i?.message,code:i?.code}),this.a.fire(i)}),this.b.on("data",i=>{this.f.traceSocketEvent("zlibDeflateData",i),this.c.push(_.wrap(i))})}write(e){this.f.traceSocketEvent("zlibDeflateWrite",e.buffer),this.b.write(e.buffer)}flush(e){this.b.flush(2,()=>{this.f.traceSocketEvent("zlibDeflateFlushFired");let t=_.concat(this.c);this.c.length=0,t=t.slice(0,t.byteLength-4),e(t)})}};function qF(e,t){if(t===0)return;const i=e.byteLength>>>2;for(let c=0;c<i;c++){const l=e.readUInt32BE(c*4);e.writeUInt32BE(l^t,c*4)}const s=i*4,r=e.byteLength-s,n=t>>>24&255,o=t>>>16&255,a=t>>>8&255;r>=1&&e.writeUInt8(e.readUInt8(s)^n,s),r>=2&&e.writeUInt8(e.readUInt8(s+1)^o,s+1),r>=3&&e.writeUInt8(e.readUInt8(s+2)^a,s+2)}var Ek=process.env.XDG_RUNTIME_DIR,VF={2:107,1:103};function GF(){const e=At();if(process.platform==="win32")return`\\\\.\\pipe\\vscode-ipc-${e}-sock`;const t=process.platform!=="darwin"&&Ek?Ek:FF(),i=Ge(t,`vscode-ipc-${e}.sock`);return JF(i),i}function JF(e){const t=VF[v2];typeof t=="number"&&e.length>=t&&console.warn(`WARNING: IPC handle "${e}" is longer than ${t} chars, try a shorter --user-data-dir`)}function ct(e){if(!e||typeof e!="object"||e instanceof RegExp)return e;const t=Array.isArray(e)?[]:{};return Object.entries(e).forEach(([i,s])=>{t[i]=s&&typeof s=="object"?ct(s):s}),t}function y0(e){if(!e||typeof e!="object")return e;const t=[e];for(;t.length>0;){const i=t.shift();Object.freeze(i);for(const s in i)if(xk.call(i,s)){const r=i[s];typeof r=="object"&&!Object.isFrozen(r)&&!jL(r)&&t.push(r)}}return e}var xk=Object.prototype.hasOwnProperty;function gc(e,t){return A0(e,t,new Set)}function A0(e,t,i){if(qt(e))return e;const s=t(e);if(typeof s<"u")return s;if(Array.isArray(e)){const r=[];for(const n of e)r.push(A0(n,t,i));return r}if(kt(e)){if(i.has(e))throw new Error("Cannot clone recursive data-structure");i.add(e);const r={};for(const n in e)xk.call(e,n)&&(r[n]=A0(e[n],t,i));return i.delete(e),r}return e}function Xr(e,t,i=!0){return kt(e)?(kt(t)&&Object.keys(t).forEach(s=>{s in e?i&&(kt(e[s])&&kt(t[s])?Xr(e[s],t[s],i):e[s]=t[s]):e[s]=t[s]}),e):t}function Ai(e,t){if(e===t)return!0;if(e==null||t===null||t===void 0||typeof e!=typeof t||typeof e!="object"||Array.isArray(e)!==Array.isArray(t))return!1;let i,s;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!Ai(e[i],t[i]))return!1}else{const r=[];for(s in e)r.push(s);r.sort();const n=[];for(s in t)n.push(s);if(n.sort(),!Ai(r,n))return!1;for(i=0;i<r.length;i++)if(!Ai(e[r[i]],t[r[i]]))return!1}return!0}function ZF(e){const t=new Set;return JSON.stringify(e,(i,s)=>{if(kt(s)||Array.isArray(s)){if(t.has(s))return"[Circular]";t.add(s)}return typeof s=="bigint"?`[BigInt ${s.toString()}]`:s})}function Ck(e,t){const i=t.toLowerCase(),s=Object.keys(e).find(r=>r.toLowerCase()===i);return s?e[s]:e[t]}function kk(e,t){const i=Object.create(null);for(const[s,r]of Object.entries(e))t(s,r)&&(i[s]=r);return i}var YF=new class{constructor(){this.a=0,this.b=new I,this.onDidChangeZoomLevel=this.b.event}getZoomLevel(){return this.a}setZoomLevel(e){e=Math.min(Math.max(-5,e),20),this.a!==e&&(this.a=e,this.b.fire(this.a))}},QF=Nt?1.5:1.35,S0=8,XF=class RE{static _create(t,i,s,r,n,o,a,c,l){o===0?o=QF*s:o<S0&&(o=o*s),o=Math.round(o),o<S0&&(o=S0);const u=1+(l?0:YF.getZoomLevel()*.1);return s*=u,o*=u,n===Ik&&(i==="normal"||i==="bold"?n=$k:(n=`'wght' ${parseInt(i,10)}`,i="normal")),new RE({pixelRatio:c,fontFamily:t,fontWeight:i,fontSize:s,fontFeatureSettings:r,fontVariationSettings:n,lineHeight:o,letterSpacing:a})}constructor(t){this._bareFontInfoBrand=void 0,this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=t.lineHeight|0,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const t=br.fontFamily,i=RE.a(this.fontFamily);return t&&this.fontFamily!==t?`${i}, ${t}`:i}static a(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}},KF=2,ej=class extends XF{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=KF,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}},$k="normal",Ik="translate",tj="Consolas, 'Courier New', monospace",ij="Menlo, Monaco, 'Courier New', monospace",sj="'Droid Sans Mono', monospace",br={fontFamily:Nt?ij:ze?tj:sj,fontWeight:"normal",fontSize:Nt?12:14,lineHeight:0,letterSpacing:0},Dk={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},Pk="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function rj(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const i of Pk)e.indexOf(i)>=0||(t+="\\"+i);return t+="\\s]+)",new RegExp(t,"g")}var nj=rj();function Tk(e){let t=nj;if(e&&e instanceof RegExp)if(e.global)t=e;else{let i="g";e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),t=new RegExp(e.source,i)}return t.lastIndex=0,t}var Mk=new Pn;Mk.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Nk(e,t,i,s,r){if(t=Tk(t),r||(r=ai.first(Mk)),i.length>r.maxLen){let l=e-r.maxLen/2;return l<0?l=0:s+=l,i=i.substring(l,e+r.maxLen/2),Nk(e,t,i,s,r)}const n=Date.now(),o=e-1-s;let a=-1,c=null;for(let l=1;!(Date.now()-n>=r.timeBudget);l++){const u=o-r.windowSize*l;t.lastIndex=Math.max(0,u);const h=oj(t,i,o,a);if(!h&&c||(c=h,u<=0))break;a=u}if(c){const l={word:c[0],startColumn:s+1+c.index,endColumn:s+1+c.index+c[0].length};return t.lastIndex=0,l}return null}function oj(e,t,i,s){let r;for(;r=e.exec(t);){const n=r.index||0;if(n<=i&&e.lastIndex>=i)return r;if(s>0&&n>s)return null}return null}var Rk;(function(e){e[e.None=0]="None",e[e.Keep=1]="Keep",e[e.Brackets=2]="Brackets",e[e.Advanced=3]="Advanced",e[e.Full=4]="Full"})(Rk||(Rk={}));var aj=8,cj=class{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},lt=class{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return Df(e,t)}compute(e,t,i){return i}},If=class{constructor(e,t){this.newValue=e,this.didChange=t}};function Df(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return new If(t,e!==t);if(Array.isArray(e)||Array.isArray(t)){const s=Array.isArray(e)&&Array.isArray(t)&&$i(e,t);return new If(t,!s)}let i=!1;for(const s in t)if(t.hasOwnProperty(s)){const r=Df(e[s],t[s]);r.didChange&&(e[s]=r.newValue,i=!0)}return new If(e,i)}var Vn=class{constructor(e,t){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=t}applyUpdate(e,t){return Df(e,t)}validate(e){return this.defaultValue}},mc=class{constructor(e,t,i,s){this.id=e,this.name=t,this.defaultValue=i,this.schema=s}applyUpdate(e,t){return Df(e,t)}compute(e,t,i){return i}};function te(e,t){return typeof e>"u"?t:e==="false"?!1:!!e}var pe=class extends mc{constructor(e,t,i,s=void 0){typeof s<"u"&&(s.type="boolean",s.default=i),super(e,t,i,s)}validate(e){return te(e,this.defaultValue)}};function lj(e,t,i,s){if(typeof e=="string"&&(e=parseInt(e,10)),typeof e!="number"||isNaN(e))return t;let r=e;return r=Math.max(i,r),r=Math.min(s,r),r|0}var Be=class CN extends mc{static clampedInt(t,i,s,r){return lj(t,i,s,r)}constructor(t,i,s,r,n,o=void 0){typeof o<"u"&&(o.type="integer",o.default=s,o.minimum=r,o.maximum=n),super(t,i,s,o),this.minimum=r,this.maximum=n}validate(t){return CN.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}},ks=class kN extends mc{static clamp(t,i,s){return t<i?i:t>s?s:t}static float(t,i){return typeof t=="string"&&(t=parseFloat(t)),typeof t!="number"||isNaN(t)?i:t}constructor(t,i,s,r,n,o,a){typeof n<"u"&&(n.type="number",n.default=s,n.minimum=o,n.maximum=a),super(t,i,s,n),this.validationFn=r,this.minimum=o,this.maximum=a}validate(t){return this.validationFn(kN.float(t,this.defaultValue))}},Ti=class $N extends mc{static string(t,i){return typeof t!="string"?i:t}constructor(t,i,s,r=void 0){typeof r<"u"&&(r.type="string",r.default=s),super(t,i,s,r)}validate(t){return $N.string(t,this.defaultValue)}};function nt(e,t,i,s){return typeof e!="string"?t:s&&e in s?s[e]:i.indexOf(e)===-1?t:e}var ut=class extends mc{constructor(e,t,i,s,r=void 0){typeof r<"u"&&(r.type="string",r.enum=s.slice(0),r.default=i),super(e,t,i,r),this.c=s}validate(e){return nt(e,this.defaultValue,this.c)}},bu=class extends lt{constructor(e,t,i,s,r,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=r,o.default=s),super(e,t,i,o),this.c=r,this.d=n}validate(e){return typeof e!="string"?this.defaultValue:this.c.indexOf(e)===-1?this.defaultValue:this.d(e)}};function uj(e){switch(e){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var hj=class extends lt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[d(319,null),d(320,null),d(321,null)],default:"auto",tags:["accessibility"],description:d(322,null)})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}},dj=class extends lt{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(29,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:d(323,null)},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:d(324,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:te(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:te(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}},Lk;(function(e){e[e.Hidden=0]="Hidden",e[e.Blink=1]="Blink",e[e.Smooth=2]="Smooth",e[e.Phase=3]="Phase",e[e.Expand=4]="Expand",e[e.Solid=5]="Solid"})(Lk||(Lk={}));function fj(e){switch(e){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var $s;(function(e){e[e.Line=1]="Line",e[e.Block=2]="Block",e[e.Underline=3]="Underline",e[e.LineThin=4]="LineThin",e[e.BlockOutline=5]="BlockOutline",e[e.UnderlineThin=6]="UnderlineThin"})($s||($s={}));function Ok(e){switch(e){case"line":return $s.Line;case"block":return $s.Block;case"underline":return $s.Underline;case"line-thin":return $s.LineThin;case"block-outline":return $s.BlockOutline;case"underline-thin":return $s.UnderlineThin}}var pj=class extends Vn{constructor(){super(162,"")}compute(e,t,i){const s=["monaco-editor"];return t.get(48)&&s.push(t.get(48)),e.extraEditorClassName&&s.push(e.extraEditorClassName),t.get(82)==="default"?s.push("mouse-default"):t.get(82)==="copy"&&s.push("mouse-copy"),t.get(127)&&s.push("showUnused"),t.get(157)&&s.push("showDeprecated"),s.join(" ")}},gj=class extends pe{constructor(){super(45,"emptySelectionClipboard",!0,{description:d(325,null)})}compute(e,t,i){return i&&e.emptySelectionClipboard}},mj=class extends lt{constructor(){const e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(50,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:d(326,null)},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[d(327,null),d(328,null),d(329,null)],description:d(330,null)},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[d(331,null),d(332,null),d(333,null)],description:d(334,null)},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:d(335,null),included:Nt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:d(336,null)},"editor.find.loop":{type:"boolean",default:e.loop,description:d(337,null)},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[d(338,null),d(339,null)],description:d(340,null)},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[d(341,null),d(342,null)],description:d(343,null)},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:d(344,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:te(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:te(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":nt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":nt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:te(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:te(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:te(t.loop,this.defaultValue.loop),history:nt(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:nt(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}},vj=class Gl extends lt{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(60,"fontLigatures",Gl.OFF,{anyOf:[{type:"boolean",description:d(345,null)},{type:"string",description:d(346,null)}],description:d(347,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?Gl.OFF:t==="true"?Gl.ON:t:t?Gl.ON:Gl.OFF}},wj=class Jl extends lt{static{this.OFF=$k}static{this.TRANSLATE=Ik}constructor(){super(63,"fontVariations",Jl.OFF,{anyOf:[{type:"boolean",description:d(348,null)},{type:"string",description:d(349,null)}],description:d(350,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"?Jl.OFF:t==="true"?Jl.TRANSLATE:t:t?Jl.TRANSLATE:Jl.OFF}compute(t,i,s){return t.fontInfo.fontVariationSettings}},bj=class extends Vn{constructor(){super(59,new ej({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:!1,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:!1,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},!1))}compute(e,t,i){return e.fontInfo}},yj=class extends Vn{constructor(){super(161,$s.Line)}compute(e,t,i){return e.inputMode==="overtype"?t.get(92):t.get(34)}},Aj=class extends Vn{constructor(){super(170,!1)}compute(e,t){return e.editContextSupported&&t.get(44)}},Sj=class extends Vn{constructor(){super(172,!1)}compute(e,t){return e.accessibilitySupport===2?t.get(7):t.get(6)}},Ej=class extends mc{constructor(){super(61,"fontSize",br.fontSize,{type:"number",minimum:6,maximum:100,default:br.fontSize,description:d(351,null)})}validate(e){const t=ks.float(e,this.defaultValue);return t===0?br.fontSize:ks.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}},xj=class Zl extends lt{static{this.c=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.d=1}static{this.e=1e3}constructor(){super(62,"fontWeight",br.fontWeight,{anyOf:[{type:"number",minimum:Zl.d,maximum:Zl.e,errorMessage:d(352,null)},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Zl.c}],default:br.fontWeight,description:d(353,null)})}validate(t){return t==="normal"||t==="bold"?t:String(Be.clampedInt(t,br.fontWeight,Zl.d,Zl.e))}},Cj=class extends lt{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[d(354,null),d(355,null),d(356,null)]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(67,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:d(357,null)},"editor.gotoLocation.multipleDefinitions":{description:d(358,null),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:d(359,null),...t},"editor.gotoLocation.multipleDeclarations":{description:d(360,null),...t},"editor.gotoLocation.multipleImplementations":{description:d(361,null),...t},"editor.gotoLocation.multipleReferences":{description:d(362,null),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:d(363,null)},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:d(364,null)},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:d(365,null)},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:d(366,null)},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:d(367,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:nt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:nt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:nt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:nt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:nt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:nt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:nt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Ti.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Ti.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Ti.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Ti.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Ti.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Ti.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},kj=class extends lt{constructor(){const e={enabled:"on",delay:300,hidingDelay:300,sticky:!0,above:!0};super(69,"hover",e,{"editor.hover.enabled":{type:"string",enum:["on","off","onKeyboardModifier"],default:e.enabled,markdownEnumDescriptions:[d(368,null),d(369,null),d(370,null,Nt?"Command":"Control")],description:d(371,null)},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:d(372,null)},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:d(373,null)},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:d(374,null)},"editor.hover.above":{type:"boolean",default:e.above,description:d(375,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:nt(t.enabled,this.defaultValue.enabled,["on","off","onKeyboardModifier"]),delay:Be.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:te(t.sticky,this.defaultValue.sticky),hidingDelay:Be.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:te(t.above,this.defaultValue.above)}}},Fk;(function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Blocks=2]="Blocks"})(Fk||(Fk={}));var $j=class o1 extends Vn{constructor(){super(165,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(t,i,s){return o1.computeLayout(i,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){const i=t.height/t.lineHeight,s=Math.floor(t.paddingTop/t.lineHeight);let r=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(r=Math.max(r,i-1));const n=(s+t.viewLineCount+r)/(t.pixelRatio*t.height),o=Math.floor(t.viewLineCount/n);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:s,extraLinesBeyondLastLine:r,desiredRatio:n,minimapLineCount:o}}static c(t,i){const s=t.outerWidth,r=t.outerHeight,n=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(n*r),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:r};const o=i.stableMinimapLayoutInput,a=o&&t.outerHeight===o.outerHeight&&t.lineHeight===o.lineHeight&&t.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&t.pixelRatio===o.pixelRatio&&t.scrollBeyondLastLine===o.scrollBeyondLastLine&&t.paddingTop===o.paddingTop&&t.paddingBottom===o.paddingBottom&&t.minimap.enabled===o.minimap.enabled&&t.minimap.side===o.minimap.side&&t.minimap.size===o.minimap.size&&t.minimap.showSlider===o.minimap.showSlider&&t.minimap.renderCharacters===o.minimap.renderCharacters&&t.minimap.maxColumn===o.minimap.maxColumn&&t.minimap.scale===o.minimap.scale&&t.verticalScrollbarWidth===o.verticalScrollbarWidth&&t.isViewportWrapping===o.isViewportWrapping,c=t.lineHeight,l=t.typicalHalfwidthCharacterWidth,u=t.scrollBeyondLastLine,h=t.minimap.renderCharacters;let f=n>=2?Math.round(t.minimap.scale*2):t.minimap.scale;const p=t.minimap.maxColumn,g=t.minimap.size,v=t.minimap.side,b=t.verticalScrollbarWidth,S=t.viewLineCount,E=t.remainingWidth,k=t.isViewportWrapping,O=h?2:3;let F=Math.floor(n*r);const G=F/n;let j=!1,B=!1,H=O*f,ie=f/n,Ae=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:ae,extraLinesBeforeFirstLine:ge,extraLinesBeyondLastLine:we,desiredRatio:ht,minimapLineCount:We}=o1.computeContainedMinimapLineCount({viewLineCount:S,scrollBeyondLastLine:u,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:r,lineHeight:c,pixelRatio:n});if(S/We>1)j=!0,B=!0,f=1,H=1,ie=f/n;else{let vt=!1,Gt=f+1;if(g==="fit"){const jt=Math.ceil((ge+S+we)*H);k&&a&&E<=i.stableFitRemainingWidth?(vt=!0,Gt=i.stableFitMaxMinimapScale):vt=jt>F}if(g==="fill"||vt){j=!0;const jt=f;H=Math.min(c*n,Math.max(1,Math.floor(1/ht))),k&&a&&E<=i.stableFitRemainingWidth&&(Gt=i.stableFitMaxMinimapScale),f=Math.min(Gt,Math.max(1,Math.floor(H/O))),f>jt&&(Ae=Math.min(2,f/jt)),ie=f/n/Ae,F=Math.ceil(Math.max(ae,ge+S+we)*H),k?(i.stableMinimapLayoutInput=t,i.stableFitRemainingWidth=E,i.stableFitMaxMinimapScale=f):(i.stableMinimapLayoutInput=null,i.stableFitRemainingWidth=0)}}}const re=Math.floor(p*ie),$e=Math.min(re,Math.max(0,Math.floor((E-b-2)*ie/(l+ie)))+aj);let Z=Math.floor(n*$e);const z=Z/n;Z=Math.floor(Z*Ae);const ee=h?1:2,Y=v==="left"?0:s-$e-b;return{renderMinimap:ee,minimapLeft:Y,minimapWidth:$e,minimapHeightIsEditorHeight:j,minimapIsSampling:B,minimapScale:f,minimapLineHeight:H,minimapCanvasInnerWidth:Z,minimapCanvasInnerHeight:F,minimapCanvasOuterWidth:z,minimapCanvasOuterHeight:G}}static computeLayout(t,i){const s=i.outerWidth|0,r=i.outerHeight|0,n=i.lineHeight|0,o=i.lineNumbersDigitCount|0,a=i.typicalHalfwidthCharacterWidth,c=i.maxDigitWidth,l=i.pixelRatio,u=i.viewLineCount,h=t.get(154),f=h==="inherit"?t.get(153):h,p=f==="inherit"?t.get(149):f,g=t.get(152),v=i.isDominatedByLongLines,b=t.get(66),S=t.get(76).renderType!==0,E=t.get(77),k=t.get(119),O=t.get(96),F=t.get(81),G=t.get(117),j=G.verticalScrollbarSize,B=G.verticalHasArrows,H=G.arrowSize,ie=G.horizontalScrollbarSize,Ae=t.get(52),re=t.get(126)!=="never";let $e=t.get(74);Ae&&re&&($e+=16);let Z=0;if(S){const $n=Math.max(o,E);Z=Math.round($n*c)}let z=0;b&&(z=n*i.glyphMarginDecorationLaneCount);let ee=0,Y=ee+z,ae=Y+Z,ge=ae+$e;const we=s-z-Z-$e;let ht=!1,We=!1,Le=-1;t.get(2)===2&&f==="inherit"&&v?(ht=!0,We=!0):p==="on"||p==="bounded"?We=!0:p==="wordWrapColumn"&&(Le=g);const vt=o1.c({outerWidth:s,outerHeight:r,lineHeight:n,typicalHalfwidthCharacterWidth:a,pixelRatio:l,scrollBeyondLastLine:k,paddingTop:O.top,paddingBottom:O.bottom,minimap:F,verticalScrollbarWidth:j,viewLineCount:u,remainingWidth:we,isViewportWrapping:We},i.memory||new cj);vt.renderMinimap!==0&&vt.minimapLeft===0&&(ee+=vt.minimapWidth,Y+=vt.minimapWidth,ae+=vt.minimapWidth,ge+=vt.minimapWidth);const Gt=we-vt.minimapWidth,jt=Math.max(1,Math.floor((Gt-j-2)/a)),yi=B?H:0;return We&&(Le=Math.max(1,jt),p==="bounded"&&(Le=Math.min(Le,g))),{width:s,height:r,glyphMarginLeft:ee,glyphMarginWidth:z,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:Y,lineNumbersWidth:Z,decorationsLeft:ae,decorationsWidth:$e,contentLeft:ge,contentWidth:Gt,minimap:vt,viewportColumn:jt,isWordWrapMinified:ht,isViewportWrapping:We,wrappingColumn:Le,verticalScrollbarWidth:j,horizontalScrollbarHeight:ie,overviewRuler:{top:yi,width:j,height:r-2*yi,right:0}}}},Ij=class extends lt{constructor(){super(156,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[d(376,null),d(377,null)],type:"string",enum:["simple","advanced"],default:"simple",description:d(378,null)}})}validate(e){return nt(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}},Kr;(function(e){e.Off="off",e.OnCode="onCode",e.On="on"})(Kr||(Kr={}));var Dj=class extends lt{constructor(){const e={enabled:Kr.OnCode};super(73,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[Kr.Off,Kr.OnCode,Kr.On],default:e.enabled,enumDescriptions:[d(379,null),d(380,null),d(381,null)],description:d(382,null)}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:nt(e.enabled,this.defaultValue.enabled,[Kr.Off,Kr.OnCode,Kr.On])}}},Pj=class extends lt{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(131,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:d(383,null)},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:d(384,null)},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:d(385,null)},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:d(386,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),maxLineCount:Be.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:nt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:te(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},Tj=class extends lt{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(159,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:d(387,null),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[d(388,null),d(389,null,Nt?"Ctrl+Option":"Ctrl+Alt"),d(390,null,Nt?"Ctrl+Option":"Ctrl+Alt"),d(391,null)]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:d(392,null,"`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:d(393,null,"`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:d(394,null)},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:d(395,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:nt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Be.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Ti.string(t.fontFamily,this.defaultValue.fontFamily),padding:te(t.padding,this.defaultValue.padding),maximumLength:Be.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},Mj=class extends lt{constructor(){super(74,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Be.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Be.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},Nj=class extends ks{constructor(){super(75,"lineHeight",br.lineHeight,e=>ks.clamp(e,0,150),{markdownDescription:d(396,null)},0,150)}compute(e,t,i){return e.fontInfo.lineHeight}},Rj=class extends lt{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(81,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:d(397,null)},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[d(398,null),d(399,null),d(400,null)],default:e.autohide,description:d(401,null)},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[d(402,null),d(403,null),d(404,null)],default:e.size,description:d(405,null)},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:d(406,null)},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:d(407,null)},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:d(408,null)},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:d(409,null)},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:d(410,null)},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:d(411,null)},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:d(412,null)},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:d(413,null)},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:d(414,null)},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:d(415,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const s=t.markSectionHeaderRegex;if(typeof s=="string")try{new RegExp(s,"d"),i=s}catch{}return{enabled:te(t.enabled,this.defaultValue.enabled),autohide:nt(t.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:nt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:nt(t.side,this.defaultValue.side,["right","left"]),showSlider:nt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:te(t.renderCharacters,this.defaultValue.renderCharacters),scale:Be.clampedInt(t.scale,1,1,3),maxColumn:Be.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:te(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:te(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:ks.clamp(ks.float(t.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:ks.clamp(ks.float(t.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}};function Lj(e){return e==="ctrlCmd"?Nt?"metaKey":"ctrlKey":"altKey"}var Oj=class extends lt{constructor(){super(96,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:d(416,null)},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:d(417,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Be.clampedInt(t.top,0,0,1e3),bottom:Be.clampedInt(t.bottom,0,0,1e3)}}},Fj=class extends lt{constructor(){const e={enabled:!0,cycle:!0};super(98,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:d(418,null)},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:d(419,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),cycle:te(t.cycle,this.defaultValue.cycle)}}},jj=class extends Vn{constructor(){super(163,1)}compute(e,t,i){return e.pixelRatio}},Uj=class extends lt{constructor(){super(100,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},zj=class extends lt{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[d(420,null),d(421,null),d(422,null)]}];super(102,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:d(423,null)},comments:{anyOf:t,default:e.comments,description:d(424,null)},other:{anyOf:t,default:e.other,description:d(425,null)}},default:e,markdownDescription:d(426,null,"`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:s}=e,r=["on","inline","off"];let n,o,a;return typeof t=="boolean"?n=t?"on":"off":n=nt(t,this.defaultValue.other,r),typeof i=="boolean"?o=i?"on":"off":o=nt(i,this.defaultValue.comments,r),typeof s=="boolean"?a=s?"on":"off":a=nt(s,this.defaultValue.strings,r),{other:n,comments:o,strings:a}}},jk;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval",e[e.Custom=4]="Custom"})(jk||(jk={}));var Hj=class extends lt{constructor(){super(76,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[d(427,null),d(428,null),d(429,null),d(430,null)],default:"on",description:d(431,null)})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}},Wj=class extends lt{constructor(){const e=[],t={type:"number",description:d(432,null)};super(116,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:d(433,null),format:"color-hex"}}}]},default:e,description:d(434,null)})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Be.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const s=i;t.push({column:Be.clampedInt(s.column,0,0,1e4),color:s.color})}return t.sort((i,s)=>i.column-s.column),t}return this.defaultValue}},_j=class extends lt{constructor(){super(105,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function Uk(e,t){if(typeof e!="string")return t;switch(e){case"hidden":return 2;case"visible":return 3;default:return 1}}var Bj=class extends lt{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(117,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[d(435,null),d(436,null),d(437,null)],default:"auto",description:d(438,null)},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[d(439,null),d(440,null),d(441,null)],default:"auto",description:d(442,null)},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:d(443,null)},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:d(444,null)},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:d(445,null)},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:d(446,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Be.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),s=Be.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Be.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:Uk(t.vertical,this.defaultValue.vertical),horizontal:Uk(t.horizontal,this.defaultValue.horizontal),useShadows:te(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:te(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:te(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:te(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:te(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Be.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:s,verticalSliderSize:Be.clampedInt(t.verticalSliderSize,s,0,1e3),scrollByPage:te(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:te(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},Bs="inUntrustedWorkspace",Zo={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},qj=class extends lt{constructor(){const e={nonBasicASCII:Bs,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:Bs,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(142,"unicodeHighlight",e,{[Zo.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bs],default:e.nonBasicASCII,description:d(447,null)},[Zo.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:d(448,null)},[Zo.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:d(449,null)},[Zo.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bs],default:e.includeComments,description:d(450,null)},[Zo.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,Bs],default:e.includeStrings,description:d(451,null)},[Zo.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:d(452,null),additionalProperties:{type:"boolean"}},[Zo.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:d(453,null)}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(Ai(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(Ai(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const s=super.applyUpdate(e,t);return i?new If(s.newValue,!0):s}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:vc(t.nonBasicASCII,Bs,[!0,!1,Bs]),invisibleCharacters:te(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:te(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:vc(t.includeComments,Bs,[!0,!1,Bs]),includeStrings:vc(t.includeStrings,Bs,[!0,!1,Bs]),allowedCharacters:this.c(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.c(t.allowedLocales,this.defaultValue.allowedLocales)}}c(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[s,r]of Object.entries(e))r===!0&&(i[s]=!0);return i}},Vj=class extends lt{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,minShowDelay:0,suppressInSnippetMode:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always",showLongDistanceHint:!0},triggerCommandOnProviderChange:!1,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:!0}};super(71,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:d(454,null)},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[d(455,null),d(456,null),d(457,null)],description:d(458,null)},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:d(459,null)},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:d(460,null)},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:d(461,null)},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:d(462,null)},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:d(463,null),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:d(464,null),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:d(465,null),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:d(466,null),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:d(467,null)},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:d(468,null),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showLongDistanceHint":{type:"boolean",default:e.edits.showLongDistanceHint,description:d(469,null),tags:["nextEditSuggestions","experimental"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:d(470,null),enum:["auto","never"],enumDescriptions:[d(471,null),d(472,null)],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:d(473,null),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),mode:nt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:nt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:te(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:te(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Ti.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:te(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:Be.clampedInt(t.minShowDelay,0,0,1e4),suppressInSnippetMode:te(t.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this.c(t.edits),triggerCommandOnProviderChange:te(t.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this.d(t.experimental)}}c(e){if(!e||typeof e!="object")return this.defaultValue.edits;const t=e;return{enabled:te(t.enabled,this.defaultValue.edits.enabled),showCollapsed:te(t.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:nt(t.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),showLongDistanceHint:te(t.showLongDistanceHint,this.defaultValue.edits.showLongDistanceHint),renderSideBySide:nt(t.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}d(e){if(!e||typeof e!="object")return this.defaultValue.experimental;const t=e;return{suppressInlineSuggestions:Ti.string(t.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:nt(t.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:te(t.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}},Gj=class extends lt{constructor(){const e={enabled:Dk.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Dk.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(21,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(474,null,"`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:d(475,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:te(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},Jj=class extends lt{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(22,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[d(476,null),d(477,null),d(478,null)],default:e.bracketPairs,description:d(479,null)},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[d(480,null),d(481,null),d(482,null)],default:e.bracketPairsHorizontal,description:d(483,null)},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:d(484,null)},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:d(485,null)},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[d(486,null),d(487,null),d(488,null)],default:e.highlightActiveIndentation,description:d(489,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:vc(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:vc(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:te(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:te(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:vc(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function vc(e,t,i){const s=i.indexOf(e);return s===-1?t:i[s]}var Zj=class extends lt{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(134,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[d(490,null),d(491,null)],default:e.insertMode,description:d(492,null)},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:d(493,null)},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:d(494,null)},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:d(495,null)},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[d(496,null),d(497,null),d(498,null),d(499,null)],default:e.selectionMode,markdownDescription:d(500,null,"`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:d(501,null)},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:d(502,null)},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:d(503,null)},"editor.suggest.preview":{type:"boolean",default:e.preview,description:d(504,null)},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:d(505,null)},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:d(506,null)},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:d(507,null)},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:d(508,null)},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:d(509,null)},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:d(510,null)},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:d(511,null)},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:d(512,null)},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:d(513,null)},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:d(514,null)},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:d(515,null)},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:d(516,null)},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:d(517,null)},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:d(518,null)},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:d(519,null)},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:d(520,null)},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:d(521,null)},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:d(522,null)},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:d(523,null)},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:d(524,null)},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:d(525,null)},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:d(526,null)},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:d(527,null)},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:d(528,null)},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:d(529,null)},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:d(530,null)},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:d(531,null)},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:d(532,null)},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:d(533,null)},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:d(534,null)},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:d(535,null)},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:d(536,null)},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:d(537,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:nt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:te(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:te(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:te(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:te(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:nt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:te(t.showIcons,this.defaultValue.showIcons),showStatusBar:te(t.showStatusBar,this.defaultValue.showStatusBar),preview:te(t.preview,this.defaultValue.preview),previewMode:nt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:te(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:te(t.showMethods,this.defaultValue.showMethods),showFunctions:te(t.showFunctions,this.defaultValue.showFunctions),showConstructors:te(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:te(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:te(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:te(t.showFields,this.defaultValue.showFields),showVariables:te(t.showVariables,this.defaultValue.showVariables),showClasses:te(t.showClasses,this.defaultValue.showClasses),showStructs:te(t.showStructs,this.defaultValue.showStructs),showInterfaces:te(t.showInterfaces,this.defaultValue.showInterfaces),showModules:te(t.showModules,this.defaultValue.showModules),showProperties:te(t.showProperties,this.defaultValue.showProperties),showEvents:te(t.showEvents,this.defaultValue.showEvents),showOperators:te(t.showOperators,this.defaultValue.showOperators),showUnits:te(t.showUnits,this.defaultValue.showUnits),showValues:te(t.showValues,this.defaultValue.showValues),showConstants:te(t.showConstants,this.defaultValue.showConstants),showEnums:te(t.showEnums,this.defaultValue.showEnums),showEnumMembers:te(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:te(t.showKeywords,this.defaultValue.showKeywords),showWords:te(t.showWords,this.defaultValue.showWords),showColors:te(t.showColors,this.defaultValue.showColors),showFiles:te(t.showFiles,this.defaultValue.showFiles),showReferences:te(t.showReferences,this.defaultValue.showReferences),showFolders:te(t.showFolders,this.defaultValue.showFolders),showTypeParameters:te(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:te(t.showSnippets,this.defaultValue.showSnippets),showUsers:te(t.showUsers,this.defaultValue.showUsers),showIssues:te(t.showIssues,this.defaultValue.showIssues)}}},Yj=class extends lt{constructor(){super(129,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:d(538,null),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:d(539,null),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:te(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:te(e.selectSubwords,this.defaultValue.selectSubwords)}}},Qj=class extends lt{constructor(){const e=[];super(147,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:d(540,null),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}},zk;(function(e){e[e.None=0]="None",e[e.Same=1]="Same",e[e.Indent=2]="Indent",e[e.DeepIndent=3]="DeepIndent"})(zk||(zk={}));var Xj=class extends lt{constructor(){super(155,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[d(541,null),d(542,null),d(543,null),d(544,null)],description:d(545,null),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}},Kj=class extends Vn{constructor(){super(166,{isDominatedByLongLines:!1,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1})}compute(e,t,i){const s=t.get(165);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}},eU=class extends lt{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(43,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(546,null)},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:d(547,null),enum:["afterDrop","never"],enumDescriptions:[d(548,null),d(549,null)],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),showDropSelector:nt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},tU=class extends lt{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(97,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(550,null)},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:d(551,null),enum:["afterPaste","never"],enumDescriptions:[d(552,null),d(553,null)],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:te(t.enabled,this.defaultValue.enabled),showPasteSelector:nt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},iU=[];function M(e){return iU[e.id]=e,e}var Hk;(function(e){e[e.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",e[e.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",e[e.accessibilitySupport=2]="accessibilitySupport",e[e.accessibilityPageSize=3]="accessibilityPageSize",e[e.allowOverflow=4]="allowOverflow",e[e.allowVariableLineHeights=5]="allowVariableLineHeights",e[e.allowVariableFonts=6]="allowVariableFonts",e[e.allowVariableFontsInAccessibilityMode=7]="allowVariableFontsInAccessibilityMode",e[e.ariaLabel=8]="ariaLabel",e[e.ariaRequired=9]="ariaRequired",e[e.autoClosingBrackets=10]="autoClosingBrackets",e[e.autoClosingComments=11]="autoClosingComments",e[e.screenReaderAnnounceInlineSuggestion=12]="screenReaderAnnounceInlineSuggestion",e[e.autoClosingDelete=13]="autoClosingDelete",e[e.autoClosingOvertype=14]="autoClosingOvertype",e[e.autoClosingQuotes=15]="autoClosingQuotes",e[e.autoIndent=16]="autoIndent",e[e.autoIndentOnPaste=17]="autoIndentOnPaste",e[e.autoIndentOnPasteWithinString=18]="autoIndentOnPasteWithinString",e[e.automaticLayout=19]="automaticLayout",e[e.autoSurround=20]="autoSurround",e[e.bracketPairColorization=21]="bracketPairColorization",e[e.guides=22]="guides",e[e.codeLens=23]="codeLens",e[e.codeLensFontFamily=24]="codeLensFontFamily",e[e.codeLensFontSize=25]="codeLensFontSize",e[e.colorDecorators=26]="colorDecorators",e[e.colorDecoratorsLimit=27]="colorDecoratorsLimit",e[e.columnSelection=28]="columnSelection",e[e.comments=29]="comments",e[e.contextmenu=30]="contextmenu",e[e.copyWithSyntaxHighlighting=31]="copyWithSyntaxHighlighting",e[e.cursorBlinking=32]="cursorBlinking",e[e.cursorSmoothCaretAnimation=33]="cursorSmoothCaretAnimation",e[e.cursorStyle=34]="cursorStyle",e[e.cursorSurroundingLines=35]="cursorSurroundingLines",e[e.cursorSurroundingLinesStyle=36]="cursorSurroundingLinesStyle",e[e.cursorWidth=37]="cursorWidth",e[e.cursorHeight=38]="cursorHeight",e[e.disableLayerHinting=39]="disableLayerHinting",e[e.disableMonospaceOptimizations=40]="disableMonospaceOptimizations",e[e.domReadOnly=41]="domReadOnly",e[e.dragAndDrop=42]="dragAndDrop",e[e.dropIntoEditor=43]="dropIntoEditor",e[e.editContext=44]="editContext",e[e.emptySelectionClipboard=45]="emptySelectionClipboard",e[e.experimentalGpuAcceleration=46]="experimentalGpuAcceleration",e[e.experimentalWhitespaceRendering=47]="experimentalWhitespaceRendering",e[e.extraEditorClassName=48]="extraEditorClassName",e[e.fastScrollSensitivity=49]="fastScrollSensitivity",e[e.find=50]="find",e[e.fixedOverflowWidgets=51]="fixedOverflowWidgets",e[e.folding=52]="folding",e[e.foldingStrategy=53]="foldingStrategy",e[e.foldingHighlight=54]="foldingHighlight",e[e.foldingImportsByDefault=55]="foldingImportsByDefault",e[e.foldingMaximumRegions=56]="foldingMaximumRegions",e[e.unfoldOnClickAfterEndOfLine=57]="unfoldOnClickAfterEndOfLine",e[e.fontFamily=58]="fontFamily",e[e.fontInfo=59]="fontInfo",e[e.fontLigatures=60]="fontLigatures",e[e.fontSize=61]="fontSize",e[e.fontWeight=62]="fontWeight",e[e.fontVariations=63]="fontVariations",e[e.formatOnPaste=64]="formatOnPaste",e[e.formatOnType=65]="formatOnType",e[e.glyphMargin=66]="glyphMargin",e[e.gotoLocation=67]="gotoLocation",e[e.hideCursorInOverviewRuler=68]="hideCursorInOverviewRuler",e[e.hover=69]="hover",e[e.inDiffEditor=70]="inDiffEditor",e[e.inlineSuggest=71]="inlineSuggest",e[e.letterSpacing=72]="letterSpacing",e[e.lightbulb=73]="lightbulb",e[e.lineDecorationsWidth=74]="lineDecorationsWidth",e[e.lineHeight=75]="lineHeight",e[e.lineNumbers=76]="lineNumbers",e[e.lineNumbersMinChars=77]="lineNumbersMinChars",e[e.linkedEditing=78]="linkedEditing",e[e.links=79]="links",e[e.matchBrackets=80]="matchBrackets",e[e.minimap=81]="minimap",e[e.mouseStyle=82]="mouseStyle",e[e.mouseWheelScrollSensitivity=83]="mouseWheelScrollSensitivity",e[e.mouseWheelZoom=84]="mouseWheelZoom",e[e.multiCursorMergeOverlapping=85]="multiCursorMergeOverlapping",e[e.multiCursorModifier=86]="multiCursorModifier",e[e.mouseMiddleClickAction=87]="mouseMiddleClickAction",e[e.multiCursorPaste=88]="multiCursorPaste",e[e.multiCursorLimit=89]="multiCursorLimit",e[e.occurrencesHighlight=90]="occurrencesHighlight",e[e.occurrencesHighlightDelay=91]="occurrencesHighlightDelay",e[e.overtypeCursorStyle=92]="overtypeCursorStyle",e[e.overtypeOnPaste=93]="overtypeOnPaste",e[e.overviewRulerBorder=94]="overviewRulerBorder",e[e.overviewRulerLanes=95]="overviewRulerLanes",e[e.padding=96]="padding",e[e.pasteAs=97]="pasteAs",e[e.parameterHints=98]="parameterHints",e[e.peekWidgetDefaultFocus=99]="peekWidgetDefaultFocus",e[e.placeholder=100]="placeholder",e[e.definitionLinkOpensInPeek=101]="definitionLinkOpensInPeek",e[e.quickSuggestions=102]="quickSuggestions",e[e.quickSuggestionsDelay=103]="quickSuggestionsDelay",e[e.readOnly=104]="readOnly",e[e.readOnlyMessage=105]="readOnlyMessage",e[e.renameOnType=106]="renameOnType",e[e.renderRichScreenReaderContent=107]="renderRichScreenReaderContent",e[e.renderControlCharacters=108]="renderControlCharacters",e[e.renderFinalNewline=109]="renderFinalNewline",e[e.renderLineHighlight=110]="renderLineHighlight",e[e.renderLineHighlightOnlyWhenFocus=111]="renderLineHighlightOnlyWhenFocus",e[e.renderValidationDecorations=112]="renderValidationDecorations",e[e.renderWhitespace=113]="renderWhitespace",e[e.revealHorizontalRightPadding=114]="revealHorizontalRightPadding",e[e.roundedSelection=115]="roundedSelection",e[e.rulers=116]="rulers",e[e.scrollbar=117]="scrollbar",e[e.scrollBeyondLastColumn=118]="scrollBeyondLastColumn",e[e.scrollBeyondLastLine=119]="scrollBeyondLastLine",e[e.scrollPredominantAxis=120]="scrollPredominantAxis",e[e.selectionClipboard=121]="selectionClipboard",e[e.selectionHighlight=122]="selectionHighlight",e[e.selectionHighlightMaxLength=123]="selectionHighlightMaxLength",e[e.selectionHighlightMultiline=124]="selectionHighlightMultiline",e[e.selectOnLineNumbers=125]="selectOnLineNumbers",e[e.showFoldingControls=126]="showFoldingControls",e[e.showUnused=127]="showUnused",e[e.snippetSuggestions=128]="snippetSuggestions",e[e.smartSelect=129]="smartSelect",e[e.smoothScrolling=130]="smoothScrolling",e[e.stickyScroll=131]="stickyScroll",e[e.stickyTabStops=132]="stickyTabStops",e[e.stopRenderingLineAfter=133]="stopRenderingLineAfter",e[e.suggest=134]="suggest",e[e.suggestFontSize=135]="suggestFontSize",e[e.suggestLineHeight=136]="suggestLineHeight",e[e.suggestOnTriggerCharacters=137]="suggestOnTriggerCharacters",e[e.suggestSelection=138]="suggestSelection",e[e.tabCompletion=139]="tabCompletion",e[e.tabIndex=140]="tabIndex",e[e.trimWhitespaceOnDelete=141]="trimWhitespaceOnDelete",e[e.unicodeHighlighting=142]="unicodeHighlighting",e[e.unusualLineTerminators=143]="unusualLineTerminators",e[e.useShadowDOM=144]="useShadowDOM",e[e.useTabStops=145]="useTabStops",e[e.wordBreak=146]="wordBreak",e[e.wordSegmenterLocales=147]="wordSegmenterLocales",e[e.wordSeparators=148]="wordSeparators",e[e.wordWrap=149]="wordWrap",e[e.wordWrapBreakAfterCharacters=150]="wordWrapBreakAfterCharacters",e[e.wordWrapBreakBeforeCharacters=151]="wordWrapBreakBeforeCharacters",e[e.wordWrapColumn=152]="wordWrapColumn",e[e.wordWrapOverride1=153]="wordWrapOverride1",e[e.wordWrapOverride2=154]="wordWrapOverride2",e[e.wrappingIndent=155]="wrappingIndent",e[e.wrappingStrategy=156]="wrappingStrategy",e[e.showDeprecated=157]="showDeprecated",e[e.inertialScroll=158]="inertialScroll",e[e.inlayHints=159]="inlayHints",e[e.wrapOnEscapedLineFeeds=160]="wrapOnEscapedLineFeeds",e[e.effectiveCursorStyle=161]="effectiveCursorStyle",e[e.editorClassName=162]="editorClassName",e[e.pixelRatio=163]="pixelRatio",e[e.tabFocusMode=164]="tabFocusMode",e[e.layoutInfo=165]="layoutInfo",e[e.wrappingInfo=166]="wrappingInfo",e[e.defaultColorDecorators=167]="defaultColorDecorators",e[e.colorDecoratorsActivatedOn=168]="colorDecoratorsActivatedOn",e[e.inlineCompletionsAccessibilityVerbose=169]="inlineCompletionsAccessibilityVerbose",e[e.effectiveEditContext=170]="effectiveEditContext",e[e.scrollOnMiddleClick=171]="scrollOnMiddleClick",e[e.effectiveAllowVariableFonts=172]="effectiveAllowVariableFonts"})(Hk||(Hk={}));var pie={acceptSuggestionOnCommitCharacter:M(new pe(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:d(554,null)})),acceptSuggestionOnEnter:M(new ut(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",d(555,null),""],markdownDescription:d(556,null)})),accessibilitySupport:M(new hj),accessibilityPageSize:M(new Be(3,"accessibilityPageSize",500,1,1073741824,{description:d(557,null),tags:["accessibility"]})),allowOverflow:M(new pe(4,"allowOverflow",!0)),allowVariableLineHeights:M(new pe(5,"allowVariableLineHeights",!0,{description:d(558,null)})),allowVariableFonts:M(new pe(6,"allowVariableFonts",!0,{description:d(559,null)})),allowVariableFontsInAccessibilityMode:M(new pe(7,"allowVariableFontsInAccessibilityMode",!1,{description:d(560,null),tags:["accessibility"]})),ariaLabel:M(new Ti(8,"ariaLabel",d(561,null))),ariaRequired:M(new pe(9,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:M(new pe(12,"screenReaderAnnounceInlineSuggestion",!0,{description:d(562,null),tags:["accessibility"]})),autoClosingBrackets:M(new ut(10,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(563,null),d(564,null),""],description:d(565,null)})),autoClosingComments:M(new ut(11,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(566,null),d(567,null),""],description:d(568,null)})),autoClosingDelete:M(new ut(13,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",d(569,null),""],description:d(570,null)})),autoClosingOvertype:M(new ut(14,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",d(571,null),""],description:d(572,null)})),autoClosingQuotes:M(new ut(15,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(573,null),d(574,null),""],description:d(575,null)})),autoIndent:M(new bu(16,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],uj,{enumDescriptions:[d(576,null),d(577,null),d(578,null),d(579,null),d(580,null)],description:d(581,null)})),autoIndentOnPaste:M(new pe(17,"autoIndentOnPaste",!1,{description:d(582,null)})),autoIndentOnPasteWithinString:M(new pe(18,"autoIndentOnPasteWithinString",!0,{description:d(583,null)})),automaticLayout:M(new pe(19,"automaticLayout",!1)),autoSurround:M(new ut(20,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[d(584,null),d(585,null),d(586,null),""],description:d(587,null)})),bracketPairColorization:M(new Gj),bracketPairGuides:M(new Jj),stickyTabStops:M(new pe(132,"stickyTabStops",!1,{description:d(588,null)})),codeLens:M(new pe(23,"codeLens",!0,{description:d(589,null)})),codeLensFontFamily:M(new Ti(24,"codeLensFontFamily","",{description:d(590,null)})),codeLensFontSize:M(new Be(25,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:d(591,null)})),colorDecorators:M(new pe(26,"colorDecorators",!0,{description:d(592,null)})),colorDecoratorActivatedOn:M(new ut(168,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[d(593,null),d(594,null),d(595,null)],description:d(596,null)})),colorDecoratorsLimit:M(new Be(27,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:d(597,null)})),columnSelection:M(new pe(28,"columnSelection",!1,{description:d(598,null)})),comments:M(new dj),contextmenu:M(new pe(30,"contextmenu",!0)),copyWithSyntaxHighlighting:M(new pe(31,"copyWithSyntaxHighlighting",!0,{description:d(599,null)})),cursorBlinking:M(new bu(32,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],fj,{description:d(600,null)})),cursorSmoothCaretAnimation:M(new ut(33,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[d(601,null),d(602,null),d(603,null)],description:d(604,null)})),cursorStyle:M(new bu(34,"cursorStyle",$s.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],Ok,{description:d(605,null)})),overtypeCursorStyle:M(new bu(92,"overtypeCursorStyle",$s.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],Ok,{description:d(606,null)})),cursorSurroundingLines:M(new Be(35,"cursorSurroundingLines",0,0,1073741824,{description:d(607,null)})),cursorSurroundingLinesStyle:M(new ut(36,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[d(608,null),d(609,null)],markdownDescription:d(610,null)})),cursorWidth:M(new Be(37,"cursorWidth",0,0,1073741824,{markdownDescription:d(611,null)})),cursorHeight:M(new Be(38,"cursorHeight",0,0,1073741824,{markdownDescription:d(612,null)})),disableLayerHinting:M(new pe(39,"disableLayerHinting",!1)),disableMonospaceOptimizations:M(new pe(40,"disableMonospaceOptimizations",!1)),domReadOnly:M(new pe(41,"domReadOnly",!1)),dragAndDrop:M(new pe(42,"dragAndDrop",!0,{description:d(613,null)})),emptySelectionClipboard:M(new gj),dropIntoEditor:M(new eU),editContext:M(new pe(44,"editContext",!0,{description:d(614,null),included:W1||Gx||zx})),renderRichScreenReaderContent:M(new pe(107,"renderRichScreenReaderContent",!1,{markdownDescription:d(615,null)})),stickyScroll:M(new Pj),experimentalGpuAcceleration:M(new ut(46,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[d(616,null),d(617,null)],description:d(618,null)})),experimentalWhitespaceRendering:M(new ut(47,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[d(619,null),d(620,null),d(621,null)],description:d(622,null)})),extraEditorClassName:M(new Ti(48,"extraEditorClassName","")),fastScrollSensitivity:M(new ks(49,"fastScrollSensitivity",5,e=>e<=0?5:e,{markdownDescription:d(623,null)})),find:M(new mj),fixedOverflowWidgets:M(new pe(51,"fixedOverflowWidgets",!1)),folding:M(new pe(52,"folding",!0,{description:d(624,null)})),foldingStrategy:M(new ut(53,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[d(625,null),d(626,null)],description:d(627,null)})),foldingHighlight:M(new pe(54,"foldingHighlight",!0,{description:d(628,null)})),foldingImportsByDefault:M(new pe(55,"foldingImportsByDefault",!1,{description:d(629,null)})),foldingMaximumRegions:M(new Be(56,"foldingMaximumRegions",5e3,10,65e3,{description:d(630,null)})),unfoldOnClickAfterEndOfLine:M(new pe(57,"unfoldOnClickAfterEndOfLine",!1,{description:d(631,null)})),fontFamily:M(new Ti(58,"fontFamily",br.fontFamily,{description:d(632,null)})),fontInfo:M(new bj),fontLigatures2:M(new vj),fontSize:M(new Ej),fontWeight:M(new xj),fontVariations:M(new wj),formatOnPaste:M(new pe(64,"formatOnPaste",!1,{description:d(633,null)})),formatOnType:M(new pe(65,"formatOnType",!1,{description:d(634,null)})),glyphMargin:M(new pe(66,"glyphMargin",!0,{description:d(635,null)})),gotoLocation:M(new Cj),hideCursorInOverviewRuler:M(new pe(68,"hideCursorInOverviewRuler",!1,{description:d(636,null)})),hover:M(new kj),inDiffEditor:M(new pe(70,"inDiffEditor",!1)),inertialScroll:M(new pe(158,"inertialScroll",!1,{description:d(637,null)})),letterSpacing:M(new ks(72,"letterSpacing",br.letterSpacing,e=>ks.clamp(e,-5,20),{description:d(638,null)})),lightbulb:M(new Dj),lineDecorationsWidth:M(new Mj),lineHeight:M(new Nj),lineNumbers:M(new Hj),lineNumbersMinChars:M(new Be(77,"lineNumbersMinChars",5,1,300)),linkedEditing:M(new pe(78,"linkedEditing",!1,{description:d(639,null)})),links:M(new pe(79,"links",!0,{description:d(640,null)})),matchBrackets:M(new ut(80,"matchBrackets","always",["always","near","never"],{description:d(641,null)})),minimap:M(new Rj),mouseStyle:M(new ut(82,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:M(new ks(83,"mouseWheelScrollSensitivity",1,e=>e===0?1:e,{markdownDescription:d(642,null)})),mouseWheelZoom:M(new pe(84,"mouseWheelZoom",!1,{markdownDescription:d(Nt?643:644,null)})),multiCursorMergeOverlapping:M(new pe(85,"multiCursorMergeOverlapping",!0,{description:d(645,null)})),multiCursorModifier:M(new bu(86,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],Lj,{markdownEnumDescriptions:[d(646,null),d(647,null)],markdownDescription:d(648,null)})),mouseMiddleClickAction:M(new ut(87,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:d(649,null)})),multiCursorPaste:M(new ut(88,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[d(650,null),d(651,null)],markdownDescription:d(652,null)})),multiCursorLimit:M(new Be(89,"multiCursorLimit",1e4,1,1e5,{markdownDescription:d(653,null)})),occurrencesHighlight:M(new ut(90,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[d(654,null),d(655,null),d(656,null)],markdownDescription:d(657,null)})),occurrencesHighlightDelay:M(new Be(91,"occurrencesHighlightDelay",0,0,2e3,{description:d(658,null),tags:["preview"]})),overtypeOnPaste:M(new pe(93,"overtypeOnPaste",!0,{description:d(659,null)})),overviewRulerBorder:M(new pe(94,"overviewRulerBorder",!0,{description:d(660,null)})),overviewRulerLanes:M(new Be(95,"overviewRulerLanes",3,0,3)),padding:M(new Oj),pasteAs:M(new tU),parameterHints:M(new Fj),peekWidgetDefaultFocus:M(new ut(99,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[d(661,null),d(662,null)],description:d(663,null)})),placeholder:M(new Uj),definitionLinkOpensInPeek:M(new pe(101,"definitionLinkOpensInPeek",!1,{description:d(664,null)})),quickSuggestions:M(new zj),quickSuggestionsDelay:M(new Be(103,"quickSuggestionsDelay",10,0,1073741824,{description:d(665,null),experiment:{mode:"auto"}})),readOnly:M(new pe(104,"readOnly",!1)),readOnlyMessage:M(new _j),renameOnType:M(new pe(106,"renameOnType",!1,{description:d(666,null),markdownDeprecationMessage:d(667,null)})),renderControlCharacters:M(new pe(108,"renderControlCharacters",!0,{description:d(668,null),restricted:!0})),renderFinalNewline:M(new ut(109,"renderFinalNewline",Mt?"dimmed":"on",["off","on","dimmed"],{description:d(669,null)})),renderLineHighlight:M(new ut(110,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",d(670,null)],description:d(671,null)})),renderLineHighlightOnlyWhenFocus:M(new pe(111,"renderLineHighlightOnlyWhenFocus",!1,{description:d(672,null)})),renderValidationDecorations:M(new ut(112,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:M(new ut(113,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",d(673,null),d(674,null),d(675,null),""],description:d(676,null)})),revealHorizontalRightPadding:M(new Be(114,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:M(new pe(115,"roundedSelection",!0,{description:d(677,null)})),rulers:M(new Wj),scrollbar:M(new Bj),scrollBeyondLastColumn:M(new Be(118,"scrollBeyondLastColumn",4,0,1073741824,{description:d(678,null)})),scrollBeyondLastLine:M(new pe(119,"scrollBeyondLastLine",!0,{description:d(679,null)})),scrollOnMiddleClick:M(new pe(171,"scrollOnMiddleClick",!1,{description:d(680,null)})),scrollPredominantAxis:M(new pe(120,"scrollPredominantAxis",!0,{description:d(681,null)})),selectionClipboard:M(new pe(121,"selectionClipboard",!0,{description:d(682,null),included:Mt})),selectionHighlight:M(new pe(122,"selectionHighlight",!0,{description:d(683,null)})),selectionHighlightMaxLength:M(new Be(123,"selectionHighlightMaxLength",200,0,1073741824,{description:d(684,null)})),selectionHighlightMultiline:M(new pe(124,"selectionHighlightMultiline",!1,{description:d(685,null)})),selectOnLineNumbers:M(new pe(125,"selectOnLineNumbers",!0)),showFoldingControls:M(new ut(126,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[d(686,null),d(687,null),d(688,null)],description:d(689,null)})),showUnused:M(new pe(127,"showUnused",!0,{description:d(690,null)})),showDeprecated:M(new pe(157,"showDeprecated",!0,{description:d(691,null)})),inlayHints:M(new Tj),snippetSuggestions:M(new ut(128,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[d(692,null),d(693,null),d(694,null),d(695,null)],description:d(696,null)})),smartSelect:M(new Yj),smoothScrolling:M(new pe(130,"smoothScrolling",!1,{description:d(697,null)})),stopRenderingLineAfter:M(new Be(133,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:M(new Zj),inlineSuggest:M(new Vj),inlineCompletionsAccessibilityVerbose:M(new pe(169,"inlineCompletionsAccessibilityVerbose",!1,{description:d(698,null)})),suggestFontSize:M(new Be(135,"suggestFontSize",0,0,1e3,{markdownDescription:d(699,null,"`0`","`#editor.fontSize#`")})),suggestLineHeight:M(new Be(136,"suggestLineHeight",0,0,1e3,{markdownDescription:d(700,null,"`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:M(new pe(137,"suggestOnTriggerCharacters",!0,{description:d(701,null)})),suggestSelection:M(new ut(138,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[d(702,null),d(703,null),d(704,null)],description:d(705,null)})),tabCompletion:M(new ut(139,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[d(706,null),d(707,null),d(708,null)],description:d(709,null)})),tabIndex:M(new Be(140,"tabIndex",0,-1,1073741824)),trimWhitespaceOnDelete:M(new pe(141,"trimWhitespaceOnDelete",!1,{description:d(710,null)})),unicodeHighlight:M(new qj),unusualLineTerminators:M(new ut(143,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[d(711,null),d(712,null),d(713,null)],description:d(714,null)})),useShadowDOM:M(new pe(144,"useShadowDOM",!0)),useTabStops:M(new pe(145,"useTabStops",!0,{description:d(715,null)})),wordBreak:M(new ut(146,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[d(716,null),d(717,null)],description:d(718,null)})),wordSegmenterLocales:M(new Qj),wordSeparators:M(new Ti(148,"wordSeparators",Pk,{description:d(719,null)})),wordWrap:M(new ut(149,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[d(720,null),d(721,null),d(722,null),d(723,null)],description:d(724,null)})),wordWrapBreakAfterCharacters:M(new Ti(150,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:M(new Ti(151,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:M(new Be(152,"wordWrapColumn",80,1,1073741824,{markdownDescription:d(725,null)})),wordWrapOverride1:M(new ut(153,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:M(new ut(154,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:M(new pe(160,"wrapOnEscapedLineFeeds",!1,{markdownDescription:d(726,null)})),effectiveCursorStyle:M(new yj),editorClassName:M(new pj),defaultColorDecorators:M(new ut(167,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[d(727,null),d(728,null),d(729,null)],description:d(730,null)})),pixelRatio:M(new jj),tabFocusMode:M(new pe(164,"tabFocusMode",!1,{markdownDescription:d(731,null)})),layoutInfo:M(new $j),wrappingInfo:M(new Kj),wrappingIndent:M(new Xj),wrappingStrategy:M(new Ij),effectiveEditContextEnabled:M(new Aj),effectiveAllowVariableFonts:M(new Sj)},ts,E0=globalThis.vscode;if(typeof E0<"u"&&typeof E0.context<"u"){const e=E0.context.configuration();if(e)ts=e.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(ts=globalThis._VSCODE_PRODUCT_JSON,Rn.VSCODE_DEV&&Object.assign(ts,{nameShort:`${ts.nameShort} Dev`,nameLong:`${ts.nameLong} Dev`,dataFolderName:`${ts.dataFolderName}-dev`,serverDataFolderName:ts.serverDataFolderName?`${ts.serverDataFolderName}-dev`:void 0}),!ts.version){const e=globalThis._VSCODE_PACKAGE_JSON;Object.assign(ts,{version:e.version})}}else ts={},Object.keys(ts).length===0&&Object.assign(ts,{version:"1.104.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",defaultChatAgent:{extensionId:"GitHub.copilot",chatExtensionId:"GitHub.copilot-chat",provider:{default:{id:"github",name:"GitHub"},enterprise:{id:"github-enterprise",name:"GitHub Enterprise"}},providerScopes:[]}});var qs=ts,Wk=class IN{static{this.count=0}constructor(t){this._proxyIdentifierBrand=void 0,this.sid=t,this.nid=++IN.count}},_k=[];function N(e){const t=new Wk(e);return _k[t.nid]=t,t}function Pf(e){return _k[e].sid}var Si=class{constructor(e){this.value=e}},Bk;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Bk||(Bk={}));var qk;(function(e){e[e.UnknownInput=0]="UnknownInput",e[e.TextInput=1]="TextInput",e[e.TextDiffInput=2]="TextDiffInput",e[e.TextMergeInput=3]="TextMergeInput",e[e.NotebookInput=4]="NotebookInput",e[e.NotebookDiffInput=5]="NotebookDiffInput",e[e.CustomEditorInput=6]="CustomEditorInput",e[e.WebviewEditorInput=7]="WebviewEditorInput",e[e.TerminalEditorInput=8]="TerminalEditorInput",e[e.InteractiveEditorInput=9]="InteractiveEditorInput",e[e.ChatEditorInput=10]="ChatEditorInput",e[e.MultiDiffEditorInput=11]="MultiDiffEditorInput"})(qk||(qk={}));var Vk;(function(e){e[e.TAB_OPEN=0]="TAB_OPEN",e[e.TAB_CLOSE=1]="TAB_CLOSE",e[e.TAB_UPDATE=2]="TAB_UPDATE",e[e.TAB_MOVE=3]="TAB_MOVE"})(Vk||(Vk={}));var Gk;(function(e){e[e.Editable=0]="Editable",e[e.SupportsHotExit=1]="SupportsHotExit"})(Gk||(Gk={}));var Jk;(function(e){e[e.Int8Array=1]="Int8Array",e[e.Uint8Array=2]="Uint8Array",e[e.Uint8ClampedArray=3]="Uint8ClampedArray",e[e.Int16Array=4]="Int16Array",e[e.Uint16Array=5]="Uint16Array",e[e.Int32Array=6]="Int32Array",e[e.Uint32Array=7]="Uint32Array",e[e.Float32Array=8]="Float32Array",e[e.Float64Array=9]="Float64Array",e[e.BigInt64Array=10]="BigInt64Array",e[e.BigUint64Array=11]="BigUint64Array"})(Jk||(Jk={}));var Zk;(function(e){e[e.Text=1]="Text",e[e.Error=2]="Error",e[e.Rich=3]="Rich"})(Zk||(Zk={}));var Yk;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Yk||(Yk={}));var x0;(function(e){e[e.None=0]="None",e[e.Process=1]="Process",e[e.Output=2]="Output",e[e.Hybrid=3]="Hybrid"})(x0||(x0={}));var gie=class DN{static{this.a=0}static mixin(t){return t._id=DN.a++,t}},Qk;(function(e){e.label="a",e.kind="b",e.detail="c",e.documentation="d",e.sortText="e",e.filterText="f",e.preselect="g",e.insertText="h",e.insertTextRules="i",e.range="j",e.commitCharacters="k",e.additionalTextEdits="l",e.kindModifier="m",e.commandIdent="n",e.commandId="o",e.commandArguments="p"})(Qk||(Qk={}));var Xk;(function(e){e.defaultRanges="a",e.completions="b",e.isIncomplete="c",e.duration="d"})(Xk||(Xk={}));var Kk;(function(e){e[e.Workspace=0]="Workspace",e[e.TextDocument=1]="TextDocument"})(Kk||(Kk={}));var e5;(function(e){e.Header="header",e.WellKnown="wellKnown",e.None="none"})(e5||(e5={}));var t5;(function(e){e.ResourceMetadata="resourceMetadata",e.WellKnown="wellKnown",e.Default="default"})(t5||(t5={}));var Q={MainThreadAuthentication:N("MainThreadAuthentication"),MainThreadBulkEdits:N("MainThreadBulkEdits"),MainThreadLanguageModels:N("MainThreadLanguageModels"),MainThreadEmbeddings:N("MainThreadEmbeddings"),MainThreadChatAgents2:N("MainThreadChatAgents2"),MainThreadCodeMapper:N("MainThreadCodeMapper"),MainThreadLanguageModelTools:N("MainThreadChatSkills"),MainThreadClipboard:N("MainThreadClipboard"),MainThreadCommands:N("MainThreadCommands"),MainThreadComments:N("MainThreadComments"),MainThreadConfiguration:N("MainThreadConfiguration"),MainThreadConsole:N("MainThreadConsole"),MainThreadDebugService:N("MainThreadDebugService"),MainThreadDecorations:N("MainThreadDecorations"),MainThreadDiagnostics:N("MainThreadDiagnostics"),MainThreadDialogs:N("MainThreadDiaglogs"),MainThreadDocuments:N("MainThreadDocuments"),MainThreadDocumentContentProviders:N("MainThreadDocumentContentProviders"),MainThreadTextEditors:N("MainThreadTextEditors"),MainThreadEditorInsets:N("MainThreadEditorInsets"),MainThreadEditorTabs:N("MainThreadEditorTabs"),MainThreadErrors:N("MainThreadErrors"),MainThreadTreeViews:N("MainThreadTreeViews"),MainThreadDownloadService:N("MainThreadDownloadService"),MainThreadLanguageFeatures:N("MainThreadLanguageFeatures"),MainThreadLanguages:N("MainThreadLanguages"),MainThreadLogger:N("MainThreadLogger"),MainThreadMessageService:N("MainThreadMessageService"),MainThreadOutputService:N("MainThreadOutputService"),MainThreadProgress:N("MainThreadProgress"),MainThreadQuickDiff:N("MainThreadQuickDiff"),MainThreadQuickOpen:N("MainThreadQuickOpen"),MainThreadStatusBar:N("MainThreadStatusBar"),MainThreadSecretState:N("MainThreadSecretState"),MainThreadStorage:N("MainThreadStorage"),MainThreadSpeech:N("MainThreadSpeechProvider"),MainThreadTelemetry:N("MainThreadTelemetry"),MainThreadTerminalService:N("MainThreadTerminalService"),MainThreadTerminalShellIntegration:N("MainThreadTerminalShellIntegration"),MainThreadWebviews:N("MainThreadWebviews"),MainThreadWebviewPanels:N("MainThreadWebviewPanels"),MainThreadWebviewViews:N("MainThreadWebviewViews"),MainThreadCustomEditors:N("MainThreadCustomEditors"),MainThreadUrls:N("MainThreadUrls"),MainThreadUriOpeners:N("MainThreadUriOpeners"),MainThreadProfileContentHandlers:N("MainThreadProfileContentHandlers"),MainThreadWorkspace:N("MainThreadWorkspace"),MainThreadFileSystem:N("MainThreadFileSystem"),MainThreadFileSystemEventService:N("MainThreadFileSystemEventService"),MainThreadExtensionService:N("MainThreadExtensionService"),MainThreadSCM:N("MainThreadSCM"),MainThreadSearch:N("MainThreadSearch"),MainThreadShare:N("MainThreadShare"),MainThreadTask:N("MainThreadTask"),MainThreadWindow:N("MainThreadWindow"),MainThreadLabelService:N("MainThreadLabelService"),MainThreadNotebook:N("MainThreadNotebook"),MainThreadNotebookDocuments:N("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:N("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:N("MainThreadNotebookKernels"),MainThreadNotebookRenderers:N("MainThreadNotebookRenderers"),MainThreadInteractive:N("MainThreadInteractive"),MainThreadTheming:N("MainThreadTheming"),MainThreadTunnelService:N("MainThreadTunnelService"),MainThreadManagedSockets:N("MainThreadManagedSockets"),MainThreadTimeline:N("MainThreadTimeline"),MainThreadTesting:N("MainThreadTesting"),MainThreadLocalization:N("MainThreadLocalizationShape"),MainThreadMcp:N("MainThreadMcpShape"),MainThreadAiRelatedInformation:N("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:N("MainThreadAiEmbeddingVector"),MainThreadChatStatus:N("MainThreadChatStatus"),MainThreadAiSettingsSearch:N("MainThreadAiSettingsSearch"),MainThreadDataChannels:N("MainThreadDataChannels"),MainThreadChatSessions:N("MainThreadChatSessions"),MainThreadChatOutputRenderer:N("MainThreadChatOutputRenderer"),MainThreadChatContext:N("MainThreadChatContext")},oe={ExtHostCodeMapper:N("ExtHostCodeMapper"),ExtHostCommands:N("ExtHostCommands"),ExtHostConfiguration:N("ExtHostConfiguration"),ExtHostDiagnostics:N("ExtHostDiagnostics"),ExtHostDebugService:N("ExtHostDebugService"),ExtHostDecorations:N("ExtHostDecorations"),ExtHostDocumentsAndEditors:N("ExtHostDocumentsAndEditors"),ExtHostDocuments:N("ExtHostDocuments"),ExtHostDocumentContentProviders:N("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:N("ExtHostDocumentSaveParticipant"),ExtHostEditors:N("ExtHostEditors"),ExtHostTreeViews:N("ExtHostTreeViews"),ExtHostFileSystem:N("ExtHostFileSystem"),ExtHostFileSystemInfo:N("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:N("ExtHostFileSystemEventService"),ExtHostLanguages:N("ExtHostLanguages"),ExtHostLanguageFeatures:N("ExtHostLanguageFeatures"),ExtHostQuickOpen:N("ExtHostQuickOpen"),ExtHostQuickDiff:N("ExtHostQuickDiff"),ExtHostStatusBar:N("ExtHostStatusBar"),ExtHostShare:N("ExtHostShare"),ExtHostExtensionService:N("ExtHostExtensionService"),ExtHostLogLevelServiceShape:N("ExtHostLogLevelServiceShape"),ExtHostTerminalService:N("ExtHostTerminalService"),ExtHostTerminalShellIntegration:N("ExtHostTerminalShellIntegration"),ExtHostSCM:N("ExtHostSCM"),ExtHostSearch:N("ExtHostSearch"),ExtHostTask:N("ExtHostTask"),ExtHostWorkspace:N("ExtHostWorkspace"),ExtHostWindow:N("ExtHostWindow"),ExtHostWebviews:N("ExtHostWebviews"),ExtHostWebviewPanels:N("ExtHostWebviewPanels"),ExtHostCustomEditors:N("ExtHostCustomEditors"),ExtHostWebviewViews:N("ExtHostWebviewViews"),ExtHostEditorInsets:N("ExtHostEditorInsets"),ExtHostEditorTabs:N("ExtHostEditorTabs"),ExtHostProgress:N("ExtHostProgress"),ExtHostComments:N("ExtHostComments"),ExtHostSecretState:N("ExtHostSecretState"),ExtHostStorage:N("ExtHostStorage"),ExtHostUrls:N("ExtHostUrls"),ExtHostUriOpeners:N("ExtHostUriOpeners"),ExtHostChatOutputRenderer:N("ExtHostChatOutputRenderer"),ExtHostProfileContentHandlers:N("ExtHostProfileContentHandlers"),ExtHostOutputService:N("ExtHostOutputService"),ExtHostLabelService:N("ExtHostLabelService"),ExtHostNotebook:N("ExtHostNotebook"),ExtHostNotebookDocuments:N("ExtHostNotebookDocuments"),ExtHostNotebookEditors:N("ExtHostNotebookEditors"),ExtHostNotebookKernels:N("ExtHostNotebookKernels"),ExtHostNotebookRenderers:N("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:N("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:N("ExtHostInteractive"),ExtHostChatAgents2:N("ExtHostChatAgents"),ExtHostLanguageModelTools:N("ExtHostChatSkills"),ExtHostChatProvider:N("ExtHostChatProvider"),ExtHostChatContext:N("ExtHostChatContext"),ExtHostSpeech:N("ExtHostSpeech"),ExtHostEmbeddings:N("ExtHostEmbeddings"),ExtHostAiRelatedInformation:N("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:N("ExtHostAiEmbeddingVector"),ExtHostAiSettingsSearch:N("ExtHostAiSettingsSearch"),ExtHostTheming:N("ExtHostTheming"),ExtHostTunnelService:N("ExtHostTunnelService"),ExtHostManagedSockets:N("ExtHostManagedSockets"),ExtHostAuthentication:N("ExtHostAuthentication"),ExtHostTimeline:N("ExtHostTimeline"),ExtHostTesting:N("ExtHostTesting"),ExtHostTelemetry:N("ExtHostTelemetry"),ExtHostLocalization:N("ExtHostLocalization"),ExtHostMcp:N("ExtHostMcp"),ExtHostDataChannels:N("ExtHostDataChannels"),ExtHostChatSessions:N("ExtHostChatSessions")};function i5(e){return e.toJSON()}var sU=class{constructor(e){this.a=e}transformIncoming(e){const t=this.a.transformIncoming(e);return t===e?e:i5(y.from(t))}transformOutgoing(e){const t=this.a.transformOutgoing(e);return t===e?e:i5(y.from(t))}transformOutgoingURI(e){const t=this.a.transformOutgoing(e);return t===e?e:y.from(t)}transformOutgoingScheme(e){return this.a.transformOutgoingScheme(e)}},mie=new class{transformIncoming(e){return e}transformOutgoing(e){return e}transformOutgoingURI(e){return e}transformOutgoingScheme(e){return e}};function s5(e,t,i,s){if(!e||s>200)return null;if(typeof e=="object"){if(e.$mid===1)return i?y.revive(t.transformIncoming(e)):t.transformIncoming(e);if(e instanceof _)return null;for(const r in e)if(Object.hasOwnProperty.call(e,r)){const n=s5(e[r],t,i,s+1);n!==null&&(e[r]=n)}}return null}function yu(e,t){const i=s5(e,t,!1,0);return i===null?e:i}var r5=class{constructor(){this.a=null,this.b=null,this.d=null,this.f=!1,this.g=null,this.h=!1,this.i=null}get[Symbol.toStringTag](){return this.toString()}j(){return this.a||(this.a=new Promise((e,t)=>{this.b=e,this.d=t,this.f&&this.b(this.g),this.h&&this.d(this.i)})),this.a}resolveOk(e){this.f||this.h||(this.f=!0,this.g=e,this.a&&this.b(e))}resolveErr(e){this.f||this.h||(this.h=!0,this.i=e,this.a?this.d(e):pt(e))}then(e,t){return this.j().then(e,t)}catch(e){return this.j().then(void 0,e)}finally(e){return this.j().finally(e)}},rU=class extends r5{constructor(){super(),this.h=!0,this.i=new dt}},n5;function C0(e,t){try{return JSON.stringify(e,t)}catch{return"null"}}var k0="$$ref$$",nU={[k0]:-1};function o5(e,t=null,i=!1){const s=[];return{jsonString:(i?C0:JSON.stringify)(e,(n,o)=>{if(typeof o>"u")return nU;if(typeof o=="object"){if(o instanceof _){const a=s.push(o)-1;return{[k0]:a}}if(t)return t(n,o)}return o}),referencedBuffers:s}}function a5(e,t,i){return JSON.parse(e,(s,r)=>{if(r){const n=r[k0];if(typeof n=="number")return t[n];if(i&&r.$mid===1)return i.transformIncoming(r)}return r})}function c5(e,t){return JSON.stringify(e,t)}function oU(e){return e?(t,i)=>i&&i.$mid===1?e.transformOutgoing(i):i:null}var l5;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(l5||(l5={}));var u5;(function(e){e[e.Responsive=0]="Responsive",e[e.Unresponsive=1]="Unresponsive"})(u5||(u5={}));var aU=()=>{},cU=Symbol.for("rpcProtocol"),lU=Symbol.for("rpcProxy"),uU=class LE extends J{static{n5=cU}static{this.a=3*1e3}constructor(t,i=null,s=null){super(),this[n5]=!0,this.b=this.D(new I),this.onDidChangeResponsiveState=this.b.event,this.c=t,this.f=i,this.g=s,this.h=oU(this.g),this.j=!1,this.m=[],this.q=[];for(let r=0,n=Wk.count;r<n;r++)this.m[r]=null,this.q[r]=null;this.s=0,this.t=Object.create(null),this.u={},this.w=0,this.y=0,this.z=0,this.C=this.D(new vr(()=>this.H(),1e3)),this.D(this.c.onMessage(r=>this.L(r)))}dispose(){this.j=!0,Object.keys(this.u).forEach(t=>{const i=this.u[t];delete this.u[t],i.resolveErr(ou())}),super.dispose()}drain(){return typeof this.c.drain=="function"?this.c.drain():Promise.resolve()}F(t){this.y===0&&(this.z=Date.now()+LE.a),this.y++,this.C.isScheduled()||this.C.schedule()}G(t){this.z=Date.now()+LE.a,this.y--,this.y===0&&this.C.cancel(),this.I(0)}H(){this.y!==0&&(Date.now()>this.z?this.I(1):this.C.schedule())}I(t){this.w!==t&&(this.w=t,this.b.fire(this.w))}get responsiveState(){return this.w}transformIncomingURIs(t){return this.g?yu(t,this.g):t}getProxy(t){const{nid:i,sid:s}=t;return this.q[i]||(this.q[i]=this.J(i,s)),this.q[i]}J(t,i){const s={get:(r,n)=>(typeof n=="string"&&!r[n]&&n.charCodeAt(0)===36&&(r[n]=(...o)=>this.U(t,n,o)),n===lU?i:r[n])};return new Proxy(Object.create(null),s)}set(t,i){return this.m[t.nid]=i,i}assertRegistered(t){for(let i=0,s=t.length;i<s;i++){const r=t[i];if(!this.m[r.nid])throw new Error(`Missing proxy instance ${r.sid}`)}}L(t){if(this.j)return;const i=t.byteLength,s=Vt.read(t,0),r=s.readUInt8(),n=s.readUInt32();switch(r){case 1:case 2:{let{rpcId:o,method:a,args:c}=Is.deserializeRequestJSONArgs(s);this.g&&(c=yu(c,this.g)),this.M(i,n,o,a,c,r===2);break}case 3:case 4:{let{rpcId:o,method:a,args:c}=Is.deserializeRequestMixedArgs(s);this.g&&(c=yu(c,this.g)),this.M(i,n,o,a,c,r===4);break}case 5:{this.f?.logIncoming(i,n,0,"ack"),this.G(n);break}case 6:{this.N(i,n);break}case 7:{this.O(i,n,void 0);break}case 9:{let o=Is.deserializeReplyOKJSON(s);this.g&&(o=yu(o,this.g)),this.O(i,n,o);break}case 10:{const o=Is.deserializeReplyOKJSONWithBuffers(s,this.g);this.O(i,n,o);break}case 8:{const o=Is.deserializeReplyOKVSBuffer(s);this.O(i,n,o);break}case 11:{let o=Is.deserializeReplyErrError(s);this.g&&(o=yu(o,this.g)),this.P(i,n,o);break}case 12:{this.P(i,n,void 0);break}default:console.error("received unexpected message"),console.error(t)}}M(t,i,s,r,n,o){this.f?.logIncoming(t,i,1,`receiveRequest ${Pf(s)}.${r}(`,n);const a=String(i);let c,l;if(o){const h=new Ke;n.push(h.token),c=this.Q(s,r,n),l=()=>h.cancel()}else c=this.Q(s,r,n),l=aU;this.t[a]=l;const u=Is.serializeAcknowledged(i);this.f?.logOutgoing(u.byteLength,i,1,"ack"),this.c.send(u),c.then(h=>{delete this.t[a];const f=Is.serializeReplyOK(i,h,this.h);this.f?.logOutgoing(f.byteLength,i,1,"reply:",h),this.c.send(f)},h=>{delete this.t[a];const f=Is.serializeReplyErr(i,h);this.f?.logOutgoing(f.byteLength,i,1,"replyErr:",h),this.c.send(f)})}N(t,i){this.f?.logIncoming(t,i,1,"receiveCancel");const s=String(i);this.t[s]?.()}O(t,i,s){this.f?.logIncoming(t,i,0,"receiveReply:",s);const r=String(i);if(!this.u.hasOwnProperty(r))return;const n=this.u[r];delete this.u[r],n.resolveOk(s)}P(t,i,s){this.f?.logIncoming(t,i,0,"receiveReplyErr:",s);const r=String(i);if(!this.u.hasOwnProperty(r))return;const n=this.u[r];delete this.u[r];let o;s&&(s.$isError?(o=new Error,o.name=s.name,o.message=s.message,o.stack=s.stack):o=s),n.resolveErr(o)}Q(t,i,s){try{return Promise.resolve(this.S(t,i,s))}catch(r){return Promise.reject(r)}}S(t,i,s){const r=this.m[t];if(!r)throw new Error("Unknown actor "+Pf(t));const n=r[i];if(typeof n!="function")throw new Error("Unknown method "+i+" on actor "+Pf(t));return n.apply(r,s)}U(t,i,s){if(this.j)return new rU;let r=null;if(s.length>0&&De.isCancellationToken(s[s.length-1])&&(r=s.pop()),r&&r.isCancellationRequested)return Promise.reject(ou());const n=Is.serializeRequestArguments(s,this.h),o=++this.s,a=String(o),c=new r5,l=new X;r&&l.add(r.onCancellationRequested(()=>{const h=Is.serializeCancel(o);this.f?.logOutgoing(h.byteLength,o,0,"cancel"),this.c.send(h)})),this.u[a]=new hU(c,l),this.F(o);const u=Is.serializeRequest(o,t,i,n,!!r);return this.f?.logOutgoing(u.byteLength,o,0,`request: ${Pf(t)}.${i}(`,s),this.c.send(u),c}},hU=class{constructor(e,t){this.a=e,this.b=t}resolveOk(e){this.a.resolveOk(e),this.b.dispose()}resolveErr(e){this.a.resolveErr(e),this.b.dispose()}},Vt=class OE{static alloc(t,i,s){const r=new OE(_.alloc(s+1+4),0);return r.writeUInt8(t),r.writeUInt32(i),r}static read(t,i){return new OE(t,i)}get buffer(){return this.a}constructor(t,i){this.a=t,this.b=i}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(t){this.a.writeUInt8(t,this.b),this.b+=1}readUInt8(){const t=this.a.readUInt8(this.b);return this.b+=1,t}writeUInt32(t){this.a.writeUInt32BE(t,this.b),this.b+=4}readUInt32(){const t=this.a.readUInt32BE(this.b);return this.b+=4,t}static sizeShortString(t){return 1+t.byteLength}writeShortString(t){this.a.writeUInt8(t.byteLength,this.b),this.b+=1,this.a.set(t,this.b),this.b+=t.byteLength}readShortString(){const t=this.a.readUInt8(this.b);this.b+=1;const s=this.a.slice(this.b,this.b+t).toString();return this.b+=t,s}static sizeLongString(t){return 4+t.byteLength}writeLongString(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}readLongString(){const t=this.a.readUInt32BE(this.b);this.b+=4;const s=this.a.slice(this.b,this.b+t).toString();return this.b+=t,s}writeBuffer(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}static sizeVSBuffer(t){return 4+t.byteLength}writeVSBuffer(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}readVSBuffer(){const t=this.a.readUInt32BE(this.b);this.b+=4;const i=this.a.slice(this.b,this.b+t);return this.b+=t,i}static sizeMixedArray(t){let i=0;i+=1;for(let s=0,r=t.length;s<r;s++){const n=t[s];switch(i+=1,n.type){case 1:i+=this.sizeLongString(n.value);break;case 2:i+=this.sizeVSBuffer(n.value);break;case 3:i+=this.sizeUInt32,i+=this.sizeLongString(n.value);for(let o=0;o<n.buffers.length;++o)i+=this.sizeVSBuffer(n.buffers[o]);break;case 4:break}}return i}writeMixedArray(t){this.a.writeUInt8(t.length,this.b),this.b+=1;for(let i=0,s=t.length;i<s;i++){const r=t[i];switch(r.type){case 1:this.writeUInt8(1),this.writeLongString(r.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(r.value);break;case 3:this.writeUInt8(3),this.writeUInt32(r.buffers.length),this.writeLongString(r.value);for(let n=0;n<r.buffers.length;++n)this.writeBuffer(r.buffers[n]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const t=this.a.readUInt8(this.b);this.b+=1;const i=new Array(t);for(let s=0;s<t;s++)switch(this.readUInt8()){case 1:i[s]=this.readLongString();break;case 2:i[s]=this.readVSBuffer();break;case 3:{const n=this.readUInt32(),o=this.readLongString(),a=[];for(let c=0;c<n;++c)a.push(this.readVSBuffer());i[s]=new Si(a5(o,a,null));break}case 4:i[s]=void 0;break}return i}},h5;(function(e){e[e.Simple=0]="Simple",e[e.Mixed=1]="Mixed"})(h5||(h5={}));var Is=class{static a(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof _||e[t]instanceof Si||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this.a(e)){const i=[];for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n instanceof _)i[s]={type:2,value:n};else if(typeof n>"u")i[s]={type:4};else if(n instanceof Si){const{jsonString:o,referencedBuffers:a}=o5(n.value,t);i[s]={type:3,value:_.fromString(o),buffers:a}}else i[s]={type:1,value:_.fromString(c5(n,t))}}return{type:1,args:i}}return{type:0,args:c5(e,t)}}static serializeRequest(e,t,i,s,r){switch(s.type){case 0:return this.b(e,t,i,s.args,r);case 1:return this.c(e,t,i,s.args,r)}}static b(e,t,i,s,r){const n=_.fromString(i),o=_.fromString(s);let a=0;a+=Vt.sizeUInt8(),a+=Vt.sizeShortString(n),a+=Vt.sizeLongString(o);const c=Vt.alloc(r?2:1,e,a);return c.writeUInt8(t),c.writeShortString(n),c.writeLongString(o),c.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),s=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(s)}}static c(e,t,i,s,r){const n=_.fromString(i);let o=0;o+=Vt.sizeUInt8(),o+=Vt.sizeShortString(n),o+=Vt.sizeMixedArray(s);const a=Vt.alloc(r?4:3,e,o);return a.writeUInt8(t),a.writeShortString(n),a.writeMixedArray(s),a.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),s=e.readMixedArray(),r=new Array(s.length);for(let n=0,o=s.length;n<o;n++){const a=s[n];typeof a=="string"?r[n]=JSON.parse(a):r[n]=a}return{rpcId:t,method:i,args:r}}static serializeAcknowledged(e){return Vt.alloc(5,e,0).buffer}static serializeCancel(e){return Vt.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this.d(e);if(t instanceof _)return this.e(e,t);if(t instanceof Si){const{jsonString:s,referencedBuffers:r}=o5(t.value,i,!0);return this.g(e,s,r)}else return this.f(e,C0(t,i))}static d(e){return Vt.alloc(7,e,0).buffer}static e(e,t){let i=0;i+=Vt.sizeVSBuffer(t);const s=Vt.alloc(8,e,i);return s.writeVSBuffer(t),s.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static f(e,t){const i=_.fromString(t);let s=0;s+=Vt.sizeLongString(i);const r=Vt.alloc(9,e,s);return r.writeLongString(i),r.buffer}static g(e,t,i){const s=_.fromString(t);let r=0;r+=Vt.sizeUInt32,r+=Vt.sizeLongString(s);for(const o of i)r+=Vt.sizeVSBuffer(o);const n=Vt.alloc(10,e,r);n.writeUInt32(i.length),n.writeLongString(s);for(const o of i)n.writeBuffer(o);return n.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),s=e.readLongString(),r=[];for(let n=0;n<i;++n)r.push(e.readVSBuffer());return new Si(a5(s,r,t))}static serializeReplyErr(e,t){const i=t?C0(tc(t),null):void 0;if(typeof i!="string")return this.h(e);const s=_.fromString(i);let r=0;r+=Vt.sizeLongString(s);const n=Vt.alloc(11,e,r);return n.writeLongString(s),n.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static h(e){return Vt.alloc(12,e,0).buffer}},d5;(function(e){e[e.RequestJSONArgs=1]="RequestJSONArgs",e[e.RequestJSONArgsWithCancellation=2]="RequestJSONArgsWithCancellation",e[e.RequestMixedArgs=3]="RequestMixedArgs",e[e.RequestMixedArgsWithCancellation=4]="RequestMixedArgsWithCancellation",e[e.Acknowledged=5]="Acknowledged",e[e.Cancel=6]="Cancel",e[e.ReplyOKEmpty=7]="ReplyOKEmpty",e[e.ReplyOKVSBuffer=8]="ReplyOKVSBuffer",e[e.ReplyOKJSON=9]="ReplyOKJSON",e[e.ReplyOKJSONWithBuffers=10]="ReplyOKJSONWithBuffers",e[e.ReplyErrError=11]="ReplyErrError",e[e.ReplyErrEmpty=12]="ReplyErrEmpty"})(d5||(d5={}));var f5;(function(e){e[e.String=1]="String",e[e.VSBuffer=2]="VSBuffer",e[e.SerializedObjectWithBuffers=3]="SerializedObjectWithBuffers",e[e.Undefined=4]="Undefined"})(f5||(f5={}));var Vs;(function(e){e.serviceIds=new Map,e.DI_TARGET="$di$target",e.DI_DEPENDENCIES="$di$dependencies";function t(i){return i[e.DI_DEPENDENCIES]||[]}e.getServiceDependencies=t})(Vs||(Vs={}));var Yo=W("instantiationService");function dU(e,t,i){t[Vs.DI_TARGET]===t?t[Vs.DI_DEPENDENCIES].push({id:e,index:i}):(t[Vs.DI_DEPENDENCIES]=[{id:e,index:i}],t[Vs.DI_TARGET]=t)}function W(e){if(Vs.serviceIds.has(e))return Vs.serviceIds.get(e);const t=function(i,s,r){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");dU(t,i,r)};return t.toString=()=>e,Vs.serviceIds.set(e,t),t}function vie(e){return e}function p5(e){if(!e)return;const t=e.indexOf("+");return t<0?e:e.substr(0,t)}var g5=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"],m5;(function(e){e[e.System=0]="System",e[e.User=1]="User"})(m5||(m5={}));var v5;(function(e){e.WIN32_X64="win32-x64",e.WIN32_ARM64="win32-arm64",e.LINUX_X64="linux-x64",e.LINUX_ARM64="linux-arm64",e.LINUX_ARMHF="linux-armhf",e.ALPINE_X64="alpine-x64",e.ALPINE_ARM64="alpine-arm64",e.DARWIN_X64="darwin-x64",e.DARWIN_ARM64="darwin-arm64",e.WEB="web",e.UNIVERSAL="universal",e.UNKNOWN="unknown",e.UNDEFINED="undefined"})(v5||(v5={}));var it=class{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,s=typeof t=="string"?t:t.value;return gs(i,s)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}},Qo=class{get size(){return this.c.size}constructor(e){if(this.c=new Set,e)for(const t of e)this.add(t)}add(e){this.c.add(it.toKey(e))}delete(e){return this.c.delete(it.toKey(e))}has(e){return this.c.has(it.toKey(e))}},Gn=class{constructor(){this.c=new Map}clear(){this.c.clear()}delete(e){this.c.delete(it.toKey(e))}get(e){return this.c.get(it.toKey(e))}has(e){return this.c.has(it.toKey(e))}set(e,t){this.c.set(it.toKey(e),t)}values(){return this.c.values()}forEach(e){this.c.forEach(e)}[Symbol.iterator](){return this.c[Symbol.iterator]()}},w5=class extends Error{constructor(e,t,i){super(`Error in extension ${it.toKey(e)}: ${i??t.message}`,{cause:t}),this.name="ExtensionError",this.extension=e}},wie=W("IBuiltinExtensionsScannerService");function $0(e,t){return t&&(e.stack||e.stacktrace)?d(113,null,y5(e),b5(e.stack)||b5(e.stacktrace)):y5(e)}function b5(e){return Array.isArray(e)?e.join(`
`):e}function y5(e){return e.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${e.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof e.code=="string"&&typeof e.errno=="number"&&typeof e.syscall=="string"?d(114,null,e.message):e.message||d(115,null)}function yr(e=null,t=!1){if(!e)return d(116,null);if(Array.isArray(e)){const i=yt(e),s=yr(i[0],t);return i.length>1?d(117,null,s,i.length):s}if(Oe(e))return e;if(e.detail){const i=e.detail;if(i.error)return $0(i.error,t);if(i.exception)return $0(i.exception,t)}return e.stack?$0(e,t):e.message?e.message:d(118,null)}function Ar(e){return I0(e,0)}function I0(e,t){switch(typeof e){case"object":return e===null?en(349,t):Array.isArray(e)?pU(e,t):gU(e,t);case"string":return D0(e,t);case"boolean":return fU(e,t);case"number":return en(e,t);case"undefined":return en(937,t);default:return en(617,t)}}function en(e,t){return(t<<5)-t+e|0}function fU(e,t){return en(e?433:863,t)}function D0(e,t){t=en(149417,t);for(let i=0,s=e.length;i<s;i++)t=en(e.charCodeAt(i),t);return t}function pU(e,t){return t=en(104579,t),e.reduce((i,s)=>I0(s,i),t)}function gU(e,t){return t=en(181387,t),Object.keys(e).sort().reduce((i,s)=>(i=D0(s,i),I0(e[s],i)),t)}var A5;(function(e){e[e.BLOCK_SIZE=64]="BLOCK_SIZE",e[e.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"})(A5||(A5={}));function P0(e,t,i=32){const s=i-t,r=~((1<<s)-1);return(e<<t|(r&e)>>>s)>>>0}function Au(e,t=32){return e instanceof ArrayBuffer?c0(_.wrap(new Uint8Array(e))):(e>>>0).toString(16).padStart(t/4,"0")}var bie=class PN{static{this.g=new DataView(new ArrayBuffer(320))}constructor(){this.h=1732584193,this.l=4023233417,this.m=2562383102,this.n=271733878,this.o=3285377520,this.p=new Uint8Array(67),this.q=new DataView(this.p.buffer),this.r=0,this.t=0,this.u=0,this.v=!1}update(t){const i=t.length;if(i===0)return;const s=this.p;let r=this.r,n=this.u,o,a;for(n!==0?(o=n,a=-1,n=0):(o=t.charCodeAt(0),a=0);;){let c=o;if(hf(o))if(a+1<i){const l=t.charCodeAt(a+1);df(l)?(a++,c=J1(o,l)):c=65533}else{n=o;break}else df(o)&&(c=65533);if(r=this.w(s,r,c),a++,a<i)o=t.charCodeAt(a);else break}this.r=r,this.u=n}w(t,i,s){return s<128?t[i++]=s:s<2048?(t[i++]=192|(s&1984)>>>6,t[i++]=128|(s&63)>>>0):s<65536?(t[i++]=224|(s&61440)>>>12,t[i++]=128|(s&4032)>>>6,t[i++]=128|(s&63)>>>0):(t[i++]=240|(s&1835008)>>>18,t[i++]=128|(s&258048)>>>12,t[i++]=128|(s&4032)>>>6,t[i++]=128|(s&63)>>>0),i>=64&&(this.y(),i-=64,this.t+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),i}digest(){return this.v||(this.v=!0,this.u&&(this.u=0,this.r=this.w(this.p,this.r,65533)),this.t+=this.r,this.x()),Au(this.h)+Au(this.l)+Au(this.m)+Au(this.n)+Au(this.o)}x(){this.p[this.r++]=128,this.p.subarray(this.r).fill(0),this.r>56&&(this.y(),this.p.fill(0));const t=8*this.t;this.q.setUint32(56,Math.floor(t/4294967296),!1),this.q.setUint32(60,t%4294967296,!1),this.y()}y(){const t=PN.g,i=this.q;for(let h=0;h<64;h+=4)t.setUint32(h,i.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)t.setUint32(h,P0(t.getUint32(h-12,!1)^t.getUint32(h-32,!1)^t.getUint32(h-56,!1)^t.getUint32(h-64,!1),1),!1);let s=this.h,r=this.l,n=this.m,o=this.n,a=this.o,c,l,u;for(let h=0;h<80;h++)h<20?(c=r&n|~r&o,l=1518500249):h<40?(c=r^n^o,l=1859775393):h<60?(c=r&n|r&o|n&o,l=2400959708):(c=r^n^o,l=3395469782),u=P0(s,5)+c+a+l+t.getUint32(h*4,!1)&4294967295,a=o,o=n,n=P0(r,30),r=s,s=u;this.h=this.h+s&4294967295,this.l=this.l+r&4294967295,this.m=this.m+n&4294967295,this.n=this.n+o&4294967295,this.o=this.o+a&4294967295}},S5;(function(e){e[e.LParen=0]="LParen",e[e.RParen=1]="RParen",e[e.Neg=2]="Neg",e[e.Eq=3]="Eq",e[e.NotEq=4]="NotEq",e[e.Lt=5]="Lt",e[e.LtEq=6]="LtEq",e[e.Gt=7]="Gt",e[e.GtEq=8]="GtEq",e[e.RegexOp=9]="RegexOp",e[e.RegexStr=10]="RegexStr",e[e.True=11]="True",e[e.False=12]="False",e[e.In=13]="In",e[e.Not=14]="Not",e[e.And=15]="And",e[e.Or=16]="Or",e[e.Str=17]="Str",e[e.QuotedStr=18]="QuotedStr",e[e.Error=19]="Error",e[e.EOF=20]="EOF"})(S5||(S5={}));function T0(...e){switch(e.length){case 1:return d(1872,null,e[0]);case 2:return d(1873,null,e[0],e[1]);case 3:return d(1874,null,e[0],e[1],e[2]);default:return}}var mU=d(1875,null),vU=d(1876,null),Su=class FE{constructor(){this.c="",this.d=0,this.e=0,this.f=[],this.g=[],this.m=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw $1(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static{this.a=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)))}static{this.b=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this.g}reset(t){return this.c=t,this.d=0,this.e=0,this.f=[],this.g=[],this}scan(){for(;!this.r();)switch(this.d=this.e,this.i()){case 40:this.k(0);break;case 41:this.k(1);break;case 33:if(this.h(61)){const i=this.h(61);this.f.push({type:4,offset:this.d,isTripleEq:i})}else this.k(2);break;case 39:this.o();break;case 47:this.q();break;case 61:if(this.h(61)){const i=this.h(61);this.f.push({type:3,offset:this.d,isTripleEq:i})}else this.h(126)?this.k(9):this.l(T0("==","=~"));break;case 60:this.k(this.h(61)?6:5);break;case 62:this.k(this.h(61)?8:7);break;case 38:this.h(38)?this.k(15):this.l(T0("&&"));break;case 124:this.h(124)?this.k(16):this.l(T0("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this.n()}return this.d=this.e,this.k(20),Array.from(this.f)}h(t){return this.r()||this.c.charCodeAt(this.e)!==t?!1:(this.e++,!0)}i(){return this.c.charCodeAt(this.e++)}j(){return this.r()?0:this.c.charCodeAt(this.e)}k(t){this.f.push({type:t,offset:this.d})}l(t){const i=this.d,s=this.c.substring(this.d,this.e),r={type:19,offset:this.d,lexeme:s};this.g.push({offset:i,lexeme:s,additionalInfo:t}),this.f.push(r)}n(){this.m.lastIndex=this.d;const t=this.m.exec(this.c);if(t){this.e=this.d+t[0].length;const i=this.c.substring(this.d,this.e),s=FE.b.get(i);s?this.k(s):this.f.push({type:17,lexeme:i,offset:this.d})}}o(){for(;this.j()!==39&&!this.r();)this.i();if(this.r()){this.l(mU);return}this.i(),this.f.push({type:18,lexeme:this.c.substring(this.d+1,this.e-1),offset:this.d+1})}q(){let t=this.e,i=!1,s=!1;for(;;){if(t>=this.c.length){this.e=t,this.l(vU);return}const n=this.c.charCodeAt(t);if(i)i=!1;else if(n===47&&!s){t++;break}else n===91?s=!0:n===92?i=!0:n===93&&(s=!1);t++}for(;t<this.c.length&&FE.a.has(this.c.charCodeAt(t));)t++;this.e=t;const r=this.c.substring(this.d,this.e);this.f.push({type:10,lexeme:r,offset:this.d})}r(){return this.e>=this.c.length}},pi=new Map;pi.set("false",!1),pi.set("true",!0),pi.set("isMac",Nt),pi.set("isLinux",Mt),pi.set("isWindows",ze),pi.set("isWeb",jo),pi.set("isMacNative",Nt&&!jo),pi.set("isEdge",Gx),pi.set("isFirefox",b2),pi.set("isChrome",W1),pi.set("isSafari",y2);var wU=Object.prototype.hasOwnProperty,E5;(function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.Defined=2]="Defined",e[e.Not=3]="Not",e[e.Equals=4]="Equals",e[e.NotEquals=5]="NotEquals",e[e.And=6]="And",e[e.Regex=7]="Regex",e[e.NotRegex=8]="NotRegex",e[e.Or=9]="Or",e[e.In=10]="In",e[e.NotIn=11]="NotIn",e[e.Greater=12]="Greater",e[e.GreaterEquals=13]="GreaterEquals",e[e.Smaller=14]="Smaller",e[e.SmallerEquals=15]="SmallerEquals"})(E5||(E5={}));var bU={regexParsingWithErrorRecovery:!0},yU=d(1852,null),AU=d(1853,null),SU=d(1854,null),x5=d(1855,null),EU=d(1856,null),xU=d(1857,null),CU=d(1858,null),kU=d(1859,null),C5=class zd{static{this.c=new Error}get lexingErrors(){return this.d.errors}get parsingErrors(){return this.h}constructor(t=bU){this.k=t,this.d=new Su,this.f=[],this.g=0,this.h=[],this.v=/g|y/g}parse(t){if(t===""){this.h.push({message:yU,offset:0,lexeme:"",additionalInfo:AU});return}this.f=this.d.reset(t).scan(),this.g=0,this.h=[];try{const i=this.l();if(!this.E()){const s=this.D(),r=s.type===17?xU:void 0;throw this.h.push({message:EU,offset:s.offset,lexeme:Su.getLexeme(s),additionalInfo:r}),zd.c}return i}catch(i){if(i!==zd.c)throw i;return}}l(){return this.m()}m(){const t=[this.o()];for(;this.y(16);){const i=this.o();t.push(i)}return t.length===1?t[0]:Ot.or(...t)}o(){const t=[this.s()];for(;this.y(15);){const i=this.s();t.push(i)}return t.length===1?t[0]:Ot.and(...t)}s(){if(this.y(2)){const t=this.D();switch(t.type){case 11:return this.z(),zi.INSTANCE;case 12:return this.z(),is.INSTANCE;case 0:{this.z();const i=this.l();return this.A(1,x5),i?.negate()}case 17:return this.z(),Cu.create(t.lexeme);default:throw this.B("KEY | true | false | '(' expression ')'",t)}}return this.t()}t(){const t=this.D();switch(t.type){case 11:return this.z(),Ot.true();case 12:return this.z(),Ot.false();case 0:{this.z();const i=this.l();return this.A(1,x5),i}case 17:{const i=t.lexeme;if(this.z(),this.y(9)){const r=this.D();if(!this.k.regexParsingWithErrorRecovery){if(this.z(),r.type!==10)throw this.B("REGEX",r);const n=r.lexeme,o=n.lastIndexOf("/"),a=o===n.length-1?void 0:this.w(n.substring(o+1));let c;try{c=new RegExp(n.substring(1,o),a)}catch{throw this.B("REGEX",r)}return F0.create(i,c)}switch(r.type){case 10:case 19:{const n=[r.lexeme];this.z();let o=this.D(),a=0;for(let f=0;f<r.lexeme.length;f++)r.lexeme.charCodeAt(f)===40?a++:r.lexeme.charCodeAt(f)===41&&a--;for(;!this.E()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?a++:r.lexeme.charCodeAt(f)===41&&a--}if(a<0)break;n.push(Su.getLexeme(o)),this.z(),o=this.D()}const c=n.join(""),l=c.lastIndexOf("/"),u=l===c.length-1?void 0:this.w(c.substring(l+1));let h;try{h=new RegExp(c.substring(1,l),u)}catch{throw this.B("REGEX",r)}return Ot.regex(i,h)}case 18:{const n=r.lexeme;this.z();let o=null;if(!ac(n)){const a=n.indexOf("/"),c=n.lastIndexOf("/");if(a!==c&&a>=0){const l=n.slice(a+1,c),u=n[c+1]==="i"?"i":"";try{o=new RegExp(l,u)}catch{throw this.B("REGEX",r)}}}if(o===null)throw this.B("REGEX",r);return F0.create(i,o)}default:throw this.B("REGEX",this.D())}}if(this.y(14)){this.A(13,SU);const r=this.u();return Ot.notIn(i,r)}switch(this.D().type){case 3:{this.z();const r=this.u();if(this.x().type===18)return Ot.equals(i,r);switch(r){case"true":return Ot.has(i);case"false":return Ot.not(i);default:return Ot.equals(i,r)}}case 4:{this.z();const r=this.u();if(this.x().type===18)return Ot.notEquals(i,r);switch(r){case"true":return Ot.not(i);case"false":return Ot.has(i);default:return Ot.notEquals(i,r)}}case 5:return this.z(),L0.create(i,this.u());case 6:return this.z(),O0.create(i,this.u());case 7:return this.z(),Mf.create(i,this.u());case 8:return this.z(),R0.create(i,this.u());case 13:return this.z(),Ot.in(i,this.u());default:return Ot.has(i)}}case 20:throw this.h.push({message:CU,offset:t.offset,lexeme:"",additionalInfo:kU}),zd.c;default:throw this.B(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this.D())}}u(){const t=this.D();switch(t.type){case 17:case 18:return this.z(),t.lexeme;case 11:return this.z(),"true";case 12:return this.z(),"false";case 13:return this.z(),"in";default:return""}}w(t){return t.replaceAll(this.v,"")}x(){return this.f[this.g-1]}y(t){return this.C(t)?(this.z(),!0):!1}z(){return this.E()||this.g++,this.x()}A(t,i){if(this.C(t))return this.z();throw this.B(i,this.D())}B(t,i,s){const r=d(1860,null,t,Su.getLexeme(i)),n=i.offset,o=Su.getLexeme(i);return this.h.push({message:r,offset:n,lexeme:o,additionalInfo:s}),zd.c}C(t){return this.D().type===t}D(){return this.f[this.g]}E(){return this.D().type===20}},Ot=class{static false(){return zi.INSTANCE}static true(){return is.INSTANCE}static has(e){return xu.create(e)}static equals(e,t){return M0.create(e,t)}static notEquals(e,t){return N0.create(e,t)}static regex(e,t){return F0.create(e,t)}static in(e,t){return k5.create(e,t)}static notIn(e,t){return $5.create(e,t)}static not(e){return Cu.create(e)}static and(...e){return D5.create(e,null,!0)}static or(...e){return j0.create(e,null,!0)}static greater(e,t){return Mf.create(e,t)}static greaterEquals(e,t){return R0.create(e,t)}static smaller(e,t){return L0.create(e,t)}static smallerEquals(e,t){return O0.create(e,t)}static{this.c=new C5({regexParsingWithErrorRecovery:!1})}static deserialize(e){return e==null?void 0:this.c.parse(e)}};function $U(e){const t=new C5({regexParsingWithErrorRecovery:!1});return e.map(i=>(t.parse(i),t.lexingErrors.length>0?t.lexingErrors.map(s=>({errorMessage:s.additionalInfo?d(1861,null,s.additionalInfo):d(1862,null),offset:s.offset,length:s.lexeme.length})):t.parsingErrors.length>0?t.parsingErrors.map(s=>({errorMessage:s.additionalInfo?`${s.message}. ${s.additionalInfo}`:s.message,offset:s.offset,length:s.lexeme.length})):[]))}function Eu(e,t){return e.cmp(t)}var zi=class TN{static{this.INSTANCE=new TN}constructor(){this.type=0}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return is.INSTANCE}},is=class MN{static{this.INSTANCE=new MN}constructor(){this.type=1}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return zi.INSTANCE}},xu=class NN{static create(t,i=null){const s=pi.get(t);return typeof s=="boolean"?s?is.INSTANCE:zi.INSTANCE:new NN(t,i)}constructor(t,i){this.key=t,this.c=i,this.type=2}cmp(t){return t.type!==this.type?this.type-t.type:P5(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){const t=pi.get(this.key);return typeof t=="boolean"?t?is.INSTANCE:zi.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.c||(this.c=Cu.create(this.key,this)),this.c}},M0=class RN{static create(t,i,s=null){if(typeof i=="boolean")return i?xu.create(t,s):Cu.create(t,s);const r=pi.get(t);return typeof r=="boolean"?i===(r?"true":"false")?is.INSTANCE:zi.INSTANCE:new RN(t,i,s)}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=4}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){const t=pi.get(this.c);if(typeof t=="boolean"){const i=t?"true":"false";return this.d===i?is.INSTANCE:zi.INSTANCE}return this}evaluate(t){return t.getValue(this.c)==this.d}serialize(){return`${this.c} == '${this.d}'`}keys(){return[this.c]}map(t){return t.mapEquals(this.c,this.d)}negate(){return this.f||(this.f=N0.create(this.c,this.d,this)),this.f}},k5=class LN{static create(t,i){return new LN(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=10,this.c=null}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.d,this.f,t.d,t.f)}equals(t){return t.type===this.type?this.d===t.d&&this.f===t.f:!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.f),s=t.getValue(this.d);return Array.isArray(i)?i.includes(s):typeof s=="string"&&typeof i=="object"&&i!==null?wU.call(i,s):!1}serialize(){return`${this.d} in '${this.f}'`}keys(){return[this.d,this.f]}map(t){return t.mapIn(this.d,this.f)}negate(){return this.c||(this.c=$5.create(this.d,this.f)),this.c}},$5=class ON{static create(t,i){return new ON(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=11,this.c=k5.create(t,i)}cmp(t){return t.type!==this.type?this.type-t.type:this.c.cmp(t.c)}equals(t){return t.type===this.type?this.c.equals(t.c):!1}substituteConstants(){return this}evaluate(t){return!this.c.evaluate(t)}serialize(){return`${this.d} not in '${this.f}'`}keys(){return this.c.keys()}map(t){return t.mapNotIn(this.d,this.f)}negate(){return this.c}},N0=class FN{static create(t,i,s=null){if(typeof i=="boolean")return i?Cu.create(t,s):xu.create(t,s);const r=pi.get(t);return typeof r=="boolean"?i===(r?"true":"false")?zi.INSTANCE:is.INSTANCE:new FN(t,i,s)}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=5}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){const t=pi.get(this.c);if(typeof t=="boolean"){const i=t?"true":"false";return this.d===i?zi.INSTANCE:is.INSTANCE}return this}evaluate(t){return t.getValue(this.c)!=this.d}serialize(){return`${this.c} != '${this.d}'`}keys(){return[this.c]}map(t){return t.mapNotEquals(this.c,this.d)}negate(){return this.f||(this.f=M0.create(this.c,this.d,this)),this.f}},Cu=class jN{static create(t,i=null){const s=pi.get(t);return typeof s=="boolean"?s?zi.INSTANCE:is.INSTANCE:new jN(t,i)}constructor(t,i){this.c=t,this.d=i,this.type=3}cmp(t){return t.type!==this.type?this.type-t.type:P5(this.c,t.c)}equals(t){return t.type===this.type?this.c===t.c:!1}substituteConstants(){const t=pi.get(this.c);return typeof t=="boolean"?t?zi.INSTANCE:is.INSTANCE:this}evaluate(t){return!t.getValue(this.c)}serialize(){return`!${this.c}`}keys(){return[this.c]}map(t){return t.mapNot(this.c)}negate(){return this.d||(this.d=xu.create(this.c,this)),this.d}};function Tf(e,t){if(typeof e=="string"){const i=parseFloat(e);isNaN(i)||(e=i)}return typeof e=="string"||typeof e=="number"?t(e):zi.INSTANCE}var Mf=class UN{static create(t,i,s=null){return Tf(i,r=>new UN(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=12}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))>this.d}serialize(){return`${this.c} > ${this.d}`}keys(){return[this.c]}map(t){return t.mapGreater(this.c,this.d)}negate(){return this.f||(this.f=O0.create(this.c,this.d,this)),this.f}},R0=class zN{static create(t,i,s=null){return Tf(i,r=>new zN(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=13}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))>=this.d}serialize(){return`${this.c} >= ${this.d}`}keys(){return[this.c]}map(t){return t.mapGreaterEquals(this.c,this.d)}negate(){return this.f||(this.f=L0.create(this.c,this.d,this)),this.f}},L0=class HN{static create(t,i,s=null){return Tf(i,r=>new HN(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=14}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))<this.d}serialize(){return`${this.c} < ${this.d}`}keys(){return[this.c]}map(t){return t.mapSmaller(this.c,this.d)}negate(){return this.f||(this.f=R0.create(this.c,this.d,this)),this.f}},O0=class WN{static create(t,i,s=null){return Tf(i,r=>new WN(t,r,s))}constructor(t,i,s){this.c=t,this.d=i,this.f=s,this.type=15}cmp(t){return t.type!==this.type?this.type-t.type:Xo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))<=this.d}serialize(){return`${this.c} <= ${this.d}`}keys(){return[this.c]}map(t){return t.mapSmallerEquals(this.c,this.d)}negate(){return this.f||(this.f=Mf.create(this.c,this.d,this)),this.f}},F0=class _N{static create(t,i){return new _N(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=7,this.c=null}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.d<t.d)return-1;if(this.d>t.d)return 1;const i=this.f?this.f.source:"",s=t.f?t.f.source:"";return i<s?-1:i>s?1:0}equals(t){if(t.type===this.type){const i=this.f?this.f.source:"",s=t.f?t.f.source:"";return this.d===t.d&&i===s}return!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.d);return this.f?this.f.test(i):!1}serialize(){const t=this.f?`/${this.f.source}/${this.f.flags}`:"/invalid/";return`${this.d} =~ ${t}`}keys(){return[this.d]}map(t){return t.mapRegex(this.d,this.f)}negate(){return this.c||(this.c=IU.create(this)),this.c}},IU=class jE{static create(t){return new jE(t)}constructor(t){this.c=t,this.type=8}cmp(t){return t.type!==this.type?this.type-t.type:this.c.cmp(t.c)}equals(t){return t.type===this.type?this.c.equals(t.c):!1}substituteConstants(){return this}evaluate(t){return!this.c.evaluate(t)}serialize(){return`!(${this.c.serialize()})`}keys(){return this.c.keys()}map(t){return new jE(this.c.map(t))}negate(){return this.c}};function I5(e){let t=null;for(let i=0,s=e.length;i<s;i++){const r=e[i].substituteConstants();if(e[i]!==r&&t===null){t=[];for(let n=0;n<i;n++)t[n]=e[n]}t!==null&&(t[i]=r)}return t===null?e:t}var D5=class Yl{static create(t,i,s){return Yl.d(t,i,s)}constructor(t,i){this.expr=t,this.c=i,this.type=6}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,s=this.expr.length;i<s;i++){const r=Eu(this.expr[i],t.expr[i]);if(r!==0)return r}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,s=this.expr.length;i<s;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=I5(this.expr);return t===this.expr?this:Yl.create(t,this.c,!1)}evaluate(t){for(let i=0,s=this.expr.length;i<s;i++)if(!this.expr[i].evaluate(t))return!1;return!0}static d(t,i,s){const r=[];let n=!1;for(const o of t)if(o){if(o.type===1){n=!0;continue}if(o.type===0)return zi.INSTANCE;if(o.type===6){r.push(...o.expr);continue}r.push(o)}if(r.length===0&&n)return is.INSTANCE;if(r.length!==0){if(r.length===1)return r[0];r.sort(Eu);for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];for(;r.length>1;){const o=r[r.length-1];if(o.type!==9)break;r.pop();const a=r.pop(),c=r.length===0,l=j0.create(o.expr.map(u=>Yl.create([u,a],null,s)),null,c);l&&(r.push(l),r.sort(Eu))}if(r.length===1)return r[0];if(s){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return zi.INSTANCE;if(r.length===1)return r[0]}return new Yl(r,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Yl(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.c){const t=[];for(const i of this.expr)t.push(i.negate());this.c=j0.create(t,this,!0)}return this.c}},j0=class Ja{static create(t,i,s){return Ja.d(t,i,s)}constructor(t,i){this.expr=t,this.c=i,this.type=9}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,s=this.expr.length;i<s;i++){const r=Eu(this.expr[i],t.expr[i]);if(r!==0)return r}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,s=this.expr.length;i<s;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=I5(this.expr);return t===this.expr?this:Ja.create(t,this.c,!1)}evaluate(t){for(let i=0,s=this.expr.length;i<s;i++)if(this.expr[i].evaluate(t))return!0;return!1}static d(t,i,s){let r=[],n=!1;if(t){for(let o=0,a=t.length;o<a;o++){const c=t[o];if(c){if(c.type===0){n=!0;continue}if(c.type===1)return is.INSTANCE;if(c.type===9){r=r.concat(c.expr);continue}r.push(c)}}if(r.length===0&&n)return zi.INSTANCE;r.sort(Eu)}if(r.length!==0){if(r.length===1)return r[0];for(let o=1;o<r.length;o++)r[o-1].equals(r[o])&&(r.splice(o,1),o--);if(r.length===1)return r[0];if(s){for(let o=0;o<r.length;o++)for(let a=o+1;a<r.length;a++)if(r[o].negate().equals(r[a]))return is.INSTANCE;if(r.length===1)return r[0]}return new Ja(r,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Ja(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.c){const t=[];for(const i of this.expr)t.push(i.negate());for(;t.length>1;){const i=t.shift(),s=t.shift(),r=[];for(const n of T5(i))for(const o of T5(s))r.push(D5.create([n,o],null,!1));t.unshift(Ja.create(r,null,!1))}this.c=Ja.create(t,this,!0)}return this.c}},C=class a1 extends xu{static{this.d=[]}static all(){return a1.d.values()}constructor(t,i,s){super(t,null),this.f=i,typeof s=="object"?a1.d.push({...s,key:t}):s!==!0&&a1.d.push({key:t,description:s,type:i!=null?typeof i:void 0})}bindTo(t){return t.createKey(this.key,this.f)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return M0.create(this.key,t)}notEqualsTo(t){return N0.create(this.key,t)}greater(t){return Mf.create(this.key,t)}},Jn=W("contextKeyService");function P5(e,t){return e<t?-1:e>t?1:0}function Xo(e,t,i,s){return e<i?-1:e>i?1:t<s?-1:t>s?1:0}function T5(e){return e.type===9?e.expr:[e]}var xe=W("logService"),Zn=W("loggerService"),K;(function(e){e[e.Off=0]="Off",e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error"})(K||(K={}));var DU=K.Info;function U0(e,t){return e!==K.Off&&e<=t}function PU(e,t,i){switch(t){case K.Trace:e.trace(i);break;case K.Debug:e.debug(i);break;case K.Info:e.info(i);break;case K.Warning:e.warn(i);break;case K.Error:e.error(i);break;case K.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function wc(e,t=!1){let i="";for(let s=0;s<e.length;s++){let r=e[s];if(r instanceof Error&&(r=yr(r,t)),typeof r=="object")try{r=JSON.stringify(r)}catch{}i+=(s>0?" ":"")+r}return i}var M5=class extends J{constructor(){super(...arguments),this.b=DU,this.c=this.D(new I)}get onDidChangeLogLevel(){return this.c.event}setLevel(e){this.b!==e&&(this.b=e,this.c.fire(this.b))}getLevel(){return this.b}f(e){return U0(this.b,e)}g(e){return this.B.isDisposed?!1:this.f(e)}},z0=class extends M5{constructor(e){super(),this.h=e}f(e){return this.h||super.f(e)}trace(e,...t){this.g(K.Trace)&&this.m(K.Trace,wc([e,...t],!0))}debug(e,...t){this.g(K.Debug)&&this.m(K.Debug,wc([e,...t]))}info(e,...t){this.g(K.Info)&&this.m(K.Info,wc([e,...t]))}warn(e,...t){this.g(K.Warning)&&this.m(K.Warning,wc([e,...t]))}error(e,...t){if(this.g(K.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.m(K.Error,wc(i))}else this.m(K.Error,wc([e,...t]))}flush(){}},TU=class extends M5{constructor(e){super(),this.h=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.h)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.h)i.trace(e,...t)}debug(e,...t){for(const i of this.h)i.debug(e,...t)}info(e,...t){for(const i of this.h)i.info(e,...t)}warn(e,...t){for(const i of this.h)i.warn(e,...t)}error(e,...t){for(const i of this.h)i.error(e,...t)}flush(){for(const e of this.h)e.flush()}dispose(){for(const e of this.h)e.dispose();super.dispose()}},MU=class extends J{constructor(e,t,i){if(super(),this.j=e,this.m=t,this.b=new Ct,this.f=this.D(new I),this.onDidChangeLoggers=this.f.event,this.g=this.D(new I),this.onDidChangeLogLevel=this.g.event,this.h=this.D(new I),this.onDidChangeVisibility=this.h.event,i)for(const s of i)this.b.set(s.resource,{logger:void 0,info:s})}n(e){return Oe(e)?[...this.b.values()].find(t=>t.info.id===e):this.b.get(e)}getLogger(e){return this.n(e)?.logger}createLogger(e,t){const i=this.q(e),s=Oe(e)?e:t?.id??Ar(i.toString()).toString(16);let r=this.b.get(i)?.logger;const n=t?.logLevel==="always"?K.Trace:t?.logLevel;r||(r=this.s(i,n??this.getLogLevel(i)??this.j,{...t,id:s}));const o={logger:r,info:{resource:i,id:s,logLevel:n,name:t?.name,hidden:t?.hidden,group:t?.group,extensionId:t?.extensionId,when:t?.when}};return this.registerLogger(o.info),this.b.set(i,o),r}q(e){return Oe(e)?Lt(this.m,`${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`):e}setLogLevel(e,t){if(y.isUri(e)){const i=e,s=t,r=this.b.get(i);r&&s!==r.info.logLevel&&(r.info.logLevel=s===this.j?void 0:s,r.logger?.setLevel(s),this.b.set(r.info.resource,r),this.g.fire([i,s]))}else{this.j=e;for(const[i,s]of this.b.entries())this.b.get(i)?.info.logLevel===void 0&&s.logger?.setLevel(this.j);this.g.fire(this.j)}}setVisibility(e,t){const i=this.n(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this.b.set(i.info.resource,i),this.h.fire([i.info.resource,t]))}getLogLevel(e){let t;return e&&(t=this.b.get(e)?.info.logLevel),t??this.j}registerLogger(e){const t=this.b.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this.b.set(e.resource,{info:e,logger:void 0}),this.f.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this.q(e),i=this.b.get(t);i&&(i.logger&&i.logger.dispose(),this.b.delete(t),this.f.fire({added:[],removed:[i.info]}))}*getRegisteredLoggers(){for(const e of this.b.values())yield e.info}getRegisteredLogger(e){return this.b.get(e)?.info}dispose(){this.b.forEach(e=>e.logger?.dispose()),this.b.clear(),super.dispose()}};function NU(e){switch(e){case K.Trace:return"trace";case K.Debug:return"debug";case K.Info:return"info";case K.Warning:return"warn";case K.Error:return"error";case K.Off:return"off"}}var yie=new C("logLevel",NU(K.Info)),Sr=class{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}},N5=[],R5;(function(e){e[e.Eager=0]="Eager",e[e.Delayed=1]="Delayed"})(R5||(R5={}));function Ne(e,t,i){t instanceof Sr||(t=new Sr(t,[],!!i)),N5.push([e,t])}function RU(){return N5}var H0=class{constructor(...e){this.a=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this.a.get(e);return this.a.set(e,t),i}has(e){return this.a.has(e)}get(e){return this.a.get(e)}},Wt=W("IExtHostInitDataService"),LU=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}},L5=class{constructor(e){this.b=e,this.a=new Map}roots(){const e=[];for(const t of this.a.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),s=this.lookupOrInsertNode(t);i.outgoing.set(s.key,s),s.incoming.set(i.key,i)}removeNode(e){const t=this.b(e);this.a.delete(t);for(const i of this.a.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this.b(e);let i=this.a.get(t);return i||(i=new LU(t,e),this.a.set(t,i)),i}lookup(e){return this.a.get(this.b(e))}isEmpty(){return this.a.size===0}toString(){const e=[];for(const[t,i]of this.a)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this.a){const i=new Set([e]),s=this.c(t,i);if(s)return s}}c(e,t){for(const[i,s]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const r=this.c(s,t);if(r)return r;t.delete(i)}}},OU=!1,O5=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},FU=class UE{constructor(t=new H0,i=!1,s,r=OU){this.i=t,this.j=i,this.k=s,this.l=r,this.f=!1,this.g=new Set,this.h=new Set,this.t=new Set,this.i.set(Yo,this),this._globalGraph=r?s?._globalGraph??new L5(n=>n):void 0}dispose(){if(!this.f){this.f=!0,Yi(this.h),this.h.clear();for(const t of this.g)kx(t)&&t.dispose();this.g.clear()}}m(){if(this.f)throw new Error("InstantiationService has been disposed")}createChild(t,i){this.m();const s=this,r=new class extends UE{dispose(){s.h.delete(r),super.dispose()}}(t,this.j,this,this.l);return this.h.add(r),i?.add(r),r}invokeFunction(t,...i){this.m();const s=W0.traceInvocation(this.l,t);let r=!1;try{return t({get:o=>{if(r)throw $1("service accessor is only valid during the invocation of its target method");const a=this.s(o,s);return a||this.y(`[invokeFunction] unknown service '${o}'`,!1),a}},...i)}finally{r=!0,s.stop()}}createInstance(t,...i){this.m();let s,r;return t instanceof Sr?(s=W0.traceCreation(this.l,t.ctor),r=this.o(t.ctor,t.staticArguments.concat(i),s)):(s=W0.traceCreation(this.l,t),r=this.o(t,i,s)),s.stop(),r}o(t,i=[],s){const r=Vs.getServiceDependencies(t).sort((a,c)=>a.index-c.index),n=[];for(const a of r){const c=this.s(a.id,s);c||this.y(`[createInstance] ${t.name} depends on UNKNOWN service ${a.id}.`,!1),n.push(c)}const o=r.length>0?r[0].index:i.length;if(i.length!==o){console.trace(`[createInstance] First service dependency of ${t.name} at position ${o+1} conflicts with ${i.length} static arguments`);const a=o-i.length;a>0?i=i.concat(new Array(a)):i=i.slice(0,o)}return Reflect.construct(t,i.concat(n))}q(t,i){if(this.i.get(t)instanceof Sr)this.i.set(t,i);else if(this.k)this.k.q(t,i);else throw new Error("illegalState - setting UNKNOWN service instance")}r(t){const i=this.i.get(t);return!i&&this.k?this.k.r(t):i}s(t,i){this._globalGraph&&this.c&&this._globalGraph.insertEdge(this.c,String(t));const s=this.r(t);return s instanceof Sr?this.u(t,s,i.branch(t,!0)):(i.branch(t,!1),s)}u(t,i,s){if(this.t.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this.t.add(t);try{return this.v(t,i,s)}finally{this.t.delete(t)}}v(t,i,s){const r=new L5(c=>c.id.toString());let n=0;const o=[{id:t,desc:i,_trace:s}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),r.lookupOrInsertNode(c),n++>1e3)throw new O5(r);for(const l of Vs.getServiceDependencies(c.desc.ctor)){const u=this.r(l.id);if(u||this.y(`[createInstance] ${t} depends on ${l.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(c.id),String(l.id)),u instanceof Sr){const h={id:l.id,desc:u,_trace:c._trace.branch(l.id,!0)};r.insertEdge(c,h),o.push(h)}}}}for(;;){const c=r.roots();if(c.length===0){if(!r.isEmpty())throw new O5(r);break}for(const{data:l}of c){if(this.r(l.id)instanceof Sr){const h=this.w(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this.q(l.id,h)}r.removeNode(l)}}return this.r(t)}w(t,i,s=[],r,n){if(this.i.get(t)instanceof Sr)return this.x(t,i,s,r,n,this.g);if(this.k)return this.k.w(t,i,s,r,n);throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}x(t,i,s=[],r,n,o){if(r){const a=new UE(void 0,this.j,this,this.l);a.c=String(t);const c=new Map,l=new UO(()=>{const u=a.o(i,s,n);for(const[h,f]of c){const p=u[h];if(typeof p=="function")for(const g of f)g.disposable=p.apply(u,g.listener)}return c.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,h){if(!l.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let g=c.get(h);return g||(g=new Pn,c.set(h,g)),(b,S,E)=>{if(l.isInitialized)return l.value[h](b,S,E);{const k={listener:[b,S,E],disposable:void 0},O=g.push(k);return se(()=>{O(),k.disposable?.dispose()})}}}if(h in u)return u[h];const f=l.value;let p=f[h];return typeof p!="function"||(p=p.bind(f),u[h]=p),p},set(u,h,f){return l.value[h]=f,!0},getPrototypeOf(u){return i.prototype}})}else{const a=this.o(i,s,n);return o.add(a),a}}y(t,i){if(i&&console.warn(t),this.j)throw new Error(t)}},F5;(function(e){e[e.None=0]="None",e[e.Creation=1]="Creation",e[e.Invocation=2]="Invocation",e[e.Branch=3]="Branch"})(F5||(F5={}));var W0=class Wr{static{this.all=new Set}static{this.c=new class extends Wr{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(t,i){return t?new Wr(2,i.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Wr.c}static traceCreation(t,i){return t?new Wr(1,i.name):Wr.c}static{this.f=0}constructor(t,i){this.type=t,this.name=i,this.g=Date.now(),this.h=[]}branch(t,i){const s=new Wr(3,t.toString());return this.h.push([t,i,s]),s}stop(){const t=Date.now()-this.g;Wr.f+=t;let i=!1;function s(n,o){const a=[],c=new Array(n+1).join("	");for(const[l,u,h]of o.h)if(u&&h){i=!0,a.push(`${c}CREATES -> ${l}`);const f=s(n+1,h);f&&a.push(f)}else a.push(`${c}uses -> ${l}`);return a.join(`
`)}const r=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${s(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${Wr.f.toFixed(2)}ms)`];(t>2||i)&&Wr.all.add(r.join(`
`))}},Te=W("IExtHostRpcService"),jU=class{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}},ku=W("IURITransformerService"),UU=class{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}},zU=class{constructor(){this.b="",this.c=0}reset(e){return this.b=e,this.c=0,this}next(){return this.c+=1,this}hasNext(){return this.c<this.b.length-1}cmp(e){const t=e.charCodeAt(0),i=this.b.charCodeAt(this.c);return t-i}value(){return this.b[this.c]}},HU=class{constructor(e=!0){this.e=e}reset(e){return this.b=e,this.c=0,this.d=0,this.next()}hasNext(){return this.d<this.b.length}next(){this.c=this.d;let e=!0;for(;this.d<this.b.length;this.d++)if(this.b.charCodeAt(this.d)===46)if(e)this.c++;else break;else e=!1;return this}cmp(e){return this.e?V1(e,this.b,0,e.length,this.c,this.d):cc(e,this.b,0,e.length,this.c,this.d)}value(){return this.b.substring(this.c,this.d)}},j5=class{constructor(e=!0,t=!0){this.f=e,this.g=t}reset(e){this.d=0,this.e=0,this.b=e,this.c=e.length;for(let t=e.length-1;t>=0;t--,this.c--){const i=this.b.charCodeAt(t);if(!(i===47||this.f&&i===92))break}return this.next()}hasNext(){return this.e<this.c}next(){this.d=this.e;let e=!0;for(;this.e<this.c;this.e++){const t=this.b.charCodeAt(this.e);if(t===47||this.f&&t===92)if(e)this.d++;else break;else e=!1}return this}cmp(e){return this.g?V1(e,this.b,0,e.length,this.d,this.e):cc(e,this.b,0,e.length,this.d,this.e)}value(){return this.b.substring(this.d,this.e)}},U5;(function(e){e[e.Scheme=1]="Scheme",e[e.Authority=2]="Authority",e[e.Path=3]="Path",e[e.Query=4]="Query",e[e.Fragment=5]="Fragment"})(U5||(U5={}));var z5=class{constructor(e,t){this.f=e,this.g=t,this.d=[],this.e=0}reset(e){return this.c=e,this.d=[],this.c.scheme&&this.d.push(1),this.c.authority&&this.d.push(2),this.c.path&&(this.b=new j5(!1,!this.f(e)),this.b.reset(e.path),this.b.value()&&this.d.push(3)),this.g(e)||(this.c.query&&this.d.push(4),this.c.fragment&&this.d.push(5)),this.e=0,this}next(){return this.d[this.e]===3&&this.b.hasNext()?this.b.next():this.e+=1,this}hasNext(){return this.d[this.e]===3&&this.b.hasNext()||this.e<this.d.length-1}cmp(e){if(this.d[this.e]===1)return G1(e,this.c.scheme);if(this.d[this.e]===2)return G1(e,this.c.authority);if(this.d[this.e]===3)return this.b.cmp(e);if(this.d[this.e]===4)return _o(e,this.c.query);if(this.d[this.e]===5)return _o(e,this.c.fragment);throw new Error}value(){if(this.d[this.e]===1)return this.c.scheme;if(this.d[this.e]===2)return this.c.authority;if(this.d[this.e]===3)return this.b.value();if(this.d[this.e]===4)return this.c.query;if(this.d[this.e]===5)return this.c.fragment;throw new Error}},Ko=class zE{static{this.Val=Symbol("undefined_placeholder")}static wrap(t){return t===void 0?zE.Val:t}static unwrap(t){return t===zE.Val?void 0:t}},Nf=class{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}},H5;(function(e){e[e.Left=-1]="Left",e[e.Mid=0]="Mid",e[e.Right=1]="Right"})(H5||(H5={}));var Yn=class Hd{static forUris(t=()=>!1,i=()=>!1){return new Hd(new z5(t,i))}static forPaths(t=!1){return new Hd(new j5(void 0,!t))}static forStrings(){return new Hd(new zU)}static forConfigKeys(){return new Hd(new HU)}constructor(t){this.b=t}clear(){this.c=void 0}fill(t,i){if(i){const s=i.slice(0);mx(s);for(const r of s)this.set(r,t)}else{const s=t.slice(0);mx(s);for(const r of s)this.set(r[0],r[1])}}set(t,i){const s=this.b.reset(t);let r;this.c||(this.c=new Nf,this.c.segment=s.value());const n=[];for(r=this.c;;){const a=s.cmp(r.segment);if(a>0)r.left||(r.left=new Nf,r.left.segment=s.value()),n.push([-1,r]),r=r.left;else if(a<0)r.right||(r.right=new Nf,r.right.segment=s.value()),n.push([1,r]),r=r.right;else if(s.hasNext())s.next(),r.mid||(r.mid=new Nf,r.mid.segment=s.value()),n.push([0,r]),r=r.mid;else break}const o=Ko.unwrap(r.value);r.value=Ko.wrap(i),r.key=t;for(let a=n.length-1;a>=0;a--){const c=n[a][1];c.updateHeight();const l=c.balanceFactor();if(l<-1||l>1){const u=n[a][0],h=n[a+1][0];if(u===1&&h===1)n[a][1]=c.rotateLeft();else if(u===-1&&h===-1)n[a][1]=c.rotateRight();else if(u===1&&h===-1)c.right=n[a+1][1]=n[a+1][1].rotateRight(),n[a][1]=c.rotateLeft();else if(u===-1&&h===1)c.left=n[a+1][1]=n[a+1][1].rotateLeft(),n[a][1]=c.rotateRight();else throw new Error;if(a>0)switch(n[a-1][0]){case-1:n[a-1][1].left=n[a][1];break;case 1:n[a-1][1].right=n[a][1];break;case 0:n[a-1][1].mid=n[a][1];break}else this.c=n[0][1]}}return o}get(t){return Ko.unwrap(this.d(t)?.value)}d(t){const i=this.b.reset(t);let s=this.c;for(;s;){const r=i.cmp(s.segment);if(r>0)s=s.left;else if(r<0)s=s.right;else if(i.hasNext())i.next(),s=s.mid;else break}return s}has(t){const i=this.d(t);return!(i?.value===void 0&&i?.mid===void 0)}delete(t){return this.e(t,!1)}deleteSuperstr(t){return this.e(t,!0)}e(t,i){const s=this.b.reset(t),r=[];let n=this.c;for(;n;){const o=s.cmp(n.segment);if(o>0)r.push([-1,n]),n=n.left;else if(o<0)r.push([1,n]),n=n.right;else if(s.hasNext())s.next(),r.push([0,n]),n=n.mid;else break}if(n){if(i?(n.left=void 0,n.mid=void 0,n.right=void 0,n.height=1):(n.key=void 0,n.value=void 0),!n.mid&&!n.value)if(n.left&&n.right){const o=[[1,n]],a=this.f(n.right,o);if(a.key){n.key=a.key,n.value=a.value,n.segment=a.segment;const c=a.right;if(o.length>1){const[u,h]=o[o.length-1];switch(u){case-1:h.left=c;break;case 0:N1(!1);case 1:N1(!1)}}else n.right=c;const l=this.g(o);if(r.length>0){const[u,h]=r[r.length-1];switch(u){case-1:h.left=l;break;case 0:h.mid=l;break;case 1:h.right=l;break}}else this.c=l}}else{const o=n.left??n.right;if(r.length>0){const[a,c]=r[r.length-1];switch(a){case-1:c.left=o;break;case 0:c.mid=o;break;case 1:c.right=o;break}}else this.c=o}this.c=this.g(r)??this.c}}f(t,i){for(;t.left;)i.push([-1,t]),t=t.left;return t}g(t){for(let i=t.length-1;i>=0;i--){const s=t[i][1];s.updateHeight();const r=s.balanceFactor();if(r>1?(s.right.balanceFactor()>=0||(s.right=s.right.rotateRight()),t[i][1]=s.rotateLeft()):r<-1&&(s.left.balanceFactor()<=0||(s.left=s.left.rotateLeft()),t[i][1]=s.rotateRight()),i>0)switch(t[i-1][0]){case-1:t[i-1][1].left=t[i][1];break;case 1:t[i-1][1].right=t[i][1];break;case 0:t[i-1][1].mid=t[i][1];break}else return t[0][1]}}findSubstr(t){const i=this.b.reset(t);let s=this.c,r;for(;s;){const n=i.cmp(s.segment);if(n>0)s=s.left;else if(n<0)s=s.right;else if(i.hasNext())i.next(),r=Ko.unwrap(s.value)||r,s=s.mid;else break}return s&&Ko.unwrap(s.value)||r}findSuperstr(t){return this.h(t,!1)}h(t,i){const s=this.b.reset(t);let r=this.c;for(;r;){const n=s.cmp(r.segment);if(n>0)r=r.left;else if(n<0)r=r.right;else if(s.hasNext())s.next(),r=r.mid;else return r.mid?this.j(r.mid):i?Ko.unwrap(r.value):void 0}}hasElementOrSubtree(t){return this.h(t,!0)!==void 0}forEach(t){for(const[i,s]of this)t(s,i)}*[Symbol.iterator](){yield*this.j(this.c)}j(t){const i=[];return this.l(t,i),i[Symbol.iterator]()}l(t,i){t&&(t.left&&this.l(t.left,i),t.value!==void 0&&i.push([t.key,Ko.unwrap(t.value)]),t.mid&&this.l(t.mid,i),t.right&&this.l(t.right,i))}_isBalanced(){const t=i=>{if(!i)return!0;const s=i.balanceFactor();return s<-1||s>1?!1:t(i.left)&&t(i.right)};return t(this.c)}};function WU(e,t,i){return Math.min(Math.max(e,t),i)}var _U=class{constructor(){this.a=0}getNext(){return this.a++}},BU=class{constructor(){this.a=1,this.b=0}update(e){return this.b=this.b+(e-this.b)/this.a,this.a+=1,this.b}get value(){return this.b}},$u;(function(e){e[e.Ignore=0]="Ignore",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})($u||($u={})),(function(e){const t="error",i="warning",s="warn",r="info",n="ignore";function o(c){return c?gs(t,c)?e.Error:gs(i,c)||gs(s,c)?e.Warning:gs(r,c)?e.Info:e.Ignore:e.Ignore}e.fromValue=o;function a(c){switch(c){case e.Error:return t;case e.Warning:return i;case e.Info:return r;default:return n}}e.toString=a})($u||($u={}));var rt=$u,qU=rt,Aie=W("notificationService"),W5;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.SILENT=2]="SILENT",e[e.URGENT=3]="URGENT"})(W5||(W5={}));var _5;(function(e){e[e.WORKSPACE=0]="WORKSPACE",e[e.PROFILE=1]="PROFILE",e[e.APPLICATION=2]="APPLICATION"})(_5||(_5={}));var B5;(function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR"})(B5||(B5={}));var Iu=W("contextService");function VU(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.uri)}function GU(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.configPath)}var q5;(function(e){e[e.EMPTY=1]="EMPTY",e[e.FOLDER=2]="FOLDER",e[e.WORKSPACE=3]="WORKSPACE"})(q5||(q5={}));var JU=class{get folders(){return this.g}set folders(e){this.g=e,this.o()}constructor(e,t,i,s,r,n){this.h=e,this.j=i,this.k=s,this.l=r,this.n=n,this.c=Yn.forUris(this.l,()=>!0),this.folders=t}update(e){this.h=e.id,this.k=e.configuration,this.j=e.transient,this.l=e.l,this.n=e.isAgentSessionsWorkspace,this.folders=e.folders}get id(){return this.h}get transient(){return this.j}get configuration(){return this.k}set configuration(e){this.k=e}get isAgentSessionsWorkspace(){return this.n}getFolder(e){return e&&this.c.findSubstr(e)||null}o(){this.c=Yn.forUris(this.l,()=>!0);for(const e of this.folders)this.c.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration,isAgentSessionsWorkspace:this.isAgentSessionsWorkspace}}},_0=class{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return Lt(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}};function B0(e){return new _0({uri:e,index:0,name:t0(e)},{uri:e.toString()})}var V5="code-workspace",ZU=`.${V5}`,Sie=[{name:d(2778,null),extensions:[V5]}];function YU(e){return(typeof e=="string"?lf(e):CC(e))===ZU}var QU=class{constructor(){this.a=new Set(Object.keys(V)),this.b=new Map,this.extUri=new uc(e=>{const t=this.b.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this.b.delete(e.scheme):this.b.set(e.scheme,t)}isFreeScheme(e){return!this.b.has(e)&&!this.a.has(e)}getCapabilities(e){return this.b.get(e)}},bc=W("IExtHostFileSystemInfo"),q0=Object.freeze({create:e=>Ro(e.map(t=>t.toString())).join(`\r
`),split:e=>e.split(`\r
`),parse:e=>q0.split(e).filter(t=>!t.startsWith("#"))}),Eie=new Uint32Array(10),G5;(function(e){e[e.InitialConsonant=4352]="InitialConsonant",e[e.Vowel=4449]="Vowel",e[e.FinalConsonant=4520]="FinalConsonant",e[e.CompatibilityJamo=12593]="CompatibilityJamo"})(G5||(G5={}));var J5;(function(e){e[e.NUL=0]="NUL",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z"})(J5||(J5={}));var Z5;(function(e){e[e.fa=24934]="fa",e[e.fg=26470]="fg",e[e.fq=29030]="fq",e[e.fr=29286]="fr",e[e.ft=29798]="ft",e[e.fv=30310]="fv",e[e.fx=30822]="fx",e[e.hk=27496]="hk",e[e.hl=27752]="hl",e[e.ho=28520]="ho",e[e.ml=27757]="ml",e[e.nj=27246]="nj",e[e.nl=27758]="nl",e[e.np=28782]="np",e[e.qt=29809]="qt",e[e.rt=29810]="rt",e[e.sg=26483]="sg",e[e.sw=30579]="sw"})(Z5||(Z5={}));var xie=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Cie=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),kie=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),$ie=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function Y5(...e){return function(t,i){for(let s=0,r=e.length;s<r;s++){const n=e[s](t,i);if(n)return n}return null}}var Iie=Q5.bind(void 0,!1),V0=Q5.bind(void 0,!0);function Q5(e,t,i){if(!i||i.length<t.length)return null;let s;return e?s=uf(i,t):s=i.indexOf(t)===0,s?t.length>0?[{start:0,end:t.length}]:[]:null}function XU(e,t){if(e.length>t.length)return null;const i=t.toLowerCase().indexOf(e.toLowerCase());return i===-1?null:[{start:i,end:i+e.length}]}function KU(e,t){return e.length>t.length?null:G0(e.toLowerCase(),t.toLowerCase(),0,0)}function G0(e,t,i,s){if(i===e.length)return[];if(s===t.length)return null;if(e[i]===t[s]){let r=null;return(r=G0(e,t,i+1,s+1))?K5({start:s,end:s+1},r):null}return G0(e,t,i,s+1)}function J0(e){return 97<=e&&e<=122}function Du(e){return 65<=e&&e<=90}function Z0(e){return 48<=e&&e<=57}function ez(e){return e===32||e===9||e===10||e===13}var tz=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(e=>tz.add(e.charCodeAt(0)));function X5(e){return J0(e)||Du(e)||Z0(e)}function K5(e,t){return t.length===0?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function e$(e,t){for(let i=t;i<e.length;i++){const s=e.charCodeAt(i);if(Du(s)||Z0(s)||i>0&&!X5(e.charCodeAt(i-1)))return i}return e.length}function Y0(e,t,i,s){if(i===e.length)return[];if(s===t.length)return null;if(e[i]!==t[s].toLowerCase())return null;{let r=null,n=s+1;for(r=Y0(e,t,i+1,s+1);!r&&(n=e$(t,n))<t.length;)r=Y0(e,t,i+1,n),n++;return r===null?null:K5({start:s,end:s+1},r)}}function iz(e){let t=0,i=0,s=0,r=0,n=0;for(let u=0;u<e.length;u++)n=e.charCodeAt(u),Du(n)&&t++,J0(n)&&i++,X5(n)&&s++,Z0(n)&&r++;const o=t/e.length,a=i/e.length,c=s/e.length,l=r/e.length;return{upperPercent:o,lowerPercent:a,alphaPercent:c,numericPercent:l}}function sz(e){const{upperPercent:t,lowerPercent:i}=e;return i===0&&t>.6}function rz(e){const{upperPercent:t,lowerPercent:i,alphaPercent:s,numericPercent:r}=e;return i>.2&&t<.8&&s>.6&&r<.2}function nz(e){let t=0,i=0,s=0,r=0;for(let n=0;n<e.length;n++)s=e.charCodeAt(n),Du(s)&&t++,J0(s)&&i++,ez(s)&&r++;return(t===0||i===0)&&r===0?e.length<=30:t<=5}function t$(e,t){if(!t||(t=t.trim(),t.length===0)||!nz(e))return null;t.length>60&&(t=t.substring(0,60));const i=iz(t);if(!rz(i)){if(!sz(i))return null;t=t.toLowerCase()}let s=null,r=0;for(e=e.toLowerCase();r<t.length&&(s=Y0(e,t,0,r))===null;)r=e$(t,r+1);return s}var Die=Y5(V0,t$,XU),Pie=Y5(V0,t$,KU),Tie=new ic(1e4),Rf=128;function Q0(){const e=[],t=[];for(let i=0;i<=Rf;i++)t[i]=0;for(let i=0;i<=Rf;i++)e.push(t.slice(0));return e}function i$(e){const t=[];for(let i=0;i<=e;i++)t[i]=0;return t}var Mie=i$(2*Rf),Nie=i$(2*Rf),Rie=Q0(),Lie=Q0(),Oie=Q0(),s$;(function(e){e[e.Diag=1]="Diag",e[e.Left=2]="Left",e[e.LeftLeft=3]="LeftLeft"})(s$||(s$={}));var r$;(function(e){e.Default=[-100,0];function t(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}e.isDefault=t})(r$||(r$={}));var Fie=class{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}},X0=Object.create(null);function m(e,t){if(Oe(t)){const i=X0[t];if(i===void 0)throw new Error(`${e} references an unknown codicon: ${t}`);t=i}return X0[e]=t,{id:e}}function oz(){return X0}var az={add:m("add",6e4),plus:m("plus",6e4),gistNew:m("gist-new",6e4),repoCreate:m("repo-create",6e4),lightbulb:m("lightbulb",60001),lightBulb:m("light-bulb",60001),repo:m("repo",60002),repoDelete:m("repo-delete",60002),gistFork:m("gist-fork",60003),repoForked:m("repo-forked",60003),gitPullRequest:m("git-pull-request",60004),gitPullRequestAbandoned:m("git-pull-request-abandoned",60004),recordKeys:m("record-keys",60005),keyboard:m("keyboard",60005),tag:m("tag",60006),gitPullRequestLabel:m("git-pull-request-label",60006),tagAdd:m("tag-add",60006),tagRemove:m("tag-remove",60006),person:m("person",60007),personFollow:m("person-follow",60007),personOutline:m("person-outline",60007),personFilled:m("person-filled",60007),sourceControl:m("source-control",60008),mirror:m("mirror",60009),mirrorPublic:m("mirror-public",60009),star:m("star",60010),starAdd:m("star-add",60010),starDelete:m("star-delete",60010),starEmpty:m("star-empty",60010),comment:m("comment",60011),commentAdd:m("comment-add",60011),alert:m("alert",60012),warning:m("warning",60012),search:m("search",60013),searchSave:m("search-save",60013),logOut:m("log-out",60014),signOut:m("sign-out",60014),logIn:m("log-in",60015),signIn:m("sign-in",60015),eye:m("eye",60016),eyeUnwatch:m("eye-unwatch",60016),eyeWatch:m("eye-watch",60016),circleFilled:m("circle-filled",60017),primitiveDot:m("primitive-dot",60017),closeDirty:m("close-dirty",60017),debugBreakpoint:m("debug-breakpoint",60017),debugBreakpointDisabled:m("debug-breakpoint-disabled",60017),debugHint:m("debug-hint",60017),terminalDecorationSuccess:m("terminal-decoration-success",60017),primitiveSquare:m("primitive-square",60018),edit:m("edit",60019),pencil:m("pencil",60019),info:m("info",60020),issueOpened:m("issue-opened",60020),gistPrivate:m("gist-private",60021),gitForkPrivate:m("git-fork-private",60021),lock:m("lock",60021),mirrorPrivate:m("mirror-private",60021),close:m("close",60022),removeClose:m("remove-close",60022),x:m("x",60022),repoSync:m("repo-sync",60023),sync:m("sync",60023),clone:m("clone",60024),desktopDownload:m("desktop-download",60024),beaker:m("beaker",60025),microscope:m("microscope",60025),vm:m("vm",60026),deviceDesktop:m("device-desktop",60026),file:m("file",60027),more:m("more",60028),ellipsis:m("ellipsis",60028),kebabHorizontal:m("kebab-horizontal",60028),mailReply:m("mail-reply",60029),reply:m("reply",60029),organization:m("organization",60030),organizationFilled:m("organization-filled",60030),organizationOutline:m("organization-outline",60030),newFile:m("new-file",60031),fileAdd:m("file-add",60031),newFolder:m("new-folder",60032),fileDirectoryCreate:m("file-directory-create",60032),trash:m("trash",60033),trashcan:m("trashcan",60033),history:m("history",60034),clock:m("clock",60034),folder:m("folder",60035),fileDirectory:m("file-directory",60035),symbolFolder:m("symbol-folder",60035),logoGithub:m("logo-github",60036),markGithub:m("mark-github",60036),github:m("github",60036),terminal:m("terminal",60037),console:m("console",60037),repl:m("repl",60037),zap:m("zap",60038),symbolEvent:m("symbol-event",60038),error:m("error",60039),stop:m("stop",60039),variable:m("variable",60040),symbolVariable:m("symbol-variable",60040),array:m("array",60042),symbolArray:m("symbol-array",60042),symbolModule:m("symbol-module",60043),symbolPackage:m("symbol-package",60043),symbolNamespace:m("symbol-namespace",60043),symbolObject:m("symbol-object",60043),symbolMethod:m("symbol-method",60044),symbolFunction:m("symbol-function",60044),symbolConstructor:m("symbol-constructor",60044),symbolBoolean:m("symbol-boolean",60047),symbolNull:m("symbol-null",60047),symbolNumeric:m("symbol-numeric",60048),symbolNumber:m("symbol-number",60048),symbolStructure:m("symbol-structure",60049),symbolStruct:m("symbol-struct",60049),symbolParameter:m("symbol-parameter",60050),symbolTypeParameter:m("symbol-type-parameter",60050),symbolKey:m("symbol-key",60051),symbolText:m("symbol-text",60051),symbolReference:m("symbol-reference",60052),goToFile:m("go-to-file",60052),symbolEnum:m("symbol-enum",60053),symbolValue:m("symbol-value",60053),symbolRuler:m("symbol-ruler",60054),symbolUnit:m("symbol-unit",60054),activateBreakpoints:m("activate-breakpoints",60055),archive:m("archive",60056),arrowBoth:m("arrow-both",60057),arrowDown:m("arrow-down",60058),arrowLeft:m("arrow-left",60059),arrowRight:m("arrow-right",60060),arrowSmallDown:m("arrow-small-down",60061),arrowSmallLeft:m("arrow-small-left",60062),arrowSmallRight:m("arrow-small-right",60063),arrowSmallUp:m("arrow-small-up",60064),arrowUp:m("arrow-up",60065),bell:m("bell",60066),bold:m("bold",60067),book:m("book",60068),bookmark:m("bookmark",60069),debugBreakpointConditionalUnverified:m("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:m("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:m("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:m("debug-breakpoint-data-unverified",60072),debugBreakpointData:m("debug-breakpoint-data",60073),debugBreakpointDataDisabled:m("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:m("debug-breakpoint-log-unverified",60074),debugBreakpointLog:m("debug-breakpoint-log",60075),debugBreakpointLogDisabled:m("debug-breakpoint-log-disabled",60075),briefcase:m("briefcase",60076),broadcast:m("broadcast",60077),browser:m("browser",60078),bug:m("bug",60079),calendar:m("calendar",60080),caseSensitive:m("case-sensitive",60081),check:m("check",60082),checklist:m("checklist",60083),chevronDown:m("chevron-down",60084),chevronLeft:m("chevron-left",60085),chevronRight:m("chevron-right",60086),chevronUp:m("chevron-up",60087),chromeClose:m("chrome-close",60088),chromeMaximize:m("chrome-maximize",60089),chromeMinimize:m("chrome-minimize",60090),chromeRestore:m("chrome-restore",60091),circleOutline:m("circle-outline",60092),circle:m("circle",60092),debugBreakpointUnverified:m("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:m("terminal-decoration-incomplete",60092),circleSlash:m("circle-slash",60093),circuitBoard:m("circuit-board",60094),clearAll:m("clear-all",60095),clippy:m("clippy",60096),closeAll:m("close-all",60097),cloudDownload:m("cloud-download",60098),cloudUpload:m("cloud-upload",60099),code:m("code",60100),collapseAll:m("collapse-all",60101),colorMode:m("color-mode",60102),commentDiscussion:m("comment-discussion",60103),creditCard:m("credit-card",60105),dash:m("dash",60108),dashboard:m("dashboard",60109),database:m("database",60110),debugContinue:m("debug-continue",60111),debugDisconnect:m("debug-disconnect",60112),debugPause:m("debug-pause",60113),debugRestart:m("debug-restart",60114),debugStart:m("debug-start",60115),debugStepInto:m("debug-step-into",60116),debugStepOut:m("debug-step-out",60117),debugStepOver:m("debug-step-over",60118),debugStop:m("debug-stop",60119),debug:m("debug",60120),deviceCameraVideo:m("device-camera-video",60121),deviceCamera:m("device-camera",60122),deviceMobile:m("device-mobile",60123),diffAdded:m("diff-added",60124),diffIgnored:m("diff-ignored",60125),diffModified:m("diff-modified",60126),diffRemoved:m("diff-removed",60127),diffRenamed:m("diff-renamed",60128),diff:m("diff",60129),diffSidebyside:m("diff-sidebyside",60129),discard:m("discard",60130),editorLayout:m("editor-layout",60131),emptyWindow:m("empty-window",60132),exclude:m("exclude",60133),extensions:m("extensions",60134),eyeClosed:m("eye-closed",60135),fileBinary:m("file-binary",60136),fileCode:m("file-code",60137),fileMedia:m("file-media",60138),filePdf:m("file-pdf",60139),fileSubmodule:m("file-submodule",60140),fileSymlinkDirectory:m("file-symlink-directory",60141),fileSymlinkFile:m("file-symlink-file",60142),fileZip:m("file-zip",60143),files:m("files",60144),filter:m("filter",60145),flame:m("flame",60146),foldDown:m("fold-down",60147),foldUp:m("fold-up",60148),fold:m("fold",60149),folderActive:m("folder-active",60150),folderOpened:m("folder-opened",60151),gear:m("gear",60152),gift:m("gift",60153),gistSecret:m("gist-secret",60154),gist:m("gist",60155),gitCommit:m("git-commit",60156),gitCompare:m("git-compare",60157),compareChanges:m("compare-changes",60157),gitMerge:m("git-merge",60158),githubAction:m("github-action",60159),githubAlt:m("github-alt",60160),globe:m("globe",60161),grabber:m("grabber",60162),graph:m("graph",60163),gripper:m("gripper",60164),heart:m("heart",60165),home:m("home",60166),horizontalRule:m("horizontal-rule",60167),hubot:m("hubot",60168),inbox:m("inbox",60169),issueReopened:m("issue-reopened",60171),issues:m("issues",60172),italic:m("italic",60173),jersey:m("jersey",60174),json:m("json",60175),bracket:m("bracket",60175),kebabVertical:m("kebab-vertical",60176),key:m("key",60177),law:m("law",60178),lightbulbAutofix:m("lightbulb-autofix",60179),linkExternal:m("link-external",60180),link:m("link",60181),listOrdered:m("list-ordered",60182),listUnordered:m("list-unordered",60183),liveShare:m("live-share",60184),loading:m("loading",60185),location:m("location",60186),mailRead:m("mail-read",60187),mail:m("mail",60188),markdown:m("markdown",60189),megaphone:m("megaphone",60190),mention:m("mention",60191),milestone:m("milestone",60192),gitPullRequestMilestone:m("git-pull-request-milestone",60192),mortarBoard:m("mortar-board",60193),move:m("move",60194),multipleWindows:m("multiple-windows",60195),mute:m("mute",60196),noNewline:m("no-newline",60197),note:m("note",60198),octoface:m("octoface",60199),openPreview:m("open-preview",60200),package:m("package",60201),paintcan:m("paintcan",60202),pin:m("pin",60203),play:m("play",60204),run:m("run",60204),plug:m("plug",60205),preserveCase:m("preserve-case",60206),preview:m("preview",60207),project:m("project",60208),pulse:m("pulse",60209),question:m("question",60210),quote:m("quote",60211),radioTower:m("radio-tower",60212),reactions:m("reactions",60213),references:m("references",60214),refresh:m("refresh",60215),regex:m("regex",60216),remoteExplorer:m("remote-explorer",60217),remote:m("remote",60218),remove:m("remove",60219),replaceAll:m("replace-all",60220),replace:m("replace",60221),repoClone:m("repo-clone",60222),repoForcePush:m("repo-force-push",60223),repoPull:m("repo-pull",60224),repoPush:m("repo-push",60225),report:m("report",60226),requestChanges:m("request-changes",60227),rocket:m("rocket",60228),rootFolderOpened:m("root-folder-opened",60229),rootFolder:m("root-folder",60230),rss:m("rss",60231),ruby:m("ruby",60232),saveAll:m("save-all",60233),saveAs:m("save-as",60234),save:m("save",60235),screenFull:m("screen-full",60236),screenNormal:m("screen-normal",60237),searchStop:m("search-stop",60238),server:m("server",60240),settingsGear:m("settings-gear",60241),settings:m("settings",60242),shield:m("shield",60243),smiley:m("smiley",60244),sortPrecedence:m("sort-precedence",60245),splitHorizontal:m("split-horizontal",60246),splitVertical:m("split-vertical",60247),squirrel:m("squirrel",60248),starFull:m("star-full",60249),starHalf:m("star-half",60250),symbolClass:m("symbol-class",60251),symbolColor:m("symbol-color",60252),symbolConstant:m("symbol-constant",60253),symbolEnumMember:m("symbol-enum-member",60254),symbolField:m("symbol-field",60255),symbolFile:m("symbol-file",60256),symbolInterface:m("symbol-interface",60257),symbolKeyword:m("symbol-keyword",60258),symbolMisc:m("symbol-misc",60259),symbolOperator:m("symbol-operator",60260),symbolProperty:m("symbol-property",60261),wrench:m("wrench",60261),wrenchSubaction:m("wrench-subaction",60261),symbolSnippet:m("symbol-snippet",60262),tasklist:m("tasklist",60263),telescope:m("telescope",60264),textSize:m("text-size",60265),threeBars:m("three-bars",60266),thumbsdown:m("thumbsdown",60267),thumbsup:m("thumbsup",60268),tools:m("tools",60269),triangleDown:m("triangle-down",60270),triangleLeft:m("triangle-left",60271),triangleRight:m("triangle-right",60272),triangleUp:m("triangle-up",60273),twitter:m("twitter",60274),unfold:m("unfold",60275),unlock:m("unlock",60276),unmute:m("unmute",60277),unverified:m("unverified",60278),verified:m("verified",60279),versions:m("versions",60280),vmActive:m("vm-active",60281),vmOutline:m("vm-outline",60282),vmRunning:m("vm-running",60283),watch:m("watch",60284),whitespace:m("whitespace",60285),wholeWord:m("whole-word",60286),window:m("window",60287),wordWrap:m("word-wrap",60288),zoomIn:m("zoom-in",60289),zoomOut:m("zoom-out",60290),listFilter:m("list-filter",60291),listFlat:m("list-flat",60292),listSelection:m("list-selection",60293),selection:m("selection",60293),listTree:m("list-tree",60294),debugBreakpointFunctionUnverified:m("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:m("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:m("debug-breakpoint-function-disabled",60296),debugStackframeActive:m("debug-stackframe-active",60297),circleSmallFilled:m("circle-small-filled",60298),debugStackframeDot:m("debug-stackframe-dot",60298),terminalDecorationMark:m("terminal-decoration-mark",60298),debugStackframe:m("debug-stackframe",60299),debugStackframeFocused:m("debug-stackframe-focused",60299),debugBreakpointUnsupported:m("debug-breakpoint-unsupported",60300),symbolString:m("symbol-string",60301),debugReverseContinue:m("debug-reverse-continue",60302),debugStepBack:m("debug-step-back",60303),debugRestartFrame:m("debug-restart-frame",60304),debugAlt:m("debug-alt",60305),callIncoming:m("call-incoming",60306),callOutgoing:m("call-outgoing",60307),menu:m("menu",60308),expandAll:m("expand-all",60309),feedback:m("feedback",60310),gitPullRequestReviewer:m("git-pull-request-reviewer",60310),groupByRefType:m("group-by-ref-type",60311),ungroupByRefType:m("ungroup-by-ref-type",60312),account:m("account",60313),gitPullRequestAssignee:m("git-pull-request-assignee",60313),bellDot:m("bell-dot",60314),debugConsole:m("debug-console",60315),library:m("library",60316),output:m("output",60317),runAll:m("run-all",60318),syncIgnored:m("sync-ignored",60319),pinned:m("pinned",60320),githubInverted:m("github-inverted",60321),serverProcess:m("server-process",60322),serverEnvironment:m("server-environment",60323),pass:m("pass",60324),issueClosed:m("issue-closed",60324),stopCircle:m("stop-circle",60325),playCircle:m("play-circle",60326),record:m("record",60327),debugAltSmall:m("debug-alt-small",60328),vmConnect:m("vm-connect",60329),cloud:m("cloud",60330),merge:m("merge",60331),export:m("export",60332),graphLeft:m("graph-left",60333),magnet:m("magnet",60334),notebook:m("notebook",60335),redo:m("redo",60336),checkAll:m("check-all",60337),pinnedDirty:m("pinned-dirty",60338),passFilled:m("pass-filled",60339),circleLargeFilled:m("circle-large-filled",60340),circleLarge:m("circle-large",60341),circleLargeOutline:m("circle-large-outline",60341),combine:m("combine",60342),gather:m("gather",60342),table:m("table",60343),variableGroup:m("variable-group",60344),typeHierarchy:m("type-hierarchy",60345),typeHierarchySub:m("type-hierarchy-sub",60346),typeHierarchySuper:m("type-hierarchy-super",60347),gitPullRequestCreate:m("git-pull-request-create",60348),runAbove:m("run-above",60349),runBelow:m("run-below",60350),notebookTemplate:m("notebook-template",60351),debugRerun:m("debug-rerun",60352),workspaceTrusted:m("workspace-trusted",60353),workspaceUntrusted:m("workspace-untrusted",60354),workspaceUnknown:m("workspace-unknown",60355),terminalCmd:m("terminal-cmd",60356),terminalDebian:m("terminal-debian",60357),terminalLinux:m("terminal-linux",60358),terminalPowershell:m("terminal-powershell",60359),terminalTmux:m("terminal-tmux",60360),terminalUbuntu:m("terminal-ubuntu",60361),terminalBash:m("terminal-bash",60362),arrowSwap:m("arrow-swap",60363),copy:m("copy",60364),personAdd:m("person-add",60365),filterFilled:m("filter-filled",60366),wand:m("wand",60367),debugLineByLine:m("debug-line-by-line",60368),inspect:m("inspect",60369),layers:m("layers",60370),layersDot:m("layers-dot",60371),layersActive:m("layers-active",60372),compass:m("compass",60373),compassDot:m("compass-dot",60374),compassActive:m("compass-active",60375),azure:m("azure",60376),issueDraft:m("issue-draft",60377),gitPullRequestClosed:m("git-pull-request-closed",60378),gitPullRequestDraft:m("git-pull-request-draft",60379),debugAll:m("debug-all",60380),debugCoverage:m("debug-coverage",60381),runErrors:m("run-errors",60382),folderLibrary:m("folder-library",60383),debugContinueSmall:m("debug-continue-small",60384),beakerStop:m("beaker-stop",60385),graphLine:m("graph-line",60386),graphScatter:m("graph-scatter",60387),pieChart:m("pie-chart",60388),bracketDot:m("bracket-dot",60389),bracketError:m("bracket-error",60390),lockSmall:m("lock-small",60391),azureDevops:m("azure-devops",60392),verifiedFilled:m("verified-filled",60393),newline:m("newline",60394),layout:m("layout",60395),layoutActivitybarLeft:m("layout-activitybar-left",60396),layoutActivitybarRight:m("layout-activitybar-right",60397),layoutPanelLeft:m("layout-panel-left",60398),layoutPanelCenter:m("layout-panel-center",60399),layoutPanelJustify:m("layout-panel-justify",60400),layoutPanelRight:m("layout-panel-right",60401),layoutPanel:m("layout-panel",60402),layoutSidebarLeft:m("layout-sidebar-left",60403),layoutSidebarRight:m("layout-sidebar-right",60404),layoutStatusbar:m("layout-statusbar",60405),layoutMenubar:m("layout-menubar",60406),layoutCentered:m("layout-centered",60407),target:m("target",60408),indent:m("indent",60409),recordSmall:m("record-small",60410),errorSmall:m("error-small",60411),terminalDecorationError:m("terminal-decoration-error",60411),arrowCircleDown:m("arrow-circle-down",60412),arrowCircleLeft:m("arrow-circle-left",60413),arrowCircleRight:m("arrow-circle-right",60414),arrowCircleUp:m("arrow-circle-up",60415),layoutSidebarRightOff:m("layout-sidebar-right-off",60416),layoutPanelOff:m("layout-panel-off",60417),layoutSidebarLeftOff:m("layout-sidebar-left-off",60418),blank:m("blank",60419),heartFilled:m("heart-filled",60420),map:m("map",60421),mapHorizontal:m("map-horizontal",60421),foldHorizontal:m("fold-horizontal",60421),mapFilled:m("map-filled",60422),mapHorizontalFilled:m("map-horizontal-filled",60422),foldHorizontalFilled:m("fold-horizontal-filled",60422),circleSmall:m("circle-small",60423),bellSlash:m("bell-slash",60424),bellSlashDot:m("bell-slash-dot",60425),commentUnresolved:m("comment-unresolved",60426),gitPullRequestGoToChanges:m("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:m("git-pull-request-new-changes",60428),searchFuzzy:m("search-fuzzy",60429),commentDraft:m("comment-draft",60430),send:m("send",60431),sparkle:m("sparkle",60432),insert:m("insert",60433),mic:m("mic",60434),thumbsdownFilled:m("thumbsdown-filled",60435),thumbsupFilled:m("thumbsup-filled",60436),coffee:m("coffee",60437),snake:m("snake",60438),game:m("game",60439),vr:m("vr",60440),chip:m("chip",60441),piano:m("piano",60442),music:m("music",60443),micFilled:m("mic-filled",60444),repoFetch:m("repo-fetch",60445),copilot:m("copilot",60446),lightbulbSparkle:m("lightbulb-sparkle",60447),robot:m("robot",60448),sparkleFilled:m("sparkle-filled",60449),diffSingle:m("diff-single",60450),diffMultiple:m("diff-multiple",60451),surroundWith:m("surround-with",60452),share:m("share",60453),gitStash:m("git-stash",60454),gitStashApply:m("git-stash-apply",60455),gitStashPop:m("git-stash-pop",60456),vscode:m("vscode",60457),vscodeInsiders:m("vscode-insiders",60458),codeOss:m("code-oss",60459),runCoverage:m("run-coverage",60460),runAllCoverage:m("run-all-coverage",60461),coverage:m("coverage",60462),githubProject:m("github-project",60463),mapVertical:m("map-vertical",60464),foldVertical:m("fold-vertical",60464),mapVerticalFilled:m("map-vertical-filled",60465),foldVerticalFilled:m("fold-vertical-filled",60465),goToSearch:m("go-to-search",60466),percentage:m("percentage",60467),sortPercentage:m("sort-percentage",60467),attach:m("attach",60468),goToEditingSession:m("go-to-editing-session",60469),editSession:m("edit-session",60470),codeReview:m("code-review",60471),copilotWarning:m("copilot-warning",60472),python:m("python",60473),copilotLarge:m("copilot-large",60474),copilotWarningLarge:m("copilot-warning-large",60475),keyboardTab:m("keyboard-tab",60476),copilotBlocked:m("copilot-blocked",60477),copilotNotConnected:m("copilot-not-connected",60478),flag:m("flag",60479),lightbulbEmpty:m("lightbulb-empty",60480),symbolMethodArrow:m("symbol-method-arrow",60481),copilotUnavailable:m("copilot-unavailable",60482),repoPinned:m("repo-pinned",60483),keyboardTabAbove:m("keyboard-tab-above",60484),keyboardTabBelow:m("keyboard-tab-below",60485),gitPullRequestDone:m("git-pull-request-done",60486),mcp:m("mcp",60487),extensionsLarge:m("extensions-large",60488),layoutPanelDock:m("layout-panel-dock",60489),layoutSidebarLeftDock:m("layout-sidebar-left-dock",60490),layoutSidebarRightDock:m("layout-sidebar-right-dock",60491),copilotInProgress:m("copilot-in-progress",60492),copilotError:m("copilot-error",60493),copilotSuccess:m("copilot-success",60494),chatSparkle:m("chat-sparkle",60495),searchSparkle:m("search-sparkle",60496),editSparkle:m("edit-sparkle",60497),copilotSnooze:m("copilot-snooze",60498),sendToRemoteAgent:m("send-to-remote-agent",60499),commentDiscussionSparkle:m("comment-discussion-sparkle",60500),chatSparkleWarning:m("chat-sparkle-warning",60501),chatSparkleError:m("chat-sparkle-error",60502),collection:m("collection",60503),newCollection:m("new-collection",60504),thinking:m("thinking",60505),build:m("build",60506),commentDiscussionQuote:m("comment-discussion-quote",60507),cursor:m("cursor",60508),eraser:m("eraser",60509),fileText:m("file-text",60510),quotes:m("quotes",60512),rename:m("rename",60513),runWithDeps:m("run-with-deps",60514),debugConnected:m("debug-connected",60515),strikethrough:m("strikethrough",60516),openInProduct:m("open-in-product",60517),indexZero:m("index-zero",60518),agent:m("agent",60519),editCode:m("edit-code",60520),repoSelected:m("repo-selected",60521),skip:m("skip",60522),mergeInto:m("merge-into",60523),gitBranchChanges:m("git-branch-changes",60524),gitBranchStagedChanges:m("git-branch-staged-changes",60525),gitBranchConflicts:m("git-branch-conflicts",60526),gitBranch:m("git-branch",60527),gitBranchCreate:m("git-branch-create",60527),gitBranchDelete:m("git-branch-delete",60527),searchLarge:m("search-large",60528),terminalGitBash:m("terminal-git-bash",60529),windowActive:m("window-active",60530),forward:m("forward",60531),download:m("download",60532),clockface:m("clockface",60533),unarchive:m("unarchive",60534),sessionInProgress:m("session-in-progress",60535),collectionSmall:m("collection-small",60536),vmSmall:m("vm-small",60537),cloudSmall:m("cloud-small",60538),addSmall:m("add-small",60539),removeSmall:m("remove-small",60540),worktreeSmall:m("worktree-small",60541),worktree:m("worktree",60542),screenCut:m("screen-cut",60543),ask:m("ask",60544),openai:m("openai",60545),claude:m("claude",60546)},cz={dialogError:m("dialog-error","error"),dialogWarning:m("dialog-warning","warning"),dialogInfo:m("dialog-info","info"),dialogClose:m("dialog-close","close"),treeItemExpanded:m("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:m("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:m("tree-filter-on-type-off","list-selection"),treeFilterClear:m("tree-filter-clear","close"),treeItemLoading:m("tree-item-loading","loading"),menuSelection:m("menu-selection","check"),menuSubmenu:m("menu-submenu","chevron-right"),menuBarMore:m("menubar-more","more"),scrollbarButtonLeft:m("scrollbar-button-left","triangle-left"),scrollbarButtonRight:m("scrollbar-button-right","triangle-right"),scrollbarButtonUp:m("scrollbar-button-up","triangle-up"),scrollbarButtonDown:m("scrollbar-button-down","triangle-down"),toolBarMore:m("toolbar-more","more"),quickInputBack:m("quick-input-back","arrow-left"),dropDownButton:m("drop-down-button",60084),symbolCustomColor:m("symbol-customcolor",60252),exportIcon:m("export",60332),workspaceUnspecified:m("workspace-unspecified",60355),newLine:m("newline",60394),thumbsDownFilled:m("thumbsdown-filled",60435),thumbsUpFilled:m("thumbsup-filled",60436),gitFetch:m("git-fetch",60445),lightbulbSparkleAutofix:m("lightbulb-sparkle-autofix",60447),debugBreakpointPending:m("debug-breakpoint-pending",60377)},ce={...az,...cz},yc;(function(e){function t(i){return!!i&&typeof i=="object"&&typeof i.id=="string"}e.isThemeColor=t})(yc||(yc={}));var Ft;(function(e){e.iconNameSegment="[A-Za-z0-9]+",e.iconNameExpression="[A-Za-z0-9-]+",e.iconModifierExpression="~[A-Za-z]+",e.iconNameCharacter="[A-Za-z0-9~-]";const t=new RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function i(g){const v=t.exec(g.id);if(!v)return i(ce.error);const[,b,S]=v,E=["codicon","codicon-"+b];return S&&E.push("codicon-modifier-"+S.substring(1)),E}e.asClassNameArray=i;function s(g){return i(g).join(" ")}e.asClassName=s;function r(g){return"."+i(g).join(".")}e.asCSSSelector=r;function n(g){return!!g&&typeof g=="object"&&typeof g.id=="string"&&(typeof g.color>"u"||yc.isThemeColor(g.color))}e.isThemeIcon=n;const o=new RegExp(`^\\$\\((${e.iconNameExpression}(?:${e.iconModifierExpression})?)\\)$`);function a(g){const v=o.exec(g);if(!v)return;const[,b]=v;return{id:b}}e.fromString=a;function c(g){return{id:g}}e.fromId=c;function l(g,v){let b=g.id;const S=b.lastIndexOf("~");return S!==-1&&(b=b.substring(0,S)),v&&(b=`${b}~${v}`),{id:b}}e.modify=l;function u(g){const v=g.id.lastIndexOf("~");if(v!==-1)return g.id.substring(v+1)}e.getModifier=u;function h(g,v){return g.id===v.id&&g.color?.id===v.color?.id}e.isEqual=h;function f(g){return g?.id===ce.file.id}e.isFile=f;function p(g){return g?.id===ce.folder.id}e.isFolder=p})(Ft||(Ft={}));var K0=new RegExp(`\\$\\(${Ft.iconNameExpression}(?:${Ft.iconModifierExpression})?\\)`,"g"),lz=new RegExp(`(\\\\)?${K0.source}`,"g");function uz(e){return e.replace(lz,(t,i)=>i?t:`\\${t}`)}var jie=new RegExp(`\\\\${K0.source}`,"g"),Uie=new RegExp(`(\\s)?(\\\\)?${K0.source}(\\s)?`,"g"),zie=new RegExp(`\\$\\(${Ft.iconNameCharacter}+\\)`,"g"),n$;(function(e){e[e.Paragraph=0]="Paragraph",e[e.Break=1]="Break"})(n$||(n$={}));var Qn=class BN{static lift(t){const i=new BN(t.value,t);return i.uris=t.uris,i.baseUri=t.baseUri?y.revive(t.baseUri):void 0,i}constructor(t="",i=!1){if(this.value=t,typeof this.value!="string")throw Me("value");typeof i=="boolean"?(this.isTrusted=i,this.supportThemeIcons=!1,this.supportHtml=!1,this.supportAlertSyntax=!1):(this.isTrusted=i.isTrusted??void 0,this.supportThemeIcons=i.supportThemeIcons??!1,this.supportHtml=i.supportHtml??!1,this.supportAlertSyntax=i.supportAlertSyntax??!1)}appendText(t,i=0){return this.value+=hz(this.supportThemeIcons?uz(t):t).replace(/([ \t]+)/g,(s,r)=>"&nbsp;".repeat(r.length)).replace(/\>/gm,"\\>").replace(/\n/g,i===1?`\\
`:`

`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,i){return this.value+=`
${dz(i,t)}
`,this}appendLink(t,i,s){return this.value+="[",this.value+=this.c(i,"]"),this.value+="](",this.value+=this.c(String(t),")"),s&&(this.value+=` "${this.c(this.c(s,'"'),")")}"`),this.value+=")",this}c(t,i){const s=new RegExp(On(i),"g");return t.replace(s,(r,n)=>t.charAt(n-1)!=="\\"?`\\${r}`:r)}};function Xn(e){return e instanceof Qn?!0:e&&typeof e=="object"?typeof e.value=="string"&&(typeof e.isTrusted=="boolean"||typeof e.isTrusted=="object"||e.isTrusted===void 0)&&(typeof e.supportThemeIcons=="boolean"||e.supportThemeIcons===void 0)&&(typeof e.supportAlertSyntax=="boolean"||e.supportAlertSyntax===void 0):!1}function hz(e){return e.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function dz(e,t){const i=e.match(/^`+/gm)?.reduce((r,n)=>r.length>n.length?r:n).length??0,s=i>=3?i+1:3;return[`${"`".repeat(s)}${t}`,e,`${"`".repeat(s)}`].join(`
`)}function fz(e){const t=[],i=e.split("|").map(r=>r.trim());e=i[0];const s=i[1];if(s){const r=/height=(\d+)/.exec(s),n=/width=(\d+)/.exec(s),o=r?r[1]:"",a=n?n[1]:"",c=isFinite(parseInt(a)),l=isFinite(parseInt(o));c&&t.push(`width="${a}"`),l&&t.push(`height="${o}"`)}return{href:e,dimensions:t}}function ew(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ea=ew();function o$(e){ea=e}var a$=/[&<>"']/,pz=new RegExp(a$.source,"g"),c$=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,gz=new RegExp(c$.source,"g"),mz={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},l$=e=>mz[e];function vs(e,t){if(t){if(a$.test(e))return e.replace(pz,l$)}else if(c$.test(e))return e.replace(gz,l$);return e}var vz=/(^|[^\[])\^/g;function St(e,t){let i=typeof e=="string"?e:e.source;t=t||"";const s={replace:(r,n)=>{let o=typeof n=="string"?n:n.source;return o=o.replace(vz,"$1"),i=i.replace(r,o),s},getRegex:()=>new RegExp(i,t)};return s}function u$(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}var Pu={exec:()=>null};function h$(e,t){const i=e.replace(/\|/g,(n,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),s=i.split(/ \|/);let r=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),t)if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;r<s.length;r++)s[r]=s[r].trim().replace(/\\\|/g,"|");return s}function Tu(e,t,i){const s=e.length;if(s===0)return"";let r=0;for(;r<s;){const n=e.charAt(s-r-1);if(n===t&&!i)r++;else if(n!==t&&i)r++;else break}return e.slice(0,s-r)}function wz(e,t){if(e.indexOf(t[1])===-1)return-1;let i=0;for(let s=0;s<e.length;s++)if(e[s]==="\\")s++;else if(e[s]===t[0])i++;else if(e[s]===t[1]&&(i--,i<0))return s;return-1}function d$(e,t,i,s){const r=t.href,n=t.title?vs(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){s.state.inLink=!0;const a={type:"link",raw:i,href:r,title:n,text:o,tokens:s.inlineTokens(o)};return s.state.inLink=!1,a}return{type:"image",raw:i,href:r,title:n,text:vs(o)}}function bz(e,t){const i=e.match(/^(\s+)(?:```)/);if(i===null)return t;const s=i[1];return t.split(`
`).map(r=>{const n=r.match(/^\s+/);if(n===null)return r;const[o]=n;return o.length>=s.length?r.slice(s.length):r}).join(`
`)}var Lf=class{options;rules;lexer;constructor(e){this.options=e||ea}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Tu(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],s=bz(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const s=Tu(i,"#");(this.options.pedantic||!s||/ $/.test(s))&&(i=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Tu(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=Tu(t[0],`
`).split(`
`),s="",r="";const n=[];for(;i.length>0;){let o=!1;const a=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))a.push(i[c]),o=!0;else if(!o)a.push(i[c]);else break;i=i.slice(c);const l=a.join(`
`),u=l.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");s=s?`${s}
${l}`:l,r=r?`${r}
${u}`:u;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,n,!0),this.lexer.state.top=h,i.length===0)break;const f=n[n.length-1];if(f?.type==="code")break;if(f?.type==="blockquote"){const p=f,g=p.raw+`
`+i.join(`
`),v=this.blockquote(g);n[n.length-1]=v,s=s.substring(0,s.length-p.raw.length)+v.raw,r=r.substring(0,r.length-p.text.length)+v.text;break}else if(f?.type==="list"){const p=f,g=p.raw+`
`+i.join(`
`),v=this.list(g);n[n.length-1]=v,s=s.substring(0,s.length-f.raw.length)+v.raw,r=r.substring(0,r.length-p.raw.length)+v.raw,i=g.substring(n[n.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:n,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const s=i.length>1,r={type:"list",raw:"",ordered:s,start:s?+i.slice(0,-1):"",loose:!1,items:[]};i=s?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=s?i:"[*+-]");const n=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o=!1;for(;e;){let a=!1,c="",l="";if(!(t=n.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let u=t[2].split(`
`,1)[0].replace(/^\t+/,b=>" ".repeat(3*b.length)),h=e.split(`
`,1)[0],f=!u.trim(),p=0;if(this.options.pedantic?(p=2,l=u.trimStart()):f?p=t[1].length+1:(p=t[2].search(/[^ ]/),p=p>4?1:p,l=u.slice(p),p+=t[1].length),f&&/^ *$/.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),a=!0),!a){const b=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),S=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),E=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),k=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const O=e.split(`
`,1)[0];if(h=O,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),E.test(h)||k.test(h)||b.test(h)||S.test(e))break;if(h.search(/[^ ]/)>=p||!h.trim())l+=`
`+h.slice(p);else{if(f||u.search(/[^ ]/)>=4||E.test(u)||k.test(u)||S.test(u))break;l+=`
`+h}!f&&!h.trim()&&(f=!0),c+=O+`
`,e=e.substring(O.length+1),u=h.slice(p)}}r.loose||(o?r.loose=!0:/\n *\n *$/.test(c)&&(o=!0));let g=null,v;this.options.gfm&&(g=/^\[[ xX]\] /.exec(l),g&&(v=g[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),r.items.push({type:"list_item",raw:c,task:!!g,checked:v,loose:!1,text:l,tokens:[]}),r.raw+=c}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd(),r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd(),r.raw=r.raw.trimEnd();for(let a=0;a<r.items.length;a++)if(this.lexer.state.top=!1,r.items[a].tokens=this.lexer.blockTokens(r.items[a].text,[]),!r.loose){const c=r.items[a].tokens.filter(u=>u.type==="space"),l=c.length>0&&c.some(u=>/\n.*\n/.test(u.raw));r.loose=l}if(r.loose)for(let a=0;a<r.items.length;a++)r.items[a].loose=!0;return r}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),s=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:s,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=h$(t[1]),s=t[2].replace(/^\||\| *$/g,"").split("|"),r=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],n={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===s.length){for(const o of s)/^ *-+: *$/.test(o)?n.align.push("right"):/^ *:-+: *$/.test(o)?n.align.push("center"):/^ *:-+ *$/.test(o)?n.align.push("left"):n.align.push(null);for(let o=0;o<i.length;o++)n.header.push({text:i[o],tokens:this.lexer.inline(i[o]),header:!0,align:n.align[o]});for(const o of r)n.rows.push(h$(o,n.header.length).map((a,c)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:n.align[c]})));return n}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:vs(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const n=Tu(i.slice(0,-1),"\\");if((i.length-n.length)%2===0)return}else{const n=wz(t[2],"()");if(n>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+n;t[2]=t[2].substring(0,n),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let s=t[2],r="";if(this.options.pedantic){const n=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);n&&(s=n[1],r=n[3])}else r=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(i)?s=s.slice(1):s=s.slice(1,-1)),d$(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=(i[2]||i[1]).replace(/\s+/g," "),r=t[s.toLowerCase()];if(!r){const n=i[0].charAt(0);return{type:"text",raw:n,text:n}}return d$(i,r,i[0],this.lexer)}}emStrong(e,t,i=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s||s[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(s[1]||s[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const n=[...s[0]].length-1;let o,a,c=n,l=0;const u=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+n);(s=u.exec(t))!=null;){if(o=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!o)continue;if(a=[...o].length,s[3]||s[4]){c+=a;continue}else if((s[5]||s[6])&&n%3&&!((n+a)%3)){l+=a;continue}if(c-=a,c>0)continue;a=Math.min(a,a+c+l);const h=[...s[0]][0].length,f=e.slice(0,n+s.index+h+a);if(Math.min(n,a)%2){const g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const s=/[^ ]/.test(i),r=/^ /.test(i)&&/ $/.test(i);return s&&r&&(i=i.substring(1,i.length-1)),i=vs(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,s;return t[2]==="@"?(i=vs(t[1]),s="mailto:"+i):(i=vs(t[1]),s=i),{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,s;if(t[2]==="@")i=vs(t[0]),s="mailto:"+i;else{let r;do r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(r!==t[0]);i=vs(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:i,href:s,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=vs(t[0]),{type:"text",raw:t[0],text:i}}}},yz=/^(?: *(?:\n|$))+/,Az=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Sz=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Mu=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ez=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,f$=/(?:[*+-]|\d{1,9}[.)])/,p$=St(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,f$).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),tw=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,xz=/^[^\n]+/,iw=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Cz=St(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",iw).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),kz=St(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,f$).getRegex(),Of="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",sw=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,$z=St("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",sw).replace("tag",Of).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),g$=St(tw).replace("hr",Mu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Of).getRegex(),Iz=St(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",g$).getRegex(),rw={blockquote:Iz,code:Az,def:Cz,fences:Sz,heading:Ez,hr:Mu,html:$z,lheading:p$,list:kz,newline:yz,paragraph:g$,table:Pu,text:xz},m$=St("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Mu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Of).getRegex(),Dz={...rw,table:m$,paragraph:St(tw).replace("hr",Mu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",m$).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Of).getRegex()},Pz={...rw,html:St(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",sw).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Pu,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:St(tw).replace("hr",Mu).replace("heading",` *#{1,6} *[^
]`).replace("lheading",p$).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},v$=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Tz=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,w$=/^( {2,}|\\)\n(?!\s*$)/,Mz=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Nu="\\p{P}\\p{S}",Nz=St(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Nu).getRegex(),Rz=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Lz=St(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Nu).getRegex(),Oz=St("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Nu).getRegex(),Fz=St("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Nu).getRegex(),jz=St(/\\([punct])/,"gu").replace(/punct/g,Nu).getRegex(),Uz=St(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),zz=St(sw).replace("(?:-->|$)","-->").getRegex(),Hz=St("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",zz).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ff=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Wz=St(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Ff).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),b$=St(/^!?\[(label)\]\[(ref)\]/).replace("label",Ff).replace("ref",iw).getRegex(),y$=St(/^!?\[(ref)\](?:\[\])?/).replace("ref",iw).getRegex(),_z=St("reflink|nolink(?!\\()","g").replace("reflink",b$).replace("nolink",y$).getRegex(),nw={_backpedal:Pu,anyPunctuation:jz,autolink:Uz,blockSkip:Rz,br:w$,code:Tz,del:Pu,emStrongLDelim:Lz,emStrongRDelimAst:Oz,emStrongRDelimUnd:Fz,escape:v$,link:Wz,nolink:y$,punctuation:Nz,reflink:b$,reflinkSearch:_z,tag:Hz,text:Mz,url:Pu},Bz={...nw,link:St(/^!?\[(label)\]\((.*?)\)/).replace("label",Ff).getRegex(),reflink:St(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ff).getRegex()},ow={...nw,escape:St(v$).replace("])","~|])").getRegex(),url:St(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},qz={...ow,br:St(w$).replace("{2,}","*").getRegex(),text:St(ow.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},jf={normal:rw,gfm:Dz,pedantic:Pz},Ru={normal:nw,gfm:ow,breaks:qz,pedantic:Bz},ta=class HE{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||ea,this.options.tokenizer=this.options.tokenizer||new Lf,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const i={block:jf.normal,inline:Ru.normal};this.options.pedantic?(i.block=jf.pedantic,i.inline=Ru.pedantic):this.options.gfm&&(i.block=jf.gfm,this.options.breaks?i.inline=Ru.breaks:i.inline=Ru.gfm),this.tokenizer.rules=i}static get rules(){return{block:jf,inline:Ru}}static lex(t,i){return new HE(i).lex(t)}static lexInline(t,i){return new HE(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let i=0;i<this.inlineQueue.length;i++){const s=this.inlineQueue[i];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,i=[],s=!1){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(a,c,l)=>c+"    ".repeat(l.length));let r,n,o;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(r=a.call({lexer:this},t,i))?(t=t.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.space(t)){t=t.substring(r.raw.length),r.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(r);continue}if(r=this.tokenizer.code(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(r);continue}if(r=this.tokenizer.fences(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.heading(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.hr(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.blockquote(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.list(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.html(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.def(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+r.raw,n.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.lheading(t)){t=t.substring(r.raw.length),i.push(r);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=t.slice(1);let l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},c),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(o=t.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){n=i[i.length-1],s&&n?.type==="paragraph"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(r),s=o.length!==t.length,t=t.substring(r.raw.length);continue}if(r=this.tokenizer.text(t)){t=t.substring(r.raw.length),n=i[i.length-1],n&&n.type==="text"?(n.raw+=`
`+r.raw,n.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(r);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,i}inline(t,i=[]){return this.inlineQueue.push({src:t,tokens:i}),i}inlineTokens(t,i=[]){let s,r,n,o=t,a,c,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(s=u.call({lexer:this},t,i))?(t=t.substring(s.raw.length),i.push(s),!0):!1))){if(s=this.tokenizer.escape(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.tag(t)){t=t.substring(s.raw.length),r=i[i.length-1],r&&s.type==="text"&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):i.push(s);continue}if(s=this.tokenizer.link(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(s.raw.length),r=i[i.length-1],r&&s.type==="text"&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):i.push(s);continue}if(s=this.tokenizer.emStrong(t,o,l)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.codespan(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.br(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.del(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.autolink(t)){t=t.substring(s.raw.length),i.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(t))){t=t.substring(s.raw.length),i.push(s);continue}if(n=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const h=t.slice(1);let f;this.options.extensions.startInline.forEach(p=>{f=p.call({lexer:this},h),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(n=t.substring(0,u+1))}if(s=this.tokenizer.inlineText(n)){t=t.substring(s.raw.length),s.raw.slice(-1)!=="_"&&(l=s.raw.slice(-1)),c=!0,r=i[i.length-1],r&&r.type==="text"?(r.raw+=s.raw,r.text+=s.text):i.push(s);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return i}},Uf=class{options;parser;constructor(e){this.options=e||ea}space(e){return""}code({text:e,lang:t,escaped:i}){const s=(t||"").match(/^\S*/)?.[0],r=e.replace(/\n$/,"")+`
`;return s?'<pre><code class="language-'+vs(s)+'">'+(i?r:vs(r,!0))+`</code></pre>
`:"<pre><code>"+(i?r:vs(r,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let s="";for(let o=0;o<e.items.length;o++){const a=e.items[o];s+=this.listitem(a)}const r=t?"ol":"ul",n=t&&i!==1?' start="'+i+'"':"";return"<"+r+n+`>
`+s+"</"+r+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let r=0;r<e.header.length;r++)i+=this.tablecell(e.header[r]);t+=this.tablerow({text:i});let s="";for(let r=0;r<e.rows.length;r++){const n=e.rows[r];i="";for(let o=0;o<n.length;o++)i+=this.tablecell(n[o]);s+=this.tablerow({text:i})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+s+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const s=this.parser.parseInline(i),r=u$(e);if(r===null)return s;e=r;let n='<a href="'+e+'"';return t&&(n+=' title="'+t+'"'),n+=">"+s+"</a>",n}image({href:e,title:t,text:i}){const s=u$(e);if(s===null)return i;e=s;let r=`<img src="${e}" alt="${i}"`;return t&&(r+=` title="${t}"`),r+=">",r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}},aw=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},ia=class WE{options;renderer;textRenderer;constructor(t){this.options=t||ea,this.options.renderer=this.options.renderer||new Uf,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new aw}static parse(t,i){return new WE(i).parse(t)}static parseInline(t,i){return new WE(i).parseInline(t)}parse(t,i=!0){let s="";for(let r=0;r<t.length;r++){const n=t[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const a=n,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){s+=c||"";continue}}const o=n;switch(o.type){case"space":{s+=this.renderer.space(o);continue}case"hr":{s+=this.renderer.hr(o);continue}case"heading":{s+=this.renderer.heading(o);continue}case"code":{s+=this.renderer.code(o);continue}case"table":{s+=this.renderer.table(o);continue}case"blockquote":{s+=this.renderer.blockquote(o);continue}case"list":{s+=this.renderer.list(o);continue}case"html":{s+=this.renderer.html(o);continue}case"paragraph":{s+=this.renderer.paragraph(o);continue}case"text":{let a=o,c=this.renderer.text(a);for(;r+1<t.length&&t[r+1].type==="text";)a=t[++r],c+=`
`+this.renderer.text(a);i?s+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c}]}):s+=c;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}parseInline(t,i){i=i||this.renderer;let s="";for(let r=0;r<t.length;r++){const n=t[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const a=this.options.extensions.renderers[n.type].call({parser:this},n);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)){s+=a||"";continue}}const o=n;switch(o.type){case"escape":{s+=i.text(o);break}case"html":{s+=i.html(o);break}case"link":{s+=i.link(o);break}case"image":{s+=i.image(o);break}case"strong":{s+=i.strong(o);break}case"em":{s+=i.em(o);break}case"codespan":{s+=i.codespan(o);break}case"br":{s+=i.br(o);break}case"del":{s+=i.del(o);break}case"text":{s+=i.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return s}},zf=class{options;constructor(e){this.options=e||ea}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}},Vz=class{defaults=ew();options=this.setOptions;parse=this.parseMarkdown(ta.lex,ia.parse);parseInline=this.parseMarkdown(ta.lexInline,ia.parseInline);Parser=ia;Renderer=Uf;TextRenderer=aw;Lexer=ta;Tokenizer=Lf;Hooks=zf;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const s of e)switch(i=i.concat(t.call(this,s)),s.type){case"table":{const r=s;for(const n of r.header)i=i.concat(this.walkTokens(n.tokens,t));for(const n of r.rows)for(const o of n)i=i.concat(this.walkTokens(o.tokens,t));break}case"list":{const r=s;i=i.concat(this.walkTokens(r.items,t));break}default:{const r=s;this.defaults.extensions?.childTokens?.[r.type]?this.defaults.extensions.childTokens[r.type].forEach(n=>{const o=r[n].flat(1/0);i=i.concat(this.walkTokens(o,t))}):r.tokens&&(i=i.concat(this.walkTokens(r.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const s={...i};if(s.async=this.defaults.async||s.async||!1,i.extensions&&(i.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const n=t.renderers[r.name];n?t.renderers[r.name]=function(...o){let a=r.renderer.apply(this,o);return a===!1&&(a=n.apply(this,o)),a}:t.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const n=t[r.level];n?n.unshift(r.tokenizer):t[r.level]=[r.tokenizer],r.start&&(r.level==="block"?t.startBlock?t.startBlock.push(r.start):t.startBlock=[r.start]:r.level==="inline"&&(t.startInline?t.startInline.push(r.start):t.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(t.childTokens[r.name]=r.childTokens)}),s.extensions=t),i.renderer){const r=this.defaults.renderer||new Uf(this.defaults);for(const n in i.renderer){if(!(n in r))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const o=n,a=i.renderer[o],c=r[o];r[o]=(...l)=>{let u=a.apply(r,l);return u===!1&&(u=c.apply(r,l)),u||""}}s.renderer=r}if(i.tokenizer){const r=this.defaults.tokenizer||new Lf(this.defaults);for(const n in i.tokenizer){if(!(n in r))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const o=n,a=i.tokenizer[o],c=r[o];r[o]=(...l)=>{let u=a.apply(r,l);return u===!1&&(u=c.apply(r,l)),u}}s.tokenizer=r}if(i.hooks){const r=this.defaults.hooks||new zf;for(const n in i.hooks){if(!(n in r))throw new Error(`hook '${n}' does not exist`);if(n==="options")continue;const o=n,a=i.hooks[o],c=r[o];zf.passThroughHooks.has(n)?r[o]=l=>{if(this.defaults.async)return Promise.resolve(a.call(r,l)).then(h=>c.call(r,h));const u=a.call(r,l);return c.call(r,u)}:r[o]=(...l)=>{let u=a.apply(r,l);return u===!1&&(u=c.apply(r,l)),u}}s.hooks=r}if(i.walkTokens){const r=this.defaults.walkTokens,n=i.walkTokens;s.walkTokens=function(o){let a=[];return a.push(n.call(this,o)),r&&(a=a.concat(r.call(this,o))),a}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ta.lex(e,t??this.defaults)}parser(e,t){return ia.parse(e,t??this.defaults)}parseMarkdown(e,t){return(s,r)=>{const n={...r},o={...this.defaults,...n},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&n.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof s>"u"||s===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(s):s).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(s=o.hooks.preprocess(s));let c=e(s,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let l=t(c,o);return o.hooks&&(l=o.hooks.postprocess(l)),l}catch(c){return a(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const s="<p>An error occurred:</p><pre>"+vs(i.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(i);throw i}}},sa=new Vz;function wt(e,t){return sa.parse(e,t)}wt.options=wt.setOptions=function(e){return sa.setOptions(e),wt.defaults=sa.defaults,o$(wt.defaults),wt},wt.getDefaults=ew,wt.defaults=ea,wt.use=function(...e){return sa.use(...e),wt.defaults=sa.defaults,o$(wt.defaults),wt},wt.walkTokens=function(e,t){return sa.walkTokens(e,t)},wt.parseInline=sa.parseInline,wt.Parser=ia,wt.parser=ia.parse,wt.Renderer=Uf,wt.TextRenderer=aw,wt.Lexer=ta,wt.lexer=ta.lex,wt.Tokenizer=Lf,wt.Hooks=zf,wt.parse=wt;var Hie=wt.options,Wie=wt.setOptions,_ie=wt.use,Bie=wt.walkTokens,qie=wt.parseInline,Vie=ia.parse,Gie=ta.lex,Gs=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),Gz=/^(.+)\/(.+?)(;.+)?$/;function A$(e,t){const i=Gz.exec(e);return i?`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`:t?void 0:e}function S$(e){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(e)}var Mi=Symbol("unset"),Jz=class{constructor(){this.root=new cw,this.a=0}get size(){return this.a}get nodes(){return this.root.children?.values()||ai.empty()}get entries(){return this.root.children?.entries()||ai.empty()}insert(e,t,i){this.c(e,s=>s._value=t,i)}mutate(e,t){this.c(e,i=>i._value=t(i._value===Mi?void 0:i._value))}mutatePath(e,t){this.c(e,()=>{},i=>t(i))}delete(e){const t=this.b(e);if(!t)return;let i=t.length-1;const s=t[i].node._value;if(s!==Mi){for(this.a--,t[i].node._value=Mi;i>0;i--){const{node:r,part:n}=t[i];if(r.children?.size||r._value!==Mi)break;t[i-1].node.children.delete(n)}return s}}*deleteRecursive(e){const t=this.b(e);if(!t)return;const i=t[t.length-1].node;for(let s=t.length-1;s>0;s--){const r=t[s-1];if(r.node.children.delete(t[s].part),r.node.children.size>0||r.node._value!==Mi)break}for(const s of E$(i))s._value!==Mi&&(this.a--,yield s._value);i===this.root&&(this.root._value=Mi,this.root.children=void 0)}find(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return;t=s}return t._value===Mi?void 0:t._value}hasKeyOrParent(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return!1;if(s._value!==Mi)return!0;t=s}return!1}hasKeyOrChildren(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return!1;t=s}return!0}hasKey(e){let t=this.root;for(const i of e){const s=t.children?.get(i);if(!s)return!1;t=s}return t._value!==Mi}b(e){const t=[{part:"",node:this.root}];let i=0;for(const s of e){const r=t[i].node.children?.get(s);if(!r)return;t.push({part:s,node:r}),i++}return t}c(e,t,i){let s=this.root;for(const o of e){if(s.children)if(s.children.has(o))s=s.children.get(o);else{const a=new cw;s.children.set(o,a),s=a}else{const a=new cw;s.children=new Map([[o,a]]),s=a}i?.(s)}const r=s._value===Mi?0:1;t(s);const n=s._value===Mi?0:1;this.a+=n-r}*values(){for(const{_value:e}of E$(this.root))e!==Mi&&(yield e)}};function*E$(e){const t=[e];for(;t.length>0;){const i=t.pop();if(yield i,i.children)for(const s of i.children.values())t.push(s)}}var cw=class{constructor(){this._value=Mi}get value(){return this._value===Mi?void 0:this._value}set value(e){this._value=e===void 0?Mi:e}},ws=class Za{constructor(t,i){this.lineNumber=t,this.column=i}with(t=this.lineNumber,i=this.column){return t===this.lineNumber&&i===this.column?this:new Za(t,i)}delta(t=0,i=0){return this.with(Math.max(1,this.lineNumber+t),Math.max(1,this.column+i))}equals(t){return Za.equals(this,t)}static equals(t,i){return!t&&!i?!0:!!t&&!!i&&t.lineNumber===i.lineNumber&&t.column===i.column}isBefore(t){return Za.isBefore(this,t)}static isBefore(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<i.column}isBeforeOrEqual(t){return Za.isBeforeOrEqual(this,t)}static isBeforeOrEqual(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<=i.column}static compare(t,i){const s=t.lineNumber|0,r=i.lineNumber|0;if(s===r){const n=t.column|0,o=i.column|0;return n-o}return s-r}clone(){return new Za(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new Za(t.lineNumber,t.column)}static isIPosition(t){return!!t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},ot=class oi{constructor(t,i,s,r){t>s||t===s&&i>r?(this.startLineNumber=s,this.startColumn=r,this.endLineNumber=t,this.endColumn=i):(this.startLineNumber=t,this.startColumn=i,this.endLineNumber=s,this.endColumn=r)}isEmpty(){return oi.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(t){return oi.containsPosition(this,t)}static containsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<t.startColumn||i.lineNumber===t.endLineNumber&&i.column>t.endColumn)}static strictContainsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<=t.startColumn||i.lineNumber===t.endLineNumber&&i.column>=t.endColumn)}containsRange(t){return oi.containsRange(this,t)}static containsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>t.endColumn)}strictContainsRange(t){return oi.strictContainsRange(this,t)}static strictContainsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<=t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>=t.endColumn)}plusRange(t){return oi.plusRange(this,t)}static plusRange(t,i){let s,r,n,o;return i.startLineNumber<t.startLineNumber?(s=i.startLineNumber,r=i.startColumn):i.startLineNumber===t.startLineNumber?(s=i.startLineNumber,r=Math.min(i.startColumn,t.startColumn)):(s=t.startLineNumber,r=t.startColumn),i.endLineNumber>t.endLineNumber?(n=i.endLineNumber,o=i.endColumn):i.endLineNumber===t.endLineNumber?(n=i.endLineNumber,o=Math.max(i.endColumn,t.endColumn)):(n=t.endLineNumber,o=t.endColumn),new oi(s,r,n,o)}intersectRanges(t){return oi.intersectRanges(this,t)}static intersectRanges(t,i){let s=t.startLineNumber,r=t.startColumn,n=t.endLineNumber,o=t.endColumn;const a=i.startLineNumber,c=i.startColumn,l=i.endLineNumber,u=i.endColumn;return s<a?(s=a,r=c):s===a&&(r=Math.max(r,c)),n>l?(n=l,o=u):n===l&&(o=Math.min(o,u)),s>n||s===n&&r>o?null:new oi(s,r,n,o)}equalsRange(t){return oi.equalsRange(this,t)}static equalsRange(t,i){return!t&&!i?!0:!!t&&!!i&&t.startLineNumber===i.startLineNumber&&t.startColumn===i.startColumn&&t.endLineNumber===i.endLineNumber&&t.endColumn===i.endColumn}getEndPosition(){return oi.getEndPosition(this)}static getEndPosition(t){return new ws(t.endLineNumber,t.endColumn)}getStartPosition(){return oi.getStartPosition(this)}static getStartPosition(t){return new ws(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(t,i){return new oi(this.startLineNumber,this.startColumn,t,i)}setStartPosition(t,i){return new oi(t,i,this.endLineNumber,this.endColumn)}collapseToStart(){return oi.collapseToStart(this)}static collapseToStart(t){return new oi(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return oi.collapseToEnd(this)}static collapseToEnd(t){return new oi(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new oi(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(t,i=t){return new oi(t.lineNumber,t.column,i.lineNumber,i.column)}static lift(t){return t?new oi(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(t){return!!t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn)}static areIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<=i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<=t.startColumn)}static areOnlyIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber-1||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn-1||i.endLineNumber<t.startLineNumber-1||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn-1)}static compareRangesUsingStarts(t,i){if(t&&i){const n=t.startLineNumber|0,o=i.startLineNumber|0;if(n===o){const a=t.startColumn|0,c=i.startColumn|0;if(a===c){const l=t.endLineNumber|0,u=i.endLineNumber|0;if(l===u){const h=t.endColumn|0,f=i.endColumn|0;return h-f}return l-u}return a-c}return n-o}return(t?1:0)-(i?1:0)}static compareRangesUsingEnds(t,i){return t.endLineNumber===i.endLineNumber?t.endColumn===i.endColumn?t.startLineNumber===i.startLineNumber?t.startColumn-i.startColumn:t.startLineNumber-i.startLineNumber:t.endColumn-i.endColumn:t.endLineNumber-i.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}},Zz=class{constructor(){this.a=new Map,this.b=new Map,this.c=new I,this.onDidChange=this.c.event,this.d=null}handleChange(e){this.c.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this.a.set(e,t),this.handleChange([e]),se(()=>{this.a.get(e)===t&&(this.a.delete(e),this.handleChange([e]))})}get(e){return this.a.get(e)||null}registerFactory(e,t){this.b.get(e)?.dispose();const i=new Yz(this,e,t);return this.b.set(e,i),se(()=>{const s=this.b.get(e);!s||s!==i||(this.b.delete(e),s.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this.b.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this.b.get(e);return!!(!i||i.isResolved)}setColorMap(e){this.d=e,this.c.fire({changedLanguages:Array.from(this.a.keys()),changedColorMap:!0})}getColorMap(){return this.d}getDefaultBackground(){return this.d&&this.d.length>2?this.d[2]:null}},Yz=class extends J{get isResolved(){return this.c}constructor(e,t,i){super(),this.f=e,this.g=t,this.h=i,this.a=!1,this.b=null,this.c=!1}dispose(){this.a=!0,super.dispose()}async resolve(){return this.b||(this.b=this.j()),this.b}async j(){const e=await this.h.tokenizationSupport;this.c=!0,e&&!this.a&&this.D(this.f.register(this.g,e))}},x$;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(x$||(x$={}));var C$;(function(e){e[e.Method=0]="Method",e[e.Function=1]="Function",e[e.Constructor=2]="Constructor",e[e.Field=3]="Field",e[e.Variable=4]="Variable",e[e.Class=5]="Class",e[e.Struct=6]="Struct",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Event=10]="Event",e[e.Operator=11]="Operator",e[e.Unit=12]="Unit",e[e.Value=13]="Value",e[e.Constant=14]="Constant",e[e.Enum=15]="Enum",e[e.EnumMember=16]="EnumMember",e[e.Keyword=17]="Keyword",e[e.Text=18]="Text",e[e.Color=19]="Color",e[e.File=20]="File",e[e.Reference=21]="Reference",e[e.Customcolor=22]="Customcolor",e[e.Folder=23]="Folder",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue",e[e.Tool=27]="Tool",e[e.Snippet=28]="Snippet"})(C$||(C$={}));var k$;(function(e){const t=new Map;t.set(0,ce.symbolMethod),t.set(1,ce.symbolFunction),t.set(2,ce.symbolConstructor),t.set(3,ce.symbolField),t.set(4,ce.symbolVariable),t.set(5,ce.symbolClass),t.set(6,ce.symbolStruct),t.set(7,ce.symbolInterface),t.set(8,ce.symbolModule),t.set(9,ce.symbolProperty),t.set(10,ce.symbolEvent),t.set(11,ce.symbolOperator),t.set(12,ce.symbolUnit),t.set(13,ce.symbolValue),t.set(15,ce.symbolEnum),t.set(14,ce.symbolConstant),t.set(15,ce.symbolEnum),t.set(16,ce.symbolEnumMember),t.set(17,ce.symbolKeyword),t.set(28,ce.symbolSnippet),t.set(18,ce.symbolText),t.set(19,ce.symbolColor),t.set(20,ce.symbolFile),t.set(21,ce.symbolReference),t.set(22,ce.symbolCustomColor),t.set(23,ce.symbolFolder),t.set(24,ce.symbolTypeParameter),t.set(25,ce.account),t.set(26,ce.issues),t.set(27,ce.tools);function i(o){let a=t.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=ce.symbolProperty),a}e.toIcon=i;function s(o){switch(o){case 0:return d(853,null);case 1:return d(854,null);case 2:return d(855,null);case 3:return d(856,null);case 4:return d(857,null);case 5:return d(858,null);case 6:return d(859,null);case 7:return d(860,null);case 8:return d(861,null);case 9:return d(862,null);case 10:return d(863,null);case 11:return d(864,null);case 12:return d(865,null);case 13:return d(866,null);case 14:return d(867,null);case 15:return d(868,null);case 16:return d(869,null);case 17:return d(870,null);case 18:return d(871,null);case 19:return d(872,null);case 20:return d(873,null);case 21:return d(874,null);case 22:return d(875,null);case 23:return d(876,null);case 24:return d(877,null);case 25:return d(878,null);case 26:return d(879,null);case 27:return d(880,null);case 28:return d(881,null);default:return""}}e.toLabel=s;const r=new Map;r.set("method",0),r.set("function",1),r.set("constructor",2),r.set("field",3),r.set("variable",4),r.set("class",5),r.set("struct",6),r.set("interface",7),r.set("module",8),r.set("property",9),r.set("event",10),r.set("operator",11),r.set("unit",12),r.set("value",13),r.set("constant",14),r.set("enum",15),r.set("enum-member",16),r.set("enumMember",16),r.set("keyword",17),r.set("snippet",28),r.set("text",18),r.set("color",19),r.set("file",20),r.set("reference",21),r.set("customcolor",22),r.set("folder",23),r.set("type-parameter",24),r.set("typeParameter",24),r.set("account",25),r.set("issue",26),r.set("tool",27);function n(o,a){let c=r.get(o);return typeof c>"u"&&!a&&(c=9),c}e.fromString=n})(k$||(k$={}));var $$;(function(e){e[e.Deprecated=1]="Deprecated"})($$||($$={}));var I$;(function(e){e[e.None=0]="None",e[e.KeepWhitespace=1]="KeepWhitespace",e[e.InsertAsSnippet=4]="InsertAsSnippet"})(I$||(I$={}));var D$;(function(e){e[e.Word=0]="Word",e[e.Line=1]="Line",e[e.Suggest=2]="Suggest"})(D$||(D$={}));var P$;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(P$||(P$={}));var Hf;(function(e){e[e.Automatic=0]="Automatic",e[e.Explicit=1]="Explicit"})(Hf||(Hf={}));var Ac;(function(e){e[e.Code=1]="Code",e[e.Label=2]="Label"})(Ac||(Ac={}));var Wf;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(Wf||(Wf={}));var T$;(function(e){e[e.Invoke=1]="Invoke",e[e.Auto=2]="Auto"})(T$||(T$={}));var M$;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(M$||(M$={}));var N$;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(N$||(N$={}));var R$;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(R$||(R$={}));function Qz(e){return!!e&&y.isUri(e.uri)&&ot.isIRange(e.range)&&(ot.isIRange(e.originSelectionRange)||ot.isIRange(e.targetSelectionRange))}function Xz(e){return!!e&&y.isUri(e.uri)&&ot.isIRange(e.range)}var L$;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(L$||(L$={}));var Jie={17:d(882,null),16:d(883,null),4:d(884,null),13:d(885,null),8:d(886,null),9:d(887,null),21:d(888,null),23:d(889,null),7:d(890,null),0:d(891,null),11:d(892,null),10:d(893,null),19:d(894,null),5:d(895,null),1:d(896,null),2:d(897,null),20:d(898,null),15:d(899,null),18:d(900,null),24:d(901,null),3:d(902,null),6:d(903,null),14:d(904,null),22:d(905,null),25:d(906,null),12:d(907,null)},O$;(function(e){e[e.Deprecated=1]="Deprecated"})(O$||(O$={}));var lw;(function(e){const t=new Map;t.set(0,ce.symbolFile),t.set(1,ce.symbolModule),t.set(2,ce.symbolNamespace),t.set(3,ce.symbolPackage),t.set(4,ce.symbolClass),t.set(5,ce.symbolMethod),t.set(6,ce.symbolProperty),t.set(7,ce.symbolField),t.set(8,ce.symbolConstructor),t.set(9,ce.symbolEnum),t.set(10,ce.symbolInterface),t.set(11,ce.symbolFunction),t.set(12,ce.symbolVariable),t.set(13,ce.symbolConstant),t.set(14,ce.symbolString),t.set(15,ce.symbolNumber),t.set(16,ce.symbolBoolean),t.set(17,ce.symbolArray),t.set(18,ce.symbolObject),t.set(19,ce.symbolKey),t.set(20,ce.symbolNull),t.set(21,ce.symbolEnumMember),t.set(22,ce.symbolStruct),t.set(23,ce.symbolEvent),t.set(24,ce.symbolOperator),t.set(25,ce.symbolTypeParameter);function i(n){let o=t.get(n);return o||(console.info("No codicon found for SymbolKind "+n),o=ce.symbolProperty),o}e.toIcon=i;const s=new Map;s.set(0,20),s.set(1,8),s.set(2,8),s.set(3,8),s.set(4,5),s.set(5,0),s.set(6,9),s.set(7,3),s.set(8,2),s.set(9,15),s.set(10,7),s.set(11,1),s.set(12,4),s.set(13,14),s.set(14,18),s.set(15,13),s.set(16,13),s.set(17,13),s.set(18,13),s.set(19,17),s.set(20,13),s.set(21,16),s.set(22,6),s.set(23,10),s.set(24,11),s.set(25,24);function r(n){let o=s.get(n);return o===void 0&&(console.info("No completion kind found for SymbolKind "+n),o=20),o}e.toCompletionKind=r})(lw||(lw={}));var Sc=class Do{static{this.Comment=new Do("comment")}static{this.Imports=new Do("imports")}static{this.Region=new Do("region")}static fromValue(t){switch(t){case"comment":return Do.Comment;case"imports":return Do.Imports;case"region":return Do.Region}return new Do(t)}constructor(t){this.value=t}},F$;(function(e){e[e.AIGenerated=1]="AIGenerated"})(F$||(F$={}));var _f;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(_f||(_f={}));var uw;(function(e){function t(i){return!i||typeof i!="object"?!1:typeof i.id=="string"&&typeof i.title=="string"}e.is=t})(uw||(uw={}));var Ec;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(Ec||(Ec={}));var Lu;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(Lu||(Lu={}));var Ou;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(Ou||(Ou={}));var j$;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(j$||(j$={}));var U$;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(U$||(U$={}));var z$;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(z$||(z$={}));var Zie=new Zz,H$;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(H$||(H$={}));var W$;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(W$||(W$={}));var Hi;(function(e){e[e.Hint=1]="Hint",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"})(Hi||(Hi={})),(function(e){function t(c,l){return l-c}e.compare=t;const i=Object.create(null);i[e.Error]=d(2180,null),i[e.Warning]=d(2181,null),i[e.Info]=d(2182,null);function s(c){return i[c]||""}e.toString=s;const r=Object.create(null);r[e.Error]=d(2183,null),r[e.Warning]=d(2184,null),r[e.Info]=d(2185,null);function n(c){return r[c]||""}e.toStringPlural=n;function o(c){switch(c){case rt.Error:return e.Error;case rt.Warning:return e.Warning;case rt.Info:return e.Info;case rt.Ignore:return e.Hint}}e.fromSeverity=o;function a(c){switch(c){case e.Error:return rt.Error;case e.Warning:return rt.Warning;case e.Info:return rt.Info;case e.Hint:return rt.Ignore}}e.toSeverity=a})(Hi||(Hi={}));var _$;(function(e){function i(r){return s(r,!0)}e.makeKey=i;function s(r,n){const o=[""];return r.source?o.push(r.source.replace("\xA6","\\\xA6")):o.push(""),r.code?typeof r.code=="string"?o.push(r.code.replace("\xA6","\\\xA6")):o.push(r.code.value.replace("\xA6","\\\xA6")):o.push(""),r.severity!==void 0&&r.severity!==null?o.push(Hi.toString(r.severity)):o.push(""),r.message&&n?o.push(r.message.replace("\xA6","\\\xA6")):o.push(""),r.startLineNumber!==void 0&&r.startLineNumber!==null?o.push(r.startLineNumber.toString()):o.push(""),r.startColumn!==void 0&&r.startColumn!==null?o.push(r.startColumn.toString()):o.push(""),r.endLineNumber!==void 0&&r.endLineNumber!==null?o.push(r.endLineNumber.toString()):o.push(""),r.endColumn!==void 0&&r.endColumn!==null?o.push(r.endColumn.toString()):o.push(""),o.push(""),o.join("\xA6")}e.makeKeyOptionalMessage=s})(_$||(_$={}));var Yie=W("markerService"),Kz=class{constructor(){this.a=new Map}add(e,t){Ii(Oe(e)),Ii(kt(t)),Ii(!this.a.has(e),"There is already an extension with this id"),this.a.set(e,t)}knows(e){return this.a.has(e)}as(e){return this.a.get(e)||null}dispose(){this.a.forEach(e=>{xx(e.dispose)&&e.dispose()}),this.a.clear()}},Qt=new Kz,Bf=W("fileService");function xc(e){return e.create===!0}var ss;(function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"})(ss||(ss={}));var Er;(function(e){e[e.Readonly=1]="Readonly",e[e.Locked=2]="Locked",e[e.Executable=4]="Executable"})(Er||(Er={}));var B$;(function(e){e[e.UPDATED=2]="UPDATED",e[e.ADDED=4]="ADDED",e[e.DELETED=8]="DELETED"})(B$||(B$={}));var q$;(function(e){e[e.None=0]="None",e[e.FileReadWrite=2]="FileReadWrite",e[e.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",e[e.FileReadStream=16]="FileReadStream",e[e.FileFolderCopy=8]="FileFolderCopy",e[e.PathCaseSensitive=1024]="PathCaseSensitive",e[e.Readonly=2048]="Readonly",e[e.Trash=4096]="Trash",e[e.FileWriteUnlock=8192]="FileWriteUnlock",e[e.FileAtomicRead=16384]="FileAtomicRead",e[e.FileAtomicWrite=32768]="FileAtomicWrite",e[e.FileAtomicDelete=65536]="FileAtomicDelete",e[e.FileClone=131072]="FileClone",e[e.FileRealpath=262144]="FileRealpath",e[e.FileAppend=524288]="FileAppend"})(q$||(q$={}));var de;(function(e){e.FileExists="EntryExists",e.FileNotFound="EntryNotFound",e.FileNotADirectory="EntryNotADirectory",e.FileIsADirectory="EntryIsADirectory",e.FileExceedsStorageQuota="EntryExceedsStorageQuota",e.FileTooLarge="EntryTooLarge",e.FileWriteLocked="EntryWriteLocked",e.NoPermissions="NoPermissions",e.Unavailable="Unavailable",e.Unknown="Unknown"})(de||(de={}));var qf=class qN extends Error{static create(t,i){const s=new qN(t.toString(),i);return V$(s,i),s}constructor(t,i){super(t),this.code=i}};function tn(e,t){return qf.create(e,t)}function eH(e){return e||tn(d(2088,null),de.Unknown)}function V$(e,t){return e.name=t?`${t} (FileSystemError)`:"FileSystemError",e}function Vf(e){if(!e)return de.Unknown;if(e instanceof qf)return e.code;const t=/^(.+) \(FileSystemError\)$/.exec(e.name);if(!t)return de.Unknown;switch(t[1]){case de.FileExists:return de.FileExists;case de.FileIsADirectory:return de.FileIsADirectory;case de.FileNotADirectory:return de.FileNotADirectory;case de.FileNotFound:return de.FileNotFound;case de.FileTooLarge:return de.FileTooLarge;case de.FileWriteLocked:return de.FileWriteLocked;case de.NoPermissions:return de.NoPermissions;case de.Unavailable:return de.Unavailable}return de.Unknown}function tH(e){if(e instanceof Gf)return e.fileOperationResult;switch(Vf(e)){case de.FileNotFound:return 1;case de.FileIsADirectory:return 0;case de.FileNotADirectory:return 9;case de.FileWriteLocked:return 5;case de.NoPermissions:return 6;case de.FileExists:return 4;case de.FileTooLarge:return 7;default:return 10}}var G$;(function(e){e[e.CREATE=0]="CREATE",e[e.DELETE=1]="DELETE",e[e.MOVE=2]="MOVE",e[e.COPY=3]="COPY",e[e.WRITE=4]="WRITE"})(G$||(G$={}));var J$;(function(e){e[e.UPDATED=0]="UPDATED",e[e.ADDED=1]="ADDED",e[e.DELETED=2]="DELETED"})(J$||(J$={}));var Qie=class c1{static{this.a=null}constructor(t,i){this.c=i,this.b=void 0,this.d=new Rt(()=>{const s=Yn.forUris(()=>this.c);return s.fill(this.rawAdded.map(r=>[r,!0])),s}),this.f=new Rt(()=>{const s=Yn.forUris(()=>this.c);return s.fill(this.rawUpdated.map(r=>[r,!0])),s}),this.g=new Rt(()=>{const s=Yn.forUris(()=>this.c);return s.fill(this.rawDeleted.map(r=>[r,!0])),s}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(const s of t){switch(s.type){case 1:this.rawAdded.push(s.resource);break;case 0:this.rawUpdated.push(s.resource);break;case 2:this.rawDeleted.push(s.resource);break}this.b!==c1.a&&(typeof s.cId=="number"?this.b===void 0?this.b=s.cId:this.b!==s.cId&&(this.b=c1.a):this.b!==void 0&&(this.b=c1.a))}}contains(t,...i){return this.h(t,{includeChildren:!1},...i)}affects(t,...i){return this.h(t,{includeChildren:!0},...i)}h(t,i,...s){if(!t)return!1;const r=s.length>0;return!!((!r||s.includes(1))&&(this.d.value.get(t)||i.includeChildren&&this.d.value.findSuperstr(t))||(!r||s.includes(0))&&(this.f.value.get(t)||i.includeChildren&&this.f.value.findSuperstr(t))||(!r||s.includes(2))&&(this.g.value.findSubstr(t)||i.includeChildren&&this.g.value.findSuperstr(t)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(t){return this.b===t}hasCorrelation(){return typeof this.b=="number"}};function iH(e,t,i){return!e||!t||e===t||t.length>e.length?!1:(t.charAt(t.length-1)!==It&&(t+=It),i?uf(e,t):e.indexOf(t)===0)}var Gf=class extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}},Z$;(function(e){e[e.FILE_IS_DIRECTORY=0]="FILE_IS_DIRECTORY",e[e.FILE_NOT_FOUND=1]="FILE_NOT_FOUND",e[e.FILE_NOT_MODIFIED_SINCE=2]="FILE_NOT_MODIFIED_SINCE",e[e.FILE_MODIFIED_SINCE=3]="FILE_MODIFIED_SINCE",e[e.FILE_MOVE_CONFLICT=4]="FILE_MOVE_CONFLICT",e[e.FILE_WRITE_LOCKED=5]="FILE_WRITE_LOCKED",e[e.FILE_PERMISSION_DENIED=6]="FILE_PERMISSION_DENIED",e[e.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",e[e.FILE_INVALID_PATH=8]="FILE_INVALID_PATH",e[e.FILE_NOT_DIRECTORY=9]="FILE_NOT_DIRECTORY",e[e.FILE_OTHER_ERROR=10]="FILE_OTHER_ERROR"})(Z$||(Z$={}));var Y$;(function(e){e[e.FILE=0]="FILE",e[e.FOLDER=1]="FOLDER",e[e.ROOT_FOLDER=2]="ROOT_FOLDER"})(Y$||(Y$={}));var sH="";function Q$(e){if(!(typeof e.size!="number"||typeof e.mtime!="number"))return e.mtime.toString(29)+e.size.toString(31)}var X$=class Zi{static{this.KB=1024}static{this.MB=Zi.KB*Zi.KB}static{this.GB=Zi.MB*Zi.KB}static{this.TB=Zi.GB*Zi.KB}static formatSize(t){return xs(t)||(t=0),t<Zi.KB?d(2089,null,t.toFixed(0)):t<Zi.MB?d(2090,null,(t/Zi.KB).toFixed(2)):t<Zi.GB?d(2091,null,(t/Zi.MB).toFixed(2)):t<Zi.TB?d(2092,null,(t/Zi.GB).toFixed(2)):d(2093,null,(t/Zi.TB).toFixed(2))}},rH=class extends J{get onDidChange(){return this.j.event}constructor(e,t="",i="",s=!0,r){super(),this.j=this.D(new I),this.z=!0,this.m=e,this.n=t,this.w=i,this.z=s,this.F=r}get id(){return this.m}get label(){return this.n}set label(e){this.G(e)}G(e){this.n!==e&&(this.n=e,this.j.fire({label:e}))}get tooltip(){return this.u||""}set tooltip(e){this.H(e)}H(e){this.u!==e&&(this.u=e,this.j.fire({tooltip:e}))}get class(){return this.w}set class(e){this.I(e)}I(e){this.w!==e&&(this.w=e,this.j.fire({class:e}))}get enabled(){return this.z}set enabled(e){this.J(e)}J(e){this.z!==e&&(this.z=e,this.j.fire({enabled:e}))}get checked(){return this.C}set checked(e){this.L(e)}L(e){this.C!==e&&(this.C=e,this.j.fire({checked:e}))}async run(e,t){this.F&&await this.F(e)}},Xie=class _E{constructor(){this.id=_E.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=void 0}static join(...t){let i=[];for(const s of t)s.length&&(i.length?i=[...i,new _E,...s]:i=s);return i}static{this.ID="vs.actions.separator"}async run(){}},Kie=class VN extends rH{static{this.ID="vs.actions.empty"}constructor(){super(VN.ID,d(46,null),void 0,!1)}},nH={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},oH={id:"default",displayName:d(4496,null),providerDisplayName:d(4497,null)},aH="workbench.editors.textDiffEditor",cH="workbench.editors.binaryResourceDiffEditor",K$;(function(e){e[e.PROGRAMMATIC=1]="PROGRAMMATIC",e[e.USER=2]="USER",e[e.EDIT=3]="EDIT",e[e.NAVIGATION=4]="NAVIGATION",e[e.JUMP=5]="JUMP"})(K$||(K$={}));var eI;(function(e){e[e.IDENTICAL=1]="IDENTICAL",e[e.SIMILAR=2]="SIMILAR",e[e.DIFFERENT=3]="DIFFERENT"})(eI||(eI={}));function hw(e,t,i){for(const s of i.visibleEditorPanes)if(s.group.id===t&&e.matches(s.input))return s.getViewState()}function lH(e){if(Js(e))return!1;const t=e;return y.isUri(t?.resource)}function sn(e){if(Js(e))return!1;const t=e;return t?.original!==void 0&&t.modified!==void 0}function Fu(e){if(Js(e))return!1;const t=e;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function ra(e){if(Js(e)||sn(e))return!1;const t=e;return t?.primary!==void 0&&t.secondary!==void 0}function na(e){if(Js(e))return!1;const t=e;return y.isUri(t?.base?.resource)&&y.isUri(t?.input1?.resource)&&y.isUri(t?.input2?.resource)&&y.isUri(t?.result?.resource)}var tI;(function(e){e[e.SHORT=0]="SHORT",e[e.MEDIUM=1]="MEDIUM",e[e.LONG=2]="LONG"})(tI||(tI={}));var iI;(function(e){e[e.EXPLICIT=1]="EXPLICIT",e[e.AUTO=2]="AUTO",e[e.FOCUS_CHANGE=3]="FOCUS_CHANGE",e[e.WINDOW_CHANGE=4]="WINDOW_CHANGE"})(iI||(iI={}));var uH=class{constructor(){this.a=new Map}registerSource(e,t){let i=this.a.get(e);return i||(i={source:e,label:t},this.a.set(e,i)),i.source}getSourceLabel(e){return this.a.get(e)?.label??e}},ese=new uH,sI;(function(e){e[e.None=0]="None",e[e.Readonly=2]="Readonly",e[e.Untitled=4]="Untitled",e[e.Singleton=8]="Singleton",e[e.RequiresTrust=16]="RequiresTrust",e[e.CanSplitInGroup=32]="CanSplitInGroup",e[e.ForceDescription=64]="ForceDescription",e[e.CanDropIntoEditor=128]="CanDropIntoEditor",e[e.MultipleEditors=256]="MultipleEditors",e[e.Scratchpad=512]="Scratchpad"})(sI||(sI={}));var rI=class extends J{};function Js(e){return e instanceof rI}function hH(e){const t=e;return y.isUri(t?.preferredResource)}function dH(e){const t=e;return Js(t?.primary)&&Js(t?.secondary)}function nI(e){const t=e;return Js(t?.modified)&&Js(t?.original)}var oI;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.REPLACE=1]="REPLACE",e[e.MOVE=2]="MOVE",e[e.UNPIN=3]="UNPIN"})(oI||(oI={}));var aI;(function(e){e[e.GROUP_ACTIVE=0]="GROUP_ACTIVE",e[e.GROUP_INDEX=1]="GROUP_INDEX",e[e.GROUP_LABEL=2]="GROUP_LABEL",e[e.GROUP_LOCKED=3]="GROUP_LOCKED",e[e.EDITORS_SELECTION=4]="EDITORS_SELECTION",e[e.EDITOR_OPEN=5]="EDITOR_OPEN",e[e.EDITOR_CLOSE=6]="EDITOR_CLOSE",e[e.EDITOR_MOVE=7]="EDITOR_MOVE",e[e.EDITOR_ACTIVE=8]="EDITOR_ACTIVE",e[e.EDITOR_LABEL=9]="EDITOR_LABEL",e[e.EDITOR_CAPABILITIES=10]="EDITOR_CAPABILITIES",e[e.EDITOR_PIN=11]="EDITOR_PIN",e[e.EDITOR_TRANSIENT=12]="EDITOR_TRANSIENT",e[e.EDITOR_STICKY=13]="EDITOR_STICKY",e[e.EDITOR_DIRTY=14]="EDITOR_DIRTY",e[e.EDITOR_WILL_DISPOSE=15]="EDITOR_WILL_DISPOSE"})(aI||(aI={}));var Kn;(function(e){e[e.PRIMARY=1]="PRIMARY",e[e.SECONDARY=2]="SECONDARY",e[e.BOTH=3]="BOTH",e[e.ANY=4]="ANY"})(Kn||(Kn={}));var fH=class{getOriginalUri(e,t){if(!e)return;if(na(e))return dw.getOriginalUri(e.result,t);if(t?.supportSideBySide){const{primary:s,secondary:r}=this.a(e);if(s&&r){if(t?.supportSideBySide===Kn.BOTH)return{primary:this.getOriginalUri(s,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Kn.ANY)return this.getOriginalUri(s,{filterByScheme:t.filterByScheme})??this.getOriginalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Kn.PRIMARY?s:r}}if(sn(e)||Fu(e)||ra(e)||na(e))return;const i=hH(e)?e.preferredResource:e.resource;return!i||!t?.filterByScheme?i:this.b(i,t.filterByScheme)}a(e){return dH(e)||ra(e)?{primary:e.primary,secondary:e.secondary}:nI(e)||sn(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(na(e))return dw.getCanonicalUri(e.result,t);if(t?.supportSideBySide){const{primary:s,secondary:r}=this.a(e);if(s&&r){if(t?.supportSideBySide===Kn.BOTH)return{primary:this.getCanonicalUri(s,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Kn.ANY)return this.getCanonicalUri(s,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(r,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Kn.PRIMARY?s:r}}if(sn(e)||Fu(e)||ra(e)||na(e))return;const i=e.resource;return!i||!t?.filterByScheme?i:this.b(i,t.filterByScheme)}b(e,t){if(Array.isArray(t)){if(t.some(i=>e.scheme===i))return e}else if(t===e.scheme)return e}},cI;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.KEYBOARD=1]="KEYBOARD",e[e.MOUSE=2]="MOUSE"})(cI||(cI={}));var dw=new fH,lI;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(lI||(lI={}));var pH=class{constructor(){this.c=new Map,this.d=new Map}start(e){const t=this.a=e.get(Yo);for(const[i,s]of this.c)this.e(i,s,t);this.c.clear()}e(e,t,i){const s=i.createInstance(t);this.d.set(e,s)}registerFileEditorFactory(e){if(this.b)throw new Error("Can only register one file editor factory.");this.b=e}getFileEditorFactory(){return sc(this.b)}registerEditorSerializer(e,t){if(this.c.has(e)||this.d.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.a?this.e(e,t,this.a):this.c.set(e,t),se(()=>{this.c.delete(e),this.d.delete(e)})}getEditorSerializer(e){return this.d.get(typeof e=="string"?e:e.typeId)}};Qt.add(nH.EditorFactory,new pH);var uI;(function(e){e[e.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",e[e.SEQUENTIAL=1]="SEQUENTIAL"})(uI||(uI={}));var hI;(function(e){e[e.Failed=0]="Failed",e[e.Completed=1]="Completed",e[e.InProgress=2]="InProgress",e[e.NeedsInput=3]="NeedsInput"})(hI||(hI={}));var dI="local",tse=W("chatSessionsService"),Cc;(function(e){e.scheme=V.vscodeLocalChatSession;function t(n){const o=_n(_.wrap(new TextEncoder().encode(n)),!1,!0);return y.from({scheme:e.scheme,authority:dI,path:"/"+o})}e.forSession=t;function i(n){const o=r(n);return o?.chatSessionType===dI?o.sessionId:void 0}e.parseLocalSessionId=i;function s(n){return!!i(n)}e.isLocalSession=s;function r(n){if(n.scheme!==e.scheme||!n.authority)return;const o=n.path.split("/");if(o.length!==2)return;const a=n.authority,c=Wn(o[1]);return{chatSessionType:a,sessionId:new TextDecoder().decode(c.buffer)}}})(Cc||(Cc={}));function gH(e){const t=Cc.parseLocalSessionId(e);return t||e.toString()}var fI;(function(e){e[e.NotOmitted=0]="NotOmitted",e[e.Partial=1]="Partial",e[e.Full=2]="Full"})(fI||(fI={}));var fw;(function(e){e.icon=ce.error;function t(n){return{filterUri:n.resource,owner:n.owner,problemMessage:n.message,filterRange:{startLineNumber:n.startLineNumber,endLineNumber:n.endLineNumber,startColumn:n.startColumn,endColumn:n.endColumn}}}e.fromMarker=t;function i(n){return{id:s(n),name:r(n),icon:e.icon,value:n,kind:"diagnostic",...n}}e.toEntry=i;function s(n){return[n.filterUri,n.owner,n.filterSeverity,n.filterRange?.startLineNumber,n.filterRange?.startColumn].join(":")}e.id=s;function r(n){let o;if((function(c){c[c.MaxChars=30]="MaxChars",c[c.MaxSpaceLookback=10]="MaxSpaceLookback"})(o||(o={})),n.problemMessage){if(n.problemMessage.length<30)return n.problemMessage;const c=n.problemMessage.lastIndexOf(" ",30);return c===-1||c+10<30?n.problemMessage.substring(0,30)+"\u2026":n.problemMessage.substring(0,c)+"\u2026"}let a=d(6917,null);return n.filterUri&&(a=d(6918,null,ji(n.filterUri))),a}e.label=r})(fw||(fw={}));var pw;(function(e){function t(r){return y.isUri(r.value)?r.value:Xz(r.value)?r.value.uri:void 0}e.toUri=t;function i(r){if(r.value instanceof Uint8Array){const n={...r};return n.value={$base64:_n(_.wrap(r.value))},n}return r}e.toExport=i;function s(r){if(r&&"values"in r&&Array.isArray(r.values))return{kind:"generic",id:r.id??"",name:r.name,value:r.values[0]?.value,range:r.range,modelDescription:r.modelDescription,references:r.references};if(r.value&&typeof r.value=="object"&&"$base64"in r.value&&typeof r.value.$base64=="string"){const n={...r};return n.value=Wn(r.value.$base64).buffer,n}return r}e.fromExport=s})(pw||(pw={}));function mH(e){return e.kind==="image"}function gw(e){return e.kind==="promptFile"}function vH(e){return e.kind==="promptText"}var oa;(function(e){e.Instruction="vscode.prompt.instructions.root",e.InstructionReference="vscode.prompt.instructions",e.PromptFile="vscode.prompt.file"})(oa||(oa={}));function mw(e,t,i,s=!1,r){return{id:`${t}__${e.toString()}`,name:`prompt:${ji(e)}`,value:e,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:t!==oa.InstructionReference,originLabel:i,toolReferences:r,automaticallyAdded:s}}function wH(e,t=!1,i){return{id:"vscode.prompt.instructions.text",name:"prompt:instructionsList",value:e,kind:"promptText",modelDescription:"Prompt instructions list",automaticallyAdded:t,toolReferences:i}}function bH(e,t){return{kind:"tool",id:e.id,icon:Ft.isThemeIcon(e.icon)?e.icon:void 0,name:e.displayName,value:void 0,range:t}}var vw=class{constructor(e){this.a=new Set,this.b=[],e&&this.add(...e)}add(...e){for(const t of e)this.a.has(t.id)||(this.a.add(t.id),this.b.push(t))}insertFirst(e){this.a.has(e.id)||(this.a.add(e.id),this.b.unshift(e))}remove(e){this.a.delete(e.id),this.b=this.b.filter(t=>t.id!==e.id)}has(e){return this.a.has(e.id)}asArray(){return this.b.slice(0)}get length(){return this.b.length}},kc;(function(e){e.AIDisabled="chat.disableAIFeatures",e.AgentEnabled="chat.agent.enabled",e.RequestQueueingEnabled="chat.requestQueuing.enabled",e.RequestQueueingDefaultAction="chat.requestQueuing.defaultAction",e.AgentStatusEnabled="chat.agentsControl.enabled",e.EditorAssociations="chat.editorAssociations",e.UnifiedAgentsBar="chat.unifiedAgentsBar.enabled",e.AgentSessionProjectionEnabled="chat.agentSessionProjection.enabled",e.EditModeHidden="chat.editMode.hidden",e.AlternativeToolAction="chat.alternativeToolAction.enabled",e.Edits2Enabled="chat.edits2.enabled",e.ExtensionToolsEnabled="chat.extensionTools.enabled",e.RepoInfoEnabled="chat.repoInfo.enabled",e.EditRequests="chat.editRequests",e.InlineReferencesStyle="chat.inlineReferences.style",e.GlobalAutoApprove="chat.tools.global.autoApprove",e.AutoApproveEdits="chat.tools.edits.autoApprove",e.AutoApprovedUrls="chat.tools.urls.autoApprove",e.EligibleForAutoApproval="chat.tools.eligibleForAutoApproval",e.EnableMath="chat.math.enabled",e.CheckpointsEnabled="chat.checkpoints.enabled",e.ThinkingStyle="chat.agent.thinkingStyle",e.ThinkingGenerateTitles="chat.agent.thinking.generateTitles",e.TerminalToolsInThinking="chat.agent.thinking.terminalTools",e.AutoExpandToolFailures="chat.tools.autoExpandFailures",e.TodosShowWidget="chat.tools.todos.showWidget",e.NotifyWindowOnResponseReceived="chat.notifyWindowOnResponseReceived",e.ChatViewSessionsEnabled="chat.viewSessions.enabled",e.ChatViewSessionsGrouping="chat.viewSessions.grouping",e.ChatViewSessionsOrientation="chat.viewSessions.orientation",e.ChatViewProgressBadgeEnabled="chat.viewProgressBadge.enabled",e.SubagentToolCustomAgents="chat.customAgentInSubagent.enabled",e.ShowCodeBlockProgressAnimation="chat.agent.codeBlockProgress",e.RestoreLastPanelSession="chat.restoreLastPanelSession",e.ExitAfterDelegation="chat.exitAfterDelegation",e.AgentsControlClickBehavior="chat.agentsControl.clickBehavior",e.ExplainChangesEnabled="chat.editing.explainChanges.enabled"})(kc||(kc={}));var Zs;(function(e){e.Ask="ask",e.Edit="edit",e.Agent="agent"})(Zs||(Zs={}));var pI;(function(e){e.Collapsed="collapsed",e.CollapsedPreview="collapsedPreview",e.FixedScrolling="fixedScrolling"})(pI||(pI={}));var gI;(function(e){e.Off="off",e.WithThinking="withThinking",e.Always="always"})(gI||(gI={}));var mI;(function(e){e.Default="default",e.Cycle="cycle",e.Focus="focus"})(mI||(mI={}));var ti;(function(e){e.Chat="panel",e.Terminal="terminal",e.Notebook="notebook",e.EditorInline="editor"})(ti||(ti={})),(function(e){function t(i){switch(i){case"panel":return e.Chat;case"terminal":return e.Terminal;case"notebook":return e.Notebook;case"editor":return e.EditorInline}return e.Chat}e.fromRaw=t})(ti||(ti={}));var ise=new Set([V.vscodeChatEditor,V.walkThrough,V.vscodeLocalChatSession,V.vscodeSettings,V.webviewPanel,V.vscodeUserData,V.extension,"ccreq","openai-codex"]),sse=new C("inModelsEditor",!1),rse=new C("inModelsSearch",!1);function ju(e,t=ze){return Q1(e,t)?e.charAt(0).toUpperCase()+e.slice(1):e}function Jf(e,t){return e.replace(/^~($|\/|\\)/,`${t}$1`)}var vI="\u2026",Uu="\\\\",zu="~";function yH(e,t=It){const i=new Array(e.length);let s=!1;for(let r=0;r<e.length;r++){const n=e[r];if(n===""){i[r]=`.${t}`;continue}if(!n){i[r]=n;continue}s=!0;let o="",a=n;a.indexOf(Uu)===0?(o=a.substr(0,a.indexOf(Uu)+Uu.length),a=a.substr(a.indexOf(Uu)+Uu.length)):a.indexOf(t)===0?(o=a.substr(0,a.indexOf(t)+t.length),a=a.substr(a.indexOf(t)+t.length)):a.indexOf(zu)===0&&(o=a.substr(0,a.indexOf(zu)+zu.length),a=a.substr(a.indexOf(zu)+zu.length));const c=a.split(t);for(let l=1;s&&l<=c.length;l++)for(let u=c.length-l;s&&u>=0;u--){s=!1;let h=c.slice(u,u+l).join(t);for(let f=0;!s&&f<e.length;f++)if(f!==r&&e[f]&&e[f].indexOf(h)>-1){const p=u+l===c.length,g=u>0&&e[f].indexOf(t)>-1?t+h:h,v=e[f].endsWith(g);s=!p||v}if(!s){let f="";(c[0].endsWith(":")||o!=="")&&(u===1&&(u=0,l++,h=c[0]+t+h),u>0&&(f=c[0]+t),f=o+f),u>0&&(f=f+vI+t),f=f+h,u+l<c.length&&(f=f+t+vI),i[r]=f}}s&&(i[r]=n)}return i}var wI;(function(e){e[e.TEXT=0]="TEXT",e[e.VARIABLE=1]="VARIABLE",e[e.SEPARATOR=2]="SEPARATOR"})(wI||(wI={}));var xr;(function(e){e.SessionStart="SessionStart",e.UserPromptSubmit="UserPromptSubmit",e.PreToolUse="PreToolUse",e.PostToolUse="PostToolUse",e.PreCompact="PreCompact",e.SubagentStart="SubagentStart",e.SubagentStop="SubagentStop",e.Stop="Stop"})(xr||(xr={}));var nse=[{id:xr.SessionStart,label:d(6983,null),description:d(6984,null)},{id:xr.UserPromptSubmit,label:d(6985,null),description:d(6986,null)},{id:xr.PreToolUse,label:d(6987,null),description:d(6988,null)},{id:xr.PostToolUse,label:d(6989,null),description:d(6990,null)},{id:xr.PreCompact,label:d(6991,null),description:d(6992,null)},{id:xr.SubagentStart,label:d(6993,null),description:d(6994,null)},{id:xr.SubagentStop,label:d(6995,null),description:d(6996,null)},{id:xr.Stop,label:d(6997,null),description:d(6998,null)}],AH={type:"object",additionalProperties:!0,required:["type"],anyOf:[{required:["command"]},{required:["windows"]},{required:["linux"]},{required:["osx"]},{required:["bash"]},{required:["powershell"]}],errorMessage:d(6999,null),properties:{type:{type:"string",enum:["command"],description:d(7e3,null)},command:{type:"string",description:d(7001,null)},windows:{type:"string",description:d(7002,null)},linux:{type:"string",description:d(7003,null)},osx:{type:"string",description:d(7004,null)},cwd:{type:"string",description:d(7005,null)},env:{type:"object",additionalProperties:{type:"string"},description:d(7006,null)},timeout:{type:"number",default:30,description:d(7007,null)}}},eo={type:"array",items:AH},ose={$schema:"http://json-schema.org/draft-07/schema#",type:"object",description:d(7008,null),additionalProperties:!0,required:["hooks"],properties:{hooks:{type:"object",description:d(7009,null),additionalProperties:!0,properties:{SessionStart:{...eo,description:d(7010,null)},UserPromptSubmit:{...eo,description:d(7011,null)},PreToolUse:{...eo,description:d(7012,null)},PostToolUse:{...eo,description:d(7013,null)},PreCompact:{...eo,description:d(7014,null)},SubagentStart:{...eo,description:d(7015,null)},SubagentStop:{...eo,description:d(7016,null)},Stop:{...eo,description:d(7017,null)}}}},defaultSnippets:[{label:d(7018,null),description:d(7019,null),body:{hooks:{SessionStart:[{type:"command",command:'${1:echo "Session started" >> session.log}'}],PreToolUse:[{type:"command",command:"${2:./scripts/validate.sh}",timeout:15}]}}}]};function SH(e,t){return t===1&&e.windows?e.windows:t===2&&e.osx?e.osx:t===3&&e.linux?e.linux:e.command}var Hu=class{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return EH(e,this)}},bI=new Map,ww=new WeakMap;function EH(e,t){const i=ww.get(e);if(i)return i;const s=xH(e,t);if(s){let r=bI.get(s)??0;r++,bI.set(s,r);const n=r===1?s:`${s}#${r}`;return ww.set(e,n),n}}function xH(e,t){const i=ww.get(e);if(i)return i;const s=t.owner?kH(t.owner)+".":"";let r;const n=t.debugNameSource;if(n!==void 0)if(typeof n=="function"){if(r=n(),r!==void 0)return s+r}else return s+n;const o=t.referenceFn;if(o!==void 0&&(r=bw(o),r!==void 0))return s+r;if(t.owner!==void 0){const a=CH(t.owner,e);if(a!==void 0)return s+a}}function CH(e,t){for(const i in e)if(e[i]===t)return i}var yI=new Map,AI=new WeakMap;function kH(e){const t=AI.get(e);if(t)return t;const i=SI(e)??"Object";let s=yI.get(i)??0;s++,yI.set(i,s);const r=s===1?i:`${i}#${s}`;return AI.set(e,r),r}function SI(e){const t=e.constructor;if(t)return t.name==="Object"?void 0:t.name}function bw(e){const t=e.toString(),s=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(s?s[1]:void 0)?.trim()}function $c(e,t){return e===t}function $H(){return(e,t)=>e===t}function IH(e,t,i){return $i(e,t,i??$c)}function DH(e){return(t,i)=>$i(t,i,e??$c)}function Wu(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Wu(e[i],t[i]))return!1;return!0}if(e&&typeof e=="object"&&t&&typeof t=="object"&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){const i=e,s=t,r=Object.keys(i),n=Object.keys(s),o=new Set(n);if(r.length!==n.length)return!1;for(const a of r)if(!o.has(a)||!Wu(i[a],s[a]))return!1;return!0}return!1}function PH(){return(e,t)=>Wu(e,t)}function TH(e,t){return JSON.stringify(e)===JSON.stringify(t)}function MH(){return(e,t)=>JSON.stringify(e)===JSON.stringify(t)}function NH(){return(e,t)=>e.equals(t)}function RH(e,t,i){return e==null||t===void 0||t===null?t===e:i(e,t)}function LH(e){return(t,i)=>t==null||i===void 0||i===null?i===t:e(t,i)}var EI;(function(e){e.strict=$c,e.strictC=$H,e.array=IH,e.arrayC=DH,e.structural=Wu,e.structuralC=PH,e.jsonStringify=TH,e.jsonStringifyC=MH,e.thisC=NH,e.ifDefined=RH,e.ifDefinedC=LH})(EI||(EI={}));function xI(e){const t=new Error("BugIndicatingErrorRecovery: "+e);pt(t),console.error("recovered from an error that indicates a bug",t)}var aa;function yw(e){aa?aa instanceof CI?aa.loggers.push(e):aa=new CI([aa,e]):aa=e}function gi(){return aa}var Aw=void 0;function OH(e){Aw=e}function FH(e){Aw&&Aw(e)}var CI=class{constructor(e){this.loggers=e}handleObservableCreated(e,t){for(const i of this.loggers)i.handleObservableCreated(e,t)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e,t){for(const i of this.loggers)i.handleAutorunCreated(e,t)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const s of this.loggers)s.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const s of this.loggers)s.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}};function kI(e,t){const i=new $I(e,t);try{e(i)}finally{i.finish()}}function jH(e,t,i){e?t(e):kI(t,i)}var $I=class{constructor(e,t){this._fn=e,this.b=t,this.a=[],gi()?.handleBeginTransaction(this)}getDebugName(){return this.b?this.b():bw(this._fn)}updateObserver(e,t){if(!this.a){xI("Transaction already finished!"),kI(i=>{i.updateObserver(e,t)});return}this.a.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.a;if(!e){xI("transaction.finish() has already been called!");return}for(let t=0;t<e.length;t++){const{observer:i,observable:s}=e[t];i.endUpdate(s)}this.a=null,gi()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this.a}},rn;(function(e){let t=!1;function i(){t=!0}e.enable=i;function s(){if(!t)return;const r=Error,n=r.stackTraceLimit;r.stackTraceLimit=3;const o=new Error().stack;return r.stackTraceLimit=n,UH.fromStack(o,2)}e.ofCaller=s})(rn||(rn={}));var UH=class GN{static fromStack(t,i){const s=t.split(`
`),r=zH(s[i+1]);if(r)return new GN(r.fileName,r.line,r.column,r.id)}constructor(t,i,s,r){this.fileName=t,this.line=i,this.column=s,this.id=r}};function zH(e){const t=e.match(/\((.*):(\d+):(\d+)\)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:e};const i=e.match(/at ([^\(\)]*):(\d+):(\d+)/);if(i)return{fileName:i[1],line:parseInt(i[2]),column:parseInt(i[3]),id:e}}var Sw;function HH(e){Sw=e}var II;function WH(e){II=e}var DI;function _H(e){DI=e}var Ew;function BH(e){Ew=e}var qH=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t,i=rn.ofCaller()){const s=t===void 0?void 0:e,r=t===void 0?e:t;return Sw({owner:s,debugName:()=>{const n=bw(r);if(n!==void 0)return n;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(r.toString());if(a)return`${this.debugName}.${a[2]}`;if(!s)return`${this.debugName} (mapped)`},debugReferenceFn:r},n=>r(this.read(n),n),i)}flatten(){return Sw({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(II(this,t)),this}keepObserved(e){return e.add(DI(this)),this}get b(){return this.get()}get debug(){return new VH(this)}},VH=class{constructor(e){this.observable=e}getDependencyGraph(){return Ew(this.observable,{type:"dependencies"})}getObserverGraph(){return Ew(this.observable,{type:"observers"})}},xw=class extends qH{constructor(e){super(),this.f=new Set,gi()?.handleObservableCreated(this,e)}addObserver(e){const t=this.f.size;this.f.add(e),t===0&&this.g(),t!==this.f.size&&gi()?.handleOnListenerCountChanged(this,this.f.size)}removeObserver(e){const t=this.f.delete(e);t&&this.f.size===0&&this.h(),t&&gi()?.handleOnListenerCountChanged(this,this.f.size)}g(){}h(){}log(){const e=!!gi();return FH(this),e||gi()?.handleObservableCreated(this,rn.ofCaller()),this}debugGetObservers(){return this.f}};function PI(e,t,i=rn.ofCaller()){let s;return typeof e=="string"?s=new Hu(void 0,e,void 0):s=new Hu(e,void 0,void 0),new Zf(s,t,$c,i)}var Zf=class extends xw{get debugName(){return this.c.getDebugName(this)??"ObservableValue"}constructor(e,t,i,s){super(s),this.c=e,this.d=i,this.a=t,gi()?.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this.a}set(e,t,i){if(i===void 0&&this.d(this.a,e))return;let s;t||(t=s=new $I(()=>{},()=>`Setting ${this.debugName}`));try{const r=this.a;this.i(e),gi()?.handleObservableUpdated(this,{oldValue:r,newValue:e,change:i,didChange:!0,hadValue:!0});for(const n of this.f)t.updateObserver(n,this),n.handleChange(this,i)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this.a}`}i(e){this.a=e}debugGetState(){return{value:this.a}}debugSetValue(e){this.a=e}},TI;(function(e){e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(TI||(TI={}));function GH(e){switch(e){case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}var Yf=class{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,s){this._debugNameData=e,this._runFn=t,this.k=i,this.a=2,this.b=0,this.c=!1,this.f=new Set,this.g=new Set,this.i=!1,this.j=0,this.p=void 0,this.q=void 0,this.h=this.k?.createChangeSummary(void 0),gi()?.handleAutorunCreated(this,s),this.l(),rc(this)}dispose(){if(!this.c){this.c=!0;for(const e of this.f)e.removeObserver(this);this.f.clear(),this.p!==void 0&&this.p.dispose(),this.q!==void 0&&this.q.dispose(),gi()?.handleAutorunDisposed(this),nc(this)}}l(){const e=this.g;this.g=this.f,this.f=e,this.a=3;try{if(!this.c){gi()?.handleAutorunStarted(this);const t=this.h,i=this.q;i!==void 0&&(this.q=void 0);try{this.i=!0,this.k&&(this.k.beforeUpdate?.(this,t),this.h=this.k.createChangeSummary(t)),this.p!==void 0&&(this.p.dispose(),this.p=void 0),this._runFn(this,t)}catch(s){nu(s)}finally{this.i=!1,i!==void 0&&i.dispose()}}}finally{this.c||gi()?.handleAutorunFinished(this);for(const t of this.g)t.removeObserver(this);this.g.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this.a===3&&(this.r(),this.a=1),this.b++}endUpdate(e){try{if(this.b===1){this.j=1;do{if(this.r())return;if(this.a===1){this.a=3;for(const t of this.f)if(t.reportChanges(),this.a===2)break}this.j++,this.a!==3&&this.l()}while(this.a!==3)}}finally{this.b--}Sx(()=>this.b>=0)}handlePossibleChange(e){this.a===3&&this.m(e)&&(this.r(),this.a=1)}handleChange(e,t){if(this.m(e)){gi()?.handleAutorunDependencyChanged(this,e,t);try{(!this.k||this.k.handleChange({changedObservable:e,change:t,didChange:s=>s===e},this.h))&&(this.r(),this.a=2)}catch(i){nu(i)}}}m(e){return this.f.has(e)&&!this.g.has(e)}n(){if(!this.i)throw new Jt("The reader object cannot be used outside its compute function!")}readObservable(e){if(this.n(),this.c)return e.get();e.addObserver(this);const t=e.get();return this.f.add(e),this.g.delete(e),t}get store(){if(this.n(),this.c)throw new Jt("Cannot access store after dispose");return this.p===void 0&&(this.p=new X),this.p}get delayedStore(){if(this.n(),this.c)throw new Jt("Cannot access store after dispose");return this.q===void 0&&(this.q=new X),this.q}debugGetState(){return{isRunning:this.i,updateCount:this.b,dependencies:this.f,state:this.a,stateStr:GH(this.a)}}debugRerun(){this.i?this.a=2:this.l()}r(){return this.j>100?(nu(new Jt(`Autorun '${this.debugName}' is stuck in an infinite update loop.`)),!0):!1}};function Qf(e,t=rn.ofCaller()){return new Yf(new Hu(void 0,void 0,e),e,void 0,t)}var MI;(function(e){e[e.initial=0]="initial",e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(MI||(MI={}));function JH(e){switch(e){case 0:return"initial";case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}var Ys=class extends xw{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,s=void 0,r,n){super(n),this._debugNameData=e,this._computeFn=t,this.w=i,this.x=s,this.y=r,this.a=0,this.c=void 0,this.i=0,this.j=new Set,this.k=new Set,this.l=void 0,this.m=!1,this.n=!1,this.p=!1,this.q=!1,this.s=!1,this.t=void 0,this.u=void 0,this.v=null,this.l=this.w?.createChangeSummary(void 0)}h(){this.a=0,this.c=void 0,gi()?.handleDerivedCleared(this);for(const e of this.j)e.removeObserver(this);this.j.clear(),this.t!==void 0&&(this.t.dispose(),this.t=void 0),this.u!==void 0&&(this.u.dispose(),this.u=void 0),this.x?.()}get(){if(this.n,this.f.size===0){let t;try{this.s=!0;let i;this.w&&(i=this.w.createChangeSummary(void 0),this.w.beforeUpdate?.(this,i)),t=this._computeFn(this,i)}finally{this.s=!1}return this.h(),t}else{do{if(this.a===1){for(const t of this.j)if(t.reportChanges(),this.a===2)break}this.a===1&&(this.a=3),this.a!==3&&this.A()}while(this.a!==3);return this.c}}A(){let e=!1;this.n=!0,this.p=!1;const t=this.k;this.k=this.j,this.j=t;try{const i=this.l;this.s=!0,this.w&&(this.q=!0,this.w.beforeUpdate?.(this,i),this.q=!1,this.l=this.w?.createChangeSummary(i));const s=this.a!==0,r=this.c;this.a=3;const n=this.u;n!==void 0&&(this.u=void 0);try{this.t!==void 0&&(this.t.dispose(),this.t=void 0),this.c=this._computeFn(this,i)}finally{this.s=!1;for(const o of this.k)o.removeObserver(this);this.k.clear(),n!==void 0&&n.dispose()}e=this.p||s&&!this.y(r,this.c),gi()?.handleObservableUpdated(this,{oldValue:r,newValue:this.c,change:void 0,didChange:e,hadValue:s})}catch(i){nu(i)}if(this.n=!1,!this.p&&e)for(const i of this.f)i.handleChange(this,void 0);else this.p=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this.m)throw new Jt("Cyclic deriveds are not supported yet!");this.i++,this.m=!0;try{const t=this.i===1;if(this.a===3&&(this.a=1,!t))for(const i of this.f)i.handlePossibleChange(this);if(t)for(const i of this.f)i.beginUpdate(this)}finally{this.m=!1}}endUpdate(e){if(this.i--,this.i===0){const t=[...this.f];for(const i of t)i.endUpdate(this);if(this.v){const i=[...this.v];this.v=null;for(const s of i)s.endUpdate(this)}}Sx(()=>this.i>=0)}handlePossibleChange(e){if(this.a===3&&this.j.has(e)&&!this.k.has(e)){this.a=1;for(const t of this.f)t.handlePossibleChange(this)}}handleChange(e,t){if(this.j.has(e)&&!this.k.has(e)||this.q){gi()?.handleDerivedDependencyChanged(this,e,t);let i=!1;try{i=this.w?this.w.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this.l):!0}catch(r){nu(r)}const s=this.a===3;if(i&&(this.a===1||s)&&(this.a=2,s))for(const r of this.f)r.handlePossibleChange(this)}}B(){if(!this.s)throw new Jt("The reader object cannot be used outside its compute function!")}readObservable(e){this.B(),e.addObserver(this);const t=e.get();return this.j.add(e),this.k.delete(e),t}reportChange(e){this.B(),this.p=!0;for(const t of this.f)t.handleChange(this,e)}get store(){return this.B(),this.t===void 0&&(this.t=new X),this.t}get delayedStore(){return this.B(),this.u===void 0&&(this.u=new X),this.u}addObserver(e){const t=!this.f.has(e)&&this.i>0;super.addObserver(e),t&&(this.v?.delete(e)||e.beginUpdate(this))}removeObserver(e){this.f.has(e)&&this.i>0&&(this.v||(this.v=new Set),this.v.add(e)),super.removeObserver(e)}debugGetState(){return{state:this.a,stateStr:JH(this.a),updateCount:this.i,isComputing:this.n,dependencies:this.j,value:this.c}}debugSetValue(e){this.c=e}debugRecompute(){this.beginUpdate(this);try{this.n?this.a=2:this.A()}finally{this.endUpdate(this)}}setValue(e,t,i){this.c=e;const s=this.f;t.updateObserver(this,this);for(const r of s)r.handleChange(this,i)}};function NI(e,t,i=rn.ofCaller()){return new Ys(new Hu(e.owner,e.debugName,e.debugReferenceFn),t,void 0,e.onLastObserverRemoved,e.equalsFn??$c,i)}HH(NI);function _u(...e){let t,i,s,r;return e.length===2?[i,s]=e:[t,i,s,r]=e,new to(new Hu(t,void 0,s),i,s,()=>to.globalTransaction,$c,r??rn.ofCaller())}var to=class extends xw{constructor(e,t,i,s,r,n){super(n),this.e=e,this.i=t,this._getValue=i,this.j=s,this.k=r,this.c=!1,this.n=o=>{const a=this._getValue(o),c=this.a,l=!this.c||!this.k(c,a);let u=!1;l&&(this.a=a,this.c&&(u=!0,jH(this.j(),h=>{gi()?.handleObservableUpdated(this,{oldValue:c,newValue:a,change:void 0,didChange:l,hadValue:this.c});for(const f of this.f)h.updateObserver(f,this),f.handleChange(this,void 0)},()=>{const h=this.l();return"Event fired"+(h?`: ${h}`:"")})),this.c=!0),u||gi()?.handleObservableUpdated(this,{oldValue:c,newValue:a,change:void 0,didChange:l,hadValue:this.c})}}l(){return this.e.getDebugName(this)}get debugName(){const e=this.l();return"From Event"+(e?`: ${e}`:"")}g(){this.d=this.i(this.n)}h(){this.d.dispose(),this.d=void 0,this.c=!1,this.a=void 0}get(){return this.d?(this.c||this.n(void 0),this.a):this._getValue(void 0)}debugSetValue(e){this.a=e}debugGetState(){return{value:this.a,hasValue:this.c}}};(function(e){e.Observer=to;function t(i,s){let r=!1;to.globalTransaction===void 0&&(to.globalTransaction=i,r=!0);try{s()}finally{r&&(to.globalTransaction=void 0)}}e.batchEventsGlobally=t})(_u||(_u={}));function ZH(e){const t=new RI(!1,void 0);return e.addObserver(t),se(()=>{e.removeObserver(t)})}_H(ZH);function YH(e,t){const i=new RI(!0,t);e.addObserver(i);try{i.beginUpdate(e)}finally{i.endUpdate(e)}return se(()=>{e.removeObserver(i)})}WH(YH);var RI=class{constructor(e,t){this.b=e,this.c=t,this.a=0}beginUpdate(e){this.a++}endUpdate(e){this.a===1&&this.b&&(this.c?this.c(e.get()):e.reportChanges()),this.a--}handlePossibleChange(e){}handleChange(e,t){}},Xf;function QH(e){Xf||(Xf=new LI,yw(Xf)),Xf.addFilteredObj(e)}var LI=class{constructor(){this.a=0,this.f=new WeakMap}addFilteredObj(e){this.b||(this.b=new Set),this.b.add(e)}c(e){return this.b?.has(e)??!0}d(e){return XH([Ic(tW("|  ",this.a)),e])}e(e){return e.hadValue?e.didChange?[Ic(" "),Ds(Qs(e.oldValue,70),{color:"red",strikeThrough:!0}),Ic(" "),Ds(Qs(e.newValue,60),{color:"green"})]:[Ic(" (unchanged)")]:[Ic(" "),Ds(Qs(e.newValue,60),{color:"green"}),Ic(" (initial)")]}handleObservableCreated(e){if(e instanceof Ys){const t=e;if(this.f.set(t,new Set),!1){const s=[];t.__debugUpdating=s;const r=t.beginUpdate;t.beginUpdate=o=>(s.push(o),r.apply(t,[o]));const n=t.endUpdate;t.endUpdate=o=>{const a=s.indexOf(o);return a===-1&&console.error("endUpdate called without beginUpdate",t.debugName,o.debugName),s.splice(a,1),n.apply(t,[o])}}}}handleOnListenerCountChanged(e,t){}handleObservableUpdated(e,t){if(this.c(e)){if(e instanceof Ys){this._handleDerivedRecomputed(e,t);return}console.log(...this.d([Dc("observable value changed"),Ds(e.debugName,{color:"BlueViolet"}),...this.e(t)]))}}formatChanges(e){if(e.size!==0)return Ds(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,t,i){this.c(e)&&this.f.get(e)?.add(t)}_handleDerivedRecomputed(e,t){if(!this.c(e))return;const i=this.f.get(e);i&&(console.log(...this.d([Dc("derived recomputed"),Ds(e.debugName,{color:"BlueViolet"}),...this.e(t),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),i.clear())}handleDerivedCleared(e){this.c(e)&&console.log(...this.d([Dc("derived cleared"),Ds(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,t){this.c(e)&&console.log(...this.d([Dc("observable from event triggered"),Ds(e.debugName,{color:"BlueViolet"}),...this.e(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this.c(e)&&this.f.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,t,i){this.c(e)&&this.f.get(e).add(t)}handleAutorunStarted(e){const t=this.f.get(e);t&&(this.c(e)&&console.log(...this.d([Dc("autorun"),Ds(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.a++)}handleAutorunFinished(e){this.a--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),this.c(e)&&console.log(...this.d([Dc("transaction"),Ds(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.a++}handleEndTransaction(){this.a--}};function XH(e){const t=new Array,i=[];let s="";function r(o){if("length"in o)for(const a of o)a&&r(a);else"text"in o?(s+=`%c${o.text}`,t.push(o.style),o.data&&i.push(...o.data)):"data"in o&&i.push(...o.data)}r(e);const n=[s,...t];return n.push(...i),n}function Ic(e){return Ds(e,{color:"black"})}function Dc(e){return Ds(iW(`${e}: `,10),{color:"black",bold:!0})}function Ds(e,t={color:"black"}){function i(r){return Object.entries(r).reduce((n,[o,a])=>`${n}${o}:${a};`,"")}const s={color:t.color};return t.strikeThrough&&(s["text-decoration"]="line-through"),t.bold&&(s["font-weight"]="bold"),{text:e,style:i(s)}}function Qs(e,t){switch(typeof e){case"number":return""+e;case"string":return e.length+2<=t?`"${e}"`:`"${e.substr(0,t-7)}"+...`;case"boolean":return e?"true":"false";case"undefined":return"undefined";case"object":return e===null?"null":Array.isArray(e)?KH(e,t):eW(e,t);case"symbol":return e.toString();case"function":return`[[Function${e.name?" "+e.name:""}]]`;default:return""+e}}function KH(e,t){let i="[ ",s=!0;for(const r of e){if(s||(i+=", "),i.length-5>t){i+="...";break}s=!1,i+=`${Qs(r,t-i.length)}`}return i+=" ]",i}function eW(e,t){if(typeof e.toString=="function"&&e.toString!==Object.prototype.toString){const n=e.toString();return n.length<=t?n:n.substring(0,t-3)+"..."}const i=SI(e);let s=i?i+"(":"{ ",r=!0;for(const[n,o]of Object.entries(e)){if(r||(s+=", "),s.length-5>t){s+="...";break}r=!1,s+=`${n}: ${Qs(o,t-s.length)}`}return s+=i?")":" }",s}function tW(e,t){let i="";for(let s=1;s<=t;s++)i+=e;return i}function iW(e,t){for(;e.length<t;)e+=" ";return e}var sW=class BE{static createHost(t,i){return new BE(t,i)}static createClient(t,i){return new BE(t,i)}constructor(t,i){this.b=t,this.c=i,this.a=this.b({handleNotification:n=>{const o=n,a=this.c().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:n=>{const o=n;try{return{type:"result",value:this.c().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const s=new Proxy({},{get:(n,o)=>async(...a)=>{const c=await this.a.sendRequest([o,a]);if(c.type==="error")throw c.value;return c.value}}),r=new Proxy({},{get:(n,o)=>(...a)=>{this.a.sendNotification([o,a])}});this.api={notifications:r,requests:s}}};function rW(e,t){const i=globalThis;let s=[],r;const{channel:n,handler:o}=nW({sendNotification:c=>{r?r.sendNotification(c):s.push(c)}});let a;return(i.$$debugValueEditor_debugChannels??(i.$$debugValueEditor_debugChannels={}))[e]=c=>{a=t(),r=c;for(const l of s)c.sendNotification(l);return s=[],o},sW.createClient(n,()=>{if(!a)throw new Error("Not supported");return a})}function nW(e){let t;return{channel:s=>(t=s,{sendNotification:r=>{e.sendNotification(r)},sendRequest:r=>{throw new Error("not supported")}}),handler:{handleRequest:s=>s.type==="notification"?t?.handleNotification(s.data):t?.handleRequest(s.data)}}}var oW=class{constructor(){this.a=void 0}throttle(e,t){this.a===void 0&&(this.a=setTimeout(()=>{this.a=void 0,e()},t))}dispose(){this.a!==void 0&&clearTimeout(this.a)}};function OI(e,t){for(const i in t)e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?OI(e[i],t[i]):e[i]=t[i]}function FI(e,t){for(const i in t)t[i]===null?delete e[i]:e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?FI(e[i],t[i]):e[i]=t[i]}var aW=class Wd{static{this.a=void 0}static getInstance(){return Wd.a===void 0&&(Wd.a=new Wd),Wd.a}j(){const t=[],i=[...this.h];if(i.length===0)return;const s=i.flatMap(n=>n.debugGetUpdatingObservers()??[]).map(n=>n.observer),r=new Set;for(;s.length>0;){const n=s.shift();if(r.has(n))continue;r.add(n);const o=this.m(n,a=>{r.has(a)||s.push(a)});o&&t.push(o)}return{names:i.map(n=>n.getDebugName()??"tx"),affected:t}}k(t){const i=this.f.get(t);if(!i){pt(new Jt("No info found"));return}return i}l(t){const i=this.f.get(t);if(!i){pt(new Jt("No info found"));return}return i}m(t,i){if(t instanceof Ys){const s=[...t.debugGetObservers()];for(const c of s)i(c);const r=this.k(t);if(!r)return;const n=t.debugGetState(),o={name:t.debugName,instanceId:r.instanceId,updateCount:n.updateCount},a=[...r.changedObservables].map(c=>this.f.get(c)?.instanceId).filter(ps);if(n.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(n.state){case 0:return{...o,type:"observable/derived",state:"noValue"};case 3:return{...o,type:"observable/derived",state:"upToDate"};case 2:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(t instanceof Yf){const s=this.l(t);if(!s)return;const r={name:t.debugName,instanceId:s.instanceId,updateCount:s.updateCount},n=[...s.changedObservables].map(o=>this.f.get(o).instanceId);if(t.debugGetState().isRunning)return{...r,type:"autorun",state:"updating",changedDependencies:n};switch(t.debugGetState().state){case 3:return{...r,type:"autorun",state:"upToDate"};case 2:return{...r,type:"autorun",state:"stale",changedDependencies:n};case 1:return{...r,type:"autorun",state:"possiblyStale"}}}}n(t){const i=this.k(t);if(i)return{name:t.debugName,instanceId:i.instanceId}}p(t){if(t instanceof Ys)return{name:t.toString(),instanceId:this.k(t)?.instanceId};const i=this.l(t);if(i)return{name:t.toString(),instanceId:i.instanceId}}constructor(){this.b=0,this.c=0,this.e=new Map,this.f=new WeakMap,this.g=new Map,this.h=new Set,this.i=rW("observableDevTools",()=>({notifications:{setDeclarationIdFilter:t=>{},logObservableValue:t=>{console.log("logObservableValue",t)},flushUpdates:()=>{this.v()},resetUpdates:()=>{this.q=null,this.i.api.notifications.handleChange(this.s,!0)}},requests:{getDeclarations:()=>{const t={};for(const i of this.e.values())t[i.id]=i;return{decls:t}},getSummarizedInstances:()=>null,getObservableValueInfo:t=>({observers:[...this.g.get(t).debugGetObservers()].map(s=>this.p(s)).filter(ps)}),getDerivedInfo:t=>{const i=this.g.get(t);return{dependencies:[...i.debugGetState().dependencies].map(s=>this.n(s)).filter(ps),observers:[...i.debugGetObservers()].map(s=>this.p(s)).filter(ps)}},getAutorunInfo:t=>({dependencies:[...this.g.get(t).debugGetState().dependencies].map(s=>this.n(s)).filter(ps)}),getTransactionState:()=>this.j(),setValue:(t,i)=>{const s=this.g.get(t);if(s instanceof Ys)s.debugSetValue(i);else if(s instanceof Zf)s.debugSetValue(i);else if(s instanceof to)s.debugSetValue(i);else throw new Jt("Observable is not supported");const r=[...s.debugGetObservers()];for(const n of r)n.beginUpdate(s);for(const n of r)n.handleChange(s,void 0);for(const n of r)n.endUpdate(s)},getValue:t=>{const i=this.g.get(t);if(i instanceof Ys)return Qs(i.debugGetState().value,200);if(i instanceof Zf)return Qs(i.debugGetState().value,200)},logValue:t=>{const i=this.g.get(t);if(i&&"get"in i)console.log("Logged Value:",i.get());else throw new Jt("Observable is not supported")},rerun:t=>{const i=this.g.get(t);if(i instanceof Ys)i.debugRecompute();else if(i instanceof Yf)i.debugRerun();else throw new Jt("Observable is not supported")}}})),this.q=null,this.r=new oW,this.s={},this.v=()=>{this.q!==null&&(this.i.api.notifications.handleChange(this.q,!1),this.q=null)},rn.enable()}u(t){FI(this.s,t),this.q===null?this.q=t:OI(this.q,t),this.r.throttle(this.v,10)}w(t,i){if(!i)return-1;let s=this.e.get(i.id);return s===void 0&&(s={id:this.b++,type:t,url:i.fileName,line:i.line,column:i.column},this.e.set(i.id,s),this.u({decls:{[s.id]:s}})),s.id}handleObservableCreated(t,i){const r={declarationId:this.w("observable/value",i),instanceId:this.c++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this.f.set(t,r)}handleOnListenerCountChanged(t,i){const s=this.k(t);if(s){if(s.listenerCount===0&&i>0){const r=t instanceof Ys?"observable/derived":"observable/value";this.g.set(s.instanceId,t),this.u({instances:{[s.instanceId]:{instanceId:s.instanceId,declarationId:s.declarationId,formattedValue:s.lastValue,type:r,name:t.debugName}}})}else s.listenerCount>0&&i===0&&(this.u({instances:{[s.instanceId]:null}}),this.g.delete(s.instanceId));s.listenerCount=i}}handleObservableUpdated(t,i){if(t instanceof Ys){this._handleDerivedRecomputed(t,i);return}const s=this.k(t);s&&i.didChange&&(s.lastValue=Qs(i.newValue,30),s.listenerCount>0&&this.u({instances:{[s.instanceId]:{formattedValue:s.lastValue}}}))}handleAutorunCreated(t,i){const r={declarationId:this.w("autorun",i),instanceId:this.c++,updateCount:0,changedObservables:new Set};this.f.set(t,r),this.g.set(r.instanceId,t),r&&this.u({instances:{[r.instanceId]:{instanceId:r.instanceId,declarationId:r.declarationId,runCount:0,type:"autorun",name:t.debugName}}})}handleAutorunDisposed(t){const i=this.l(t);i&&(this.u({instances:{[i.instanceId]:null}}),this.f.delete(t),this.g.delete(i.instanceId))}handleAutorunDependencyChanged(t,i,s){const r=this.l(t);r&&r.changedObservables.add(i)}handleAutorunStarted(t){}handleAutorunFinished(t){const i=this.l(t);i&&(i.changedObservables.clear(),i.updateCount++,this.u({instances:{[i.instanceId]:{runCount:i.updateCount}}}))}handleDerivedDependencyChanged(t,i,s){const r=this.k(t);r&&r.changedObservables.add(i)}_handleDerivedRecomputed(t,i){const s=this.k(t);if(!s)return;const r=Qs(i.newValue,30);s.updateCount++,s.changedObservables.clear(),s.lastValue=r,s.listenerCount>0&&this.u({instances:{[s.instanceId]:{formattedValue:r,recomputationCount:s.updateCount}}})}handleDerivedCleared(t){const i=this.k(t);i&&(i.lastValue=void 0,i.changedObservables.clear(),i.listenerCount>0&&this.u({instances:{[i.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(t){this.h.add(t)}handleEndTransaction(t){this.h.delete(t)}};function cW(e,t){const i=t?.debugNamePostProcessor??(n=>n),s=Bu.from(e,i);if(!s)return"";const r=new Set;return t.type==="observers"?UI(s,0,r,t).trim():jI(s,0,r,t).trim()}function jI(e,t,i,s){const r="		".repeat(t),n=[];if(i.has(e.sourceObj))return n.push(`${r}* ${e.type} ${e.name} (already listed)`),n.join(`
`);if(i.add(e.sourceObj),n.push(`${r}* ${e.type} ${e.name}:`),n.push(`${r}  value: ${Qs(e.value,50)}`),n.push(`${r}  state: ${e.state}`),e.dependencies.length>0){n.push(`${r}  dependencies:`);for(const a of e.dependencies){const c=Bu.from(a,s.debugNamePostProcessor??(l=>l))??Bu.unknown(a);n.push(jI(c,t+1,i,s))}}return n.join(`
`)}function UI(e,t,i,s){const r="		".repeat(t),n=[];if(i.has(e.sourceObj))return n.push(`${r}* ${e.type} ${e.name} (already listed)`),n.join(`
`);if(i.add(e.sourceObj),n.push(`${r}* ${e.type} ${e.name}:`),n.push(`${r}  value: ${Qs(e.value,50)}`),n.push(`${r}  state: ${e.state}`),e.observers.length>0){n.push(`${r}  observers:`);for(const a of e.observers){const c=Bu.from(a,s.debugNamePostProcessor??(l=>l))??Bu.unknown(a);n.push(UI(c,t+1,i,s))}}return n.join(`
`)}var Bu=class Ql{static from(t,i){if(t instanceof Yf){const s=t.debugGetState();return new Ql(t,i(t.debugName),"autorun",void 0,s.stateStr,Array.from(s.dependencies),[])}else if(t instanceof Ys){const s=t.debugGetState();return new Ql(t,i(t.debugName),"derived",s.value,s.stateStr,Array.from(s.dependencies),Array.from(t.debugGetObservers()))}else if(t instanceof Zf){const s=t.debugGetState();return new Ql(t,i(t.debugName),"observableValue",s.value,"upToDate",[],Array.from(t.debugGetObservers()))}else if(t instanceof to){const s=t.debugGetState();return new Ql(t,i(t.debugName),"fromEvent",s.value,s.hasValue?"upToDate":"initial",[],Array.from(t.debugGetObservers()))}}static unknown(t){return new Ql(t,"(unknown)","unknown",void 0,"unknown",[],[])}constructor(t,i,s,r,n,o,a){this.sourceObj=t,this.name=i,this.type=s,this.value=r,this.state=n,this.dependencies=o,this.observers=a}};BH(cW),OH(QH);var lW=!1;lW&&yw(new LI),Rn&&Rn.VSCODE_DEV_DEBUG_OBSERVABLES&&yw(aW.getInstance());var io;(function(e){e.Internal={type:"internal",label:"Built-In"},e.External={type:"external",label:"External"};function t(r){switch(r.type){case"extension":return`extension:${r.extensionId.value}`;case"mcp":return`mcp:${r.collectionId}:${r.definitionId}`;case"user":return`user:${r.file.toString()}`;case"internal":return"internal";case"external":return"external"}}e.toKey=t;function i(r,n){return t(r)===t(n)}e.equals=i;function s(r){return r.type==="internal"?{ordinal:1,label:d(7242,null)}:r.type==="mcp"?{ordinal:2,label:r.label}:r.type==="user"?{ordinal:0,label:d(7243,null)}:{ordinal:3,label:r.label}}e.classify=s})(io||(io={}));function uW(e){return typeof e=="object"&&typeof e.sessionId=="string"&&y.isUri(e.sessionResource)}var Pc;(function(e){e.Hidden="hidden",e.HiddenAfterComplete="hiddenAfterComplete"})(Pc||(Pc={}));function hW(e){return!!e&&e.getTools!==void 0}var Kf=W("ILanguageModelToolsService"),zI;(function(e){e.execute="execute",e.edit="edit",e.search="search",e.agent="agent",e.read="read",e.web="web",e.todo="todo"})(zI||(zI={}));var ep;(function(e){e.runSubagent="runSubagent",e.vscode="vscode"})(ep||(ep={}));var Cw;(function(e){e.LATEST_PROTOCOL_VERSION="2025-11-25",e.JSONRPC_VERSION="2.0",e.PARSE_ERROR=-32700,e.INVALID_REQUEST=-32600,e.METHOD_NOT_FOUND=-32601,e.INVALID_PARAMS=-32602,e.INTERNAL_ERROR=-32603,e.URL_ELICITATION_REQUIRED=-32042})(Cw||(Cw={}));function dW(e,t){return it.toKey(e)+"/"+t}var HI;(function(e){e[e.WorkspaceFolder=0]="WorkspaceFolder",e[e.Workspace=100]="Workspace",e[e.User=200]="User",e[e.Extension=300]="Extension",e[e.Filesystem=400]="Filesystem",e[e.RemoteBoost=-50]="RemoteBoost"})(HI||(HI={}));var WI;(function(e){function t(i,s){return i.id===s.id&&i.remoteAuthority===s.remoteAuthority&&i.label===s.label&&i.trustBehavior===s.trustBehavior}e.equals=t})(WI||(WI={}));var _I;(function(e){e[e.Initial=0]="Initial",e[e.Dynamic=1]="Dynamic"})(_I||(_I={}));var BI;(function(e){function t(r){return r}e.toSerialized=t;function i(r){return{id:r.id,label:r.label,cacheNonce:r.cacheNonce,staticMetadata:r.staticMetadata,launch:Tc.fromSerialized(r.launch),variableReplacement:r.variableReplacement?kw.fromSerialized(r.variableReplacement):void 0}}e.fromSerialized=i;function s(r,n){return r.id===n.id&&r.label===n.label&&r.cacheNonce===n.cacheNonce&&$i(r.roots,n.roots,(o,a)=>o.toString()===a.toString())&&Ai(r.launch,n.launch)&&Ai(r.presentation,n.presentation)&&Ai(r.variableReplacement,n.variableReplacement)&&Ai(r.devMode,n.devMode)}e.equals=s})(BI||(BI={}));var kw;(function(e){function t(s){return s}e.toSerialized=t;function i(s){return{section:s.section,folder:s.folder?{...s.folder,uri:y.revive(s.folder.uri)}:void 0,target:s.target}}e.fromSerialized=i})(kw||(kw={}));var qI;(function(e){e.Empty={working:!1,starting:[],serversRequiringInteraction:[]}})(qI||(qI={}));var VI;(function(e){e[e.HasUnknown=0]="HasUnknown",e[e.LoadingUnknown=1]="LoadingUnknown",e[e.AllKnown=2]="AllKnown"})(VI||(VI={}));var ase=W("IMcpService"),GI;(function(e){let t;(function(i){i[i.Trusted=0]="Trusted",i[i.TrustedOnNonce=1]="TrustedOnNonce",i[i.Untrusted=2]="Untrusted",i[i.Unknown=3]="Unknown"})(t=e.Kind||(e.Kind={}))})(GI||(GI={}));var JI;(function(e){e[e.Unknown=0]="Unknown",e[e.Cached=1]="Cached",e[e.Outdated=2]="Outdated",e[e.RefreshingFromUnknown=3]="RefreshingFromUnknown",e[e.RefreshingFromCached=4]="RefreshingFromCached",e[e.Live=5]="Live"})(JI||(JI={}));var ZI;(function(e){e[e.Model=1]="Model",e[e.App=2]="App"})(ZI||(ZI={}));var YI;(function(e){e[e.Stdio=1]="Stdio",e[e.HTTP=2]="HTTP"})(YI||(YI={}));var Tc;(function(e){function t(r){return r}e.toSerialized=t;function i(r){switch(r.type){case 2:return{type:r.type,uri:y.revive(r.uri),headers:r.headers,authentication:r.authentication};case 1:return{type:r.type,cwd:r.cwd,command:r.command,args:r.args,env:r.env,envFile:r.envFile}}}e.fromSerialized=i;async function s(r){const n=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(JSON.stringify(r)));return c0(_.wrap(new Uint8Array(n)))}e.hash=s})(Tc||(Tc={}));var QI;(function(e){let t;(function(i){i[i.Stopped=0]="Stopped",i[i.Starting=1]="Starting",i[i.Running=2]="Running",i[i.Error=3]="Error"})(t=e.Kind||(e.Kind={})),e.toString=i=>{switch(i.state){case 0:return d(10617,null);case 1:return d(10618,null);case 2:return d(10619,null);case 3:return d(10620,null,i.message);default:M1(i)}},e.toKindString=i=>{switch(i){case 0:return"stopped";case 1:return"starting";case 2:return"running";case 3:return"error";default:M1(i)}},e.canBeStarted=i=>i===3||i===0,e.isRunning=i=>!e.canBeStarted(i.state)})(QI||(QI={}));var XI=class JN extends Error{static{this.d="User interaction required: "}static is(t){return t.message.startsWith(this.d)}constructor(t){super(`${JN.d}${t}`),this.reason=t}},KI;(function(e){e[e.Disabled=0]="Disabled",e[e.DisabledByAccess=1]="DisabledByAccess",e[e.Enabled=2]="Enabled"})(KI||(KI={}));var e6;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(e6||(e6={}));var t6;(function(e){e.Readme="readme",e.Manifest="manifest",e.Configuration="configuration"})(t6||(t6={}));var fW=W("IMcpWorkbenchService"),i6=class extends J{constructor(t,i){super(),this.f=t,this.D(i.onChange(this.update,this))}set mcpServer(t){this.f.forEach(i=>i.mcpServer=t)}update(t){for(const i of this.f)t&&i.mcpServer?t.id===i.mcpServer.id&&(i.mcpServer=t):i.update()}};i6=__decorate([__param(1,fW)],i6);var lse=new C("mcpServersGalleryStatus","unavailable"),use=new C("hasInstalledMcpServers",!0),s6;(function(e){e.scheme="mcp-resource";const t="dylo78gyp";function i(r,n){return typeof n=="string"&&(n=y.parse(n)),n.with({scheme:e.scheme,authority:c0(_.fromString(r.id)),path:["",n.scheme,n.authority||t].join("/")+n.path})}e.fromServer=i;function s(r){if(typeof r=="string"&&(r=y.parse(r)),r.scheme!==e.scheme)throw new Error(`Invalid MCP resource URI: ${r.toString()}`);const n=r.path.split("/");if(n.length<3)throw new Error(`Invalid MCP resource URI: ${r.toString()}`);const[,o,a,...c]=n,l=new URL(`${o}://${a.toLowerCase()===t?"":a}`);return l.pathname=c.length?"/"+c.join("/"):"",l.search=r.query,l.hash=r.fragment,{definitionId:nF(r.authority).toString(),resourceURL:l}}e.toServer=s})(s6||(s6={}));var r6;(function(e){e[e.Logging=1]="Logging",e[e.Completions=2]="Completions",e[e.Prompts=4]="Prompts",e[e.PromptsListChanged=8]="PromptsListChanged",e[e.Resources=16]="Resources",e[e.ResourcesSubscribe=32]="ResourcesSubscribe",e[e.ResourcesListChanged=64]="ResourcesListChanged",e[e.Tools=128]="Tools",e[e.ToolsListChanged=256]="ToolsListChanged"})(r6||(r6={}));var hse=W("IMcpServerSampling"),n6;(function(e){e.Prefix="mcp_",e[e.MaxPrefixLen=18]="MaxPrefixLen",e[e.MaxLength=64]="MaxLength"})(n6||(n6={}));var o6;(function(e){e[e.Form=0]="Form",e[e.URL=1]="URL"})(o6||(o6={}));var dse=W("IMcpElicitationService");function a6(){return Object.create(null)}var ca="**",$w="/",tp="[/\\\\]",ip="[^/\\\\]",pW=/\//g;function c6(e,t){switch(e){case 0:return"";case 1:return`${ip}*?`;default:return`(?:${tp}|${ip}+${tp}${t?`|${tp}${ip}+`:""})*?`}}function Mc(e,t){if(!e)return[];const i=[];let s=!1,r=!1,n="";for(const o of e){switch(o){case t:if(!s&&!r){i.push(n),n="";continue}break;case"{":s=!0;break;case"}":s=!1;break;case"[":r=!0;break;case"]":r=!1;break}n+=o}return n&&i.push(n),i}function l6(e){if(!e)return"";let t="";const i=Mc(e,$w);if(i.every(s=>s===ca))t=".*";else{let s=!1;i.forEach((r,n)=>{if(r===ca){if(s)return;t+=c6(2,n===i.length-1)}else{let o=!1,a="",c=!1,l="";for(const u of r){if(u!=="}"&&o){a+=u;continue}if(c&&(u!=="]"||!l)){let h;u==="-"?h=u:(u==="^"||u==="!")&&!l?h="^":u===$w?h="":h=On(u),l+=h;continue}switch(u){case"{":o=!0;continue;case"[":c=!0;continue;case"}":{const f=`(?:${Mc(a,",").map(p=>l6(p)).join("|")})`;t+=f,o=!1,a="";break}case"]":{t+="["+l+"]",c=!1,l="";break}case"?":t+=ip;continue;case"*":t+=c6(1);continue;default:t+=On(u)}}n<i.length-1&&(i[n+1]!==ca||n+2<i.length)&&(t+=tp)}s=r===ca})}return t}var gW=/^\*\*\/\*\.[\w\.-]+$/,mW=/^\*\*\/([\w\.-]+)\/?$/,vW=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,wW=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,bW=/^\*\*((\/[\w\.-]+)+)\/?$/,yW=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,u6=new ic(1e4),h6=function(){return!1},Cr=function(){return null};function Iw(e,t){if(!e)return Cr;let i;typeof e!="string"?i=e.pattern:i=e,i=i.trim();const s=t.ignoreCase??!1,r={...t,equals:s?gs:(c,l)=>c===l,endsWith:s?U2:(c,l)=>c.endsWith(l),isEqualOrParent:(c,l)=>Bo(c,l,!Mt||s)},n=`${s?i.toLowerCase():i}_${!!t.trimForExclusions}_${s}`;let o=u6.get(n);if(o)return d6(o,e,r);let a;return gW.test(i)?o=AW(i.substring(4),i,r):(a=mW.exec(Dw(i,r)))?o=SW(a[1],i,r):(t.trimForExclusions?wW:vW).test(i)?o=EW(i,r):(a=bW.exec(Dw(i,r)))?o=f6(a[1].substring(1),i,!0,r):(a=yW.exec(Dw(i,r)))?o=f6(a[1],i,!1,r):o=xW(i,r),u6.set(n,o),d6(o,e,r)}function d6(e,t,i){if(typeof t=="string")return e;const s=function(r,n){return i.isEqualOrParent(r,t.base)?e(F2(r.substring(t.base.length),It),n):null};return s.allBasenames=e.allBasenames,s.allPaths=e.allPaths,s.basenames=e.basenames,s.patterns=e.patterns,s}function Dw(e,t){return t.trimForExclusions&&e.endsWith("/**")?e.substring(0,e.length-2):e}function AW(e,t,i){return function(s,r){return typeof s=="string"&&i.endsWith(s,e)?t:null}}function SW(e,t,i){const s=`/${e}`,r=`\\${e}`,n=function(a,c){return typeof a!="string"?null:c?i.equals(c,e)?t:null:i.equals(a,e)||i.endsWith(a,s)||i.endsWith(a,r)?t:null},o=[e];return n.basenames=o,n.patterns=[t],n.allBasenames=o,n}function EW(e,t){const i=m6(e.slice(1,-1).split(",").map(a=>Iw(a,t)).filter(a=>a!==Cr),e),s=i.length;if(!s)return Cr;if(s===1)return i[0];const r=function(a,c){for(let l=0,u=i.length;l<u;l++)if(i[l](a,c))return e;return null},n=i.find(a=>!!a.allBasenames);n&&(r.allBasenames=n.allBasenames);const o=i.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function f6(e,t,i,s){const r=It===_e.sep,n=r?e:e.replace(pW,It),o=It+n,a=_e.sep+e;let c;return i?c=function(l,u){return typeof l=="string"&&(s.equals(l,n)||s.endsWith(l,o)||!r&&(s.equals(l,e)||s.endsWith(l,a)))?t:null}:c=function(l,u){return typeof l=="string"&&(s.equals(l,n)||!r&&s.equals(l,e))?t:null},c.allPaths=[(i?"*/":"./")+e],c}function xW(e,t){try{const i=new RegExp(`^${l6(e)}$`,t.ignoreCase?"i":void 0);return function(s){return i.lastIndex=0,typeof s=="string"&&i.test(s)?e:null}}catch{return Cr}}function la(e,t,i){return!e||typeof t!="string"?!1:Xs(e,i)(t)}function Xs(e,t={}){if(!e)return h6;if(typeof e=="string"||CW(e)){const i=Iw(e,t);if(i===Cr)return h6;const s=function(r,n){return!!i(r,n)};return i.allBasenames&&(s.allBasenames=i.allBasenames),i.allPaths&&(s.allPaths=i.allPaths),s}return kW(e,t)}function CW(e){const t=e;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function p6(e){return e.allBasenames||[]}function g6(e){return e.allPaths||[]}function kW(e,t){const i=m6(Object.getOwnPropertyNames(e).map(a=>$W(a,e[a],t)).filter(a=>a!==Cr)),s=i.length;if(!s)return Cr;if(!i.some(a=>!!a.requiresSiblings)){if(s===1)return i[0];const a=function(u,h){let f;for(let p=0,g=i.length;p<g;p++){const v=i[p](u,h);if(typeof v=="string")return v;zn(v)&&(f||(f=[]),f.push(v))}return f?(async()=>{for(const p of f){const g=await p;if(typeof g=="string")return g}return null})():null},c=i.find(u=>!!u.allBasenames);c&&(a.allBasenames=c.allBasenames);const l=i.reduce((u,h)=>h.allPaths?u.concat(h.allPaths):u,[]);return l.length&&(a.allPaths=l),a}const r=function(a,c,l){let u,h;for(let f=0,p=i.length;f<p;f++){const g=i[f];g.requiresSiblings&&l&&(c||(c=$t(a)),u||(u=c.substring(0,c.length-lf(a).length)));const v=g(a,c,u,l);if(typeof v=="string")return v;zn(v)&&(h||(h=[]),h.push(v))}return h?(async()=>{for(const f of h){const p=await f;if(typeof p=="string")return p}return null})():null},n=i.find(a=>!!a.allBasenames);n&&(r.allBasenames=n.allBasenames);const o=i.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(r.allPaths=o),r}function $W(e,t,i){if(t===!1)return Cr;const s=Iw(e,i);if(s===Cr)return Cr;if(typeof t=="boolean")return s;if(t){const r=t.when;if(typeof r=="string"){const n=(o,a,c,l)=>{if(!l||!s(o,a))return null;const u=r.replace("$(basename)",()=>c),h=l(u);return zn(h)?h.then(f=>f?e:null):h?e:null};return n.requiresSiblings=!0,n}}return s}function m6(e,t){const i=e.filter(a=>!!a.basenames);if(i.length<2)return e;const s=i.reduce((a,c)=>{const l=c.basenames;return l?a.concat(l):a},[]);let r;if(t){r=[];for(let a=0,c=s.length;a<c;a++)r.push(t)}else r=i.reduce((a,c)=>{const l=c.patterns;return l?a.concat(l):a},[]);const n=function(a,c){if(typeof a!="string")return null;if(!c){let u;for(u=a.length;u>0;u--){const h=a.charCodeAt(u-1);if(h===47||h===92)break}c=a.substring(u)}const l=s.indexOf(c);return l!==-1?r[l]:null};n.basenames=s,n.patterns=r,n.allBasenames=s;const o=e.filter(a=>!a.basenames);return o.push(n),o}function v6(e,t){return $i(e,t,(i,s)=>typeof i=="string"&&typeof s=="string"?i===s:typeof i!="string"&&typeof s!="string"?i.base===s.base&&i.pattern===s.pattern:!1)}var IW=W("notebookDocumentService"),Pw=["W","X","Y","Z","a","b","c","d","e","f"],DW=new RegExp(`^[${Pw.join("")}]+`),w6=7;function Tw(e){if(e.scheme!==V.vscodeNotebookCell)return;const t=e.fragment.indexOf("s");if(t<0)return;const i=parseInt(e.fragment.substring(0,t).replace(DW,""),w6),s=Wn(e.fragment.substring(t+1)).toString();if(!isNaN(i))return{handle:i,notebook:e.with({scheme:s,fragment:null})}}function PW(e,t){const i=t.toString(w6),r=`${i.length<Pw.length?Pw[i.length-1]:"z"}${i}s${_n(_.fromString(e.scheme),!0,!0)}`;return e.with({scheme:V.vscodeNotebookCell,fragment:r})}function TW(e){if(e.scheme!==V.vscodeNotebookMetadata)return;const t=Wn(e.fragment).toString();return e.with({scheme:t,fragment:null})}function MW(e){const t=`${_n(_.fromString(e.scheme),!0,!0)}`;return e.with({scheme:V.vscodeNotebookMetadata,fragment:t})}function b6(e){if(e.scheme!==V.vscodeNotebookCellOutput)return;const t=new URLSearchParams(e.query),i=t.get("openIn");if(!i)return;const s=t.get("outputId")??void 0,r=Tw(e.with({scheme:V.vscodeNotebookCell,query:null})),n=t.get("outputIndex")?parseInt(t.get("outputIndex")||"",10):void 0,o=r?r.notebook:e.with({scheme:t.get("notebookScheme")||V.file,fragment:null,query:null}),a=t.get("cellIndex")?parseInt(t.get("cellIndex")||"",10):void 0;return{notebook:o,openIn:i,outputId:s,outputIndex:n,cellHandle:r?.handle,cellFragment:e.fragment,cellIndex:a}}var NW=class{constructor(){this.a=new Ct}getNotebook(e){if(e.scheme===V.vscodeNotebookCell){const t=Tw(e);if(t){const i=this.a.get(t.notebook);if(i)return i}}if(e.scheme===V.vscodeNotebookCellOutput){const t=b6(e);if(t){const i=this.a.get(t.notebook);if(i)return i}}return this.a.get(e)}addNotebookDocument(e){this.a.set(e.uri,e)}removeNotebookDocument(e){this.a.delete(e.uri)}};Ne(IW,NW,1);var Nc;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(Nc||(Nc={}));var fse=["application/json","application/javascript","text/html","image/svg+xml",Gs.latex,Gs.markdown,"image/png","image/jpeg",Gs.text],pse=[Gs.latex,Gs.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Gs.text],y6;(function(e){e[e.Running=1]="Running",e[e.Idle=2]="Idle"})(y6||(y6={}));var A6;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(A6||(A6={}));var S6;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(S6||(S6={}));var E6;(function(e){e[e.WithHardKernelDependency=0]="WithHardKernelDependency",e[e.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",e[e.Pure=2]="Pure",e[e.Never=3]="Never"})(E6||(E6={}));var x6;(function(e){e.Always="always",e.Never="never",e.Optional="optional"})(x6||(x6={}));var Ks;(function(e){e[e.ModelChange=1]="ModelChange",e[e.Move=2]="Move",e[e.ChangeCellLanguage=5]="ChangeCellLanguage",e[e.Initialize=6]="Initialize",e[e.ChangeCellMetadata=7]="ChangeCellMetadata",e[e.Output=8]="Output",e[e.OutputItem=9]="OutputItem",e[e.ChangeCellContent=10]="ChangeCellContent",e[e.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",e[e.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",e[e.ChangeCellMime=13]="ChangeCellMime",e[e.Unknown=100]="Unknown"})(Ks||(Ks={}));var C6;(function(e){e[e.Handle=0]="Handle",e[e.Index=1]="Index"})(C6||(C6={}));var k6;(function(e){e[e.Replace=1]="Replace",e[e.Output=2]="Output",e[e.Metadata=3]="Metadata",e[e.CellLanguage=4]="CellLanguage",e[e.DocumentMetadata=5]="DocumentMetadata",e[e.Move=6]="Move",e[e.OutputItems=7]="OutputItems",e[e.PartialMetadata=8]="PartialMetadata",e[e.PartialInternalMetadata=9]="PartialInternalMetadata"})(k6||(k6={}));var $6;(function(e){e.scheme=V.vscodeNotebookMetadata;function t(s){return MW(s)}e.generate=t;function i(s){return TW(s)}e.parse=i})($6||($6={}));var Mw;(function(e){e.scheme=V.vscodeNotebookCell;function t(l,u){return PW(l,u)}e.generate=t;function i(l){return Tw(l)}e.parse=i;function s(l,u){return l.with({scheme:V.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:u??"",notebookScheme:l.scheme!==V.file?l.scheme:""}).toString()})}e.generateCellOutputUriWithId=s;function r(l,u,h){return l.with({scheme:V.vscodeNotebookCellOutput,fragment:u.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(h)}).toString()})}e.generateCellOutputUriWithIndex=r;function n(l,u,h,f,p){return l.with({scheme:V.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"notebookOutputEditor",notebook:l.toString(),cellIndex:String(h),outputId:f,outputIndex:String(p)}).toString()})}e.generateOutputEditorUri=n;function o(l){return b6(l)}e.parseCellOutputUri=o;function a(l,u,h){return e.generate(l,u).with({scheme:h})}e.generateCellPropertyUri=a;function c(l,u){if(l.scheme===u)return e.parse(l.with({scheme:e.scheme}))}e.parseCellPropertyUri=c})(Mw||(Mw={}));var gse=new C("notebookEditorCursorAtBoundary","none"),mse=new C("notebookEditorCursorAtLineBoundary","none"),I6;(function(e){e.default="default",e.option="option"})(I6||(I6={}));var D6;(function(e){e.Cells="cells",e.Text="text",e.None="none"})(D6||(D6={}));var P6;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(P6||(P6={}));var vse=class l1{static{this.d="notebook/"}static create(t,i){return`${l1.d}${t}/${i??t}`}static parse(t){if(t.startsWith(l1.d)){const i=t.substring(l1.d.length).split("/");if(i.length===2)return{notebookType:i[0],viewType:i[1]}}}},RW=new TextDecoder;function LW(e){const t=[];let i=!1;for(const o of e)(t.length===0||i)&&(t.push(o),i=!0);let s=FW(t);const r=_.concat(t.map(o=>_.wrap(o))),n=WW(r);return s=s||n.byteLength!==r.byteLength,{data:n,didCompression:s}}var sp="\x1B[A",Nw=sp.split("").map(e=>e.charCodeAt(0)),OW=10;function FW(e){let t=!1;return e.forEach((i,s)=>{if(s===0||i.length<sp.length)return;const r=e[s-1],n=i.subarray(0,sp.length);if(n[0]===Nw[0]&&n[1]===Nw[1]&&n[2]===Nw[2]){const o=r.lastIndexOf(OW);if(o===-1)return;t=!0,e[s-1]=r.subarray(0,o),e[s]=i.subarray(sp.length)}}),t}function jW(e){let t=e;do e=t,t=e.replace(/[^\n]\x08/gm,"");while(t.length<e.length);return e}function UW(e){for(e=e.replace(/\r+\n/gm,`
`);e.search(/\r[^$]/g)>-1;){const t=e.match(/^(.*)\r+/m)[1];let i=e.match(/\r+(.*)$/m)[1];i=i+t.slice(i.length,t.length),e=e.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,i)}return e}var zW=8,HW=13;function WW(e){return!e.buffer.includes(zW)&&!e.buffer.includes(HW)?e:_.fromString(UW(jW(RW.decode(e.buffer))))}var T6;(function(e){e.Delimiter="\0"})(T6||(T6={}));var M6;(function(e){e[e.IsSame=0]="IsSame",e[e.Disconnected=1]="Disconnected",e[e.IsChild=2]="IsChild",e[e.IsParent=3]="IsParent"})(M6||(M6={}));var Je=class Os{static fromExtHostTestItem(t,i,s=t.parent){if(t._isRoot)return new Os([i]);const r=[t.id];for(let n=s;n&&n.id!==i;n=n.parent)r.push(n.id);return r.push(i),new Os(r.reverse())}static isRoot(t){return!t.includes("\0")}static root(t){const i=t.indexOf("\0");return i===-1?t:t.slice(0,i)}static fromString(t){return new Os(t.split("\0"))}static join(t,i){return new Os([...t.path,i])}static split(t){return t.split("\0")}static joinToString(t,i){return t.toString()+"\0"+i}static parentId(t){const i=t.lastIndexOf("\0");return i===-1?void 0:t.slice(0,i)}static localId(t){const i=t.lastIndexOf("\0");return i===-1?t:t.slice(i+1)}static isChild(t,i){return i[t.length]==="\0"&&i.startsWith(t)}static compare(t,i){return t===i?0:Os.isChild(t,i)?2:Os.isChild(i,t)?3:1}static getLengthOfCommonPrefix(t,i){if(t===0)return 0;let s=0;for(;s<t-1;){for(let r=1;r<t;r++){const n=i(r-1),o=i(r);if(n.path[s]!==o.path[s])return s}s++}return s}constructor(t,i=t.length){if(this.path=t,this.d=i,t.length===0||i<1)throw new Error("cannot create test with empty path")}get rootId(){return new Os(this.path,1)}get parentId(){return this.d>1?new Os(this.path,this.d-1):void 0}get localId(){return this.path[this.d-1]}get controllerId(){return this.path[0]}get isRoot(){return this.d===1}*idsFromRoot(){for(let t=1;t<=this.d;t++)yield new Os(this.path,t)}*idsToRoot(){for(let t=this.d;t>0;t--)yield new Os(this.path,t)}compare(t){if(typeof t=="string")return Os.compare(this.toString(),t);for(let i=0;i<t.d&&i<this.d;i++)if(t.path[i]!==this.path[i])return 1;return t.d>this.d?2:t.d<this.d?3:0}toJSON(){return this.toString()}toString(){if(!this.c){this.c=this.path[0];for(let t=1;t<this.d;t++)this.c+="\0",this.c+=this.path[t]}return this.c}},N6;(function(e){e[e.Unset=0]="Unset",e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(N6||(N6={}));var R6;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(R6||(R6={}));var L6;(function(e){e[e.Refresh=2]="Refresh",e[e.CodeRelatedToTest=4]="CodeRelatedToTest",e[e.TestRelatedToCode=8]="TestRelatedToCode"})(L6||(L6={}));var O6;(function(e){e[e.Run=2]="Run",e[e.Debug=4]="Debug",e[e.Coverage=8]="Coverage",e[e.HasNonDefaultProfile=16]="HasNonDefaultProfile",e[e.HasConfigurable=32]="HasConfigurable",e[e.SupportsContinuousRun=64]="SupportsContinuousRun"})(O6||(O6={}));var wse={2:d(14639,null),4:d(14640,null),8:d(14641,null)},_W=e=>"runId"in e,Rc;(function(e){e.serialize=t=>({range:t.range.toJSON(),uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({range:ot.lift(i.range),uri:t.asCanonicalUri(y.revive(i.uri))})})(Rc||(Rc={}));var F6;(function(e){e[e.Error=0]="Error",e[e.Output=1]="Output"})(F6||(F6={}));var rp;(function(e){e.serialize=t=>({label:t.label,uri:t.uri?.toJSON(),position:t.position?.toJSON()}),e.deserialize=(t,i)=>({label:i.label,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,position:i.position?ws.lift(i.position):void 0})})(rp||(rp={}));var np;(function(e){e.serialize=t=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&Rc.serialize(t.location),stackTrace:t.stackTrace?.map(rp.serialize)}),e.deserialize=(t,i)=>({message:i.message,type:0,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&Rc.deserialize(t,i.location),stackTrace:i.stackTrace&&i.stackTrace.map(s=>rp.deserialize(t,s))})})(np||(np={}));var op;(function(e){e.serialize=t=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&Rc.serialize(t.location)}),e.deserialize=(t,i)=>({message:i.message,type:1,offset:i.offset,length:i.length,location:i.location&&Rc.deserialize(t,i.location)})})(op||(op={}));var ap;(function(e){e.serialize=t=>t.type===0?np.serialize(t):op.serialize(t),e.deserialize=(t,i)=>i.type===0?np.deserialize(t,i):op.deserialize(t,i),e.isDiffable=t=>t.type===0&&t.actual!==void 0&&t.expected!==void 0})(ap||(ap={}));var qu;(function(e){e.serializeWithoutMessages=t=>({state:t.state,duration:t.duration,messages:[]}),e.serialize=t=>({state:t.state,duration:t.duration,messages:t.messages.map(ap.serialize)}),e.deserialize=(t,i)=>({state:i.state,duration:i.duration,messages:i.messages.map(s=>ap.deserialize(t,s))})})(qu||(qu={}));var j6="\0",cp=(e,t)=>e+j6+t,U6=e=>{const t=e.indexOf(j6);return{ctrlId:e.slice(0,t),tagId:e.slice(t+1)}},lp;(function(e){e.serialize=t=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?.toJSON(),range:t.range?.toJSON()||null,description:t.description,error:t.error,sortText:t.sortText}),e.deserialize=(t,i)=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,range:i.range?ot.lift(i.range):null,description:i.description,error:i.error,sortText:i.sortText})})(lp||(lp={}));var z6;(function(e){e[e.NotExpandable=0]="NotExpandable",e[e.Expandable=1]="Expandable",e[e.BusyExpanding=2]="BusyExpanding",e[e.Expanded=3]="Expanded"})(z6||(z6={}));var so;(function(e){e.serialize=t=>({expand:t.expand,item:lp.serialize(t.item)}),e.deserialize=(t,i)=>({controllerId:Je.root(i.item.extId),expand:i.expand,item:lp.deserialize(t,i.item)})})(so||(so={}));var Vu;(function(e){e.serialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.uri!==void 0&&(i.uri=t.item.uri?.toJSON()),t.item.range!==void 0&&(i.range=t.item.range?.toJSON()),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}},e.deserialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.range!==void 0&&(i.range=t.item.range?ot.lift(t.item.range):null),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}}})(Vu||(Vu={}));var Rw=(e,t)=>{t.expand!==void 0&&(e.expand=t.expand),t.item!==void 0&&(e.item=e.item?Object.assign(e.item,t.item):t.item)},H6;(function(e){e.serializeWithoutMessages=t=>({...so.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(qu.serializeWithoutMessages)}),e.serialize=t=>({...so.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(qu.serialize)}),e.deserialize=(t,i)=>({...so.deserialize(t,i),ownComputedState:i.ownComputedState,computedState:i.computedState,tasks:i.tasks.map(s=>qu.deserialize(t,s)),retired:!0})})(H6||(H6={}));var Lw;(function(e){e.empty=()=>({covered:0,total:0}),e.sum=(t,i)=>{t.covered+=i.covered,t.total+=i.total}})(Lw||(Lw={}));var W6;(function(e){e.serialize=t=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({id:i.id,statement:i.statement,branch:i.branch,declaration:i.declaration,testIds:i.testIds,uri:t.asCanonicalUri(y.revive(i.uri))}),e.empty=(t,i)=>({id:t,uri:i,statement:Lw.empty()})})(W6||(W6={}));function Ow(e){return{...e,location:e.location?.toJSON()}}function Fw(e){return e.location=e.location?ws.isIPosition(e.location)?ws.lift(e.location):ot.lift(e.location):void 0,e}var _6;(function(e){e[e.Declaration=0]="Declaration",e[e.Statement=1]="Statement",e[e.Branch=2]="Branch"})(_6||(_6={}));var B6;(function(e){e.serialize=t=>t.type===0?hp.serialize(t):dp.serialize(t),e.deserialize=t=>t.type===0?hp.deserialize(t):dp.deserialize(t)})(B6||(B6={}));var up;(function(e){e.serialize=Ow,e.deserialize=Fw})(up||(up={}));var hp;(function(e){e.serialize=Ow,e.deserialize=Fw})(hp||(hp={}));var dp;(function(e){e.serialize=t=>({...Ow(t),branches:t.branches?.map(up.serialize)}),e.deserialize=t=>({...Fw(t),branches:t.branches?.map(up.deserialize)})})(dp||(dp={}));var q6;(function(e){e[e.Add=0]="Add",e[e.Update=1]="Update",e[e.DocumentSynced=2]="DocumentSynced",e[e.Remove=3]="Remove",e[e.IncrementPendingExtHosts=4]="IncrementPendingExtHosts",e[e.Retire=5]="Retire",e[e.AddTag=6]="AddTag",e[e.RemoveTag=7]="RemoveTag"})(q6||(q6={}));var fp;(function(e){e.deserialize=(t,i)=>i.op===0?{op:i.op,item:so.deserialize(t,i.item)}:i.op===1?{op:i.op,item:Vu.deserialize(i.item)}:i.op===2?{op:i.op,uri:t.asCanonicalUri(y.revive(i.uri)),docv:i.docv}:i,e.serialize=t=>t.op===0?{op:t.op,item:so.serialize(t.item)}:t.op===1?{op:t.op,item:Vu.serialize(t.item)}:t})(fp||(fp={}));var BW=class{constructor(e){this.l=e,this.f=new Map,this.g=new Map,this.h=new Set,this.j=0,this.k=0,this.tags=this.f}apply(e){const t=this.x();for(const i of e)switch(i.op){case 0:this.p(so.deserialize(this.l,i.item),t);break;case 1:this.q(Vu.deserialize(i.item),t);break;case 3:this.v(i.itemId,t);break;case 5:this.w(i.itemId);break;case 4:this.updatePendingRoots(i.amount);break;case 6:this.f.set(i.tag.id,i.tag);break;case 7:this.f.delete(i.id);break}t.complete?.()}p(e,t){const i=Je.parentId(e.item.extId)?.toString();let s;if(!i)s=this.y(e),this.h.add(s),this.g.set(e.item.extId,s);else if(this.g.has(i)){const r=this.g.get(i);r.children.add(e.item.extId),s=this.y(e,r),this.g.set(e.item.extId,s)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return t.add?.(s),e.expand===2&&this.j++,s}q(e,t){const i=this.g.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.j--,e.expand===2&&this.j++),Rw(i,e),t.update?.(i),i}v(e,t){const i=this.g.get(e);if(!i)return;const s=Je.parentId(i.item.extId)?.toString();s?this.g.get(s).children.delete(i.item.extId):this.h.delete(i);const r=[[e]];for(;r.length;)for(const n of r.pop()){const o=this.g.get(n);o&&(r.push(o.children),this.g.delete(n),t.remove?.(o,o!==i),o.expand===2&&this.j--)}}w(e){}updatePendingRoots(e){this.k+=e}x(){return{}}},bse=W("IAiSettingsSearchService"),ro;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(ro||(ro={}));var qW=W("editorGroupsService"),V6;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(V6||(V6={}));var G6;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(G6||(G6={}));var J6;(function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST",e[e.NEXT=2]="NEXT",e[e.PREVIOUS=3]="PREVIOUS"})(J6||(J6={}));var Z6;(function(e){e[e.MAXIMIZE=0]="MAXIMIZE",e[e.EXPAND=1]="EXPAND",e[e.EVEN=2]="EVEN"})(Z6||(Z6={}));var Y6;(function(e){e[e.COPY_EDITORS=0]="COPY_EDITORS",e[e.MOVE_EDITORS=1]="MOVE_EDITORS"})(Y6||(Y6={}));var Q6;(function(e){e[e.CREATION_TIME=0]="CREATION_TIME",e[e.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",e[e.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(Q6||(Q6={}));var X6;(function(e){e[e.NEW_EDITOR=1]="NEW_EDITOR",e[e.MOVE_EDITOR=2]="MOVE_EDITOR",e[e.COPY_EDITOR=3]="COPY_EDITOR"})(X6||(X6={}));var K6=W("editorService"),VW=-1,GW=-2,no;(function(e){e.Extensions="Extensions",e.IntegratedTerminal="IntegratedTerminal",e.InteractiveSession="InteractiveSession",e.Telemetry="Telemetry",e.Update="Update"})(no||(no={}));var yse={[no.Extensions]:{name:{key:"extensionsConfigurationTitle",value:d(148,null)}},[no.IntegratedTerminal]:{name:{key:"terminalIntegratedConfigurationTitle",value:d(149,null)}},[no.InteractiveSession]:{name:{key:"interactiveSessionConfigurationTitle",value:d(150,null)}},[no.Telemetry]:{name:{key:"telemetryConfigurationTitle",value:d(151,null)}},[no.Update]:{name:{key:"updateConfigurationTitle",value:d(152,null)}}},rs=W("configurationService"),eD;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.USER=2]="USER",e[e.USER_LOCAL=3]="USER_LOCAL",e[e.USER_REMOTE=4]="USER_REMOTE",e[e.WORKSPACE=5]="WORKSPACE",e[e.WORKSPACE_FOLDER=6]="WORKSPACE_FOLDER",e[e.DEFAULT=7]="DEFAULT",e[e.MEMORY=8]="MEMORY"})(eD||(eD={}));function jw(e,t){const i=Object.create(null);for(const s in e)tD(i,s,e[s],t);return i}function tD(e,t,i,s){const r=t.split("."),n=r.pop();let o=e;for(let a=0;a<r.length;a++){const c=r[a];let l=o[c];switch(typeof l){case"undefined":l=o[c]=Object.create(null);break;case"object":if(l===null){s(`Ignoring ${t} as ${r.slice(0,a+1).join(".")} is null`);return}break;default:s(`Ignoring ${t} as ${r.slice(0,a+1).join(".")} is ${JSON.stringify(l)}`);return}o=l}if(typeof o=="object"&&o!==null)try{o[n]=i}catch{s(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(o)}`)}else s(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(o)}`)}function JW(e,t){const i=t.split(".");iD(e,i)}function iD(e,t){if(!e)return;const i=e,s=t.shift();if(t.length===0){delete i[s];return}if(Object.keys(i).indexOf(s)!==-1){const r=i[s];typeof r=="object"&&!Array.isArray(r)&&(iD(r,t),Object.keys(r).length===0&&delete i[s])}}function pp(e,t,i){function s(o,a){let c=o;for(const l of a){if(typeof c!="object"||c===null)return;c=c[l]}return c}const r=t.split("."),n=s(e,r);return typeof n>"u"?i:n}function ZW(e){return e.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}function YW(e){let t=!1;const i=new Map,s=new Map;if(QW(e,u=>{if(e===u)return!0;const h=JSON.stringify(u);if(h.length<30)return!0;const f=i.get(h);if(!f){const p={schemas:[u]};return i.set(h,p),s.set(u,p),!0}return f.schemas.push(u),s.set(u,f),t=!0,!1}),i.clear(),!t)return JSON.stringify(e);let n="$defs";for(;e.hasOwnProperty(n);)n+="_";const o=[];function a(u){return JSON.stringify(u,(h,f)=>{if(f!==u){const p=s.get(f);if(p&&p.schemas.length>1)return p.id||(p.id=`_${o.length}`,o.push(p.schemas[0])),{$ref:`#/${n}/${p.id}`}}return f})}const c=a(e),l=[];for(let u=0;u<o.length;u++)l.push(`"_${u}":${a(o[u])}`);return l.length?`${c.substring(0,c.length-1)},"${n}":{${l.join(",")}}}`:c}function Lc(e){return typeof e=="object"&&e!==null}function QW(e,t){if(!e||typeof e!="object")return;const i=(...c)=>{for(const l of c)Lc(l)&&o.push(l)},s=(...c)=>{for(const l of c)if(Lc(l))for(const u in l){const h=l[u];Lc(h)&&o.push(h)}},r=(...c)=>{for(const l of c)if(Array.isArray(l))for(const u of l)Lc(u)&&o.push(u)},n=c=>{if(Array.isArray(c))for(const l of c)Lc(l)&&o.push(l);else Lc(c)&&o.push(c)},o=[e];let a=o.pop();for(;a;)t(a)&&(i(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),s(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),r(a.anyOf,a.allOf,a.oneOf,a.prefixItems),n(a.items)),a=o.pop()}var gp={JSONContribution:"base.contributions.json"};function sD(e){return e.length>0&&e.charAt(e.length-1)==="#"?e.substring(0,e.length-1):e}var XW=class extends J{constructor(){super(...arguments),this.a={},this.b={},this.c=this.D(new I),this.onDidChangeSchema=this.c.event,this.f=this.D(new I),this.onDidChangeSchemaAssociations=this.f.event}registerSchema(e,t,i){const s=sD(e);this.a[s]=t,this.c.fire(e),i&&i.add(se(()=>{delete this.a[s],this.c.fire(e)}))}registerSchemaAssociation(e,t){const i=sD(e);return this.b[i]||(this.b[i]=[]),this.b[i].includes(t)||(this.b[i].push(t),this.f.fire()),se(()=>{const s=this.b[i];if(s){const r=s.indexOf(t);r!==-1&&(s.splice(r,1),s.length===0&&delete this.b[i],this.f.fire())}})}notifySchemaChanged(e){this.c.fire(e)}getSchemaContributions(){return{schemas:this.a}}getSchemaContent(e){const t=this.a[e];return t?YW(t):void 0}hasSchemaContent(e){return!!this.a[e]}getSchemaAssociations(){return this.b}},KW=new XW;Qt.add(gp.JSONContribution,KW);var rD;(function(e){e.Multiline="multilineText",e.Singleline="singlelineText"})(rD||(rD={}));var oo={Configuration:"base.contributions.configuration"},nD;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.MACHINE=2]="MACHINE",e[e.APPLICATION_MACHINE=3]="APPLICATION_MACHINE",e[e.WINDOW=4]="WINDOW",e[e.RESOURCE=5]="RESOURCE",e[e.LANGUAGE_OVERRIDABLE=6]="LANGUAGE_OVERRIDABLE",e[e.MACHINE_OVERRIDABLE=7]="MACHINE_OVERRIDABLE"})(nD||(nD={}));var mp={properties:{},patternProperties:{}},vp={properties:{},patternProperties:{}},wp={properties:{},patternProperties:{}},bp={properties:{},patternProperties:{}},yp={properties:{},patternProperties:{}},Ap={properties:{},patternProperties:{}},Gu={properties:{},patternProperties:{}},ua="vscode://schemas/settings/resourceLanguage",Sp=Qt.as(gp.JSONContribution),e_=class extends J{constructor(){super(),this.a=[],this.n=new Set,this.q=this.D(new I),this.onDidSchemaChange=this.q.event,this.r=this.D(new I),this.onDidUpdateConfiguration=this.r.event,this.b=new Map,this.c={id:"defaultOverrides",title:d(1841,null),properties:{}},this.f=[this.c],this.m={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.g={},this.h=new Map,this.j={},Sp.registerSchema(ua,this.m),this.N()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.F(e,t,i),Sp.registerSchema(ua,this.m),this.q.fire(),this.r.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.G(e,t),Sp.registerSchema(ua,this.m),this.q.fire(),this.r.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.G(t,i),this.F(e,!1,i),Sp.registerSchema(ua,this.m),this.q.fire(),this.r.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.s(e,t),this.q.fire(),this.r.fire({properties:t,defaultsOverrides:!0})}s(e,t){this.a.push(...e);const i=[];for(const{overrides:s,source:r}of e)for(const n in s){t.add(n);const o=this.b.get(n)??this.b.set(n,{configurationDefaultOverrides:[]}).get(n),a=s[n];if(o.configurationDefaultOverrides.push({value:a,source:r}),kr.test(n)){const c=this.y(n,a,r,o.configurationDefaultOverrideValue);if(!c)continue;o.configurationDefaultOverrideValue=c,this.w(n,c,r),i.push(...Ju(n))}else{const c=this.z(n,a,r,o.configurationDefaultOverrideValue);if(!c)continue;o.configurationDefaultOverrideValue=c;const l=this.g[n];l&&(this.O(n,l),this.J(n,l))}}this.C(i)}deregisterDefaultConfigurations(e){const t=new Set;this.u(e,t),this.q.fire(),this.r.fire({properties:t,defaultsOverrides:!0})}u(e,t){for(const i of e){const s=this.a.indexOf(i);s!==-1&&this.a.splice(s,1)}for(const{overrides:i,source:s}of e)for(const r in i){const n=this.b.get(r);if(!n)continue;const o=n.configurationDefaultOverrides.findIndex(a=>s?a.source?.id===s.id:a.value===i[r]);if(o!==-1){if(n.configurationDefaultOverrides.splice(o,1),n.configurationDefaultOverrides.length===0&&this.b.delete(r),kr.test(r)){let a;for(const c of n.configurationDefaultOverrides)a=this.y(r,c.value,c.source,a);a&&!L1(a.value)?(n.configurationDefaultOverrideValue=a,this.w(r,a,s)):(this.b.delete(r),delete this.g[r],delete this.c.properties[r])}else{let a;for(const l of n.configurationDefaultOverrides)a=this.z(r,l.value,l.source,a);n.configurationDefaultOverrideValue=a;const c=this.g[r];c&&(this.O(r,c),this.J(r,c))}t.add(r)}}this.M()}w(e,t,i){const s={section:{id:this.c.id,title:this.c.title,order:this.c.order,extensionInfo:this.c.extensionInfo},type:"object",default:t.value,description:d(1842,null,ZW(e)),$ref:ua,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.g[e]=s,this.c.properties[e]=s}y(e,t,i,s){const r=s?.value||{},n=s?.source??new Map;if(!(n instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const o of Object.keys(t)){const a=t[o];if(kt(a)&&(lu(r[o])||kt(r[o]))){if(r[o]={...r[o]??{},...a},i)for(const l in a)n.set(`${o}.${l}`,i)}else r[o]=a,i?n.set(o,i):n.delete(o)}return{value:r,source:n}}z(e,t,i,s){const r=this.g[e],n=s?.value??r?.defaultDefaultValue;let o=i;if(kt(t)&&(r!==void 0&&r.type==="object"||r===void 0&&(lu(n)||kt(n)))){if(o=s?.source??new Map,!(o instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&o.set(`${e}.${c}`,i);t={...kt(n)?n:{},...t}}return{value:t,source:o}}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.u(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.s(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.G(e.removedConfigurations,i),e.addedConfigurations&&this.F(e.addedConfigurations,!1,i),this.q.fire(),this.r.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this.q.fire()}registerOverrideIdentifiers(e){this.C(e),this.q.fire()}C(e){for(const t of e)this.n.add(t);this.M()}F(e,t,i){e.forEach(s=>{this.H(s,t,s.extensionInfo,s.restrictedProperties,void 0,i),this.f.push(s),this.I(s)})}G(e,t){const i=s=>{if(s.properties)for(const r in s.properties){t.add(r);const n=this.g[r];n?.policy?.name&&this.h.delete(n.policy.name),delete this.g[r],this.L(r,s.properties[r])}s.allOf?.forEach(r=>i(r))};for(const s of e){i(s);const r=this.f.indexOf(s);r!==-1&&this.f.splice(r,1)}}H(e,t=!0,i,s,r=4,n){r=qt(e.scope)?r:e.scope;const o=e.properties;if(o)for(const c in o){const l=o[c];if(l.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo},t&&i_(c,l,i?.id)){delete o[c];continue}l.source=i,l.defaultDefaultValue=o[c].default,this.O(c,l),kr.test(c)?l.scope=void 0:(l.scope=qt(l.scope)?r:l.scope,l.restricted=qt(l.restricted)?!!s?.includes(c):l.restricted),l.experiment?l.tags?.some(f=>f.toLowerCase()==="onexp")||(l.tags=l.tags??[],l.tags.push("onExP")):l.tags?.some(f=>f.toLowerCase()==="onexp")&&(console.error(`Invalid tag 'onExP' found for property '${c}'. Please use 'experiment' property instead.`),l.experiment={mode:"startup"});const u=o[c].hasOwnProperty("included")&&!o[c].included,h=o[c].policy?.name;u?(this.j[c]=o[c],h&&(this.h.set(h,c),n.add(c)),delete o[c]):(n.add(c),h&&this.h.set(h,c),this.g[c]=o[c],!o[c].deprecationMessage&&o[c].markdownDeprecationMessage&&(o[c].deprecationMessage=o[c].markdownDeprecationMessage))}const a=e.allOf;if(a)for(const c of a)this.H(c,t,i,s,r,n)}getConfigurations(){return this.f}getConfigurationProperties(){return this.g}getPolicyConfigurations(){return this.h}getExcludedConfigurationProperties(){return this.j}getRegisteredDefaultConfigurations(){return[...this.a]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[t,i]of this.b)i.configurationDefaultOverrideValue&&e.set(t,i.configurationDefaultOverrideValue);return e}I(e){const t=i=>{const s=i.properties;if(s)for(const n in s)this.J(n,s[n]);i.allOf?.forEach(t)};t(e)}J(e,t){switch(mp.properties[e]=t,t.scope){case 1:vp.properties[e]=t;break;case 2:bp.properties[e]=t;break;case 3:wp.properties[e]=t;break;case 7:yp.properties[e]=t;break;case 4:Ap.properties[e]=t;break;case 5:Gu.properties[e]=t;break;case 6:Gu.properties[e]=t,this.m.properties[e]=t;break}}L(e,t){switch(delete mp.properties[e],t.scope){case 1:delete vp.properties[e];break;case 2:delete bp.properties[e];break;case 3:delete wp.properties[e];break;case 7:delete yp.properties[e];break;case 4:delete Ap.properties[e];break;case 5:case 6:delete Gu.properties[e],delete this.m.properties[e];break}}M(){for(const e of this.n.values()){const t=`[${e}]`,i={type:"object",description:d(1843,null),errorMessage:d(1844,null),$ref:ua};this.O(t,i),mp.properties[t]=i,vp.properties[t]=i,wp.properties[t]=i,bp.properties[t]=i,yp.properties[t]=i,Ap.properties[t]=i,Gu.properties[t]=i}}N(){const e={type:"object",description:d(1845,null),errorMessage:d(1846,null),$ref:ua};mp.patternProperties[ao]=e,vp.patternProperties[ao]=e,wp.patternProperties[ao]=e,bp.patternProperties[ao]=e,yp.patternProperties[ao]=e,Ap.patternProperties[ao]=e,Gu.patternProperties[ao]=e,this.q.fire()}O(e,t){const i=this.b.get(e)?.configurationDefaultOverrideValue;let s,r;i&&(!t.disallowConfigurationDefault||!i.source)&&(s=i.value,r=i.source),lu(s)&&(s=t.defaultDefaultValue,r=void 0),lu(s)&&(s=t_(t.type)),t.default=s,t.defaultValueSource=r}},oD="\\[([^\\]]+)\\]",aD=new RegExp(oD,"g"),ao=`^(${oD})+$`,kr=new RegExp(ao);function Ju(e){const t=[];if(kr.test(e)){let i=aD.exec(e);for(;i?.length;){const s=i[1].trim();s&&t.push(s),i=aD.exec(e)}}return Ro(t)}function t_(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var Ep=new e_;Qt.add(oo.Configuration,Ep);function i_(e,t,i){return e.trim()?kr.test(e)?d(1848,null,e):Ep.getConfigurationProperties()[e]!==void 0&&(!i||!s_.has(i.toLowerCase()))?d(1849,null,e):t.policy?.name&&Ep.getPolicyConfigurations().get(t.policy?.name)!==void 0?d(1850,null,e,t.policy?.name,Ep.getPolicyConfigurations().get(t.policy?.name)):null:d(1847,null)}var s_=new Set(qs.defaultChatAgent?[qs.defaultChatAgent.extensionId,qs.defaultChatAgent.chatExtensionId].map(e=>e.toLowerCase()):[]),xp="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",Ase=new RegExp(xp),cD;(function(e){e.COMMAND="command",e.SETTINGS_SYNC="settingsSync"})(cD||(cD={}));var lD;(function(e){e.NoneOrRelevance="NoneOrRelevance",e.LastUpdatedDate="LastUpdatedDate",e.Title="Title",e.PublisherName="PublisherName",e.InstallCount="InstallCount",e.PublishedDate="PublishedDate",e.AverageRating="AverageRating",e.WeightedRating="WeightedRating"})(lD||(lD={}));var uD;(function(e){e[e.Default=0]="Default",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"})(uD||(uD={}));var hD;(function(e){e.Category="Category",e.ExtensionId="ExtensionId",e.ExtensionName="ExtensionName",e.ExcludeWithFlags="ExcludeWithFlags",e.Featured="Featured",e.SearchText="SearchText",e.Tag="Tag",e.Target="Target"})(hD||(hD={}));var dD;(function(e){e.Install="install",e.Uninstall="uninstall"})(dD||(dD={}));var fD;(function(e){e[e.None=1]="None",e[e.Install=2]="Install",e[e.Update=3]="Update",e[e.Migrate=4]="Migrate"})(fD||(fD={}));var Sse=W("extensionGalleryService"),pD;(function(e){e.Timeout="Timeout",e.Cancelled="Cancelled",e.ClientError="ClientError",e.ServerError="ServerError",e.Failed="Failed",e.DownloadFailedWriting="DownloadFailedWriting",e.Offline="Offline"})(pD||(pD={}));var gD;(function(e){e.NotFound="NotFound",e.Unsupported="Unsupported",e.Deprecated="Deprecated",e.Malicious="Malicious",e.Incompatible="Incompatible",e.IncompatibleApi="IncompatibleApi",e.IncompatibleTargetPlatform="IncompatibleTargetPlatform",e.ReleaseVersionNotFound="ReleaseVersionNotFound",e.Invalid="Invalid",e.Download="Download",e.DownloadSignature="DownloadSignature",e.DownloadFailedWriting="DownloadFailedWriting",e.UpdateMetadata="UpdateMetadata",e.Extract="Extract",e.Scanning="Scanning",e.ScanningExtension="ScanningExtension",e.ReadRemoved="ReadRemoved",e.UnsetRemoved="UnsetRemoved",e.Delete="Delete",e.Rename="Rename",e.IntializeDefaultProfile="IntializeDefaultProfile",e.AddToProfile="AddToProfile",e.InstalledExtensionNotFound="InstalledExtensionNotFound",e.PostInstall="PostInstall",e.CorruptZip="CorruptZip",e.IncompleteZip="IncompleteZip",e.PackageNotSigned="PackageNotSigned",e.SignatureVerificationInternal="SignatureVerificationInternal",e.SignatureVerificationFailed="SignatureVerificationFailed",e.NotAllowed="NotAllowed",e.Gallery="Gallery",e.Cancelled="Cancelled",e.Unknown="Unknown",e.Internal="Internal"})(gD||(gD={}));var mD;(function(e){e.NotSigned="NotSigned",e.Success="Success",e.RequiredArgumentMissing="RequiredArgumentMissing",e.InvalidArgument="InvalidArgument",e.PackageIsUnreadable="PackageIsUnreadable",e.UnhandledException="UnhandledException",e.SignatureManifestIsMissing="SignatureManifestIsMissing",e.SignatureManifestIsUnreadable="SignatureManifestIsUnreadable",e.SignatureIsMissing="SignatureIsMissing",e.SignatureIsUnreadable="SignatureIsUnreadable",e.CertificateIsUnreadable="CertificateIsUnreadable",e.SignatureArchiveIsUnreadable="SignatureArchiveIsUnreadable",e.FileAlreadyExists="FileAlreadyExists",e.SignatureArchiveIsInvalidZip="SignatureArchiveIsInvalidZip",e.SignatureArchiveHasSameSignatureFile="SignatureArchiveHasSameSignatureFile",e.PackageIntegrityCheckFailed="PackageIntegrityCheckFailed",e.SignatureIsInvalid="SignatureIsInvalid",e.SignatureManifestIsInvalid="SignatureManifestIsInvalid",e.SignatureIntegrityCheckFailed="SignatureIntegrityCheckFailed",e.EntryIsMissing="EntryIsMissing",e.EntryIsTampered="EntryIsTampered",e.Untrusted="Untrusted",e.CertificateRevoked="CertificateRevoked",e.SignatureIsNotValid="SignatureIsNotValid",e.UnknownError="UnknownError",e.PackageIsInvalidZip="PackageIsInvalidZip",e.SignatureArchiveHasTooManyEntries="SignatureArchiveHasTooManyEntries"})(mD||(mD={}));var Ese=W("extensionManagementService"),xse=W("IGlobalExtensionEnablementService"),Cse=W("IExtensionTipsService"),kse=W("IAllowedExtensionsService"),$se=rf(2e3,"Extensions"),Ise=rf(2001,"Preferences"),r_="extensions.allowed";Qt.as(oo.Configuration).registerConfiguration({id:"extensions",order:30,title:d(1983,null),type:"object",properties:{[r_]:{type:"object",markdownDescription:d(1984,null),default:"*",defaultSnippets:[{body:{},description:d(1985,null)},{body:{"*":!0},description:d(1986,null)}],scope:1,policy:{name:"AllowedExtensions",category:no.Extensions,minimumVersion:"1.96",localization:{description:{key:"extensions.allowed.policy",value:d(1987,null)}}},additionalProperties:!1,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:["boolean","string"],enum:[!0,!1,"stable"],description:d(1988,null),enumDescriptions:[d(1989,null),d(1990,null),d(1991,null)]},{type:"array",items:{type:"string"},description:d(1992,null)}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:["boolean","string"],enum:[!0,!1,"stable"],description:d(1993,null),enumDescriptions:[d(1994,null),d(1995,null),d(1996,null)]},"\\*":{type:"boolean",enum:[!0,!1],description:d(1997,null),enumDescriptions:[d(1998,null),d(1999,null)]}}}}});var Zu=W("telemetryService"),Dse=W("customEndpointTelemetryService"),vD;(function(e){e[e.NONE=0]="NONE",e[e.CRASH=1]="CRASH",e[e.ERROR=2]="ERROR",e[e.USAGE=3]="USAGE"})(vD||(vD={}));var wD;(function(e){e.OFF="off",e.CRASH="crash",e.ERROR="error",e.ON="all"})(wD||(wD={}));var Uw=class{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}},n_=class{constructor(){this.telemetryLevel=0,this.sessionId="someValue.sessionId",this.machineId="someValue.machineId",this.sqmId="someValue.sqmId",this.devDeviceId="someValue.devDeviceId",this.firstSessionDate="someValue.firstSessionDate",this.sendErrorTelemetry=!1}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},Pse=new n_,o_="telemetry",a_={id:o_,name:d(2343,null)};function c_(e,t){if(!e)return"none";const i=p5(e),s=t?.remoteExtensionTips;if(s&&Object.prototype.hasOwnProperty.call(s,i))return i;const r=t?.virtualWorkspaceExtensionTips;return r&&Object.prototype.hasOwnProperty.call(r,i)?i:"other"}function l_(e,t){if(!e||!e.includes("/")&&!e.includes("\\"))return e;let i=e;const s=[];for(const a of t)for(;;){const c=a.exec(e);if(!c)break;s.push([c.index,a.lastIndex])}const r=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,n=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(i="";;){const a=n.exec(e);if(!a)break;const c=s.some(([l,u])=>a.index<u&&l<n.lastIndex);!r.test(a[0])&&!c&&(i+=e.substring(o,a.index)+"<REDACTED: user-file-path>",o=n.lastIndex)}return o<e.length&&(i+=e.substr(o)),i}function u_(e){if(!e)return e;const t=[{label:"URL",regex:/[a-zA-Z][a-zA-Z0-9+.-]*:\/\/[^\s]*/},{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"JWT",regex:/eyJ[0eXAiOiJKV1Qi|hbGci|a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const i of t)if(i.regex.test(e))return`<REDACTED: ${i.label}>`;return e}function bD(e,t){return e?gc(e,i=>{if(i instanceof Uw||Object.hasOwnProperty.call(i,"isTrustedTelemetryValue"))return i.value;if(typeof i=="string"){let s=i.replaceAll("%20"," ");s=l_(s,t);for(const r of t)s=s.replace(r,"");return s=u_(s),s}}):{}}function h_(e,t){return e.uuid&&t.uuid?e.uuid===t.uuid:e.id===t.id?!0:G1(e.id,t.id)===0}var Tse=new it("pprice.better-merge"),d_=class{constructor(){this.a=new Map,this.b=new WeakMap}register(e,t){this.a.set(e,t)}readActivationEvents(e){return this.b.has(e)||this.b.set(e,this.c(e)),this.b.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const s=this.readActivationEvents(i);s.length>0&&(t[it.toKey(i.identifier)]=s)}return t}c(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${it.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const s=this.a.get(i);if(!s)continue;const r=e.contributes[i],n=Array.isArray(r)?r:[r];try{t.push(...s(n))}catch(o){pt(o)}}return t}},f_=new d_,p_=Object.freeze({identifier:new it("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1,preRelease:!1}),yD=W("extensionService"),AD=class{constructor(e){this.dependency=e}},SD;(function(e){e[e.EagerAutoStart=1]="EagerAutoStart",e[e.EagerManualStart=2]="EagerManualStart",e[e.LazyAutoStart=3]="LazyAutoStart"})(SD||(SD={}));function qe(e,t){return e.enabledApiProposals?e.enabledApiProposals.includes(t):!1}function T(e,t){if(!qe(e,t))throw new Error(`Extension '${e.identifier.value}' CANNOT use API proposal: ${t}.
Its package.json#enabledApiProposals-property declares: ${e.enabledApiProposals?.join(", ")??"[]"} but NOT ${t}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${e.identifier.value}`)}var ED;(function(e){e[e.Normal=0]="Normal",e[e.Immediate=1]="Immediate"})(ED||(ED={}));var xD;(function(e){e[e.Upsert=0]="Upsert",e[e.SetTags=1]="SetTags",e[e.UpdateCanResolveChildren=2]="UpdateCanResolveChildren",e[e.RemoveChild=3]="RemoveChild",e[e.SetProp=4]="SetProp",e[e.Bulk=5]="Bulk",e[e.DocumentSynced=6]="DocumentSynced"})(xD||(xD={}));var Yu=(e,t)=>e===t,g_={range:(e,t)=>e===t?!0:!e||!t?!1:e.equalsRange(t),busy:Yu,label:Yu,description:Yu,error:Yu,sortText:Yu,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.includes(i)))},m_=Object.entries(g_),v_=(e,t)=>{let i;for(const[s,r]of m_)r(e[s],t[s])||(i?i[s]=t[s]:i={[s]:t[s]});return i},w_=class extends J{get root(){return this.q.root}constructor(e){super(),this.q=e,this.f=this.D(new vr(()=>this.flushDiff(),200)),this.g=this.D(new I),this.tree=new Map,this.j=new Map,this.m=[],this.onDidGenerateDiff=this.g.event,this.root.canResolveChildren=!0,this.y(this.root,void 0)}set resolveHandler(e){this.h=e;for(const t of this.tree.values())this.J(t)}get resolveHandler(){return this.h}collectDiff(){const e=this.m;return this.m=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.m)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.m[this.m.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){Rw(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){Rw(t.item,e.item);return}}break}}this.m.push(e),this.f.isScheduled()||this.f.schedule()}expand(e,t){const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const s=this.M(i);return s.isOpen()?this.L(i,t-1):s.wait().then(()=>this.L(i,t-1))}else if(i.expand===3)return i.resolveBarrier?.isOpen()===!1?i.resolveBarrier.wait().then(()=>this.L(i,t-1)):this.L(i,t-1)}}dispose(){for(const e of this.tree.values())this.q.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.m=[],super.dispose()}s(e,t){switch(t.op){case 3:this.O(Je.joinToString(e.fullId,t.id));break;case 0:this.y(t.item,e);break;case 5:for(const i of t.ops)this.s(e,i);break;case 1:this.z(t.new,t.old,e.fullId.toString());break;case 2:this.J(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.w(e.actual.uri);break;default:M1(t)}}w(e){e&&this.pushDiff({op:2,uri:e,docv:this.q.getDocumentVersion(e)})}y(e,t){const i=Je.fromExtHostTestItem(e,this.root.id,t?.actual),s=this.q.getApiFor(e);s.parent&&s.parent!==t?.actual&&this.q.getChildren(s.parent).delete(e.id);let r=this.tree.get(i.toString());if(!r){r={fullId:i,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.C,this),this.tree.set(r.fullId.toString(),r),this.G(e,t),this.pushDiff({op:0,item:{controllerId:this.q.controllerId,expand:r.expand,item:this.q.toITestItem(e)}}),this.I(e,r,t);return}if(r.actual===e){this.H(e,r,t);return}if(r.actual.uri?.toString()!==e.uri?.toString())return this.O(i.toString()),this.y(e,t);const n=this.q.getChildren(r.actual),o=r.actual,a=v_(this.q.toITestItem(o),this.q.toITestItem(e));this.q.getApiFor(o).listener=void 0,r.actual=e,r.resolveBarrier=void 0,r.expand=0,a&&(a.hasOwnProperty("tags")&&(this.z(e.tags,o.tags,i.toString()),delete a.tags),this.s(r,{op:4,update:a})),this.I(e,r,t);for(const[l,u]of n)this.q.getChildren(e).get(u.id)||this.O(Je.joinToString(i,u.id));const c=r.expandLevels;c!==void 0&&queueMicrotask(()=>{r.expand===1&&(r.expandLevels=void 0,this.expand(i.toString(),c))}),this.w(r.actual.uri)}z(e,t,i){const s=new Set(t.map(r=>r.id));for(const r of e)s.delete(r.id)||this.C(r);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(r=>cp(this.q.controllerId,r.id))}}}),s.forEach(this.F,this)}C(e){const t=this.j.get(e.id);t?t.refCount++:(this.j.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:cp(this.q.controllerId,e.id)}}))}F(e){const t=this.j.get(e);t&&!--t.refCount&&(this.j.delete(e),this.pushDiff({op:7,id:cp(this.q.controllerId,e)}))}G(e,t){this.q.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}H(e,t,i){this.G(e,i);const s=this.q.getApiFor(e);s.parent=i?.actual,s.listener=r=>this.s(t,r),this.J(t)}I(e,t,i){this.H(e,t,i);for(const[s,r]of this.q.getChildren(e))this.y(r,t)}J(e){let t;this.h?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.M(e))}L(e,t){if(t<0)return;const i=[];for(const[s,r]of this.q.getChildren(e.actual)){const n=this.expand(Je.joinToString(e.fullId,r.id),t);zn(n)&&i.push(n)}if(i.length)return Promise.all(i).then(()=>{})}M(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this.h){const r=new ms;return r.open(),r}e.expand=2,this.N(e);const t=e.resolveBarrier=new ms,i=r=>{console.error(`Unhandled error in resolveHandler of test controller "${this.q.controllerId}"`,r)};let s;try{s=this.h(e.actual===this.root?void 0:e.actual)}catch(r){i(r)}return zn(s)?s.catch(i).then(()=>{t.open(),this.J(e)}):(t.open(),this.J(e)),e.resolveBarrier}N(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}O(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const s=i.pop();if(s){this.q.getApiFor(s.actual).listener=void 0;for(const r of s.actual.tags)this.F(r.id);this.tree.delete(s.fullId.toString());for(const[r,n]of this.q.getChildren(s.actual))i.push(this.tree.get(Je.joinToString(s.fullId,n.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.g.fire(e)}},b_=class extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}},Cp=class extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}},y_=class extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}},A_=(e,t,i)=>{let s=new Map;return{get size(){return s.size},forEach(r,n){for(const o of s.values())r.call(n,o,this)},[Symbol.iterator](){return s.entries()},replace(r){const n=new Map,o=new Set(s.keys()),a={op:5,ops:[]};for(const c of r){if(!(c instanceof i))throw new Cp(c.id);const l=t(c).controllerId;if(l!==e.controllerId)throw new y_(c.id,l,e.controllerId);if(n.has(c.id))throw new b_(c.id);n.set(c.id,c),o.delete(c.id),a.ops.push({op:0,item:c})}for(const c of o.keys())a.ops.push({op:3,id:c});e.listener?.(a),s=n},add(r){if(!(r instanceof i))throw new Cp(r.id);s.set(r.id,r),e.listener?.({op:0,item:r})},delete(r){s.delete(r)&&e.listener?.({op:3,id:r})},get(r){return s.get(r)},toJSON(){return Array.from(s.values())}}},CD=new WeakMap,S_=(e,t)=>{const i={controllerId:t};return CD.set(e,i),i},kp=e=>{const t=CD.get(e);if(!t)throw new Cp(e?.id||"<unknown>");return t},E_=W("remoteAuthorityResolverService"),kD;(function(e){e[e.WebSocket=0]="WebSocket",e[e.Managed=1]="Managed"})(kD||(kD={}));var $D=class{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}},x_=class{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}},Wi;(function(e){e.Unknown="Unknown",e.NotAvailable="NotAvailable",e.TemporarilyNotAvailable="TemporarilyNotAvailable",e.NoResolverFound="NoResolverFound",e.InvalidAuthority="InvalidAuthority"})(Wi||(Wi={}));var zw=class Ya extends zs{static isNotAvailable(t){return t instanceof Ya&&t._code===Wi.NotAvailable}static isTemporarilyNotAvailable(t){return t instanceof Ya&&t._code===Wi.TemporarilyNotAvailable}static isNoResolverFound(t){return t instanceof Ya&&t._code===Wi.NoResolverFound}static isInvalidAuthority(t){return t instanceof Ya&&t._code===Wi.InvalidAuthority}static isHandled(t){return t instanceof Ya&&t.isHandled}constructor(t,i=Wi.Unknown,s){super(t),this._message=t,this._code=i,this._detail=s,this.isHandled=i===Wi.NotAvailable&&s===!0,Object.setPrototypeOf(this,Ya.prototype)}};function ID(e){const t=e.indexOf("+");return t===-1?e:e.substring(0,t)}function he(e){return Object.assign(e,{apply:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const s=i.length===1?[]:i[1];return Reflect.construct(e,s,i[0].constructor)}},call:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const[s,...r]=i;return Reflect.construct(e,r,s.constructor)}}})}var Hw,Ni=Hw=class{#e;static isMarkdownString(t){return t instanceof Hw?!0:!t||typeof t!="object"?!1:t.appendCodeblock&&t.appendMarkdown&&t.appendText&&t.value!==void 0}constructor(t,i=!1){this.#e=new Qn(t,{supportThemeIcons:i})}get value(){return this.#e.value}set value(t){this.#e.value=t}get isTrusted(){return this.#e.isTrusted}set isTrusted(t){this.#e.isTrusted=t}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(t){this.#e.supportThemeIcons=t}get supportHtml(){return this.#e.supportHtml}set supportHtml(t){this.#e.supportHtml=t}get supportAlertSyntax(){return this.#e.supportAlertSyntax}set supportAlertSyntax(t){this.#e.supportAlertSyntax=t}get baseUri(){return this.#e.baseUri}set baseUri(t){this.#e.baseUri=t}appendText(t){return this.#e.appendText(t),this}appendMarkdown(t){return this.#e.appendMarkdown(t),this}appendCodeblock(t,i){return this.#e.appendCodeblock(i??"",t),this}};Ni=Hw=__decorate([he],Ni);var ha,Re=ha=class{static Min(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let s=1;s<t.length;s++){const r=t[s];r.isBefore(i)&&(i=r)}return i}static Max(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let s=1;s<t.length;s++){const r=t[s];r.isAfter(i)&&(i=r)}return i}static isPosition(t){if(!t)return!1;if(t instanceof ha)return!0;const{line:i,character:s}=t;return typeof i=="number"&&typeof s=="number"}static of(t){if(t instanceof ha)return t;if(this.isPosition(t))return new ha(t.line,t.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this.a}get character(){return this.b}constructor(t,i){if(t<0)throw Me("line must be non-negative");if(i<0)throw Me("character must be non-negative");this.a=t,this.b=i}isBefore(t){return this.a<t.a?!0:t.a<this.a?!1:this.b<t.b}isBeforeOrEqual(t){return this.a<t.a?!0:t.a<this.a?!1:this.b<=t.b}isAfter(t){return!this.isBeforeOrEqual(t)}isAfterOrEqual(t){return!this.isBefore(t)}isEqual(t){return this.a===t.a&&this.b===t.b}compareTo(t){return this.a<t.a?-1:this.a>t.line?1:this.b<t.b?-1:this.b>t.b?1:0}translate(t,i=0){if(t===null||i===null)throw Me();let s;return typeof t>"u"?s=0:typeof t=="number"?s=t:(s=typeof t.lineDelta=="number"?t.lineDelta:0,i=typeof t.characterDelta=="number"?t.characterDelta:0),s===0&&i===0?this:new ha(this.line+s,this.character+i)}with(t,i=this.character){if(t===null||i===null)throw Me();let s;return typeof t>"u"?s=this.line:typeof t=="number"?s=t:(s=typeof t.line=="number"?t.line:this.line,i=typeof t.character=="number"?t.character:this.character),s===this.line&&i===this.character?this:new ha(s,i)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};Re=ha=__decorate([he],Re);var nn,ke=nn=class{static isRange(t){return t instanceof nn?!0:!t||typeof t!="object"?!1:Re.isPosition(t.start)&&Re.isPosition(t.end)}static of(t){if(t instanceof nn)return t;if(this.isRange(t))return new nn(t.start,t.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this.a}get end(){return this.b}constructor(t,i,s,r){let n,o;if(typeof t=="number"&&typeof i=="number"&&typeof s=="number"&&typeof r=="number"?(n=new Re(t,i),o=new Re(s,r)):Re.isPosition(t)&&Re.isPosition(i)&&(n=Re.of(t),o=Re.of(i)),!n||!o)throw new Error("Invalid arguments");n.isBefore(o)?(this.a=n,this.b=o):(this.a=o,this.b=n)}contains(t){return nn.isRange(t)?this.contains(t.start)&&this.contains(t.end):Re.isPosition(t)?!(Re.of(t).isBefore(this.a)||this.b.isBefore(t)):!1}isEqual(t){return this.a.isEqual(t.a)&&this.b.isEqual(t.b)}intersection(t){const i=Re.Max(t.start,this.a),s=Re.Min(t.end,this.b);if(!i.isAfter(s))return new nn(i,s)}union(t){if(this.contains(t))return this;if(t.contains(this))return t;const i=Re.Min(t.start,this.a),s=Re.Max(t.end,this.end);return new nn(i,s)}get isEmpty(){return this.a.isEqual(this.b)}get isSingleLine(){return this.a.line===this.b.line}with(t,i=this.end){if(t===null||i===null)throw Me();let s;return t?Re.isPosition(t)?s=t:(s=t.start||this.start,i=t.end||this.end):s=this.start,s.isEqual(this.a)&&i.isEqual(this.end)?this:new nn(s,i)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return DD(this)}};ke=nn=__decorate([he],ke);function DD(e){return e.isEmpty?`[${e.start.line}:${e.start.character})`:`[${e.start.line}:${e.start.character} -> ${e.end.line}:${e.end.character})`}var Qu,Pt=class{static{Qu=this}static{this.a="."}constructor(t){this.value=t}append(t){return new Qu(this.value?this.value+Qu.a+t:t)}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+Qu.a)}};Pt=Qu=__decorate([he],Pt),Pt.Empty=new Pt(""),Pt.QuickFix=Pt.Empty.append("quickfix"),Pt.Refactor=Pt.Empty.append("refactor"),Pt.RefactorExtract=Pt.Refactor.append("extract"),Pt.RefactorInline=Pt.Refactor.append("inline"),Pt.RefactorMove=Pt.Refactor.append("move"),Pt.RefactorRewrite=Pt.Refactor.append("rewrite"),Pt.Source=Pt.Empty.append("source"),Pt.SourceOrganizeImports=Pt.Source.append("organizeImports"),Pt.SourceFixAll=Pt.Source.append("fixAll"),Pt.Notebook=Pt.Empty.append("notebook");var da;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(da||(da={}));var bi;(function(e){e[e.Hint=3]="Hint",e[e.Information=2]="Information",e[e.Warning=1]="Warning",e[e.Error=0]="Error"})(bi||(bi={}));var Xu=class{static is(t){return t?typeof t.message=="string"&&t.location&&ke.isRange(t.location.range)&&y.isUri(t.location.uri):!1}constructor(t,i){this.location=t,this.message=i}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.location.range.isEqual(i.location.range)&&t.location.uri.toString()===i.location.uri.toString()}};Xu=__decorate([he],Xu);var $p=class{constructor(t,i,s=bi.Error){if(!ke.isRange(t))throw new TypeError("range must be set");if(!i)throw new TypeError("message must be set");this.range=t,this.message=i,this.severity=s}toJSON(){return{severity:bi[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.severity===i.severity&&t.code===i.code&&t.severity===i.severity&&t.source===i.source&&t.range.isEqual(i.range)&&$i(t.tags,i.tags)&&$i(t.relatedInformation,i.relatedInformation,Xu.isEqual)}};$p=__decorate([he],$p);var Ww,ns=Ww=class{static isLocation(t){return t instanceof Ww?!0:t?ke.isRange(t.range)&&y.isUri(t.uri):!1}constructor(t,i){if(this.uri=t,i)if(ke.isRange(i))this.range=ke.of(i);else if(Re.isPosition(i))this.range=new ke(i,i);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};ns=Ww=__decorate([he],ns);var co,fa;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(fa||(fa={}));var $r=class qE{static isNotebookRange(t){return t instanceof qE?!0:t?typeof t.start=="number"&&typeof t.end=="number":!1}get start(){return this.a}get end(){return this.b}get isEmpty(){return this.a===this.b}constructor(t,i){if(t<0)throw Me("start must be positive");if(i<0)throw Me("end must be positive");t<=i?(this.a=t,this.b=i):(this.a=i,this.b=t)}with(t){let i=this.a,s=this.b;return t.start!==void 0&&(i=t.start),t.end!==void 0&&(s=t.end),i===this.a&&s===this.b?this:new qE(i,s)}},Ip=class VE{static validate(t){if(typeof t.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof t.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof t.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(t){return Array.isArray(t)&&t.every(i=>VE.isNotebookCellData(i))}static isNotebookCellData(t){return!0}constructor(t,i,s,r,n,o,a){this.kind=t,this.value=i,this.languageId=s,this.mime=r,this.outputs=n??[],this.metadata=o,this.executionSummary=a,VE.validate(this)}},PD=class{constructor(e){this.cells=e}},Dp=co=class{static isNotebookCellEdit(t){return t instanceof co?!0:t?$r.isNotebookRange(t)&&Array.isArray(t.newCells):!1}static replaceCells(t,i){return new co(t,i)}static insertCells(t,i){return new co(new $r(t,t),i)}static deleteCells(t){return new co(t,[])}static updateCellMetadata(t,i){const s=new co(new $r(t,t),[]);return s.newCellMetadata=i,s}static updateNotebookMetadata(t){const i=new co(new $r(0,0),[]);return i.newNotebookMetadata=t,i}constructor(t,i){this.range=t,this.newCells=i}};Dp=co=__decorate([he],Dp);var TD=class xn{static isNotebookCellOutputItem(t){return t instanceof xn?!0:t?typeof t.mime=="string"&&t.data instanceof Uint8Array:!1}static error(t){const i={name:t.name,message:t.message,stack:t.stack};return xn.json(i,"application/vnd.code.notebook.error")}static stdout(t){return xn.text(t,"application/vnd.code.notebook.stdout")}static stderr(t){return xn.text(t,"application/vnd.code.notebook.stderr")}static bytes(t,i="application/octet-stream"){return new xn(t,i)}static#e=new TextEncoder;static text(t,i=Gs.text){const s=xn.#e.encode(String(t));return new xn(s,i)}static json(t,i="text/x-json"){const s=JSON.stringify(t,void 0,"	");return xn.text(s,i)}constructor(t,i){this.data=t,this.mime=i;const s=A$(i,!0);if(!s)throw new Error(`INVALID mime type: ${i}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=s}},Pp=class GE{static isNotebookCellOutput(t){return t instanceof GE?!0:!t||typeof t!="object"?!1:typeof t.id=="string"&&Array.isArray(t.items)}static ensureUniqueMimeTypes(t,i=!1){const s=new Set,r=new Set;for(let n=0;n<t.length;n++){const o=t[n],a=A$(o.mime);if(!s.has(a)||S$(a)){s.add(a);continue}r.add(n),i&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return r.size===0?t:t.filter((n,o)=>!r.has(o))}constructor(t,i,s){this.items=GE.ensureUniqueMimeTypes(t,!0),typeof i=="string"?(this.id=i,this.metadata=s):(this.id=At(),this.metadata=i??s)}},_w,Ir=_w=class extends ke{static isSelection(t){return t instanceof _w?!0:!t||typeof t!="object"?!1:ke.isRange(t)&&Re.isPosition(t.anchor)&&Re.isPosition(t.active)&&typeof t.isReversed=="boolean"}get anchor(){return this.c}get active(){return this.d}constructor(t,i,s,r){let n,o;if(typeof t=="number"&&typeof i=="number"&&typeof s=="number"&&typeof r=="number"?(n=new Re(t,i),o=new Re(s,r)):Re.isPosition(t)&&Re.isPosition(i)&&(n=Re.of(t),o=Re.of(i)),!n||!o)throw new Error("Invalid arguments");super(n,o),this.c=n,this.d=o}get isReversed(){return this.c===this.b}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return C_(this)}};Ir=_w=__decorate([he],Ir);function C_(e){let t=DD(e);return e.isEmpty||(e.active.isEqual(e.start)?t=`|${t}`:t=`${t}|`),t}var pa,ga=pa=class{static isSnippetString(t){return t instanceof pa?!0:!t||typeof t!="object"?!1:typeof t.value=="string"}static a(t){return t.replace(/\$|}|\\/g,"\\$&")}constructor(t){this.b=1,this.value=t||""}appendText(t){return this.value+=pa.a(t),this}appendTabstop(t=this.b++){return this.value+="$",this.value+=t,this}appendPlaceholder(t,i=this.b++){if(typeof t=="function"){const s=new pa;s.b=this.b,t(s),this.b=s.b,t=s.value}else t=pa.a(t);return this.value+="${",this.value+=i,this.value+=":",this.value+=t,this.value+="}",this}appendChoice(t,i=this.b++){const s=t.map(r=>r.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=i,this.value+="|",this.value+=s,this.value+="|}",this}appendVariable(t,i){if(typeof i=="function"){const s=new pa;s.b=this.b,i(s),this.b=s.b,i=s.value}else typeof i=="string"&&(i=i.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=t,i&&(this.value+=":",this.value+=i),this.value+="}",this}};ga=pa=__decorate([he],ga);var Bw=class u1{static isSnippetTextEdit(t){return t instanceof u1?!0:t?ke.isRange(t.range)&&ga.isSnippetString(t.snippet):!1}static replace(t,i){return new u1(t,i)}static insert(t,i){return u1.replace(new ke(t,t),i)}constructor(t,i){this.range=t,this.snippet=i}},qw,gt;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(gt||(gt={}));var Ku;(function(e){e[e.Deprecated=1]="Deprecated"})(Ku||(Ku={}));var eh=qw=class{static validate(t){if(!t.name)throw new Error("name must not be falsy")}constructor(t,i,s,r,n){this.name=t,this.kind=i,this.containerName=n,typeof s=="string"&&(this.containerName=s),r instanceof ns?this.location=r:s instanceof ke&&(this.location=new ns(r,s)),qw.validate(this)}toJSON(){return{name:this.name,kind:gt[this.kind],location:this.location,containerName:this.containerName}}};eh=qw=__decorate([he],eh);var ma,er;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(er||(er={}));var lo=ma=class{static isTextEdit(t){return t instanceof ma?!0:!t||typeof t!="object"?!1:ke.isRange(t)&&typeof t.newText=="string"}static replace(t,i){return new ma(t,i)}static insert(t,i){return ma.replace(new ke(t,t),i)}static delete(t){return ma.replace(t,"")}static setEndOfLine(t){const i=new ma(new ke(new Re(0,0),new Re(0,0)),"");return i.newEol=t,i}get range(){return this.a}set range(t){if(t&&!ke.isRange(t))throw Me("range");this.a=t}get newText(){return this.b||""}set newText(t){if(t&&typeof t!="string")throw Me("newText");this.b=t}get newEol(){return this.c}set newEol(t){if(t&&typeof t!="number")throw Me("newEol");this.c=t}constructor(t,i){this.a=t,this.b=i}toJSON(){return{range:this.range,newText:this.newText,newEol:this.c}}};lo=ma=__decorate([he],lo);var MD;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.Cell=3]="Cell",e[e.CellReplace=5]="CellReplace",e[e.Snippet=6]="Snippet"})(MD||(MD={}));var va=class{constructor(){this.a=[]}_allEntries(){return this.a}renameFile(t,i,s,r){this.a.push({_type:1,from:t,to:i,options:s,metadata:r})}createFile(t,i,s){this.a.push({_type:1,from:void 0,to:t,options:i,metadata:s})}deleteFile(t,i,s){this.a.push({_type:1,from:t,to:void 0,options:i,metadata:s})}b(t,i,s){this.a.push({_type:3,metadata:s,uri:t,edit:{editType:5,metadata:i}})}c(t,i,s,r){const n=i.start,o=i.end;(n!==o||s.length>0)&&this.a.push({_type:5,uri:t,index:n,count:o-n,cells:s,metadata:r})}d(t,i,s,r){this.a.push({_type:3,metadata:r,uri:t,edit:{editType:3,index:i,metadata:s}})}replace(t,i,s,r){this.a.push({_type:2,uri:t,edit:new lo(i,s),metadata:r})}insert(t,i,s,r){this.replace(t,new ke(i,i),s,r)}delete(t,i,s){this.replace(t,i,"",s)}has(t){return this.a.some(i=>i._type===2&&i.uri.toString()===t.toString())}set(t,i){if(i)for(const s of i){if(!s)continue;let r,n;Array.isArray(s)?(r=s[0],n=s[1]):r=s,Dp.isNotebookCellEdit(r)?r.newCellMetadata?this.d(t,r.range.start,r.newCellMetadata,n):r.newNotebookMetadata?this.b(t,r.newNotebookMetadata,n):this.c(t,r.range,r.newCells,n):Bw.isSnippetTextEdit(r)?this.a.push({_type:6,uri:t,range:r.range,edit:r.snippet,metadata:n,keepWhitespace:r.keepWhitespace}):this.a.push({_type:2,uri:t,edit:r,metadata:n})}else{for(let s=0;s<this.a.length;s++){const r=this.a[s];switch(r._type){case 2:case 6:case 3:case 5:r.uri.toString()===t.toString()&&(this.a[s]=void 0);break}}kL(this.a)}}get(t){const i=[];for(const s of this.a)s._type===2&&s.uri.toString()===t.toString()&&i.push(s.edit);return i}entries(){const t=new Ct;for(const i of this.a)if(i._type===2){let s=t.get(i.uri);s||(s=[i.uri,[]],t.set(i.uri,s)),s[1].push(i.edit)}return[...t.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};va=__decorate([he],va);var Vw,Tp,Dr,Pr,Gw,_i,Jw,Zw;(function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"})(Zw||(Zw={}));var ND;(function(e){e[e.TerminalCommand=0]="TerminalCommand",e[e.Opener=1]="Opener",e[e.Command=3]="Command"})(ND||(ND={}));var Pe=Vw=class{static from(...t){let i=t;return new Vw(function(){if(i){for(const s of i)s&&typeof s.dispose=="function"&&s.dispose();i=void 0}})}#e;constructor(t){this.#e=t}dispose(){typeof this.#e=="function"&&(this.#e(),this.#e=void 0)}};Pe=Vw=__decorate([he],Pe);var RD=e=>{if(typeof e!="string"||e.length===0||!/^[0-9A-Za-z_\-]+$/.test(e))throw Me("connectionToken")},k_=class{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw Me("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw Me("port");typeof i<"u"&&RD(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}},Mp=class{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&RD(t)}},Oc=class h1 extends Error{static NotAvailable(t,i){return new h1(t,Wi.NotAvailable,i)}static TemporarilyNotAvailable(t){return new h1(t,Wi.TemporarilyNotAvailable)}constructor(t,i=Wi.Unknown,s){super(t),this._message=t,this._code=i,this._detail=s,Object.setPrototypeOf(this,h1.prototype)}},Fc;(function(e){e[e.Replace=1]="Replace",e[e.Append=2]="Append",e[e.Prepend=3]="Prepend"})(Fc||(Fc={}));var Np=class{constructor(t,i){if(!t)throw new Error("Illegal argument, contents must be defined");Array.isArray(t)?this.contents=t:this.contents=[t],this.range=i}};Np=__decorate([he],Np);var Rp=class extends Np{constructor(t,i,s,r){super(t,i),this.canIncreaseVerbosity=s,this.canDecreaseVerbosity=r}};Rp=__decorate([he],Rp);var Yw;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(Yw||(Yw={}));var th;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(th||(th={}));var Lp=class{constructor(t,i=th.Text){this.range=t,this.kind=i}toJSON(){return{range:this.range,kind:th[this.kind]}}};Lp=__decorate([he],Lp);var Op=class{constructor(t,i){this.uri=t,this.highlights=i}toJSON(){return{uri:this.uri,highlights:this.highlights.map(t=>t.toJSON())}}};Op=__decorate([he],Op);var ih=Tp=class{static validate(t){if(!t.name)throw new Error("name must not be falsy");if(!t.range.contains(t.selectionRange))throw new Error("selectionRange must be contained in fullRange");t.children?.forEach(Tp.validate)}constructor(t,i,s,r,n){this.name=t,this.detail=i,this.kind=s,this.range=r,this.selectionRange=n,this.children=[],Tp.validate(this)}};ih=Tp=__decorate([he],ih);var sh;(function(e){e[e.Invoke=1]="Invoke",e[e.Automatic=2]="Automatic"})(sh||(sh={}));var rh=class{constructor(t,i){this.title=t,this.kind=i}};rh=__decorate([he],rh);var nh=class{constructor(t,i){if(this.range=t,this.parent=i,i&&!i.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};nh=__decorate([he],nh);var Qw=class{constructor(e,t,i,s,r,n){this.kind=e,this.name=t,this.detail=i,this.uri=s,this.range=r,this.selectionRange=n}},LD=class{constructor(e,t){this.fromRanges=t,this.from=e}},OD=class{constructor(e,t){this.fromRanges=t,this.to=e}},jc;(function(e){e[e.Information=0]="Information",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(jc||(jc={}));var Fp=class{constructor(t,i){this.range=t,this.command=i}get isResolved(){return!!this.command}};Fp=__decorate([he],Fp);var Xw=class{constructor(t,i){this.label=t,this.documentation=i}};Xw=__decorate([he],Xw);var Kw=class{constructor(t,i){this.label=t,this.documentation=i,this.parameters=[]}};Kw=__decorate([he],Kw);var eb=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};eb=__decorate([he],eb);var tb;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(tb||(tb={}));var ib;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(ib||(ib={}));var jp=class{constructor(t){this.value=t}};jp=__decorate([he],jp);var Up=class{constructor(t,i,s){this.position=t,this.label=i,this.kind=s}};Up=__decorate([he],Up);var Uc;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Uc||(Uc={}));var be;(function(e){e[e.Text=0]="Text",e[e.Method=1]="Method",e[e.Function=2]="Function",e[e.Constructor=3]="Constructor",e[e.Field=4]="Field",e[e.Variable=5]="Variable",e[e.Class=6]="Class",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Unit=10]="Unit",e[e.Value=11]="Value",e[e.Enum=12]="Enum",e[e.Keyword=13]="Keyword",e[e.Snippet=14]="Snippet",e[e.Color=15]="Color",e[e.File=16]="File",e[e.Reference=17]="Reference",e[e.Folder=18]="Folder",e[e.EnumMember=19]="EnumMember",e[e.Constant=20]="Constant",e[e.Struct=21]="Struct",e[e.Event=22]="Event",e[e.Operator=23]="Operator",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue"})(be||(be={}));var oh;(function(e){e[e.Deprecated=1]="Deprecated"})(oh||(oh={}));var zp=class{constructor(t,i){this.label=t,this.kind=i}toJSON(){return{label:this.label,kind:this.kind&&be[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};zp=__decorate([he],zp);var zc=class{constructor(t=[],i=!1){this.items=t,this.isIncomplete=i}};zc=__decorate([he],zc);var sb=class{constructor(t,i,s){this.insertText=t,this.range=i,this.command=s}};sb=__decorate([he],sb);var rb=class{constructor(t){this.commands=void 0,this.suppressSuggestions=void 0,this.items=t}};rb=__decorate([he],rb);var wa;(function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Line=2]="Line",e[e.Suggest=3]="Suggest"})(wa||(wa={}));var Hc;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(Hc||(Hc={}));var Wc;(function(e){e[e.Code=1]="Code",e[e.Label=2]="Label"})(Wc||(Wc={}));var ah;(function(e){e[e.Active=-1]="Active",e[e.Beside=-2]="Beside",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven",e[e.Eight=8]="Eight",e[e.Nine=9]="Nine"})(ah||(ah={}));var uo;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(uo||(uo={}));function $_(e,t){return`${it.toKey(e)}.${t}`}var tr;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval"})(tr||(tr={}));var _c;(function(e){e[e.Manual=1]="Manual",e[e.AfterDelay=2]="AfterDelay",e[e.FocusOut=3]="FocusOut"})(_c||(_c={}));var Hp;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Hp||(Hp={}));var Bc;(function(e){e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Command=3]="Command"})(Bc||(Bc={}));var qc;(function(e){e[e.Addition=1]="Addition",e[e.Deletion=2]="Deletion",e[e.Modification=3]="Modification"})(qc||(qc={}));var ch;(function(e){e[e.Undo=1]="Undo",e[e.Redo=2]="Redo"})(ch||(ch={}));var ba;(function(e){e[e.OpenOpen=0]="OpenOpen",e[e.ClosedClosed=1]="ClosedClosed",e[e.OpenClosed=2]="OpenClosed",e[e.ClosedOpen=3]="ClosedOpen"})(ba||(ba={})),(function(e){function t(i){switch(i){case"keyboard":return e.Keyboard;case"mouse":return e.Mouse;case"api":case"code.jump":case"code.navigation":return e.Command}}e.fromValue=t})(Bc||(Bc={}));var Vc;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(Vc||(Vc={})),(function(e){function t(i){switch(i){case e.Other:return"other";case e.Comment:return"comment";case e.String:return"string";case e.RegEx:return"regex"}return"other"}e.toString=t})(Vc||(Vc={}));var Wp=class{constructor(t,i){if(i&&!y.isUri(i))throw Me("target");if(!ke.isRange(t)||t.isEmpty)throw Me("range");this.range=t,this.target=i}};Wp=__decorate([he],Wp);var Gc=class{constructor(t,i,s,r){this.red=t,this.green=i,this.blue=s,this.alpha=r}};Gc=__decorate([he],Gc);var _p=class{constructor(t,i){if(i&&!(i instanceof Gc))throw Me("color");if(!ke.isRange(t)||t.isEmpty)throw Me("range");this.range=t,this.color=i}};_p=__decorate([he],_p);var Bp=class{constructor(t){if(!t||typeof t!="string")throw Me("label");this.label=t}};Bp=__decorate([he],Bp);var FD;(function(e){e[e.RGB=0]="RGB",e[e.HEX=1]="HEX",e[e.HSL=2]="HSL"})(FD||(FD={}));var Jc;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information"})(Jc||(Jc={}));var nb;(function(e){e[e.Unknown=0]="Unknown",e[e.Shutdown=1]="Shutdown",e[e.Process=2]="Process",e[e.User=3]="User",e[e.Extension=4]="Extension"})(nb||(nb={}));var lh;(function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"})(lh||(lh={}));var ob;(function(e){e[e.Sh=1]="Sh",e[e.Bash=2]="Bash",e[e.Fish=3]="Fish",e[e.Csh=4]="Csh",e[e.Ksh=5]="Ksh",e[e.Zsh=6]="Zsh",e[e.CommandPrompt=7]="CommandPrompt",e[e.GitBash=8]="GitBash",e[e.PowerShell=9]="PowerShell",e[e.Python=10]="Python",e[e.Julia=11]="Julia",e[e.NuShell=12]="NuShell",e[e.Node=13]="Node",e[e.Xonsh=14]="Xonsh"})(ob||(ob={}));var I_=class{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw Me("startIndex");if(typeof t!="number"||t<1)throw Me("length");if(i!==void 0&&typeof i!="string")throw Me("tooltip")}},D_=class{constructor(e){this.uri=e}},P_=class{constructor(e){this.terminalCommand=e}},ab;(function(e){e[e.Panel=1]="Panel",e[e.Editor=2]="Editor"})(ab||(ab={}));var T_=class{constructor(e){if(this.options=e,typeof e!="object")throw Me("options")}},cb;(function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Method=2]="Method",e[e.Alias=3]="Alias",e[e.Argument=4]="Argument",e[e.Option=5]="Option",e[e.OptionValue=6]="OptionValue",e[e.Flag=7]="Flag",e[e.SymbolicLinkFile=8]="SymbolicLinkFile",e[e.SymbolicLinkFolder=9]="SymbolicLinkFolder",e[e.ScmCommit=10]="ScmCommit",e[e.ScmBranch=11]="ScmBranch",e[e.ScmTag=12]="ScmTag",e[e.ScmStash=13]="ScmStash",e[e.ScmRemote=14]="ScmRemote",e[e.PullRequest=15]="PullRequest",e[e.PullRequestDone=16]="PullRequestDone"})(cb||(cb={}));var M_=class{constructor(e,t,i,s,r,n,o,a){this.label=e,this.replacementRange=t,this.kind=i,this.detail=s,this.documentation=r,this.isFile=n,this.isDirectory=o,this.isKeyword=a}},N_=class{constructor(e,t){this.items=e??[],this.resourceOptions=t}},lb;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(lb||(lb={}));var ub;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(ub||(ub={}));var hb;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(hb||(hb={}));var uh=class{static{Dr=this}static{this.Clean=new Dr("clean","Clean")}static{this.Build=new Dr("build","Build")}static{this.Rebuild=new Dr("rebuild","Rebuild")}static{this.Test=new Dr("test","Test")}static from(t){switch(t){case"clean":return Dr.Clean;case"build":return Dr.Build;case"rebuild":return Dr.Rebuild;case"test":return Dr.Test;default:return}}constructor(t,i){if(this.label=i,typeof t!="string"||typeof i!="string")throw Me("name");this.c=t}get id(){return this.c}};uh=Dr=__decorate([he],uh);function jD(e){let t="";for(let i=0;i<e.length;i++)t+=e[i].replace(/,/g,",,")+",";return t}var Zc=class{constructor(t,i,s){if(typeof t!="string")throw Me("process");this.e=[],this.c=t,i!==void 0&&(Array.isArray(i)?(this.e=i,this.f=s):this.f=i)}get process(){return this.c}set process(t){if(typeof t!="string")throw Me("process");this.c=t}get args(){return this.e}set args(t){Array.isArray(t)||(t=[]),this.e=t}get options(){return this.f}set options(t){this.f=t}computeId(){const t=[];if(t.push("process"),this.c!==void 0&&t.push(this.c),this.e&&this.e.length>0)for(const i of this.e)t.push(i);return jD(t)}};Zc=__decorate([he],Zc);var ya=class{constructor(t,i,s){if(this.f=[],Array.isArray(i)){if(!t)throw Me("command can't be undefined or null");if(typeof t!="string"&&typeof t.value!="string")throw Me("command");this.e=t,i&&(this.f=i),this.g=s}else{if(typeof t!="string")throw Me("commandLine");this.c=t,this.g=i}}get commandLine(){return this.c}set commandLine(t){if(typeof t!="string")throw Me("commandLine");this.c=t}get command(){return this.e?this.e:""}set command(t){if(typeof t!="string"&&typeof t.value!="string")throw Me("command");this.e=t}get args(){return this.f}set args(t){this.f=t||[]}get options(){return this.g}set options(t){this.g=t}computeId(){const t=[];if(t.push("shell"),this.c!==void 0&&t.push(this.c),this.e!==void 0&&t.push(typeof this.e=="string"?this.e:this.e.value),this.f&&this.f.length>0)for(const i of this.f)t.push(typeof i=="string"?i:i.value);return jD(t)}};ya=__decorate([he],ya);var db;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(db||(db={}));var ho;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace"})(ho||(ho={}));var fb=class{constructor(e){this.c=e}computeId(){return"customExecution"+At()}set callback(e){this.c=e}get callback(){return this.c}},qp=class{static{Pr=this}static{this.c="customExecution"}static{this.e="process"}static{this.f="shell"}static{this.g="$empty"}constructor(t,i,s,r,n,o){this.k=!1,this.l=this.definition=t;let a;typeof i=="string"?(this.o=this.name=i,this.u=this.source=s,this.execution=r,a=n,this.k=!0):i===ho.Global||i===ho.Workspace?(this.target=i,this.o=this.name=s,this.u=this.source=r,this.execution=n,a=o):(this.target=i,this.o=this.name=s,this.u=this.source=r,this.execution=n,a=o),typeof a=="string"?(this.q=[a],this.r=!0):Array.isArray(a)?(this.q=a,this.r=!0):(this.q=[],this.r=!1),this.t=!1,this.x=Object.create(null),this.y=Object.create(null)}get _id(){return this.j}set _id(t){this.j=t}get _deprecated(){return this.k}A(){this.j!==void 0&&(this.j=void 0,this.m=void 0,this.B())}B(){this.p instanceof Zc?this.l={type:Pr.e,id:this.p.computeId()}:this.p instanceof ya?this.l={type:Pr.f,id:this.p.computeId()}:this.p instanceof fb?this.l={type:Pr.c,id:this.p.computeId()}:this.l={type:Pr.g,id:At()}}get definition(){return this.l}set definition(t){if(t==null)throw Me("Kind can't be undefined or null");this.A(),this.l=t}get scope(){return this.m}set target(t){this.A(),this.m=t}get name(){return this.o}set name(t){if(typeof t!="string")throw Me("name");this.A(),this.o=t}get execution(){return this.p}set execution(t){t===null&&(t=void 0),this.A(),this.p=t;const i=this.l.type;(Pr.g===i||Pr.e===i||Pr.f===i||Pr.c===i)&&this.B()}get problemMatchers(){return this.q}set problemMatchers(t){if(Array.isArray(t))this.A(),this.q=t,this.r=!0;else{this.A(),this.q=[],this.r=!1;return}}get hasDefinedMatchers(){return this.r}get isBackground(){return this.t}set isBackground(t){t!==!0&&t!==!1&&(t=!1),this.A(),this.t=t}get source(){return this.u}set source(t){if(typeof t!="string"||t.length===0)throw Me("source must be a string of length > 0");this.A(),this.u=t}get group(){return this.w}set group(t){t===null&&(t=void 0),this.A(),this.w=t}get detail(){return this.z}set detail(t){t===null&&(t=void 0),this.z=t}get presentationOptions(){return this.x}set presentationOptions(t){t==null&&(t=Object.create(null)),this.A(),this.x=t}get runOptions(){return this.y}set runOptions(t){t==null&&(t=Object.create(null)),this.A(),this.y=t}};qp=Pr=__decorate([he],qp);var fo;(function(e){e[e.SourceControl=1]="SourceControl",e[e.Window=10]="Window",e[e.Notification=15]="Notification"})(fo||(fo={}));var pb;(function(e){function t(i){const s=i;return xs(s.value)?s.tooltip&&!Oe(s.tooltip)?(console.log("INVALID view badge, invalid tooltip",s.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",s.value),!1)}e.isViewBadge=t})(pb||(pb={}));var Vp=Gw=class{static isTreeItem(t,i){const s=t;if(s.checkboxState!==void 0){const r=xs(s.checkboxState)?s.checkboxState:kt(s.checkboxState)&&xs(s.checkboxState.state)?s.checkboxState.state:void 0,n=!xs(s.checkboxState)&&kt(s.checkboxState)?s.checkboxState.tooltip:void 0;if(r===void 0||r!==Tr.Checked&&r!==Tr.Unchecked||n!==void 0&&!Oe(n))return console.log("INVALID tree item, invalid checkboxState",s.checkboxState),!1}if(t instanceof Gw)return!0;if(s.label!==void 0&&!Oe(s.label)&&!s.label?.label)return console.log("INVALID tree item, invalid label",s.label),!1;if(s.id!==void 0&&!Oe(s.id))return console.log("INVALID tree item, invalid id",s.id),!1;if(s.iconPath!==void 0&&!Oe(s.iconPath)&&!y.isUri(s.iconPath)&&(!s.iconPath||!Oe(s.iconPath.id))){const r=s.iconPath;if(!r||!Oe(r.light)&&!y.isUri(r.light)&&!Oe(r.dark)&&!y.isUri(r.dark))return console.log("INVALID tree item, invalid iconPath",s.iconPath),!1}return s.description!==void 0&&!Oe(s.description)&&typeof s.description!="boolean"?(console.log("INVALID tree item, invalid description",s.description),!1):s.resourceUri!==void 0&&!y.isUri(s.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",s.resourceUri),!1):s.tooltip!==void 0&&!Oe(s.tooltip)&&!(s.tooltip instanceof Ni)?(console.log("INVALID tree item, invalid tooltip",s.tooltip),!1):s.command!==void 0&&!s.command.command?(console.log("INVALID tree item, invalid command",s.command),!1):s.collapsibleState!==void 0&&s.collapsibleState<Aa.None&&s.collapsibleState>Aa.Expanded?(console.log("INVALID tree item, invalid collapsibleState",s.collapsibleState),!1):s.contextValue!==void 0&&!Oe(s.contextValue)?(console.log("INVALID tree item, invalid contextValue",s.contextValue),!1):s.accessibilityInformation!==void 0&&!s.accessibilityInformation?.label?(console.log("INVALID tree item, invalid accessibilityInformation",s.accessibilityInformation),!1):!0}constructor(t,i=Aa.None){this.collapsibleState=i,y.isUri(t)?this.resourceUri=t:this.label=t}};Vp=Gw=__decorate([he],Vp);var Aa;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(Aa||(Aa={}));var Tr;(function(e){e[e.Unchecked=0]="Unchecked",e[e.Checked=1]="Checked"})(Tr||(Tr={}));var Gp=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(t){this.value=t}};Gp=__decorate([he],Gp);var Jp=class extends Gp{},R_=class extends Jp{#e;constructor(e){super(""),this.#e=e}asFile(){return this.#e}},L_=class{constructor(e,t,i,s){this.name=e,this.uri=t,this._itemId=i,this.c=s}data(){return this.c()}},Yc=class{#e=new Map;constructor(t){for(const[i,s]of t??[]){const r=this.#e.get(this.#t(i));r?r.push(s):this.#e.set(this.#t(i),[s])}}get(t){return this.#e.get(this.#t(t))?.[0]}set(t,i){this.#e.set(this.#t(t),[i])}forEach(t,i){for(const[s,r]of this.#e)for(const n of r)t.call(i,n,s,this)}*[Symbol.iterator](){for(const[t,i]of this.#e)for(const s of i)yield[t,s]}#t(t){return t.toLowerCase()}};Yc=__decorate([he],Yc);var gb=class{constructor(t,i,s){this.insertText=t,this.title=i,this.kind=s}};gb=__decorate([he],gb);var mb;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(mb||(mb={}));var po=class d1{static{this.c="."}constructor(t){this.value=t}append(...t){return new d1((this.value?[this.value,...t]:t).join(d1.c))}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+d1.c)}};po.Empty=new po(""),po.Text=new po("text"),po.TextUpdateImports=po.Text.append("updateImports");var O_=class{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}},Ri=class{constructor(t,i){this.id=t,this.color=i}static isThemeIcon(t){return typeof t.id!="string"?(console.log("INVALID ThemeIcon, invalid id",t.id),!1):!0}};Ri=__decorate([he],Ri),Ri.File=new Ri("file"),Ri.Folder=new Ri("folder");var hh=class{constructor(t){this.id=t}};hh=__decorate([he],hh);var Qc;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.WorkspaceFolder=3]="WorkspaceFolder"})(Qc||(Qc={}));var Xc=class{get base(){return this.c}set base(t){this.c=t,this.e=y.file(t)}get baseUri(){return this.e}set baseUri(t){this.e=t,this.c=t.fsPath}constructor(t,i){if(typeof t!="string"&&(!t||!y.isUri(t)&&!y.isUri(t.uri)))throw Me("base");if(typeof i!="string")throw Me("pattern");typeof t=="string"?this.baseUri=y.file(t):y.isUri(t)?this.baseUri=t:this.baseUri=t.uri,this.pattern=i}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Xc=__decorate([he],Xc);var UD=new WeakMap;function F_(e,t){UD.set(e,t)}var Kc=class{constructor(t,i,s,r,n){this.enabled=typeof t=="boolean"?t:!0,typeof i=="string"&&(this.condition=i),typeof s=="string"&&(this.hitCondition=s),typeof r=="string"&&(this.logMessage=r),typeof n=="string"&&(this.mode=n)}get id(){return this.c||(this.c=UD.get(this)??At()),this.c}};Kc=__decorate([he],Kc);var Sa=class extends Kc{constructor(t,i,s,r,n,o){if(super(i,s,r,n,o),t===null)throw Me("location");this.location=t}};Sa=__decorate([he],Sa);var Ea=class extends Kc{constructor(t,i,s,r,n,o){super(i,s,r,n,o),this.functionName=t}};Ea=__decorate([he],Ea);var Zp=class extends Kc{constructor(t,i,s,r,n,o,a,c){if(super(r,n,o,a,c),!i)throw Me("dataId");this.label=t,this.dataId=i,this.canPersist=s}};Zp=__decorate([he],Zp);var el=class{constructor(t,i,s){this.command=t,this.args=i||[],this.options=s}};el=__decorate([he],el);var tl=class{constructor(t,i){this.port=t,this.host=i}};tl=__decorate([he],tl);var dh=class{constructor(t){this.path=t}};dh=__decorate([he],dh);var fh=class{constructor(t){this.implementation=t}};fh=__decorate([he],fh);var zD=class{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}},HD=class{constructor(e,t){this.session=e,this.threadId=t}},Yp=class{constructor(t,i){this.range=t,this.expression=i}};Yp=__decorate([he],Yp);var ph;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(ph||(ph={}));var on;(function(e){e[e.Other=0]="Other",e[e.Empty=1]="Empty",e[e.TokenCancellation=2]="TokenCancellation",e[e.LostRace=3]="LostRace",e[e.NotTaken=4]="NotTaken"})(on||(on={}));var Qp=class{constructor(t,i){this.range=t,this.text=i}};Qp=__decorate([he],Qp);var Xp=class{constructor(t,i,s=!0){this.range=t,this.variableName=i,this.caseSensitiveLookup=s}};Xp=__decorate([he],Xp);var Kp=class{constructor(t,i){this.range=t,this.expression=i}};Kp=__decorate([he],Kp);var vb=class{constructor(t,i){this.frameId=t,this.stoppedLocation=i}};vb=__decorate([he],vb);var wb;(function(e){e[e.AIGenerated=1]="AIGenerated"})(wb||(wb={}));var gh;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(gh||(gh={}));var j_=class{constructor(e,t){this.newSymbolName=e,this.tags=t}},il;(function(e){e[e.Changed=1]="Changed",e[e.Created=2]="Created",e[e.Deleted=3]="Deleted"})(il||(il={}));var ii=_i=class extends Error{static FileExists(t){return new _i(t,de.FileExists,_i.FileExists)}static FileNotFound(t){return new _i(t,de.FileNotFound,_i.FileNotFound)}static FileNotADirectory(t){return new _i(t,de.FileNotADirectory,_i.FileNotADirectory)}static FileIsADirectory(t){return new _i(t,de.FileIsADirectory,_i.FileIsADirectory)}static NoPermissions(t){return new _i(t,de.NoPermissions,_i.NoPermissions)}static Unavailable(t){return new _i(t,de.Unavailable,_i.Unavailable)}constructor(t,i=de.Unknown,s){super(y.isUri(t)?t.toString(!0):t),this.code=s?.name??"Unknown",V$(this,i),Object.setPrototypeOf(this,_i.prototype),typeof Error.captureStackTrace=="function"&&typeof s=="function"&&Error.captureStackTrace(this,s)}};ii=_i=__decorate([he],ii);var bb=class{constructor(t,i,s){this.start=t,this.end=i,this.kind=s}};bb=__decorate([he],bb);var an;(function(e){e[e.Comment=1]="Comment",e[e.Imports=2]="Imports",e[e.Region=3]="Region"})(an||(an={}));var mh;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(mh||(mh={}));var yb;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(yb||(yb={}));var Ab;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(Ab||(Ab={}));var vh;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(vh||(vh={}));var wh;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(wh||(wh={}));var bh;(function(e){e[e.Reply=1]="Reply",e[e.Comment=2]="Comment"})(bh||(bh={}));var Sb=class{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}};function U_(e){return typeof e>"u"||OL(e)}var z_=class ZN{constructor(t){if(this.c=0,this.e=0,this.f=!0,this.g=[],this.j=0,this.k=new Map,this.l=new Map,this.m=!1,t){this.m=!0;for(let i=0,s=t.tokenTypes.length;i<s;i++)this.k.set(t.tokenTypes[i],i);for(let i=0,s=t.tokenModifiers.length;i<s;i++)this.l.set(t.tokenModifiers[i],i)}}push(t,i,s,r,n){if(typeof t=="number"&&typeof i=="number"&&typeof s=="number"&&typeof r=="number"&&(typeof n=="number"||typeof n>"u"))return typeof n>"u"&&(n=0),this.p(t,i,s,r,n);if(ke.isRange(t)&&typeof i=="string"&&U_(s))return this.o(t,i,s);throw Me()}o(t,i,s){if(!this.m)throw new Error("Legend must be provided in constructor");if(t.start.line!==t.end.line)throw new Error("`range` cannot span multiple lines");if(!this.k.has(i))throw new Error("`tokenType` is not in the provided legend");const r=t.start.line,n=t.start.character,o=t.end.character-t.start.character,a=this.k.get(i);let c=0;if(s)for(const l of s){if(!this.l.has(l))throw new Error("`tokenModifier` is not in the provided legend");const u=this.l.get(l);c|=1<<u>>>0}this.p(r,n,o,a,c)}p(t,i,s,r,n){if(this.f&&(t<this.c||t===this.c&&i<this.e)){this.f=!1;const c=this.g.length/5|0;let l=0,u=0;for(let h=0;h<c;h++){let f=this.g[5*h],p=this.g[5*h+1];f===0?(f=l,p+=u):f+=l,this.g[5*h]=f,this.g[5*h+1]=p,l=f,u=p}}let o=t,a=i;this.f&&this.j>0&&(o-=this.c,o===0&&(a-=this.e)),this.g[this.j++]=o,this.g[this.j++]=a,this.g[this.j++]=s,this.g[this.j++]=r,this.g[this.j++]=n,this.c=t,this.e=i}static q(t){const i=[],s=t.length/5|0;for(let a=0;a<s;a++)i[a]=a;i.sort((a,c)=>{const l=t[5*a],u=t[5*c];if(l===u){const h=t[5*a+1],f=t[5*c+1];return h-f}return l-u});const r=new Uint32Array(t.length);let n=0,o=0;for(let a=0;a<s;a++){const c=5*i[a],l=t[c+0],u=t[c+1],h=t[c+2],f=t[c+3],p=t[c+4],g=l-n,v=g===0?u-o:u,b=5*a;r[b+0]=g,r[b+1]=v,r[b+2]=h,r[b+3]=f,r[b+4]=p,n=l,o=u}return r}build(t){return this.f?new sl(new Uint32Array(this.g),t):new sl(ZN.q(this.g),t)}},sl=class{constructor(e,t){this.resultId=t,this.data=e}},WD=class{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}},eg=class{constructor(e,t){this.resultId=t,this.edits=e}},tg;(function(e){e[e.Separate=0]="Separate",e[e.MergeWithParent=1]="MergeWithParent"})(tg||(tg={}));var H_=class{constructor(e){this.name=e}},Eb;(function(e){e[e.Title=1]="Title",e[e.Inline=2]="Inline",e[e.Input=3]="Input"})(Eb||(Eb={}));var yh=class{static{this.Back={iconPath:new Ri("arrow-left")}}constructor(){}};yh=__decorate([he],yh);var Ah;(function(e){e[e.Separator=-1]="Separator",e[e.Default=0]="Default"})(Ah||(Ah={}));var rl;(function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(rl||(rl={}));var xa;(function(e){e[e.UI=1]="UI",e[e.Workspace=2]="Workspace"})(xa||(xa={}));var xb=class{static validate(e){if(typeof e.badge=="string"){let t=rC(e.badge,0);if(t<e.badge.length&&(t+=rC(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Ri.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}},ig=class{constructor(t){this.kind=t}};ig=__decorate([he],ig);var go;(function(e){e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.HighContrast=3]="HighContrast",e[e.HighContrastLight=4]="HighContrastLight"})(go||(go={}));var W_=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},Cb;(function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(Cb||(Cb={}));var sg;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(sg||(sg={}));var rg;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(rg||(rg={}));var __=class{constructor(e,t){this.text=e,this.alignment=t}},kb;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred"})(kb||(kb={}));var ng;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred",e[e.Hidden=-1]="Hidden"})(ng||(ng={}));var _D=class{constructor(e,t=[]){this.uri=e,this.provides=Es(t)}},B_=class{constructor(e){this.label=e}},Sh;(function(e){e[e.Named=1]="Named",e[e.Indexed=2]="Indexed"})(Sh||(Sh={}));var $b=class{constructor(t,i){this.label=t,this.timestamp=i}};$b=__decorate([he],$b);var nl;(function(e){e[e.Production=1]="Production",e[e.Development=2]="Development",e[e.Test=3]="Test"})(nl||(nl={}));var og;(function(e){e[e.Node=1]="Node",e[e.Webworker=2]="Webworker"})(og||(og={}));var mo;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(mo||(mo={}));var q_=class{constructor(e,t){this.ranges=e,this.wordPattern=t}},V_=class{constructor(e){this.c=e}get autoForwardAction(){return this.c}},Ib;(function(e){e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(Ib||(Ib={}));var ol;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(ol||(ol={}));var BD=class{constructor(e,t,i){this.controllerId=e,this.profileId=t,this.kind=i}},ag=class{constructor(t=void 0,i=void 0,s=void 0,r=!1,n=!0){this.include=t,this.exclude=i,this.profile=s,this.continuous=r,this.preserveFocus=n}};ag=__decorate([he],ag);var cg=Jw=class{static diff(t,i,s){const r=new Jw(t);return r.expectedOutput=i,r.actualOutput=s,r}constructor(t){this.message=t}};cg=Jw=__decorate([he],cg);var Eh=class{constructor(t){this.id=t}};Eh=__decorate([he],Eh);var G_=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},lg=class{constructor(e,t){this.covered=e,this.total=t,ug(this)}};function ug(e){if(e){if(e.covered>e.total)throw new Error(`The total number of covered items (${e.covered}) cannot be greater than the total (${e.total})`);if(e.total<0)throw new Error(`The number of covered items (${e.total}) cannot be negative`)}}var hg=class YN{static fromDetails(t,i){const s=new lg(0,0),r=new lg(0,0),n=new lg(0,0);for(const a of i)if("branches"in a){s.total+=1,s.covered+=a.executed?1:0;for(const c of a.branches)r.total+=1,r.covered+=c.executed?1:0}else n.total+=1,n.covered+=a.executed?1:0;const o=new YN(t,s,r.total>0?r:void 0,n.total>0?n:void 0);return o.detailedCoverage=i,o}constructor(t,i,s,r,n=[]){this.uri=t,this.statementCoverage=i,this.branchCoverage=s,this.declarationCoverage=r,this.includesTests=n}},qD=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}},VD=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}},GD=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}},Db;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(Db||(Db={}));var Pb;(function(e){e[e.Untrusted=0]="Untrusted",e[e.Trusted=1]="Trusted",e[e.Unspecified=2]="Unspecified"})(Pb||(Pb={}));var Tb;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(Tb||(Tb={}));var Mb=class{constructor(e,t,i,s,r,n){this.kind=e,this.name=t,this.detail=i,this.uri=s,this.range=r,this.selectionRange=n}},Nb=class{constructor(e){this.uri=e}},dg=class{constructor(e,t){this.original=e,this.modified=t}},JD=class{constructor(e,t,i,s){this.base=e,this.input1=t,this.input2=i,this.result=s}},Rb=class{constructor(e,t){this.uri=e,this.viewType=t}},ZD=class{constructor(e){this.viewType=e}},Lb=class{constructor(e,t){this.uri=e,this.notebookType=t}},Ob=class{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}},YD=class{constructor(){}},QD=class{constructor(e,t){this.uri=e,this.inputBoxUri=t}},XD=class{constructor(){}},KD=class{constructor(e){this.textDiffs=e}},Fb;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(Fb||(Fb={}));var jb;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(jb||(jb={}));var Ub;(function(e){e[e.Short=1]="Short",e[e.Medium=2]="Medium",e[e.Full=3]="Full"})(Ub||(Ub={}));var J_=class{constructor(e,t,i){this.id=e,this.label=t,this.values=i}},Mr;(function(e){e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.Saved=3]="Saved"})(Mr||(Mr={}));var zb;(function(e){e[e.Keep=1]="Keep",e[e.Undo=2]="Undo",e[e.UserModification=3]="UserModification"})(zb||(zb={}));var Hb;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful",e[e.Undone=2]="Undone",e[e.Accepted=3]="Accepted",e[e.Bug=4]="Bug"})(Hb||(Hb={}));var xh;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful"})(xh||(xh={}));var fg=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Ni(e):e}},Ch=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Ni(e):e,this.vulnerabilities=t}},pg=class{constructor(e,t,i,s){this.title=e,this.message=t,this.data=i,this.buttons=s}},gg=class{constructor(e,t){this.value=e,this.baseUri=t}},Wb=class{constructor(e,t,i){this.value=e,this.title=t,this.readOnly=i}},Z_=class{constructor(e,t){this.data=e,this.mimeType=t}},_b=class{constructor(e,t){this.uris=e,this.callback=t,this.applied=new Promise(i=>{this.didGetApplied=i})}},kh=class{constructor(e,t){this.value=e,this.value2=e,this.title=t}},Bb=class{constructor(e){this.value=e}},mg=class{constructor(e,t){this.value=e,this.task=t}},al=class{constructor(e,t,i){this.value=e,this.id=t,this.metadata=i}},vg=class{constructor(e,t,i,s){this.hookType=e,this.stopReason=t,this.systemMessage=i,this.metadata=s}},$h=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new Ni(e):e}},wg=class{constructor(e){this.value=e}},Ca=class{constructor(e,t,i){this.value=e,this.iconPath=t,this.options=i}},bg=class{constructor(e,t,i){this.value=e,this.isEdit=t,this.undoStopId=i}},yg=class{constructor(e,t,i){this.value=e,this.license=t,this.snippet=i}},Ag=class{constructor(e,t){this.uri=e,this.range=t}},qb=class{constructor(e){this.extensions=e}},Vb=class{constructor(e,t,i,s,r){this.uri=e,this.title=t,this.description=i,this.author=s,this.linkTag=r}toJSON(){return{$mid:26,uri:this.uri,title:this.title,description:this.description,author:this.author}}},Nr;(function(e){e[e.Text=1]="Text",e[e.SingleSelect=2]="SingleSelect",e[e.MultiSelect=3]="MultiSelect"})(Nr||(Nr={}));var e9=class{constructor(e,t,i,s){this.id=e,this.type=t,this.title=i,this.message=s?.message,this.options=s?.options,this.defaultValue=s?.defaultValue,this.allowFreeformInput=s?.allowFreeformInput}},Ih=class{constructor(e,t=!0){this.questions=e,this.allowSkip=t}},Dh=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},Sg=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},Gb=class{constructor(e){this.edits=e}},Jb=class{constructor(e,t,i){this.toolName=e,this.toolCallId=t,this.isError=i}},Eg=class{constructor(e,t,i,s,r,n,o){this.prompt=e,this.command=t,this.references=i,this.participant=s,this.toolReferences=r,this.editedFileEvents=n,this.id=o}},t9=class{constructor(e,t,i,s){this.response=e,this.result=t,this.participant=i,this.command=s}},Y_=class{constructor(e,t,i,s){this.response=e,this.result=t,this.participant=i,this.command=s}},ir;(function(e){e[e.Panel=1]="Panel",e[e.Terminal=2]="Terminal",e[e.Notebook=3]="Notebook",e[e.Editor=4]="Editor"})(ir||(ir={}));var Zb;(function(e){e[e.Failed=0]="Failed",e[e.Completed=1]="Completed",e[e.InProgress=2]="InProgress"})(Zb||(Zb={}));var Q_=class{constructor(e,t,i,s){this.modifiedUri=e,this.insertions=t,this.deletions=i,this.originalUri=s}},X_=class{constructor(e,t,i,s,r){this.uri=e,this.originalUri=t,this.modifiedUri=i,this.insertions=s,this.deletions=r}},Yb;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(Yb||(Yb={}));var Qb;(function(e){e[e.NoReason=0]="NoReason",e[e.FilteredContentRetry=1]="FilteredContentRetry",e[e.CopyrightContentRetry=2]="CopyrightContentRetry"})(Qb||(Qb={}));var i9=class{constructor(e,t,i,s){this.editor=e,this.document=t,this.selection=i,this.wholeRange=s}},s9=class{constructor(e){this.cell=e}},r9=class{constructor(e,t,i){this.mimeType=e,this.data=t,this.reference=i}},Xb=class{constructor(e){this.diagnostics=e}},os;(function(e){e[e.User=1]="User",e[e.Assistant=2]="Assistant",e[e.System=3]="System"})(os||(os={}));var cl=class{constructor(e,t,i){this.callId=e,this.content=t,this.isError=i??!1}},Kb;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(Kb||(Kb={}));var n9=class JE{static User(t,i){return new JE(os.User,t,i)}static Assistant(t,i){return new JE(os.Assistant,t,i)}set content(t){typeof t=="string"?this.c=[new Xt(t)]:this.c=t}get content(){return this.c}constructor(t,i,s){this.c=[],this.role=t,this.content=i,this.name=s}},o9=class ZE{static User(t,i){return new ZE(os.User,t,i)}static Assistant(t,i){return new ZE(os.Assistant,t,i)}set content(t){typeof t=="string"?this.c=[new Xt(t)]:this.c=t}get content(){return this.c}set content2(t){t&&(this.content=t.map(i=>typeof i=="string"?new Xt(i):i))}get content2(){return this.content.map(t=>t instanceof Xt?t.value:t)}constructor(t,i,s){this.c=[],this.role=t,this.content=i,this.name=s}},ka=class{constructor(e,t,i){this.callId=e,this.name=t,this.input=i}},xg;(function(e){e[e.Assistant=0]="Assistant",e[e.User=1]="User",e[e.Extension=2]="Extension"})(xg||(xg={}));var Xt=class{constructor(e,t){this.value=e,t=t}toJSON(){return{$mid:21,value:this.value,audience:this.audience}}},Li=class f1{constructor(t,i,s){this.mimeType=i,this.data=t,this.audience=s}static image(t,i){return new f1(t,i)}static json(t,i="text/x-json"){const s=JSON.stringify(t,void 0,"	");return new f1(_.fromString(s).buffer,i)}static text(t,i=Gs.text){return new f1(_.fromString(t).buffer,i)}toJSON(){return{$mid:24,mimeType:this.mimeType,data:this.data,audience:this.audience}}},ey;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(ey||(ey={}));var ll=class{constructor(e,t,i){this.value=e,this.id=t,this.metadata=i}toJSON(){return{$mid:22,value:this.value,id:this.id,metadata:this.metadata}}},vo=class{constructor(e){this.value=e}toJSON(){return{$mid:23,value:this.value}}},cn=class _r extends Error{static#e="LanguageModelError";static NotFound(t){return new _r(t,_r.NotFound.name)}static NoPermissions(t){return new _r(t,_r.NoPermissions.name)}static Blocked(t){return new _r(t,_r.Blocked.name)}static tryDeserialize(t){if(t.name===_r.#e)return new _r(t.message,t.code,t.cause)}constructor(t,i,s){super(t,{cause:s}),this.name=_r.#e,this.code=i??""}},Cg=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},K_=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},eB=class extends Cg{},kg;(function(e){e[e.Auto=1]="Auto",e[e.Required=2]="Required"})(kg||(kg={}));var a9=class{constructor(e,t){this.id=e,this.label=t}},c9=class{constructor(e,t,i){this.label=e,this.name=t,this.instructions=i}},ty;(function(e){e[e.SymbolInformation=1]="SymbolInformation",e[e.CommandInformation=2]="CommandInformation",e[e.SearchInformation=3]="SearchInformation",e[e.SettingInformation=4]="SettingInformation"})(ty||(ty={}));var iy;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(iy||(iy={}));var sy;(function(e){e[e.Started=1]="Started",e[e.Recognizing=2]="Recognizing",e[e.Recognized=3]="Recognized",e[e.Stopped=4]="Stopped",e[e.Error=5]="Error"})(sy||(sy={}));var ry;(function(e){e[e.Started=1]="Started",e[e.Stopped=2]="Stopped",e[e.Error=3]="Error"})(ry||(ry={}));var ny;(function(e){e[e.Recognized=1]="Recognized",e[e.Stopped=2]="Stopped"})(ny||(ny={}));var $g;(function(e){e[e.Initial=0]="Initial",e[e.Dynamic=1]="Dynamic"})($g||($g={}));var oy=class{constructor(e,t,i,s={},r,n){this.label=e,this.command=t,this.args=i,this.env=s,this.version=r,this.metadata=n}},ay=class{constructor(e,t,i={},s,r,n){this.label=e,this.uri=t,this.headers=i,this.version=s,this.metadata=r,this.authentication=n}},sr;(function(e){function t(s){const{selectionStartLineNumber:r,selectionStartColumn:n,positionLineNumber:o,positionColumn:a}=s,c=new Re(r-1,n-1),l=new Re(o-1,a-1);return new Ir(c,l)}e.to=t;function i(s){const{anchor:r,active:n}=s;return{selectionStartLineNumber:r.line+1,selectionStartColumn:r.character+1,positionLineNumber:n.line+1,positionColumn:n.character+1}}e.from=i})(sr||(sr={}));var U;(function(e){function t(s){if(!s)return;const{start:r,end:n}=s;return{startLineNumber:r.line+1,startColumn:r.character+1,endLineNumber:n.line+1,endColumn:n.character+1}}e.from=t;function i(s){if(!s)return;const{startLineNumber:r,startColumn:n,endLineNumber:o,endColumn:a}=s;return new ke(r-1,n-1,o-1,a-1)}e.to=i})(U||(U={}));var rr;(function(e){function t(s){return{uri:s.uri,range:U.from(s.range)}}e.from=t;function i(s){return new ns(y.revive(s.uri),U.to(s.range))}e.to=i})(rr||(rr={}));var cy;(function(e){function t(i){switch(i){case 1:return mo.Comment;case 0:return mo.Other;case 3:return mo.RegEx;case 2:return mo.String}}e.to=t})(cy||(cy={}));var et;(function(e){function t(s){return new Re(s.lineNumber-1,s.column-1)}e.to=t;function i(s){return{lineNumber:s.line+1,column:s.character+1}}e.from=i})(et||(et={}));var $a;(function(e){function t(r,n,o){return yt(Es(r).map(a=>i(a,n,o)))}e.from=t;function i(r,n,o){if(typeof r=="string")return{$serialized:!0,language:r,isBuiltin:o?.isBuiltin};if(r)return{$serialized:!0,language:r.language,scheme:s(r.scheme,n),pattern:qi.from(r.pattern)??void 0,exclusive:r.exclusive,notebookType:r.notebookType,isBuiltin:o?.isBuiltin}}function s(r,n){return n&&typeof r=="string"?n.transformOutgoingScheme(r):r}})($a||($a={}));var Ig;(function(e){function t(s){switch(s){case da.Unnecessary:return 1;case da.Deprecated:return 2}}e.from=t;function i(s){switch(s){case 1:return da.Unnecessary;case 2:return da.Deprecated;default:return}}e.to=i})(Ig||(Ig={}));var Ia;(function(e){function t(s){let r;return s.code&&(Oe(s.code)||xs(s.code)?r=String(s.code):r={value:String(s.code.value),target:s.code.target}),{...U.from(s.range),message:s.message,source:s.source,code:r,severity:Ph.from(s.severity),relatedInformation:s.relatedInformation&&s.relatedInformation.map(Dg.from),tags:Array.isArray(s.tags)?yt(s.tags.map(Ig.from)):void 0}}e.from=t;function i(s){const r=new $p(U.to(s),s.message,Ph.to(s.severity));return r.source=s.source,r.code=Oe(s.code)?s.code:s.code?.value,r.relatedInformation=s.relatedInformation&&s.relatedInformation.map(Dg.to),r.tags=s.tags&&yt(s.tags.map(Ig.to)),r}e.to=i})(Ia||(Ia={}));var Dg;(function(e){function t(s){return{...U.from(s.location.range),message:s.message,resource:s.location.uri}}e.from=t;function i(s){return new Xu(new ns(s.resource,U.to(s)),s.message)}e.to=i})(Dg||(Dg={}));var Ph;(function(e){function t(s){switch(s){case bi.Error:return Hi.Error;case bi.Warning:return Hi.Warning;case bi.Information:return Hi.Info;case bi.Hint:return Hi.Hint}return Hi.Error}e.from=t;function i(s){switch(s){case Hi.Info:return bi.Information;case Hi.Warning:return bi.Warning;case Hi.Error:return bi.Error;case Hi.Hint:return bi.Hint;default:return bi.Error}}e.to=i})(Ph||(Ph={}));var si;(function(e){function t(s){return typeof s=="number"&&s>=ah.One?s-1:s===ah.Beside?GW:VW}e.from=t;function i(s){if(typeof s=="number"&&s>=0)return s+1;throw new Error("invalid 'EditorGroupColumn'")}e.to=i})(si||(si={}));function tB(e){return typeof e.range<"u"}function l9(e){return e.length===0?!0:!!tB(e[0])}var le;(function(e){function t(a){return a.map(e.from)}e.fromMany=t;function i(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function s(a){let c;if(i(a)){const{language:h,value:f}=a;c={value:"```"+h+`
`+f+"\n```\n"}}else Ni.isMarkdownString(a)?c={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,supportAlertSyntax:a.supportAlertSyntax,baseUri:a.baseUri}:typeof a=="string"?c={value:a}:c={value:""};const l=Object.create(null);c.uris=l;const u=({href:h})=>{try{let f=y.parse(h,!0);f=f.with({query:r(f.query,l)}),l[h]=f}catch{}return""};return wt.walkTokens(wt.lexer(c.value),h=>{h.type==="link"?u({href:h.href}):h.type==="image"&&typeof h.href=="string"&&u(fz(h.href))}),c}e.from=s;function r(a,c){if(!a)return a;let l;try{l=ok(a)}catch{}if(!l)return a;let u=!1;return l=gc(l,h=>{if(y.isUri(h)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return c[f]=h,u=!0,f}else return}),u?JSON.stringify(l):a}function n(a){const c=new Ni(a.value,a.supportThemeIcons);return c.isTrusted=a.isTrusted,c.supportHtml=a.supportHtml,c.supportAlertSyntax=a.supportAlertSyntax,c.baseUri=a.baseUri?y.from(a.baseUri):void 0,c}e.to=n;function o(a){if(a)return typeof a=="string"?a:e.from(a)}e.fromStrict=o})(le||(le={}));function iB(e){return l9(e)?e.map(t=>({range:U.from(t.range),hoverMessage:Array.isArray(t.hoverMessage)?le.fromMany(t.hoverMessage):t.hoverMessage?le.from(t.hoverMessage):void 0,renderOptions:t.renderOptions})):e.map(t=>({range:U.from(t)}))}function Pg(e){return typeof e>"u"?e:typeof e=="string"?y.file(e):e}var ul;(function(e){function t(i){return typeof i>"u"?i:{contentText:i.contentText,contentIconPath:i.contentIconPath?Pg(i.contentIconPath):void 0,border:i.border,borderColor:i.borderColor,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,color:i.color,backgroundColor:i.backgroundColor,margin:i.margin,width:i.width,height:i.height}}e.from=t})(ul||(ul={}));var Tg;(function(e){function t(i){return typeof i>"u"?i:{backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?Pg(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?ul.from(i.before):void 0,after:i.after?ul.from(i.after):void 0}}e.from=t})(Tg||(Tg={}));var ly;(function(e){function t(i){if(typeof i>"u")return i;switch(i){case ba.OpenOpen:return 0;case ba.ClosedClosed:return 1;case ba.OpenClosed:return 2;case ba.ClosedOpen:return 3}}e.from=t})(ly||(ly={}));var uy;(function(e){function t(i){return{isWholeLine:i.isWholeLine,rangeBehavior:i.rangeBehavior?ly.from(i.rangeBehavior):void 0,overviewRulerLane:i.overviewRulerLane,light:i.light?Tg.from(i.light):void 0,dark:i.dark?Tg.from(i.dark):void 0,backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?Pg(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?ul.from(i.before):void 0,after:i.after?ul.from(i.after):void 0}}e.from=t})(uy||(uy={}));var ri;(function(e){function t(s){return{text:s.newText,eol:s.newEol&&pl.from(s.newEol),range:U.from(s.range)}}e.from=t;function i(s){const r=new lo(U.to(s.range),s.text);return r.newEol=typeof s.eol>"u"?void 0:pl.to(s.eol),r}e.to=i})(ri||(ri={}));var as;(function(e){function t(s,r){const n={edits:[]};if(s instanceof va){const o=new cu;for(const a of s._allEntries())a._type===1&&y.isUri(a.to)&&a.from===void 0&&o.add(a.to);for(const a of s._allEntries())if(a._type===1){let c;a.options?.contents&&(ArrayBuffer.isView(a.options.contents)?c={type:"base64",value:_n(_.wrap(a.options.contents))}:c={type:"dataTransferItem",id:a.options.contents._itemId}),n.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:c},metadata:a.metadata})}else a._type===2?n.edits.push({resource:a.uri,textEdit:ri.from(a.edit),versionId:o.has(a.uri)?void 0:r?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===6?n.edits.push({resource:a.uri,textEdit:{range:U.from(a.range),text:a.edit.value,insertAsSnippet:!0,keepWhitespace:a.keepWhitespace},versionId:o.has(a.uri)?void 0:r?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===3?n.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookVersionId:r?.getNotebookDocumentVersion(a.uri)}):a._type===5&&n.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:r?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:1,index:a.index,count:a.count,cells:a.cells.map(ml.from)}})}return n}e.from=t;function i(s){const r=new va,n=new Ct;for(const o of s.edits)if(o.textEdit){const a=o,c=y.revive(a.resource),l=U.to(a.textEdit.range),u=a.textEdit.text,h=a.textEdit.insertAsSnippet;let f;h?f=Bw.replace(l,new ga(u)):f=lo.replace(l,u);const p=n.get(c);p?p.push(f):n.set(c,[f])}else r.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of n)r.set(o,a);return r}e.to=i})(as||(as={}));var Ps;(function(e){const t=Object.create(null);t[gt.File]=0,t[gt.Module]=1,t[gt.Namespace]=2,t[gt.Package]=3,t[gt.Class]=4,t[gt.Method]=5,t[gt.Property]=6,t[gt.Field]=7,t[gt.Constructor]=8,t[gt.Enum]=9,t[gt.Interface]=10,t[gt.Function]=11,t[gt.Variable]=12,t[gt.Constant]=13,t[gt.String]=14,t[gt.Number]=15,t[gt.Boolean]=16,t[gt.Array]=17,t[gt.Object]=18,t[gt.Key]=19,t[gt.Null]=20,t[gt.EnumMember]=21,t[gt.Struct]=22,t[gt.Event]=23,t[gt.Operator]=24,t[gt.TypeParameter]=25;function i(r){return typeof t[r]=="number"?t[r]:6}e.from=i;function s(r){for(const n in t)if(t[n]===r)return Number(n);return gt.Property}e.to=s})(Ps||(Ps={}));var ln;(function(e){function t(s){if(s===Ku.Deprecated)return 1}e.from=t;function i(s){if(s===1)return Ku.Deprecated}e.to=i})(ln||(ln={}));var Da;(function(e){function t(s){return{name:s.name,kind:Ps.from(s.kind),tags:s.tags&&s.tags.map(ln.from),containerName:s.containerName,location:Bi.from(s.location)}}e.from=t;function i(s){const r=new eh(s.name,Ps.to(s.kind),s.containerName,Bi.to(s.location));return r.tags=s.tags&&s.tags.map(ln.to),r}e.to=i})(Da||(Da={}));var hy;(function(e){function t(s){const r={name:s.name||"!!MISSING: name!!",detail:s.detail,range:U.from(s.range),selectionRange:U.from(s.selectionRange),kind:Ps.from(s.kind),tags:s.tags?.map(ln.from)??[]};return s.children&&(r.children=s.children.map(t)),r}e.from=t;function i(s){const r=new ih(s.name,s.detail,Ps.to(s.kind),U.to(s.range),U.to(s.selectionRange));return au(s.tags)&&(r.tags=s.tags.map(ln.to)),s.children&&(r.children=s.children.map(i)),r}e.to=i})(hy||(hy={}));var Pa;(function(e){function t(s){const r=new Qw(Ps.to(s.kind),s.name,s.detail||"",y.revive(s.uri),U.to(s.range),U.to(s.selectionRange));return r._sessionId=s._sessionId,r._itemId=s._itemId,r}e.to=t;function i(s,r,n){if(r=r??s._sessionId,n=n??s._itemId,r===void 0||n===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:n,name:s.name,detail:s.detail,kind:Ps.from(s.kind),uri:s.uri,range:U.from(s.range),selectionRange:U.from(s.selectionRange),tags:s.tags?.map(ln.from)}}e.from=i})(Pa||(Pa={}));var dy;(function(e){function t(i){return new LD(Pa.to(i.from),i.fromRanges.map(s=>U.to(s)))}e.to=t})(dy||(dy={}));var fy;(function(e){function t(i){return new OD(Pa.to(i.to),i.fromRanges.map(s=>U.to(s)))}e.to=t})(fy||(fy={}));var Bi;(function(e){function t(s){return{range:s.range&&U.from(s.range),uri:s.uri}}e.from=t;function i(s){return new ns(y.revive(s.uri),U.to(s.range))}e.to=i})(Bi||(Bi={}));var Th;(function(e){function t(s){const r=s,n=s;return{originSelectionRange:r.originSelectionRange?U.from(r.originSelectionRange):void 0,uri:r.targetUri?r.targetUri:n.uri,range:U.from(r.targetRange?r.targetRange:n.range),targetSelectionRange:r.targetSelectionRange?U.from(r.targetSelectionRange):void 0}}e.from=t;function i(s){return{targetUri:y.revive(s.uri),targetRange:U.to(s.range),targetSelectionRange:s.targetSelectionRange?U.to(s.targetSelectionRange):void 0,originSelectionRange:s.originSelectionRange?U.to(s.originSelectionRange):void 0}}e.to=i})(Th||(Th={}));var Mh;(function(e){function t(s){return{range:U.from(s.range),contents:le.fromMany(s.contents),canIncreaseVerbosity:s.canIncreaseVerbosity,canDecreaseVerbosity:s.canDecreaseVerbosity}}e.from=t;function i(s){const r=s.contents.map(le.to),n=U.to(s.range),o=s.canIncreaseVerbosity,a=s.canDecreaseVerbosity;return new Rp(r,n,o,a)}e.to=i})(Mh||(Mh={}));var py;(function(e){function t(s){return{range:U.from(s.range),expression:s.expression}}e.from=t;function i(s){return new Yp(U.to(s.range),s.expression)}e.to=i})(py||(py={}));var Mg;(function(e){function t(s){if(s instanceof Qp)return{type:"text",range:U.from(s.range),text:s.text};if(s instanceof Xp)return{type:"variable",range:U.from(s.range),variableName:s.variableName,caseSensitiveLookup:s.caseSensitiveLookup};if(s instanceof Kp)return{type:"expression",range:U.from(s.range),expression:s.expression};throw new Error("Unknown 'InlineValue' type")}e.from=t;function i(s){switch(s.type){case"text":return{range:U.to(s.range),text:s.text};case"variable":return{range:U.to(s.range),variableName:s.variableName,caseSensitiveLookup:s.caseSensitiveLookup};case"expression":return{range:U.to(s.range),expression:s.expression}}}e.to=i})(Mg||(Mg={}));var Ng;(function(e){function t(s){return{frameId:s.frameId,stoppedLocation:U.from(s.stoppedLocation)}}e.from=t;function i(s){return new vb(s.frameId,U.to(s.stoppedLocation))}e.to=i})(Ng||(Ng={}));var hl;(function(e){function t(s){return{range:U.from(s.range),kind:s.kind}}e.from=t;function i(s){return new Lp(U.to(s.range),s.kind)}e.to=i})(hl||(hl={}));var gy;(function(e){function t(s){return{uri:s.uri,highlights:s.highlights.map(hl.from)}}e.from=t;function i(s){return new Op(y.revive(s.uri),s.highlights.map(hl.to))}e.to=i})(gy||(gy={}));var my;(function(e){function t(i){switch(i){case 1:return Uc.TriggerCharacter;case 2:return Uc.TriggerForIncompleteCompletions;default:return Uc.Invoke}}e.to=t})(my||(my={}));var vy;(function(e){function t(i){return{triggerKind:my.to(i.triggerKind),triggerCharacter:i.triggerCharacter}}e.to=t})(vy||(vy={}));var Rg;(function(e){function t(s){if(s===oh.Deprecated)return 1}e.from=t;function i(s){if(s===1)return oh.Deprecated}e.to=i})(Rg||(Rg={}));var wy;(function(e){function t(i,s,r){return"icon"in i&&"command"in i?{command:s.toInternal(i.command,r),icon:un.fromThemeIcon(i.icon)}:{command:s.toInternal(i,r)}}e.from=t})(wy||(wy={}));var Lg;(function(e){const t=new Map([[be.Method,0],[be.Function,1],[be.Constructor,2],[be.Field,3],[be.Variable,4],[be.Class,5],[be.Interface,7],[be.Struct,6],[be.Module,8],[be.Property,9],[be.Unit,12],[be.Value,13],[be.Constant,14],[be.Enum,15],[be.EnumMember,16],[be.Keyword,17],[be.Snippet,28],[be.Text,18],[be.Color,19],[be.File,20],[be.Reference,21],[be.Folder,23],[be.Event,10],[be.Operator,11],[be.TypeParameter,24],[be.Issue,26],[be.User,25]]);function i(n){return t.get(n)??9}e.from=i;const s=new Map([[0,be.Method],[1,be.Function],[2,be.Constructor],[3,be.Field],[4,be.Variable],[5,be.Class],[7,be.Interface],[6,be.Struct],[8,be.Module],[9,be.Property],[12,be.Unit],[13,be.Value],[14,be.Constant],[15,be.Enum],[16,be.EnumMember],[17,be.Keyword],[28,be.Snippet],[18,be.Text],[19,be.Color],[20,be.File],[21,be.Reference],[23,be.Folder],[10,be.Event],[11,be.Operator],[24,be.TypeParameter],[25,be.User],[26,be.Issue]]);function r(n){return s.get(n)??be.Property}e.to=r})(Lg||(Lg={}));var by;(function(e){function t(i,s){const r=new zp(i.label);return r.insertText=i.insertText,r.kind=Lg.to(i.kind),r.tags=i.tags?.map(Rg.to),r.detail=i.detail,r.documentation=Xn(i.documentation)?le.to(i.documentation):i.documentation,r.sortText=i.sortText,r.filterText=i.filterText,r.preselect=i.preselect,r.commitCharacters=i.commitCharacters,ot.isIRange(i.range)?r.range=U.to(i.range):typeof i.range=="object"&&(r.range={inserting:U.to(i.range.insert),replacing:U.to(i.range.replace)}),r.keepWhitespace=typeof i.insertTextRules>"u"?!1:!!(i.insertTextRules&1),typeof i.insertTextRules<"u"&&i.insertTextRules&4?r.insertText=new ga(i.insertText):(r.insertText=i.insertText,r.textEdit=r.range instanceof ke?new lo(r.range,r.insertText):void 0),i.additionalTextEdits&&i.additionalTextEdits.length>0&&(r.additionalTextEdits=i.additionalTextEdits.map(n=>ri.to(n))),r.command=s&&i.command?s.fromInternal(i.command):void 0,r}e.to=t})(by||(by={}));var Og;(function(e){function t(s){if(typeof s.label!="string"&&!Array.isArray(s.label))throw new TypeError("Invalid label");return{label:s.label,documentation:le.fromStrict(s.documentation)}}e.from=t;function i(s){return{label:s.label,documentation:Xn(s.documentation)?le.to(s.documentation):s.documentation}}e.to=i})(Og||(Og={}));var Fg;(function(e){function t(s){return{label:s.label,documentation:le.fromStrict(s.documentation),parameters:Array.isArray(s.parameters)?s.parameters.map(Og.from):[],activeParameter:s.activeParameter}}e.from=t;function i(s){return{label:s.label,documentation:Xn(s.documentation)?le.to(s.documentation):s.documentation,parameters:Array.isArray(s.parameters)?s.parameters.map(Og.to):[],activeParameter:s.activeParameter}}e.to=i})(Fg||(Fg={}));var Nh;(function(e){function t(s){return{activeSignature:s.activeSignature,activeParameter:s.activeParameter,signatures:Array.isArray(s.signatures)?s.signatures.map(Fg.from):[]}}e.from=t;function i(s){return{activeSignature:s.activeSignature,activeParameter:s.activeParameter,signatures:Array.isArray(s.signatures)?s.signatures.map(Fg.to):[]}}e.to=i})(Nh||(Nh={}));var yy;(function(e){function t(i,s){const r=new Up(et.to(s.position),typeof s.label=="string"?s.label:s.label.map(Ay.to.bind(void 0,i)),s.kind&&jg.to(s.kind));return r.textEdits=s.textEdits&&s.textEdits.map(ri.to),r.tooltip=Xn(s.tooltip)?le.to(s.tooltip):s.tooltip,r.paddingLeft=s.paddingLeft,r.paddingRight=s.paddingRight,r}e.to=t})(yy||(yy={}));var Ay;(function(e){function t(i,s){const r=new jp(s.label);return r.tooltip=Xn(s.tooltip)?le.to(s.tooltip):s.tooltip,uw.is(s.command)&&(r.command=i.fromInternal(s.command)),s.location&&(r.location=Bi.to(s.location)),r}e.to=t})(Ay||(Ay={}));var jg;(function(e){function t(s){return s}e.from=t;function i(s){return s}e.to=i})(jg||(jg={}));var Ta;(function(e){function t(s){return{range:U.from(s.range),url:s.target,tooltip:s.tooltip}}e.from=t;function i(s){let r;if(s.url)try{r=typeof s.url=="string"?y.parse(s.url,!0):y.revive(s.url)}catch{}const n=new Wp(U.to(s.range),r);return n.tooltip=s.tooltip,n}e.to=i})(Ta||(Ta={}));var Ug;(function(e){function t(s){const r=new Bp(s.label);return s.textEdit&&(r.textEdit=ri.to(s.textEdit)),s.additionalTextEdits&&(r.additionalTextEdits=s.additionalTextEdits.map(n=>ri.to(n))),r}e.to=t;function i(s){return{label:s.label,textEdit:s.textEdit?ri.from(s.textEdit):void 0,additionalTextEdits:s.additionalTextEdits?s.additionalTextEdits.map(r=>ri.from(r)):void 0}}e.from=i})(Ug||(Ug={}));var dl;(function(e){function t(s){return new Gc(s[0],s[1],s[2],s[3])}e.to=t;function i(s){return[s.red,s.green,s.blue,s.alpha]}e.from=i})(dl||(dl={}));var Sy;(function(e){function t(s){return{range:U.from(s.range)}}e.from=t;function i(s){return new nh(U.to(s.range))}e.to=i})(Sy||(Sy={}));var zg;(function(e){function t(i){switch(i){case 2:return _c.AfterDelay;case 1:return _c.Manual;case 3:case 4:return _c.FocusOut}}e.to=t})(zg||(zg={}));var fl;(function(e){function t(s){switch(s){case tr.Off:return 0;case tr.Relative:return 2;case tr.Interval:return 3;case tr.On:default:return 1}}e.from=t;function i(s){switch(s){case 0:return tr.Off;case 2:return tr.Relative;case 3:return tr.Interval;default:return tr.On}}e.to=i})(fl||(fl={}));var pl;(function(e){function t(s){if(s===er.CRLF)return 1;if(s===er.LF)return 0}e.from=t;function i(s){if(s===1)return er.CRLF;if(s===0)return er.LF}e.to=i})(pl||(pl={}));var Hg;(function(e){function t(i){if(typeof i=="object")return i.viewId;switch(i){case fo.SourceControl:return 3;case fo.Window:return 10;case fo.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}e.from=t})(Hg||(Hg={}));var Wg;(function(e){function t(s){const r={start:s.start+1,end:s.end+1};return s.kind&&(r.kind=_g.from(s.kind)),r}e.from=t;function i(s){const r={start:s.start-1,end:s.end-1};return s.kind&&(r.kind=_g.to(s.kind)),r}e.to=i})(Wg||(Wg={}));var _g;(function(e){function t(s){if(s)switch(s){case an.Comment:return Sc.Comment;case an.Imports:return Sc.Imports;case an.Region:return Sc.Region}}e.from=t;function i(s){if(s)switch(s.value){case Sc.Comment.value:return an.Comment;case Sc.Imports.value:return an.Imports;case Sc.Region.value:return an.Region}}e.to=i})(_g||(_g={}));var Rh;(function(e){function t(i){if(i)return{pinned:typeof i.preview=="boolean"?!i.preview:void 0,inactive:i.background,preserveFocus:i.preserveFocus,selection:typeof i.selection=="object"?U.from(i.selection):void 0,override:typeof i.override=="boolean"?oH.id:void 0}}e.from=t})(Rh||(Rh={}));var qi;(function(e){function t(n){return n instanceof Xc?n.toJSON():typeof n=="string"?n:i(n)||s(n)?new Xc(n.baseUri??n.base,n.pattern).toJSON():n}e.from=t;function i(n){const o=n;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function s(n){const o=n;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function r(n){return typeof n=="string"?n:new Xc(y.revive(n.baseUri),n.pattern)}e.to=r})(qi||(qi={}));var Ey;(function(e){function t(i){if(i){if(Array.isArray(i))return i.map(t);if(typeof i=="string")return i;{const s=i;return{language:s.language,scheme:s.scheme,pattern:qi.from(s.pattern)??void 0,exclusive:s.exclusive,notebookType:s.notebookType}}}else return}e.from=t})(Ey||(Ey={}));var Rr;(function(e){function t(s){return{start:s.start,end:s.end}}e.from=t;function i(s){return new $r(s.start,s.end)}e.to=i})(Rr||(Rr={}));var gl;(function(e){function t(s){return{timing:typeof s.runStartTime=="number"&&typeof s.runEndTime=="number"?{startTime:s.runStartTime,endTime:s.runEndTime}:void 0,executionOrder:s.executionOrder,success:s.lastRunSuccess}}e.to=t;function i(s){return{lastRunSuccess:s.success,runStartTime:s.timing?.startTime,runEndTime:s.timing?.endTime,executionOrder:s.executionOrder}}e.from=i})(gl||(gl={}));var Lh;(function(e){function t(s){switch(s){case fa.Markup:return Nc.Markup;case fa.Code:default:return Nc.Code}}e.from=t;function i(s){switch(s){case Nc.Markup:return fa.Markup;case Nc.Code:default:return fa.Code}}e.to=i})(Lh||(Lh={}));var wo;(function(e){function t(s){const r={metadata:s.metadata??Object.create(null),cells:[]};for(const n of s.cells)Ip.validate(n),r.cells.push(ml.from(n));return r}e.from=t;function i(s){const r=new PD(s.cells.map(ml.to));return L1(s.metadata)||(r.metadata=s.metadata),r}e.to=i})(wo||(wo={}));var ml;(function(e){function t(s){return{cellKind:Lh.from(s.kind),language:s.languageId,mime:s.mime,source:s.value,metadata:s.metadata,internalMetadata:gl.from(s.executionSummary??{}),outputs:s.outputs?s.outputs.map(bo.from):[]}}e.from=t;function i(s){return new Ip(Lh.to(s.cellKind),s.source,s.language,s.mime,s.outputs?s.outputs.map(bo.to):void 0,s.metadata,s.internalMetadata?gl.to(s.internalMetadata):void 0)}e.to=i})(ml||(ml={}));var vl;(function(e){function t(s){return{mime:s.mime,valueBytes:_.wrap(s.data)}}e.from=t;function i(s){return new TD(s.valueBytes.buffer,s.mime)}e.to=i})(vl||(vl={}));var bo;(function(e){function t(s){return{outputId:s.id,items:s.items.map(vl.from),metadata:s.metadata}}e.from=t;function i(s){const r=s.items.map(vl.to);return new Pp(r,s.outputId,s.metadata)}e.to=i})(bo||(bo={}));var Bg;(function(e){function t(r){return s(r)?{include:qi.from(r.include)??void 0,exclude:qi.from(r.exclude)??void 0}:qi.from(r)??void 0}e.from=t;function i(r){return s(r)?{include:qi.to(r.include),exclude:qi.to(r.exclude)}:qi.to(r)}e.to=i;function s(r){const n=r;return n?!qt(n.include)&&!qt(n.exclude):!1}})(Bg||(Bg={}));var xy;(function(e){function t(i,s,r){const n=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{alignment:i.alignment===sg.Left?1:2,command:s.toInternal(n,r),text:i.text,tooltip:i.tooltip,accessibilityInformation:i.accessibilityInformation,priority:i.priority}}e.from=t})(xy||(xy={}));var Cy;(function(e){function t(i,s,r){const n=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{command:s.toInternal(n,r),label:i.label,description:i.description,detail:i.detail,documentation:i.documentation}}e.from=t})(Cy||(Cy={}));var ky;(function(e){function t(i){return{transientOutputs:i?.transientOutputs??!1,transientCellMetadata:i?.transientCellMetadata??{},transientDocumentMetadata:i?.transientDocumentMetadata??{},cellContentMetadata:i?.cellContentMetadata??{}}}e.from=t})(ky||(ky={}));var qg;(function(e){function t(s){return{uri:s.uri,provides:s.provides}}e.from=t;function i(s){return new _D(y.revive(s.uri),s.provides)}e.to=i})(qg||(qg={}));var wl;(function(e){function t(s){return{message:le.fromStrict(s.message)||"",type:0,expected:s.expectedOutput,actual:s.actualOutput,contextValue:s.contextValue,location:s.location&&{range:U.from(s.location.range),uri:s.location.uri},stackTrace:s.stackTrace?.map(r=>({label:r.label,position:r.position&&et.from(r.position),uri:r.uri&&y.revive(r.uri).toJSON()}))}}e.from=t;function i(s){const r=new cg(typeof s.message=="string"?s.message:le.to(s.message));return r.actualOutput=s.actual,r.expectedOutput=s.expected,r.contextValue=s.contextValue,r.location=s.location?Bi.to(s.location):void 0,r}e.to=i})(wl||(wl={}));var nr;(function(e){e.namespace=cp,e.denamespace=U6})(nr||(nr={}));var $y;(function(e){function t(i){return{controllerId:i.controllerId,profileId:i.profileId,group:bl.from(i.kind)}}e.from=t})($y||($y={}));var bl;(function(e){const t={[ol.Coverage]:8,[ol.Debug]:4,[ol.Run]:2};function i(s){return t.hasOwnProperty(s)?t[s]:2}e.from=i})(bl||(bl={}));var yo;(function(e){function t(s){const r=kp(s).controllerId;return{extId:Je.fromExtHostTestItem(s,r).toString(),label:s.label,uri:y.revive(s.uri),busy:s.busy,tags:s.tags.map(n=>nr.namespace(r,n.id)),range:ot.lift(U.from(s.range)),description:s.description||null,sortText:s.sortText||null,error:s.error&&le.fromStrict(s.error)||null}}e.from=t;function i(s){return{parent:void 0,error:void 0,id:Je.fromString(s.extId).localId,label:s.label,uri:y.revive(s.uri),tags:(s.tags||[]).map(r=>{const{tagId:n}=nr.denamespace(r);return new Eh(n)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:U.to(s.range||void 0),canResolveChildren:!1,busy:s.busy,description:s.description||void 0,sortText:s.sortText||void 0}}e.toPlain=i})(yo||(yo={})),(function(e){function t(s){return{id:s.id}}e.from=t;function i(s){return new Eh(s.id)}e.to=i})(nr||(nr={}));var Iy;(function(e){const t=(s,r)=>{const n=s.value;if(!n)return;const o={...yo.toPlain(n.item),parent:r,taskStates:n.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(c=>c.type===0).map(wl.to)})),children:[]};if(s.children)for(const a of s.children.values()){const c=t(a,o);c&&o.children.push(c)}return o};function i(s){const r=new Jz;for(const a of s.items)r.insert(Je.fromString(a.item.extId).path,a);const n=[r.nodes],o=[];for(;n.length;)for(const a of n.pop())a.value?o.push(a):a.children&&n.push(a.children.values());return{completedAt:s.completedAt,results:o.map(a=>t(a)).filter(ps)}}e.to=i})(Iy||(Iy={}));var Oh;(function(e){function t(a){return{covered:a.covered,total:a.total}}function i(a){return"line"in a?et.from(a):U.from(a)}function s(a){if(a)return"endLineNumber"in a?U.to(a):et.to(a)}function r(a){if(a.type===1){const c=[];if(a.branches)for(const l of a.branches)c.push({executed:l.count,location:s(l.location),label:l.label});return new qD(a.count,s(a.location),a.branches?.map(l=>new VD(l.count,s(l.location),l.label)))}else return new GD(a.name,a.count,s(a.location))}e.to=r;function n(a){if(typeof a.executed=="number"&&a.executed<0)throw new Error(`Invalid coverage count ${a.executed}`);return"branches"in a?{count:a.executed,location:i(a.location),type:1,branches:a.branches.length?a.branches.map(c=>({count:c.executed,location:c.location&&i(c.location),label:c.label})):void 0}:{type:0,name:a.name,count:a.executed,location:i(a.location)}}e.fromDetails=n;function o(a,c,l){return ug(l.statementCoverage),ug(l.branchCoverage),ug(l.declarationCoverage),{id:c,uri:l.uri,statement:t(l.statementCoverage),branch:l.branchCoverage&&t(l.branchCoverage),declaration:l.declarationCoverage&&t(l.declarationCoverage),testIds:l instanceof hg&&l.includesTests.length?l.includesTests.map(u=>Je.fromExtHostTestItem(u,a).toString()):void 0}}e.fromFile=o})(Oh||(Oh={}));var Dy;(function(e){function t(i){switch(i){case 1:return sh.Invoke;case 2:return sh.Automatic}}e.to=t})(Dy||(Dy={}));var Ma;(function(e){function t(s){const r=new Mb(Ps.to(s.kind),s.name,s.detail||"",y.revive(s.uri),U.to(s.range),U.to(s.selectionRange));return r._sessionId=s._sessionId,r._itemId=s._itemId,r}e.to=t;function i(s,r,n){if(r=r??s._sessionId,n=n??s._itemId,r===void 0||n===void 0)throw new Error("invalid item");return{_sessionId:r,_itemId:n,kind:Ps.from(s.kind),name:s.name,detail:s.detail??"",uri:s.uri,range:U.from(s.range),selectionRange:U.from(s.selectionRange),tags:s.tags?.map(ln.from)}}e.from=i})(Ma||(Ma={}));var Vg;(function(e){function t(i){if(i)return{value:i.value,tooltip:i.tooltip}}e.from=t})(Vg||(Vg={}));var Na;(function(e){function t(n,o,a){const c=o.fileData;return c?new R_(new L_(c.name,y.revive(c.uri),c.id,D1(()=>a(c.id)))):n===Gs.uriList&&o.uriListData?new Jp(r(o.uriListData)):new Jp(o.asString)}e.to=t;async function i(n,o,a=At()){const c=await o.asString();if(n===Gs.uriList)return{id:a,asString:c,fileData:void 0,uriListData:s(c)};const l=o.asFile();return{id:a,asString:c,fileData:l?{name:l.name,uri:l.uri,id:l._itemId??l.id}:void 0}}e.from=i;function s(n){return q0.split(n).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function r(n){return q0.create(n.map(o=>typeof o=="string"?o:y.revive(o)))}})(Na||(Na={}));var yl;(function(e){function t(r,n){const o=r.items.map(([a,c])=>[a,Na.to(a,c,n)]);return new Yc(o)}e.toDataTransfer=t;async function i(r){return{items:await Promise.all(Array.from(r,async([o,a])=>[o,await Na.from(o,a)]))}}e.from=i;async function s(r){return{items:await Promise.all(Array.from(r,async([o,a])=>[o,await Na.from(o,a,a.id)]))}}e.fromList=s})(yl||(yl={}));var Gg;(function(e){function t(s,r){return{kind:"reply",agentId:s.participant??r?.agentId??"",subCommand:s.command??r?.command,message:s.prompt,title:s.label}}e.from=t;function i(s){return{prompt:s.message,label:s.title,participant:s.agentId,command:s.subCommand}}e.to=i})(Gg||(Gg={}));var Al;(function(e){function t(s){switch(s){case 0:return os.System;case 1:return os.User;case 2:return os.Assistant}}e.to=t;function i(s){switch(s){case os.System:return 0;case os.User:return 1;case os.Assistant:return 2}return 1}e.from=i})(Al||(Al={}));var u9;(function(e){function t(s){const r=s.content.map(a=>{if(a.type==="text")return new Xt(a.value,a.audience);if(a.type==="tool_result"){const c=yt(a.value.map(l=>l.type==="text"?new Xt(l.value,l.audience):l.type==="data"?new Li(l.data.buffer,l.mimeType):l.type==="prompt_tsx"?new vo(l.value):void 0));return new cl(a.toolCallId,c,a.isError)}else{if(a.type==="image_url")return new Li(a.value.data.buffer,a.value.mimeType);if(a.type==="data")return new Li(a.data.buffer,a.mimeType);if(a.type==="tool_use")return new ka(a.toolCallId,a.name,a.parameters)}}).filter(a=>a!==void 0),n=Al.to(s.role);return new n9(n,r,s.name)}e.to=t;function i(s){const r=Al.from(s.role),n=s.name;let o=s.content;typeof o=="string"&&(o=[new Xt(o)]);const a=o.map(c=>{if(c instanceof cl)return{type:"tool_result",toolCallId:c.callId,value:yt(c.content.map(l=>l instanceof Xt?{type:"text",value:l.value,audience:l.audience}:l instanceof vo?{type:"prompt_tsx",value:l.value}:l instanceof Li?{type:"data",mimeType:l.mimeType,data:_.wrap(l.data),audience:l.audience}:void 0)),isError:c.isError};if(c instanceof Li)return h9(c)?{type:"image_url",value:{mimeType:c.mimeType,data:_.wrap(c.data)}}:{type:"data",mimeType:c.mimeType,data:_.wrap(c.data),audience:c.audience};if(c instanceof ka)return{type:"tool_use",toolCallId:c.callId,name:c.name,parameters:c.input};if(c instanceof Xt)return{type:"text",value:c.value};if(typeof c!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:c}});return{role:r,name:n,content:a}}e.from=i})(u9||(u9={}));var Jg;(function(e){function t(s){const r=s.content.map(a=>{if(a.type==="text")return new Xt(a.value,a.audience);if(a.type==="tool_result"){const c=a.value.map(l=>l.type==="text"?new Xt(l.value,l.audience):l.type==="data"?new Li(l.data.buffer,l.mimeType):new vo(l.value));return new cl(a.toolCallId,c,a.isError)}else return a.type==="image_url"?new Li(a.value.data.buffer,a.value.mimeType):a.type==="data"?new Li(a.data.buffer,a.mimeType):a.type==="thinking"?new ll(a.value,a.id,a.metadata):new ka(a.toolCallId,a.name,a.parameters)}),n=Al.to(s.role);return new o9(n,r,s.name)}e.to=t;function i(s){const r=Al.from(s.role),n=s.name;let o=s.content;typeof o=="string"&&(o=[new Xt(o)]);const a=o.map(c=>{if(c instanceof cl)return{type:"tool_result",toolCallId:c.callId,value:yt(c.content.map(l=>l instanceof Xt?{type:"text",value:l.value,audience:l.audience}:l instanceof vo?{type:"prompt_tsx",value:l.value}:l instanceof Li?{type:"data",mimeType:l.mimeType,data:_.wrap(l.data),audience:l.audience}:void 0)),isError:c.isError};if(c instanceof Li)return h9(c)?{type:"image_url",value:{mimeType:c.mimeType,data:_.wrap(c.data)}}:{type:"data",mimeType:c.mimeType,data:_.wrap(c.data),audience:c.audience};if(c instanceof ka)return{type:"tool_use",toolCallId:c.callId,name:c.name,parameters:c.input};if(c instanceof Xt)return{type:"text",value:c.value};if(c instanceof ll)return{type:"thinking",value:c.value,id:c.id,metadata:c.metadata};if(typeof c!="string")throw new Error("Unexpected chat message content type llm 2");return{type:"text",value:c}});return{role:r,name:n,content:a}}e.from=i})(Jg||(Jg={}));function h9(e){switch(typeof e.mimeType=="string"?e.mimeType.toLowerCase():""){case"image/png":case"image/jpeg":case"image/jpg":case"image/gif":case"image/webp":case"image/bmp":return!0;default:return!1}}var Fh;(function(e){function t(s){return{kind:"markdownContent",content:le.from(s.value)}}e.from=t;function i(s){return new fg(le.to(s.content))}e.to=i})(Fh||(Fh={}));var Zg;(function(e){function t(s){return{kind:"codeblockUri",uri:s.value,isEdit:s.isEdit,undoStopId:s.undoStopId}}e.from=t;function i(s){return new bg(y.revive(s.uri),s.isEdit,s.undoStopId)}e.to=i})(Zg||(Zg={}));var Yg;(function(e){function t(s){return{kind:"markdownVuln",content:le.from(s.value),vulnerabilities:s.vulnerabilities}}e.from=t;function i(s){return new Ch(le.to(s.content),s.vulnerabilities)}e.to=i})(Yg||(Yg={}));var Qg;(function(e){function t(i){return{kind:"confirmation",title:i.title,message:le.from(i.message),data:i.data,buttons:i.buttons}}e.from=t})(Qg||(Qg={}));var Xg;(function(e){function t(n){switch(n){case Nr.Text:return"text";case Nr.SingleSelect:return"singleSelect";case Nr.MultiSelect:return"multiSelect";default:return"text"}}function i(n){switch(n){case"text":return Nr.Text;case"singleSelect":return Nr.SingleSelect;case"multiSelect":return Nr.MultiSelect;default:return Nr.Text}}function s(n){return{kind:"questionCarousel",questions:n.questions.map(o=>({id:o.id,type:t(o.type),title:o.title,message:o.message?le.from(o.message):void 0,options:o.options,defaultValue:o.defaultValue,allowFreeformInput:o.allowFreeformInput})),allowSkip:n.allowSkip}}e.from=s;function r(n){const o=n.questions.map(a=>new e9(a.id,i(a.type),a.title,{message:a.message?typeof a.message=="string"?new Ni(a.message):le.to(a.message):void 0,options:a.options?.map(c=>({id:c.id,label:c.label,value:c.value})),defaultValue:a.defaultValue,allowFreeformInput:a.allowFreeformInput}));return new Ih(o,n.allowSkip)}e.to=r})(Xg||(Xg={}));var jh;(function(e){function t(s){const{value:r,baseUri:n}=s;function o(a,c){return a.map(l=>{const u=y.joinPath(c,l.name);return{label:l.name,uri:u,children:l.children&&o(l.children,u)}})}return{kind:"treeData",treeData:{label:ji(n),uri:n,children:o(r,n)}}}e.from=t;function i(s){const r=ei(s.treeData);function n(c){return c.map(l=>({name:l.label,children:l.children&&n(l.children)}))}const o=r.uri,a=r.children?n(r.children):[];return new gg(a,o)}e.to=i})(jh||(jh={}));var Py;(function(e){function t(s){return{kind:"multiDiffData",multiDiffData:{title:s.title,resources:s.value.map(r=>({originalUri:r.originalUri,modifiedUri:r.modifiedUri,goToFileUri:r.goToFileUri,added:r.added,removed:r.removed}))},readOnly:s.readOnly}}e.from=t;function i(s){const r=s.multiDiffData.resources.map(n=>({originalUri:n.originalUri?y.revive(n.originalUri):void 0,modifiedUri:n.modifiedUri?y.revive(n.modifiedUri):void 0,goToFileUri:n.goToFileUri?y.revive(n.goToFileUri):void 0,added:n.added,removed:n.removed}));return new Wb(r,s.multiDiffData.title,s.readOnly)}e.to=i})(Py||(Py={}));var Sl;(function(e){function t(s){const r=o=>y.isUri(o),n=o=>"name"in o;return{kind:"inlineReference",name:s.title,inlineReference:r(s.value)?s.value:n(s.value)?Da.from(s.value):rr.from(s.value)}}e.from=t;function i(s){const r=ei(s);return new kh(y.isUri(r.inlineReference)?r.inlineReference:"location"in r.inlineReference?Da.to(r.inlineReference):rr.to(r.inlineReference),s.name)}e.to=i})(Sl||(Sl={}));var Uh;(function(e){function t(s){return{kind:"progressMessage",content:le.from(s.value)}}e.from=t;function i(s){return new Bb(s.content.value)}e.to=i})(Uh||(Uh={}));var zh;(function(e){function t(s){return{kind:"thinking",value:s.value,id:s.id,metadata:s.metadata}}e.from=t;function i(s){return new al(s.value??"",s.id,s.metadata)}e.to=i})(zh||(zh={}));var Kg;(function(e){function t(s){return{kind:"hook",hookType:s.hookType,stopReason:s.stopReason,systemMessage:s.systemMessage,metadata:s.metadata}}e.from=t;function i(s){return new vg(s.hookType,s.stopReason,s.systemMessage,s.metadata)}e.to=i})(Kg||(Kg={}));var Hh;(function(e){function t(s){return{kind:"warning",content:le.from(s.value)}}e.from=t;function i(s){return new $h(s.content.value)}e.to=i})(Hh||(Hh={}));var Ty;(function(e){function t(i){return{kind:"extensions",extensions:i.extensions}}e.from=t})(Ty||(Ty={}));var My;(function(e){function t(i){return{kind:"pullRequest",author:i.author,title:i.title,description:i.description,uri:i.uri,linkTag:i.linkTag}}e.from=t})(My||(My={}));var Ny;(function(e){function t(s){return{kind:"move",uri:s.uri,range:U.from(s.range)}}e.from=t;function i(s){return new Ag(y.revive(s.uri),U.to(s.range))}e.to=i})(Ny||(Ny={}));var Ry;(function(e){function t(a){let c,l;return a.toolSpecificData&&i(a.toolSpecificData)?(c=s(a.toolSpecificData,a.isError),l=void 0):l=a.toolSpecificData?r(a.toolSpecificData):void 0,{kind:"toolInvocationSerialized",toolCallId:a.toolCallId,toolId:a.toolName,invocationMessage:a.invocationMessage?le.from(a.invocationMessage):a.toolName,originMessage:a.originMessage?le.from(a.originMessage):void 0,pastTenseMessage:a.pastTenseMessage?le.from(a.pastTenseMessage):void 0,isConfirmed:a.isConfirmed,isComplete:a.isComplete??!0,source:io.External,toolSpecificData:l,resultDetails:c,presentation:a.presentation==="hidden"?Pc.Hidden:a.presentation==="hiddenAfterComplete"?Pc.HiddenAfterComplete:void 0,subAgentInvocationId:a.subAgentInvocationId}}e.from=t;function i(a){return a!==null&&typeof a=="object"&&"input"in a&&typeof a.input=="string"&&"output"in a&&Array.isArray(a.output)}function s(a,c){return{input:a.input,output:a.output.map(l=>{const u=l.mimeType.startsWith("text/");return{type:"embed",mimeType:l.mimeType,value:u?_.wrap(l.data).toString():_n(_.wrap(l.data)),isText:u}}),isError:c??!1}}function r(a){return"command"in a&&"language"in a?{kind:"terminal",command:a.command,language:a.language}:"commandLine"in a&&"language"in a?{kind:"terminal",commandLine:a.commandLine,language:a.language,terminalCommandOutput:typeof a.output?.text=="string"?{text:a.output.text}:void 0,terminalCommandState:a.state?{exitCode:a.state.exitCode,duration:a.state.duration}:void 0}:a}function n(a){const c=new Jb(a.toolId||a.toolName,a.toolCallId,a.isError);return a.invocationMessage&&(c.invocationMessage=a.invocationMessage),a.originMessage&&(c.originMessage=a.originMessage),a.pastTenseMessage&&(c.pastTenseMessage=a.pastTenseMessage),a.isConfirmed!==void 0&&(c.isConfirmed=a.isConfirmed),a.isComplete!==void 0&&(c.isComplete=a.isComplete),a.toolSpecificData&&(c.toolSpecificData=o(a.toolSpecificData)),c.subAgentInvocationId=a.subAgentInvocationId,c.subAgentName=a.subAgentName,c}e.to=n;function o(a){if(a.kind==="terminal")if(a.commandLine){const c={commandLine:a.commandLine,language:a.language};return a.terminalCommandOutput&&(c.output={text:a.terminalCommandOutput.text,truncated:a.terminalCommandOutput.truncated,lineCount:a.terminalCommandOutput.lineCount}),a.terminalCommandState&&(c.state={exitCode:a.terminalCommandState.exitCode,duration:a.terminalCommandState.duration}),c}else return{command:a.command,language:a.language};else if(a.kind==="terminal2")return{commandLine:a.commandLine,language:a.language};return a}})(Ry||(Ry={}));var em;(function(e){function t(i){return{kind:"progressTask",content:le.from(i.value)}}e.from=t})(em||(em={}));var Ly;(function(e){function t(i){return{kind:"progressTaskResult",content:typeof i=="string"?le.from(i):void 0}}e.from=t})(Ly||(Ly={}));var Wh;(function(e){function t(s,r,n){return{kind:"command",command:r.toInternal(s.value,n)??{command:s.value.command,title:s.value.title}}}e.from=t;function i(s,r){return new wg(r.fromInternal(s.command)??{command:s.command.id,title:s.command.title})}e.to=i})(Wh||(Wh={}));var tm;(function(e){function t(s){return{kind:"textEdit",uri:s.uri,edits:s.edits.map(r=>ri.from(r)),done:s.isDone}}e.from=t;function i(s){const r=new Dh(y.revive(s.uri),s.edits.map(n=>ri.to(n)));return r.isDone=s.done,r}e.to=i})(tm||(tm={}));var im;(function(e){function t(i){return i.newCellMetadata?{editType:3,index:i.range.start,metadata:i.newCellMetadata}:i.newNotebookMetadata?{editType:5,metadata:i.newNotebookMetadata}:{editType:1,index:i.range.start,count:i.range.end-i.range.start,cells:i.newCells.map(ml.from)}}e.from=t})(im||(im={}));var sm;(function(e){function t(i){return{kind:"notebookEdit",uri:i.uri,edits:i.edits.map(im.from),done:i.isDone}}e.from=t})(sm||(sm={}));var rm;(function(e){function t(i){return{kind:"workspaceEdit",edits:i.edits.map(s=>({oldResource:s.oldResource,newResource:s.newResource}))}}e.from=t})(rm||(rm={}));var Ra;(function(e){function t(s){const r=Ft.isThemeIcon(s.iconPath)?s.iconPath:y.isUri(s.iconPath)?{light:y.revive(s.iconPath)}:s.iconPath&&"light"in s.iconPath&&"dark"in s.iconPath&&y.isUri(s.iconPath.light)&&y.isUri(s.iconPath.dark)?{light:y.revive(s.iconPath.light),dark:y.revive(s.iconPath.dark)}:void 0;return typeof s.value=="object"&&"variableName"in s.value?{kind:"reference",reference:{variableName:s.value.variableName,value:y.isUri(s.value.value)||!s.value.value?s.value.value:rr.from(s.value.value)},iconPath:r,options:s.options}:{kind:"reference",reference:y.isUri(s.value)||typeof s.value=="string"?s.value:rr.from(s.value),iconPath:r,options:s.options}}e.from=t;function i(s){const r=ei(s),n=o=>y.isUri(o)?o:rr.to(o);return new Ca(typeof r.reference=="string"?r.reference:"variableName"in r.reference?{variableName:r.reference.variableName,value:r.reference.value&&n(r.reference.value)}:n(r.reference))}e.to=i})(Ra||(Ra={}));var nm;(function(e){function t(i){return{kind:"codeCitation",value:i.value,license:i.license,snippet:i.snippet}}e.from=t})(nm||(nm={}));var _h;(function(e){function t(r,n,o){return r instanceof fg?Fh.from(r):r instanceof kh?Sl.from(r):r instanceof Ca?Ra.from(r):r instanceof Bb?Uh.from(r):r instanceof al?zh.from(r):r instanceof vg?Kg.from(r):r instanceof gg?jh.from(r):r instanceof Wb?Py.from(r):r instanceof wg?Wh.from(r,n,o):r instanceof Dh?tm.from(r):r instanceof Sg?sm.from(r):r instanceof Ch?Yg.from(r):r instanceof bg?Zg.from(r):r instanceof $h?Hh.from(r):r instanceof pg?Qg.from(r):r instanceof Ih?Xg.from(r):r instanceof yg?nm.from(r):r instanceof Ag?Ny.from(r):r instanceof qb?Ty.from(r):r instanceof Vb?My.from(r):r instanceof Jb?Ry.from(r):r instanceof Gb?rm.from(r):{kind:"markdownContent",content:le.from("")}}e.from=t;function i(r,n){switch(r.kind){case"reference":return Ra.to(r);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return s(r,n)}}e.to=i;function s(r,n){switch(r.kind){case"markdownContent":return Fh.to(r);case"inlineReference":return Sl.to(r);case"progressMessage":return;case"treeData":return jh.to(r);case"command":return Wh.to(r,n)}}e.toContent=s})(_h||(_h={}));var Bh;(function(e){function t(i,s,r,n,o,a,c){const l=[],u=[];for(const p of i.variables.variables)p.kind==="tool"?l.push(p):p.kind==="toolset"?l.push(...p.value):u.push(p);const h=Cc.parseLocalSessionId(i.sessionResource)??i.sessionResource.toString(),f={id:i.requestId,prompt:i.message,command:i.command,attempt:i.attempt??0,enableCommandDetection:i.enableCommandDetection??!0,isParticipantDetected:i.isParticipantDetected??!1,sessionId:h,sessionResource:i.sessionResource,references:u.map(p=>om.to(p,n,c)).filter(ps),toolReferences:l.map(La.to),location:qh.to(i.location),acceptedConfirmationData:i.acceptedConfirmationData,rejectedConfirmationData:i.rejectedConfirmationData,location2:s,toolInvocationToken:Object.freeze({sessionId:h,sessionResource:i.sessionResource}),tools:o,model:r,editedFileEvents:i.editedFileEvents,modeInstructions:i.modeInstructions?.content,modeInstructions2:Oy.to(i.modeInstructions),subAgentInvocationId:i.subAgentInvocationId,subAgentName:i.subAgentName,hasHooksEnabled:i.hasHooksEnabled??!1,hooks:i.hooks?Zy.to(i.hooks):void 0};return qe(a,"chatParticipantPrivate")||(delete f.id,delete f.attempt,delete f.enableCommandDetection,delete f.isParticipantDetected,delete f.location,delete f.location2,delete f.editedFileEvents,delete f.sessionId,delete f.subAgentInvocationId,delete f.subAgentName,delete f.hasHooksEnabled,delete f.hooks),qe(a,"chatParticipantAdditions")||(delete f.acceptedConfirmationData,delete f.rejectedConfirmationData,delete f.tools),f}e.to=t})(Bh||(Bh={}));var qh;(function(e){function t(s){switch(s){case ti.Notebook:return ir.Notebook;case ti.Terminal:return ir.Terminal;case ti.Chat:return ir.Panel;case ti.EditorInline:return ir.Editor}}e.to=t;function i(s){switch(s){case ir.Notebook:return ti.Notebook;case ir.Terminal:return ti.Terminal;case ir.Panel:return ti.Chat;case ir.Editor:return ti.EditorInline}}e.from=i})(qh||(qh={}));var om;(function(e){function t(i,s,r){let n=i.value;if(!n){let a;try{a=JSON.stringify(i)}catch{a=`kind=${i.kind}, id=${i.id}, name=${i.name}`}r.error(`[ChatPromptReference] Ignoring invalid reference in variable: ${a}`);return}if(pf(n))n=y.revive(n);else if(n&&typeof n=="object"&&"uri"in n&&"range"in n&&pf(n.uri))n=rr.to(ei(n));else if(mH(i)){const a=i.references?.[0]?.reference;n=new r9(i.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(i.value))),a&&y.isUri(a)?a:void 0)}else if(i.kind==="diagnostic"){const a=i.filterSeverity&&Ph.to(i.filterSeverity),c=i.filterUri&&y.revive(i.filterUri).toString();n=new Xb(s.map(([l,u])=>i.filterUri&&l.toString()!==c?[l,[]]:[l,u.filter(h=>!(a&&h.severity>a||i.filterRange&&!ot.areIntersectingOrTouching(i.filterRange,U.from(h.range))))]).filter(([,l])=>l.length>0))}let o;return(gw(i)||vH(i))&&i.toolReferences&&(o=am.to(i.toolReferences)),{id:i.id,name:i.name,range:i.range&&[i.range.start,i.range.endExclusive],toolReferences:o,value:n,modelDescription:i.modelDescription}}e.to=t})(om||(om={}));var La;(function(e){function t(i){if(i.value)throw new Error("Invalid tool reference");return{name:i.id,range:i.range&&[i.range.start,i.range.endExclusive]}}e.to=t})(La||(La={}));var am;(function(e){function t(i){const s=[];for(const r of i)if(r.kind==="tool")s.push(La.to(r));else if(r.kind==="toolset")s.push(...r.value.map(La.to));else throw new Error("Invalid tool reference in prompt variables");return s}e.to=t})(am||(am={}));var Oy;(function(e){function t(i){if(i)return{name:i.name,content:i.content,toolReferences:am.to(i.toolReferences),metadata:i.metadata}}e.to=t})(Oy||(Oy={}));var Fy;(function(e){function t(i,s,r){return{id:i.id,label:i.label,fullName:i.fullName,icon:i.icon?.id,value:i.values[0].value,insertText:i.insertText,detail:i.detail,documentation:i.documentation,command:s.toInternal(i.command,r)}}e.from=t})(Fy||(Fy={}));var El;(function(e){function t(r){return{errorDetails:r.errorDetails,metadata:s(r.metadata),nextQuestion:r.nextQuestion,details:r.details,usage:r.usage}}e.to=t;function i(r){return{errorDetails:r.errorDetails,metadata:r.metadata,nextQuestion:r.nextQuestion,details:r.details,usage:r.usage}}e.from=i;function s(r){return gc(r,n=>{if(n.$mid===20)return new Cg(gc(n.content,s));if(n.$mid===21)return new Xt(n.value);if(n.$mid===22)return new ll(n.value,n.id,n.metadata);if(n.$mid===23)return new vo(n.value)})}})(El||(El={}));var jy;(function(e){function t(i,s,r){if(s.action.kind==="vote")return;const n=El.to(i);if(s.action.kind==="command"){const o=s.action.commandButton.command;return{action:{kind:"command",commandButton:{command:r.fromInternal(o)??{command:o.id,title:o.title}}},result:n}}else return s.action.kind==="followUp"?{action:{kind:"followUp",followup:Gg.to(s.action.followup)},result:n}:s.action.kind==="inlineChat"?{action:{kind:"editor",accepted:s.action.action==="accepted"},result:n}:s.action.kind==="chatEditingSessionAction"?{action:{kind:"chatEditingSessionAction",outcome:new Map([["accepted",Mr.Accepted],["rejected",Mr.Rejected],["saved",Mr.Saved]]).get(s.action.outcome)??Mr.Rejected,uri:y.revive(s.action.uri),hasRemainingEdits:s.action.hasRemainingEdits},result:n}:s.action.kind==="chatEditingHunkAction"?{action:{kind:"chatEditingHunkAction",outcome:new Map([["accepted",Mr.Accepted],["rejected",Mr.Rejected]]).get(s.action.outcome)??Mr.Rejected,uri:y.revive(s.action.uri),hasRemainingEdits:s.action.hasRemainingEdits,lineCount:s.action.lineCount,linesAdded:s.action.linesAdded,linesRemoved:s.action.linesRemoved},result:n}:{action:s.action,result:n}}e.to=t})(jy||(jy={}));var cm;(function(e){function t(i,s,r){return"terminalCommand"in i?{terminalCommand:i.terminalCommand,shouldExecute:i.shouldExecute}:"uri"in i?{uri:i.uri}:s.toInternal(i,r)}e.from=t})(cm||(cm={}));var lm;(function(e){function t(i){return{...i,documentation:le.fromStrict(i.documentation)}}e.from=t})(lm||(lm={}));var Uy;(function(e){function t(i,s){return Array.isArray(i)?{items:i.map(r=>lm.from(r))}:{items:i.items.map(r=>lm.from(r)),resourceOptions:i.resourceOptions?zy.from(i.resourceOptions,s):void 0}}e.from=t})(Uy||(Uy={}));var zy;(function(e){function t(i,s){return{...i,pathSeparator:s,cwd:i.cwd,globPattern:qi.from(i.globPattern)??void 0}}e.from=t})(zy||(zy={}));var Hy;(function(e){function t(i){return{kind:Wy.to(i.kind),acceptedLength:i.acceptedLength}}e.to=t})(Hy||(Hy={}));var Wy;(function(e){function t(i){switch(i){case 0:return wa.Word;case 1:return wa.Line;case 2:return wa.Suggest;default:return wa.Unknown}}e.to=t})(Wy||(Wy={}));var _y;(function(e){function t(i,s){if(i.kind===Wf.Ignored){const r=i.supersededBy?s(i.supersededBy):void 0;return{kind:Hc.Ignored,supersededBy:r,userTypingDisagreed:i.userTypingDisagreed}}else if(i.kind===Wf.Accepted)return{kind:Hc.Accepted};return{kind:Hc.Rejected}}e.to=t})(_y||(_y={}));var By;(function(e){function t(s){return s===Wc.Label?Ac.Label:Ac.Code}e.from=t;function i(s){return s===Ac.Label?Wc.Label:Wc.Code}e.to=i})(By||(By={}));var qy;(function(e){function t(i,s){return{id:s,label:i.label,description:i.description,canEdit:i.canEdit,collapsibleState:i.collapsibleState||0,contextValue:i.contextValue}}e.from=t})(qy||(qy={}));var Vy;(function(e){function t(i){return i.type==="mcp"?new c9(i.label,i.serverLabel||i.label,i.instructions):i.type==="extension"?new a9(i.extensionId.value,i.label):void 0}e.to=t})(Vy||(Vy={}));var um;(function(e){function t(s){const r=new Cg(s.content.map(n=>n.kind==="text"?new Xt(n.value,n.audience):n.kind==="data"?new Li(n.value.data.buffer,n.value.mimeType,n.audience):new vo(n.value)));return s.toolMetadata!==void 0&&(r.toolMetadata=s.toolMetadata),r}e.to=t;function i(s,r){s.toolResultMessage&&T(r,"chatParticipantPrivate");const n=l=>{l.audience&&T(r,"languageModelToolResultAudience")};let o=!1,a;Array.isArray(s.toolResultDetails)?a=s.toolResultDetails?.map(l=>y.isUri(l)?l:rr.from(l)):s.toolResultDetails2&&(a={output:{type:"data",mimeType:s.toolResultDetails2.mime,value:_.wrap(s.toolResultDetails2.value)}},o=!0);const c={content:s.content.map(l=>{if(l instanceof Xt)return n(l),{kind:"text",value:l.value,audience:l.audience};if(l instanceof vo)return{kind:"promptTsx",value:l.value};if(l instanceof Li)return n(l),o=!0,{kind:"data",value:{mimeType:l.mimeType,data:_.wrap(l.data)},audience:l.audience};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:le.fromStrict(s.toolResultMessage),toolResultDetails:a,toolMetadata:s.toolMetadata};return o?new Si(c):c}e.from=i})(um||(um={}));var un;(function(e){function t(r){return r}e.fromThemeIcon=t;function i(r){if(r){if(Ft.isThemeIcon(r))return r;if(y.isUri(r))return r;if(typeof r=="string")return y.file(r);if(typeof r=="object"&&r!==null&&"dark"in r){const n=typeof r.dark=="string"?y.file(r.dark):r.dark,o=typeof r.light=="string"?y.file(r.light):r.light;return n?{dark:n,light:o??n}:void 0}else return}else return}e.from=i;function s(r){if(r){if(Ft.isThemeIcon(r))return r;if(pf(r))return y.revive(r);{const n=r;return{light:y.revive(n.light),dark:y.revive(n.dark)}}}else return}e.to=s})(un||(un={}));var Gy;(function(e){function t(s){return{query:s.query,kind:i(s.kind),settings:s.settings}}e.fromSettingsSearchResult=t;function i(s){switch(s){case ro.EMBEDDED:return ro.EMBEDDED;case ro.LLM_RANKED:return ro.LLM_RANKED;case ro.CANCELED:return ro.CANCELED;default:throw new Error("Unknown AiSettingsSearchResultKind")}}})(Gy||(Gy={}));var xl;(function(e){function t(r){return!!r.uri}function i(r){return Tc.toSerialized(t(r)?{type:2,uri:r.uri,headers:Object.entries(r.headers),authentication:r.authentication?{providerId:r.authentication.providerId,scopes:r.authentication.scopes}:void 0}:{type:1,cwd:r.cwd?.fsPath,args:r.args,command:r.command,env:r.env,envFile:void 0})}e.from=i;function s(r){const n=Tc.fromSerialized(r.launch);if(n.type===2)return new ay(r.label,n.uri,Object.fromEntries(n.headers),r.cacheNonce==="$$NONE"?void 0:r.cacheNonce);{const o=new oy(r.label,n.command,[...n.args],Object.fromEntries(Object.entries(n.env).map(([a,c])=>[a,c===null?null:String(c)])),r.cacheNonce==="$$NONE"?void 0:r.cacheNonce);return n.cwd&&(o.cwd=y.file(n.cwd)),o}}e.to=s})(xl||(xl={}));var Jy;(function(e){function t(i){switch(i){case Jc.Error:return 0;case Jc.Warning:return 1;case Jc.Information:return 2;default:throw new Error("Unknown SourceControlInputBoxValidationType")}}e.from=t})(Jy||(Jy={}));var Zy;(function(e){function t(i){const s={};for(const[r,n]of Object.entries(i)){if(!n||n.length===0)continue;const o=[];for(const a of n){const c=Yy.to(a);c&&o.push(c)}o.length>0&&(s[r]=o)}return s}e.to=t})(Zy||(Zy={}));var Yy;(function(e){function t(i){const s=SH(i,Nn);if(s)return{command:s,cwd:i.cwd,env:i.env,timeout:i.timeout}}e.to=t})(Yy||(Yy={}));var d9=class YE{constructor(t,i){this.line=t,this.character=i}isBefore(t){return!1}isBeforeOrEqual(t){return!1}isAfter(t){return!1}isAfterOrEqual(t){return!1}isEqual(t){return!1}compareTo(t){return 0}translate(t,i){return new YE(0,0)}with(t){return new YE(0,0)}},f9=class QE{constructor(t,i,s,r){this.isEmpty=!1,this.isSingleLine=!1,this.start=new d9(t,i),this.end=new d9(s,r)}contains(t){return!1}isEqual(t){return!1}intersection(t){}union(t){return new QE(0,0,0,0)}with(t){return new QE(0,0,0,0)}},hn=class{constructor(e,t,i){this.uri=e,this.ranges=t,this.previewText=i}},hm=class{constructor(e,t,i){this.uri=e,this.text=t,this.lineNumber=i}},Qy=class{constructor(e){this.keyword=e}},dn;(function(e){e[e.None=1]="None",e[e.FilesExclude=2]="FilesExclude",e[e.SearchAndFilesExclude=3]="SearchAndFilesExclude"})(dn||(dn={}));var dm;(function(e){e[e.Information=1]="Information",e[e.Warning=2]="Warning"})(dm||(dm={}));var fm=2e4,p9="\u27EA ",g9=" characters skipped \u27EB",sB=(p9.length+g9.length+5)*2,qre=W("searchService"),m9;(function(e){e[e.file=0]="file",e[e.text=1]="text",e[e.aiText=2]="aiText"})(m9||(m9={}));var v9;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.aiText=3]="aiText"})(v9||(v9={}));function Xy(e){return!!e.rangeLocations&&!!e.previewText}var w9;(function(e){e[e.Normal=0]="Normal",e[e.NewSearchStarted=1]="NewSearchStarted"})(w9||(w9={}));var b9=class{constructor(e,t,i,s){this.rangeLocations=[],this.webviewIndex=s;const r=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&rB(r)){e=tO(e,i.matchLines);let n="",o=0,a=0;const c=Math.floor(i.charsPerLine/5);for(const l of r){const u=Math.max(l.startColumn-c,0),h=l.startColumn+i.charsPerLine;if(u>a+c+sB){const f=p9+(u-a)+g9;n+=f+e.slice(u,h),o+=u-(a+f.length)}else n+=e.slice(a,h);a=h,this.rangeLocations.push({source:l,preview:new nB(0,l.startColumn-o,l.endColumn-o)})}this.previewText=n}else{const n=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber,o=Kd(t,a=>({preview:new Ky(a.startLineNumber-n,a.startColumn,a.endLineNumber-n,a.endColumn),source:a}));this.rangeLocations=Array.isArray(o)?o:[o],this.previewText=e}}};function rB(e){const t=e[0].startLineNumber;for(const i of e)if(i.startLineNumber!==t||i.endLineNumber!==t)return!1;return!0}var Ky=class{constructor(e,t,i,s){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=s}},nB=class extends Ky{constructor(e,t,i){super(e,t,e,i)}},y9;(function(e){e.List="list",e.Tree="tree"})(y9||(y9={}));var A9;(function(e){e.Default="default",e.FileNames="fileNames",e.Type="type",e.Modified="modified",e.CountDescending="countDescending",e.CountAscending="countAscending"})(A9||(A9={}));var S9;(function(e){e.Auto="auto",e.Manual="manual",e.RunOnEmpty="runOnEmpty"})(S9||(S9={}));function oB(e,t=!0){const i=e&&e.files&&e.files.exclude,s=t&&e&&e.search&&e.search.exclude;if(!i&&!s)return;if(!i||!s)return i||s||void 0;let r=Object.create(null);return r=Xr(r,ct(i)),r=Xr(r,ct(s),!0),r}function E9(e,t){const i=e.ignoreGlobCase?{ignoreCase:!0}:void 0;return e.excludePattern&&la(e.excludePattern,t,i)?!1:e.includePattern||e.usingSearchPaths?e.includePattern&&la(e.includePattern,t,i)?!0:e.usingSearchPaths?!!e.folderQueries&&e.folderQueries.some(s=>{const r=s.folder.fsPath;if(Bo(t,r,e.ignoreGlobCase)){const n=oc(r,t);return!s.includePattern||!!la(s.includePattern,n,i)}else return!1}):!1:!0}var Ao;(function(e){e[e.unknownEncoding=1]="unknownEncoding",e[e.regexParseError=2]="regexParseError",e[e.globParseError=3]="globParseError",e[e.invalidLiteral=4]="invalidLiteral",e[e.rgProcessError=5]="rgProcessError",e[e.other=6]="other",e[e.canceled=7]="canceled"})(Ao||(Ao={}));var Oa=class extends Error{constructor(e,t){super(e),this.code=t}};function x9(e){const t={message:e.message,code:e.code};return new Error(JSON.stringify(t))}function aB(e){return!!e.path}function eA(e,t,i=!0){const s=e.searchPath?e.searchPath:e.relativePath;return i?K2(s,t):la(t,s)}function Cl(e,t){const i={...e||{},...t||{}};return Object.keys(i).filter(s=>{const r=i[s];return typeof r=="boolean"&&r})}var C9=class{constructor(e,t){this.c=null;const i=e.ignoreGlobCase||t.ignoreGlobCase?{ignoreCase:!0}:void 0;this.a=t.excludePattern?.map(r=>({...e.excludePattern||{},...r.pattern||{}}))??[],this.a.length===0&&(this.a=[e.excludePattern||{}]),this.b=this.a.map(r=>Xs(r,i));let s=e.includePattern;t.includePattern&&(s?s={...s,...t.includePattern}:s=t.includePattern),s&&(this.c=Xs(s,i))}d(e,t,i){let s=null;for(const r of this.b){const n=r(e,t,i);if(typeof n=="string"){s=n;break}}return s}matchesExcludesSync(e,t,i){return!!(this.b&&this.d(e,t,i))}includedInQuerySync(e,t,i){return!(this.b&&this.d(e,t,i)||this.c&&!this.c(e,t,i))}includedInQuery(e,t,i){const s=()=>this.c?!!this.c(e,t,i):!0;return Promise.all(this.b.map(r=>{const n=r(e,t,i);return zn(n)?n.then(o=>o?!1:s()):s()})).then(r=>r.some(n=>!!n))}hasSiblingExcludeClauses(){return this.a.reduce((e,t)=>cB(t)||e,!1)}};function cB(e){for(const t in e)if(typeof e[t]!="boolean")return!0;return!1}function lB(e){if(!e)return;let t;return i=>(t||(t=(e()||Promise.resolve([])).then(s=>s?k9(s):{})),t.then(s=>!!s[i]))}function tA(e){if(!e)return;let t;return i=>{if(!t){const s=e();t=s?k9(s):{}}return!!t[i]}}function k9(e){const t={};for(const i of e)t[i]=!0;return t}function $9(e){return e.flatMap(t=>t.patterns.map(i=>t.baseUri?{baseUri:t.baseUri,pattern:i}:i))}var iA={matchLines:100,charsPerLine:1e4},uB=!1,hB=class{constructor(e,t,i){this.id=e,this.dependencies=t,this.callback=i}},Fa;(function(e){e[e.Uninitialized=1]="Uninitialized",e[e.InitializedInternal=2]="InitializedInternal",e[e.InitializedExternal=3]="InitializedExternal"})(Fa||(Fa={}));var dB=class QN{static{this.INSTANCE=new QN}constructor(){this.a=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope",this.b=typeof document=="object",this.c=[],this.d=Fa.Uninitialized}g(){if(this.d===Fa.Uninitialized){if(globalThis.define){this.d=Fa.InitializedExternal;return}}else return;this.d=Fa.InitializedInternal,globalThis.define=(t,i,s)=>{typeof t!="string"&&(s=i,i=t,t=null),(typeof i!="object"||!Array.isArray(i))&&(s=i,i=null),this.c.push(new hB(t,i,s))},globalThis.define.amd=!0,this.b?this.f=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${V.vscodeFileResource}://${EC}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this.a&&(this.f=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this.g(),this.d===Fa.InitializedExternal)return new Promise(o=>{const a=At();globalThis.define(a,[t],function(c){o(c)})});const i=await(this.a?this.i(t):this.b?this.h(t):this.j(t));if(!i){console.warn(`Did not receive a define call from script ${t}`);return}const s={},r=[],n=[];if(Array.isArray(i.dependencies))for(const o of i.dependencies)o==="exports"?r.push(s):n.push(o);if(n.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${n.join(", ")}`);return typeof i.callback=="function"?i.callback(...r)??s:i.callback}h(t){return new Promise((i,s)=>{const r=document.createElement("script");r.setAttribute("async","async"),r.setAttribute("type","text/javascript");const n=()=>{r.removeEventListener("load",o),r.removeEventListener("error",a)},o=c=>{n(),i(this.c.pop())},a=c=>{n(),s(c)};r.addEventListener("load",o),r.addEventListener("error",a),this.f&&(t=this.f.createScriptURL(t)),r.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(r)})}async i(t){return this.f&&(t=this.f.createScriptURL(t)),await import(t),this.c.pop()}async j(t){try{const i=(await import("fs")).default,s=(await import("vm")).default,r=(await import("module")).default,n=y.parse(t).fsPath,o=i.readFileSync(n).toString(),a=r.wrap(o.replace(/^#!.*/,""));return new s.Script(a).runInThisContext().apply(),this.c.pop()}catch(i){throw i}}},sA=new Map;async function rA(e,t,i){i===void 0&&(i=!!(globalThis._VSCODE_PRODUCT_JSON??globalThis.vscode?.context?.configuration()?.product)?.commit);const s=t?`${e}/${t}`:e;if(sA.has(s))return sA.get(s);let r;if(/^\w[\w\d+.-]*:\/\//.test(s))r=s;else{const c=`${uB&&i&&!jo?CO:xO}/${s}`;r=vf.asBrowserUri(c).toString(!0)}const n=dB.INSTANCE.load(r);return sA.set(s,n),n}var pm="utf8",nA="utf8bom",gm="utf16be",mm="utf16le",vm=[254,255],oA=[255,254],Vh=[239,187,191],fB=512,pB=512,gB=512*8,mB=512*128,I9;(function(e){e[e.STREAM_IS_BINARY=1]="STREAM_IS_BINARY"})(I9||(I9={}));var vB=class extends Error{constructor(e,t){super(e),this.decodeStreamErrorKind=t}},wB=class XN{static async create(t){let i;if(t!==pm)i=(await rA("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getDecoder(D9(t));else{const s=new TextDecoder;i={write(r){return s.decode(r,{stream:!0})},end(){return s.decode()}}}return new XN(i)}constructor(t){this.a=t}write(t){return this.a.write(t)}end(){return this.a.end()}};function bB(e,t){const i=t.minBytesRequiredForDetection??(t.guessEncoding?gB:pB);return new Promise((s,r)=>{const n=yf(h=>h.join("")),o=[];let a=0,c;const l=new Ke,u=async()=>{try{const h=await DB({buffer:_.concat(o),bytesRead:a},t.guessEncoding,t.candidateGuessEncodings);if(h.seemsBinary&&t.acceptTextOnly)throw new vB("Stream is binary but only text is accepted for decoding",1);h.encoding=await t.overwriteEncoding(h.encoding),c=await wB.create(h.encoding);const f=c.write(_.concat(o).buffer);n.write(f),o.length=0,a=0,s({stream:n,detected:h})}catch(h){l.cancel(),n.destroy(),r(h)}};n0(e,{onData:async h=>{c?n.write(c.write(h.buffer)):(o.push(h),a+=h.byteLength,a>=i&&(e.pause(),await u(),setTimeout(()=>e.resume())))},onError:h=>n.error(h),onEnd:async()=>{c||await u(),n.end(c?.end())}},l.token)})}async function yB(e,t,i){const r=(await rA("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getEncoder(D9(t),i);let n=!1,o=!1;return{read(){if(o)return null;const a=e.read();if(typeof a!="string"){if(o=!0,!n&&i?.addBOM)switch(t){case pm:case nA:return _.wrap(Uint8Array.from(Vh));case gm:return _.wrap(Uint8Array.from(vm));case mm:return _.wrap(Uint8Array.from(oA))}const c=r.end();return c&&c.length>0?(n=!0,_.wrap(c)):null}return n=!0,_.wrap(r.write(a))}}}function D9(e){return e===nA||e===null?pm:e}function AB(e,t){if(!e||t<vm.length)return null;const i=e.readUInt8(0),s=e.readUInt8(1);if(i===vm[0]&&s===vm[1])return gm;if(i===oA[0]&&s===oA[1])return mm;if(t<Vh.length)return null;const r=e.readUInt8(2);return i===Vh[0]&&s===Vh[1]&&r===Vh[2]?nA:null}var SB=["ascii","utf-16","utf-32"];async function EB(e,t){const i=await rA("jschardet","dist/jschardet.min.js"),s=e.slice(0,mB),r=$B(s.buffer);t&&(t=yt(t.map(a=>kB(a))),t.length===0&&(t=void 0));let n;try{n=i.detect(r,t?{detectEncodings:t}:void 0)}catch{return null}if(!n?.encoding)return null;const o=n.encoding.toLowerCase();return 0<=SB.indexOf(o)?null:CB(n.encoding)}var xB={ibm866:"cp866",big5:"cp950"};function P9(e){return e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function CB(e){const t=P9(e);return xB[t]||t}function kB(e){const t=P9(e),i=PB[t];return i?i.guessableName:void 0}function $B(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}function IB(e){switch(e){case"shiftjis":return"shift-jis";case"utf16le":return"utf-16le";case"utf16be":return"utf-16be";case"big5hkscs":return"big5-hkscs";case"eucjp":return"euc-jp";case"euckr":return"euc-kr";case"koi8r":return"koi8-r";case"koi8u":return"koi8-u";case"macroman":return"x-mac-roman";case"utf8bom":return"utf8";default:{const t=e.match(/windows(\d+)/);return t?"windows-"+t[1]:e}}}function DB({buffer:e,bytesRead:t},i,s){let r=AB(e,t),n=!1;if(r!==gm&&r!==mm&&e){let o=!0,a=!0,c=!1;for(let l=0;l<t&&l<fB;l++){const u=l%2===1,h=e.readUInt8(l)===0;if(h&&(c=!0),o&&(u&&!h||!u&&h)&&(o=!1),a&&(u&&h||!u&&!h)&&(a=!1),h&&!o&&!a)break}c&&(o?r=mm:a?r=gm:n=!0)}return i&&!n&&!r&&e?EB(e.slice(0,t),s).then(o=>({seemsBinary:!1,encoding:o})):{seemsBinary:n,encoding:r}}var aA={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},cp1125:{labelLong:"Cyrillic (CP 1125)",labelShort:"CP 1125",order:21,guessableName:"IBM1125"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:22,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:23,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:24},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:25},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:26,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:27,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:28,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:29,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:30},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:31},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:32},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:33},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:34},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:35},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:36},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:37,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:38},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:39,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:40,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:41,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:42},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:43},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:44},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:45},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:46,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:47},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:48}},PB=(()=>{const e={};for(const t in aA)aA[t].guessableName&&(e[t]=aA[t]);return e})(),Vre=W("textFileService"),T9;(function(e){e[e.FILE_IS_BINARY=0]="FILE_IS_BINARY"})(T9||(T9={}));var M9;(function(e){e[e.SAVED=0]="SAVED",e[e.DIRTY=1]="DIRTY",e[e.PENDING_SAVE=2]="PENDING_SAVE",e[e.CONFLICT=3]="CONFLICT",e[e.ORPHAN=4]="ORPHAN",e[e.ERROR=5]="ERROR"})(M9||(M9={}));var N9;(function(e){e[e.EDITOR=1]="EDITOR",e[e.REFERENCE=2]="REFERENCE",e[e.OTHER=3]="OTHER"})(N9||(N9={}));var R9;(function(e){e[e.Encode=0]="Encode",e[e.Decode=1]="Decode"})(R9||(R9={}));function TB(e){let t=!1;return{read(){return t?null:(t=!0,e)}}}function Gh(e,t,i){return new uc(s=>wm(s,i)).isEqual(e,t)}function MB(e,t,i){return Gh(e.uri,t.uri,i)?0:_o(e.uri.toString(),t.uri.toString())}function NB(e,t,i){return e.index!==t.index?e.index<t.index?-1:1:Gh(e.uri,t.uri,i)?_o(e.name,t.name):_o(e.uri.toString(),t.uri.toString())}function L9(e,t,i,s){const r=e.slice(0).sort((o,a)=>i(o,a,s)),n=t.slice(0).sort((o,a)=>i(o,a,s));return EL(r,n,(o,a)=>i(o,a,s))}function wm(e,t){const i=t.getCapabilities(e.scheme);return!(i&&i&1024)}var cA=class XE extends JU{static toExtHostWorkspace(t,i,s,r){if(!t)return{workspace:null,added:[],removed:[]};const{id:n,name:o,folders:a,configuration:c,transient:l,isUntitled:u,isAgentSessionsWorkspace:h}=t,f=[],p=i;i?a.forEach((S,E)=>{const k=y.revive(S.uri),O=XE.q(s||i,k,r);O?(O.name=S.name,O.index=S.index,f.push(O)):f.push({uri:k,name:S.name,index:E})}):f.push(...a.map(({uri:S,name:E,index:k})=>({uri:y.revive(S),name:E,index:k}))),f.sort((S,E)=>S.index<E.index?-1:1);const g=new XE(n,o,f,!!l,c?y.revive(c):null,!!u,!!h,S=>wm(S,r)),{added:v,removed:b}=L9(p?p.workspaceFolders:[],g.workspaceFolders,MB,r);return{workspace:g,added:v,removed:b}}static q(t,i,s){for(let r=0;r<t.folders.length;r++){const n=t.workspaceFolders[r];if(Gh(n.uri,i,s))return n}}constructor(t,i,s,r,n,o,a,c){super(t,s.map(l=>new _0(l)),r,n,c,a),this.u=i,this.v=o,this.s=[],this.t=Yn.forUris(c,()=>!0),s.forEach(l=>{this.s.push(l),this.t.set(l.uri,l)})}get name(){return this.u}get isUntitled(){return this.v}get workspaceFolders(){return this.s.slice(0)}getWorkspaceFolder(t,i){return i&&this.t.get(t)&&(t=dc(t)),this.t.findSubstr(t)}resolveWorkspaceFolder(t){return this.t.get(t)}},lA=class{constructor(t,i,s,r,n){this.c=new I,this.onDidChangeWorkspace=this.c.event,this.g=new I,this.onDidGrantWorkspaceTrust=this.g.event,this.h=new I,this.onDidChangeWorkspaceTrustedFolders=this.h.event,this.v=[],this.w=!1,this.x=new Map,this.C=0,this.D=new uu,this.F=new Map,this.j=r,this.t=s,this.u=n,this.k=new _U,this.l=new ms,this.q=t.getProxy(Q.MainThreadWorkspace),this.s=t.getProxy(Q.MainThreadMessageService);const o=i.workspace;this.n=o?new cA(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,!!o.isAgentSessionsWorkspace,a=>wm(a,s)):void 0}$initializeWorkspace(t,i){this.w=i,this.$acceptWorkspaceData(t),this.l.open()}waitForInitializeCall(){return this.l.wait()}get workspace(){return this.y}get name(){return this.y?this.y.name:void 0}get isAgentSessionsWorkspace(){return this.y?.isAgentSessionsWorkspace??!1}get workspaceFile(){if(this.y&&this.y.configuration)return this.y.isUntitled?y.from({scheme:V.untitled,path:ji(dc(this.y.configuration))}):this.y.configuration}get y(){return this.o||this.n}getWorkspaceFolders(){if(this.y)return this.y.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this.l.wait(),!!this.y)return this.y.workspaceFolders.slice(0)}updateWorkspaceFolders(t,i,s,...r){const n=[];if(Array.isArray(r)&&r.forEach(u=>{y.isUri(u.uri)&&!n.some(h=>Gh(h.uri,u.uri,this.t))&&n.push({uri:u.uri,name:u.name||t0(u.uri)})}),this.o||[i,s].some(u=>typeof u!="number"||u<0)||s===0&&n.length===0)return!1;const o=this.y?this.y.workspaceFolders:[];if(i+s>o.length)return!1;const a=o.slice(0);a.splice(i,s,...n.map(u=>({uri:u.uri,name:u.name||t0(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const h=a[u];if(a.some((f,p)=>p!==u&&Gh(h.uri,f.uri,this.t)))return!1}a.forEach((u,h)=>u.index=h);const{added:c,removed:l}=L9(o,a,NB,this.t);if(c.length===0&&l.length===0)return!1;if(this.q){const u=t.displayName||t.name;this.q.$updateWorkspaceFolders(u,i,s,n).then(void 0,h=>{this.o=void 0;const f={source:{identifier:t.identifier,label:t.displayName||t.name}};this.s.$showMessage(qU.Error,d(3056,null,u,h.toString()),f,[])})}return this.z(a),!0}getWorkspaceFolder(t,i){if(this.y)return this.y.getWorkspaceFolder(t,i)}async getWorkspaceFolder2(t,i){if(await this.l.wait(),!!this.y)return this.y.getWorkspaceFolder(t,i)}async resolveWorkspaceFolder(t){if(await this.l.wait(),!!this.y)return this.y.resolveWorkspaceFolder(t)}getPath(){if(!this.y)return;const{folders:t}=this.y;if(t.length!==0)return t[0].uri.fsPath}getRelativePath(t,i){let s,r="";if(typeof t=="string"?(s=y.file(t),r=t):typeof t<"u"&&(s=t,r=t.fsPath),!s)return r;const n=this.getWorkspaceFolder(s,!0);if(!n)return r;typeof i>"u"&&this.y&&(i=this.y.folders.length>1);let o=kC(n.uri,s);return i&&n.name&&(o=`${n.name}/${o}`),o}z(t){this.y&&(this.o=cA.toExtHostWorkspace({id:this.y.id,name:this.y.name,configuration:this.y.configuration,folders:t,isUntitled:this.y.isUntitled},this.y,void 0,this.t).workspace||void 0)}$acceptWorkspaceData(t){const{workspace:i,added:s,removed:r}=cA.toExtHostWorkspace(t,this.n,this.o,this.t);this.n=i||void 0,this.o=void 0,this.c.fire(Object.freeze({added:s,removed:r}))}findFiles(t,i,s,r,n=De.None){this.j.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${r.value}, entryPoint: findFiles`);let o="",a=!0;return i===null?a=!1:i!==void 0&&(typeof i=="string"?o=i:o=i.pattern),this.A({type:"include",value:t},{exclude:[o],maxResults:s,useExcludeSettings:a?dn.FilesExclude:dn.None,useIgnoreFiles:{local:!1}},n)}findFiles2(t,i={},s,r=De.None){return this.j.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${s.value}, entryPoint: findFiles2New`),this.A({type:"filePatterns",value:t},i,r)}async A(t,i,s){if(s.isCancellationRequested)return Promise.resolve([]);const r=t.type==="include"?[t.value]:t.value??[];if(!Array.isArray(r))throw console.error("Invalid file pattern provided",r),new Error(`Invalid file pattern provided ${JSON.stringify(r)}`);const n=r.map(o=>{const a=O9(i.exclude),c={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===dn.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==dn.SearchAndFilesExclude,maxResults:i.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:t.type==="include"?void 0:!0},l=bm(qi.from(o)),u=l?.folder;return t.type==="include"?c.includePattern=l?.pattern:c.filePattern=l?.pattern,{folder:u,options:c}});return this.B(n,s)}async B(t,i){const r=(await Promise.all(t?.map(a=>this.q.$startFileSearch(a.folder??null,a.options,i).then(c=>Array.isArray(c)?c.map(l=>y.revive(l)):[]))??[])).flat(),n=new uc(a=>wm(a,this.t)),o=new Map;for(const a of r){const c=n.getComparisonKey(a);o.has(c)||o.set(c,a)}return Array.from(o.values())}findTextInFiles2(t,i,s,r=De.None){this.j.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${s.value}, entryPoint: findTextInFiles2`);const n=f=>{if(!i)return{folder:void 0,options:{}};const p=f?bm(qi.from(f)):void 0,g=i.exclude?O9(i.exclude):void 0;return{options:{ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles?.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===dn.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==dn.SearchAndFilesExclude,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:i.previewOptions?{matchLines:i.previewOptions?.numMatchLines??100,charsPerLine:i.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:i.surroundingContext,includePattern:p?.pattern,excludePattern:g},folder:p?.folder}},a=(i?.include?.map(f=>n(f))??[n(void 0)]).filter(f=>!!f),c=new X,l=c.add(new I),u=this.findTextInFilesBase(t,a,(f,p)=>l.fire({result:f,uri:p}),r);return{results:new HC(async f=>{c.add(l.event(p=>{const g=p.result,v=p.uri;Xy(g)?f.emitOne(new hn(v,g.rangeLocations.map(b=>({previewRange:new ke(b.preview.startLineNumber,b.preview.startColumn,b.preview.endLineNumber,b.preview.endColumn),sourceRange:new ke(b.source.startLineNumber,b.source.startColumn,b.source.endLineNumber,b.source.endColumn)})),g.previewText)):f.emitOne(new hm(v,g.text,g.lineNumber))})),await u}),complete:u.then(f=>(c.dispose(),{limitHit:f?.limitHit??!1}))}}async findTextInFilesBase(t,i,s,r=De.None){const n=this.k.getNext();let o=!1;if(r.onCancellationRequested(a=>{o=!0}),this.v[n]=a=>{if(o)return;const c=y.revive(a.resource);a.results.forEach(l=>{const u=ei(l);s(u,c)})},r.isCancellationRequested)return{};try{const a=await Promise.all(i?.map(c=>this.q.$startTextSearch(t,c.folder??null,c.options,n,r)||{})??[]);return delete this.v[n],a.reduce((c,l)=>({limitHit:c?.limitHit||(l?.limitHit??!1),message:[c?.message??[],l?.message??[]].flat()}),{})??{limitHit:!1}}catch(a){throw delete this.v[n],a}}async findTextInFiles(t,i,s,r,n=De.None){this.j.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${r.value}, entryPoint: findTextInFiles`);const o=typeof i.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:i.previewOptions,a=bm(qi.from(i.include)),c=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,l={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof i.useSearchExclude=="boolean"?!i.useSearchExclude:!0,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:o,surroundingContext:i.afterContext,includePattern:a?.pattern,excludePattern:c?[{pattern:c}]:void 0},u=(h,f)=>{Xy(h)?s({uri:f,preview:{text:h.previewText,matches:Kd(h.rangeLocations,p=>new ke(p.preview.startLineNumber,p.preview.startColumn,p.preview.endLineNumber,p.preview.endColumn))},ranges:Kd(h.rangeLocations,p=>new ke(p.source.startLineNumber,p.source.startColumn,p.source.endLineNumber,p.source.endColumn))}):s({uri:f,text:h.text,lineNumber:h.lineNumber})};return this.findTextInFilesBase(t,[{options:l,folder:a?.folder}],u,n)}$handleTextSearchResult(t,i){this.v[i]?.(t)}async save(t){const i=await this.q.$save(t,{saveAs:!1});return y.revive(i)}async saveAs(t){const i=await this.q.$save(t,{saveAs:!0});return y.revive(i)}saveAll(t){return this.q.$saveAll(t)}resolveProxy(t){return this.q.$resolveProxy(t)}lookupAuthorization(t){return this.q.$lookupAuthorization(t)}lookupKerberosAuthorization(t){return this.q.$lookupKerberosAuthorization(t)}loadCertificates(){return this.q.$loadCertificates()}get trusted(){return this.w}requestResourceTrust(t){return this.q.$requestResourceTrust(t)}requestWorkspaceTrust(t){return this.q.$requestWorkspaceTrust(t)}$onDidGrantWorkspaceTrust(){this.w||(this.w=!0,this.g.fire())}$onDidChangeWorkspaceTrustedFolders(){this.h.fire()}isResourceTrusted(t){return this.q.$isResourceTrusted(t)}registerEditSessionIdentityProvider(t,i){if(this.x.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this.x.set(t,i);const s=this.u.transformOutgoingScheme(t),r=this.C++;return this.q.$registerEditSessionIdentityProvider(r,s),se(()=>{this.x.delete(t),this.q.$unregisterEditSessionIdentityProvider(r)})}async $getEditSessionIdentifier(t,i){this.j.info("Getting edit session identifier for workspaceFolder",t);const s=await this.resolveWorkspaceFolder(y.revive(t));if(!s){this.j.warn("Unable to resolve workspace folder");return}this.j.info("Invoking #provideEditSessionIdentity for workspaceFolder",s);const r=this.x.get(s.uri.scheme);if(this.j.info(`Provider for scheme ${s.uri.scheme} is defined: `,!!r),!r)return;const n=await r.provideEditSessionIdentity(s,i);if(this.j.info("Provider returned edit session identifier: ",n),!!n)return n}async $provideEditSessionIdentityMatch(t,i,s,r){this.j.info("Getting edit session identifier for workspaceFolder",t);const n=await this.resolveWorkspaceFolder(y.revive(t));if(!n){this.j.warn("Unable to resolve workspace folder");return}this.j.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const o=this.x.get(n.uri.scheme);if(this.j.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!o),!o)return;const a=await o.provideEditSessionIdentityMatch?.(i,s,r);if(this.j.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(t){return(i,s,r)=>{const n=function(a){i.call(s,a)};return n.extension=t,this.D.event(n,void 0,r)}}async $onWillCreateEditSessionIdentity(t,i,s){const r=await this.resolveWorkspaceFolder(y.revive(t));if(r===void 0)throw new Error("Unable to resolve workspace folder");await this.D.fireAsync({workspaceFolder:r},i,async(n,o)=>{const a=Date.now();await Promise.resolve(n),Date.now()-a>s&&this.j.warn("SLOW edit session create-participant",o.extension.identifier)}),i.isCancellationRequested}registerCanonicalUriProvider(t,i){if(this.F.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this.F.set(t,i);const s=this.u.transformOutgoingScheme(t),r=this.C++;return this.q.$registerCanonicalUriProvider(r,s),se(()=>{this.F.delete(t),this.q.$unregisterCanonicalUriProvider(r)})}async provideCanonicalUri(t,i,s){const r=this.F.get(t.scheme);if(!r)return;const n=await r.provideCanonicalUri?.(y.revive(t),i,s);if(n)return n}async $provideCanonicalUri(t,i,s){return this.provideCanonicalUri(y.revive(t),{targetScheme:i},s)}async decode(t,i){const[s,r]=this.G(i),n=await this.q.$resolveDecoding(s,r),o=(await bB(tF(_.wrap(t)),{...n,acceptTextOnly:!0,overwriteEncoding:a=>a===null||a===n.preferredEncoding?Promise.resolve(n.preferredEncoding):this.q.$validateDetectedEncoding(s,a,r)})).stream;return WC(o,a=>a.join(""))}async encode(t,i){const[s,r]=this.G(i),{encoding:n,addBOM:o}=await this.q.$resolveEncoding(s,r);if(n===pm&&!o)return _.fromString(t).buffer;const a=await yB(TB(t),n,{addBOM:o});return eF(a).buffer}G(t){const i=pf(t?.uri)?t.uri:void 0,s=typeof t?.encoding=="string"?t.encoding:void 0;return[i,s?{encoding:s}:void 0]}};lA=__decorate([__param(0,Te),__param(1,Wt),__param(2,bc),__param(3,xe),__param(4,ku)],lA);var Ts=W("IExtHostWorkspace");function bm(e){let t,i;if(e)return typeof e=="string"?t=e:(t=e.pattern,i=y.revive(e.baseUri)),{pattern:t,folder:i}}function O9(e){return(e?.map(t=>{if(typeof t=="string")return t===""?void 0:{pattern:t,uri:void 0};{const i=bm(t);return i?{pattern:i.pattern,uri:i.folder}:void 0}})??[]).filter(t=>!!t)}var F9;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(F9||(F9={}));var j9;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(j9||(j9={}));var U9;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(U9||(U9={}));var uA;(function(e){e.DEFAULT={allowTrailingComma:!0}})(uA||(uA={}));function RB(e,t=!1){let i=0;const s=e.length;let r="",n=0,o=16,a=0;function c(v){let b=0,S=0;for(;b<v;){const E=e.charCodeAt(i);if(E>=48&&E<=57)S=S*16+E-48;else if(E>=65&&E<=70)S=S*16+E-65+10;else if(E>=97&&E<=102)S=S*16+E-97+10;else break;i++,b++}return b<v&&(S=-1),S}function l(v){i=v,r="",n=0,o=16,a=0}function u(){const v=i;if(e.charCodeAt(i)===48)i++;else for(i++;i<e.length&&kl(e.charCodeAt(i));)i++;if(i<e.length&&e.charCodeAt(i)===46)if(i++,i<e.length&&kl(e.charCodeAt(i)))for(i++;i<e.length&&kl(e.charCodeAt(i));)i++;else return a=3,e.substring(v,i);let b=i;if(i<e.length&&(e.charCodeAt(i)===69||e.charCodeAt(i)===101))if(i++,(i<e.length&&e.charCodeAt(i)===43||e.charCodeAt(i)===45)&&i++,i<e.length&&kl(e.charCodeAt(i))){for(i++;i<e.length&&kl(e.charCodeAt(i));)i++;b=i}else a=3;return e.substring(v,b)}function h(){let v="",b=i;for(;;){if(i>=s){v+=e.substring(b,i),a=2;break}const S=e.charCodeAt(i);if(S===34){v+=e.substring(b,i),i++;break}if(S===92){if(v+=e.substring(b,i),i++,i>=s){a=2;break}switch(e.charCodeAt(i++)){case 34:v+='"';break;case 92:v+="\\";break;case 47:v+="/";break;case 98:v+="\b";break;case 102:v+="\f";break;case 110:v+=`
`;break;case 114:v+="\r";break;case 116:v+="	";break;case 117:{const k=c(4);k>=0?v+=String.fromCharCode(k):a=4;break}default:a=5}b=i;continue}if(S>=0&&S<=31)if(ym(S)){v+=e.substring(b,i),a=2;break}else a=6;i++}return v}function f(){if(r="",a=0,n=i,i>=s)return n=s,o=17;let v=e.charCodeAt(i);if(hA(v)){do i++,r+=String.fromCharCode(v),v=e.charCodeAt(i);while(hA(v));return o=15}if(ym(v))return i++,r+=String.fromCharCode(v),v===13&&e.charCodeAt(i)===10&&(i++,r+=`
`),o=14;switch(v){case 123:return i++,o=1;case 125:return i++,o=2;case 91:return i++,o=3;case 93:return i++,o=4;case 58:return i++,o=6;case 44:return i++,o=5;case 34:return i++,r=h(),o=10;case 47:{const b=i-1;if(e.charCodeAt(i+1)===47){for(i+=2;i<s&&!ym(e.charCodeAt(i));)i++;return r=e.substring(b,i),o=12}if(e.charCodeAt(i+1)===42){i+=2;const S=s-1;let E=!1;for(;i<S;){if(e.charCodeAt(i)===42&&e.charCodeAt(i+1)===47){i+=2,E=!0;break}i++}return E||(i++,a=1),r=e.substring(b,i),o=13}return r+=String.fromCharCode(v),i++,o=16}case 45:if(r+=String.fromCharCode(v),i++,i===s||!kl(e.charCodeAt(i)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return r+=u(),o=11;default:for(;i<s&&p(v);)i++,v=e.charCodeAt(i);if(n!==i){switch(r=e.substring(n,i),r){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return r+=String.fromCharCode(v),i++,o=16}}function p(v){if(hA(v)||ym(v))return!1;switch(v){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function g(){let v;do v=f();while(v>=12&&v<=15);return v}return{setPosition:l,getPosition:()=>i,scan:t?g:f,getToken:()=>o,getTokenValue:()=>r,getTokenOffset:()=>n,getTokenLength:()=>i-n,getTokenError:()=>a}}function hA(e){return e===32||e===9||e===11||e===12||e===160||e===5760||e>=8192&&e<=8203||e===8239||e===8287||e===12288||e===65279}function ym(e){return e===10||e===13||e===8232||e===8233}function kl(e){return e>=48&&e<=57}var z9;(function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"})(z9||(z9={}));function LB(e,t,i=uA.DEFAULT){const s=RB(e,!1);function r(H){return H?()=>H(s.getTokenOffset(),s.getTokenLength()):()=>!0}function n(H){return H?ie=>H(ie,s.getTokenOffset(),s.getTokenLength()):()=>!0}const o=r(t.onObjectBegin),a=n(t.onObjectProperty),c=r(t.onObjectEnd),l=r(t.onArrayBegin),u=r(t.onArrayEnd),h=n(t.onLiteralValue),f=n(t.onSeparator),p=r(t.onComment),g=n(t.onError),v=i&&i.disallowComments,b=i&&i.allowTrailingComma;function S(){for(;;){const H=s.scan();switch(s.getTokenError()){case 4:E(14);break;case 5:E(15);break;case 3:E(13);break;case 1:v||E(11);break;case 2:E(12);break;case 6:E(16);break}switch(H){case 12:case 13:v?E(10):p();break;case 16:E(1);break;case 15:case 14:break;default:return H}}}function E(H,ie=[],Ae=[]){if(g(H),ie.length+Ae.length>0){let re=s.getToken();for(;re!==17;){if(ie.indexOf(re)!==-1){S();break}else if(Ae.indexOf(re)!==-1)break;re=S()}}}function k(H){const ie=s.getTokenValue();return H?h(ie):a(ie),S(),!0}function O(){switch(s.getToken()){case 11:{let H=0;try{H=JSON.parse(s.getTokenValue()),typeof H!="number"&&(E(2),H=0)}catch{E(2)}h(H);break}case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return S(),!0}function F(){return s.getToken()!==10?(E(3,[],[2,5]),!1):(k(!1),s.getToken()===6?(f(":"),S(),B()||E(4,[],[2,5])):E(5,[],[2,5]),!0)}function G(){o(),S();let H=!1;for(;s.getToken()!==2&&s.getToken()!==17;){if(s.getToken()===5){if(H||E(4,[],[]),f(","),S(),s.getToken()===2&&b)break}else H&&E(6,[],[]);F()||E(4,[],[2,5]),H=!0}return c(),s.getToken()!==2?E(7,[2],[]):S(),!0}function j(){l(),S();let H=!1;for(;s.getToken()!==4&&s.getToken()!==17;){if(s.getToken()===5){if(H||E(4,[],[]),f(","),S(),s.getToken()===4&&b)break}else H&&E(6,[],[]);B()||E(4,[],[4,5]),H=!0}return u(),s.getToken()!==4?E(8,[4],[]):S(),!0}function B(){switch(s.getToken()){case 3:return j();case 1:return G();case 10:return k(!0);default:return O()}}return S(),s.getToken()===17?i.allowEmptyContent?!0:(E(4,[],[]),!1):B()?(s.getToken()!==17&&E(9,[],[]),!0):(E(4,[],[]),!1)}function Jh(e){return Object.isFrozen(e)?e:y0(e)}var $l=class Po{static createEmptyModel(t){return new Po({},[],[],void 0,t)}constructor(t,i,s,r,n){this.b=t,this.c=i,this.d=s,this.f=r,this.g=n,this.a=new Map}get rawConfiguration(){if(!this.h)if(this.f){const t=(Array.isArray(this.f)?this.f:[this.f]).map(i=>{if(i instanceof Po)return i;const s=new OB("",this.g);return s.parseRaw(i),s.configurationModel});this.h=t.reduce((i,s)=>s===i?s:i.merge(s),t[0])}else this.h=this;return this.h}get contents(){return this.b}get overrides(){return this.d}get keys(){return this.c}get raw(){if(this.f&&!(Array.isArray(this.f)&&this.f.every(t=>t instanceof Po)))return this.f}isEmpty(){return this.c.length===0&&Object.keys(this.b).length===0&&this.d.length===0}getValue(t){return t?pp(this.contents,t):this.contents}inspect(t,i){const s=this;return{get value(){return Jh(s.rawConfiguration.getValue(t))},get override(){return i?Jh(s.rawConfiguration.getOverrideValue(t,i)):void 0},get merged(){return Jh(i?s.rawConfiguration.override(i).getValue(t):s.rawConfiguration.getValue(t))},get overrides(){const r=[];for(const{contents:n,identifiers:o,keys:a}of s.rawConfiguration.overrides){const c=new Po(n,a,[],void 0,s.g).getValue(t);c!==void 0&&r.push({identifiers:o,value:c})}return r.length?Jh(r):void 0}}}getOverrideValue(t,i){const s=this.k(i);return s?t?pp(s,t):s:void 0}getKeysForOverrideIdentifier(t){const i=[];for(const s of this.overrides)s.identifiers.includes(t)&&i.push(...s.keys);return Ro(i)}getAllOverrideIdentifiers(){const t=[];for(const i of this.overrides)t.push(...i.identifiers);return Ro(t)}override(t){let i=this.a.get(t);return i||(i=this.i(t),this.a.set(t,i)),i}merge(...t){const i=ct(this.contents),s=ct(this.overrides),r=[...this.keys],n=this.f?Array.isArray(this.f)?[...this.f]:[this.f]:[this];for(const o of t)if(n.push(...o.f?Array.isArray(o.f)?o.f:[o.f]:[o]),!o.isEmpty()){this.j(i,o.contents);for(const a of o.overrides){const[c]=s.filter(l=>$i(l.identifiers,a.identifiers));c?(this.j(c.contents,a.contents),c.keys.push(...a.keys),c.keys=Ro(c.keys)):s.push(ct(a))}for(const a of o.keys)r.indexOf(a)===-1&&r.push(a)}return new Po(i,r,s,!n.length||n.every(o=>o instanceof Po)?void 0:n,this.g)}i(t){const i=this.k(t);if(!i||typeof i!="object"||!Object.keys(i).length)return this;const s={};for(const r of Ro([...Object.keys(this.contents),...Object.keys(i)])){let n=this.contents[r];const o=i[r];o&&(typeof n=="object"&&typeof o=="object"?(n=ct(n),this.j(n,o)):n=o),s[r]=n}return new Po(s,this.keys,this.overrides,void 0,this.g)}j(t,i){for(const s of Object.keys(i)){if(s in t&&kt(t[s])&&kt(i[s])){this.j(t[s],i[s]);continue}t[s]=ct(i[s])}}k(t){let i=null,s=null;const r=n=>{n&&(s?this.j(s,n):s=ct(n))};for(const n of this.overrides)n.identifiers.length===1&&n.identifiers[0]===t?i=n.contents:n.identifiers.includes(t)&&r(n.contents);return r(i),s}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,i){this.l(t,i,!0)}setValue(t,i){this.l(t,i,!1)}removeValue(t){const i=this.keys.indexOf(t);i!==-1&&(this.keys.splice(i,1),JW(this.contents,t),kr.test(t)&&this.overrides.splice(this.overrides.findIndex(s=>$i(s.identifiers,Ju(t))),1))}l(t,i,s){if(tD(this.contents,t,i,r=>this.g.error(r)),s=s||this.keys.indexOf(t)===-1,s&&this.keys.push(t),kr.test(t)){const r=this.contents[t],n=Ju(t),o={identifiers:n,keys:Object.keys(r),contents:jw(r,c=>this.g.error(c))},a=this.overrides.findIndex(c=>$i(c.identifiers,n));a!==-1?this.overrides[a]=o:this.overrides.push(o)}}},OB=class{constructor(e,t){this.f=e,this.g=t,this.a=null,this.b=null,this.c=[],this.d=[]}get configurationModel(){return this.b||$l.createEmptyModel(this.g)}get restrictedConfigurations(){return this.c}get errors(){return this.d}parse(e,t){if(!qt(e)){const i=this.h(e);this.parseRaw(i,t)}}reparse(e){this.a&&this.parseRaw(this.a,e)}parseRaw(e,t){this.a=e;const{contents:i,keys:s,overrides:r,restricted:n,hasExcludedProperties:o}=this.i(e,t);this.b=new $l(i,s,r,o?[e]:void 0,this.g),this.c=n||[]}h(e){let t={},i=null,s=[];const r=[],n=[];function o(c){Array.isArray(s)?s.push(c):i!==null&&(s[i]=c)}const a={onObjectBegin:()=>{const c={};o(c),r.push(s),s=c,i=null},onObjectProperty:c=>{i=c},onObjectEnd:()=>{s=r.pop()},onArrayBegin:()=>{const c=[];o(c),r.push(s),s=c,i=null},onArrayEnd:()=>{s=r.pop()},onLiteralValue:o,onError:(c,l,u)=>{n.push({error:c,offset:l,length:u})}};if(e)try{LB(e,a),t=s[0]||{}}catch(c){this.g.error(`Error while parsing settings file ${this.f}: ${c}`),this.d=[c]}return t}i(e,t){const i=Qt.as(oo.Configuration),s=i.getConfigurationProperties(),r=i.getExcludedConfigurationProperties(),n=this.j(e,s,r,!0,t);e=n.raw;const o=jw(e,l=>this.g.error(`Conflict in settings file ${this.f}: ${l}`)),a=Object.keys(e),c=this.m(e,l=>this.g.error(`Conflict in settings file ${this.f}: ${l}`));return{contents:o,keys:a,overrides:c,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}j(e,t,i,s,r){let n=!1;if(!r?.scopes&&!r?.skipRestricted&&!r?.skipUnregistered&&!r?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:n};const o={},a=[];for(const c in e)if(kr.test(c)&&s){const l=this.j(e[c],t,i,!1,r);o[c]=l.raw,n=n||l.hasExcludedProperties,a.push(...l.restricted)}else{const l=t[c];l?.restricted&&a.push(c),this.l(c,l,i,r)?o[c]=e[c]:n=!0}return{raw:o,restricted:a,hasExcludedProperties:n}}l(e,t,i,s){if(s.exclude?.includes(e))return!1;if(s.include?.includes(e))return!0;if(s.skipRestricted&&t?.restricted||s.skipUnregistered&&!t)return!1;const r=t??i[e],n=r?typeof r.scope<"u"?r.scope:4:void 0;return n===void 0||s.scopes===void 0?!0:s.scopes.includes(n)}m(e,t){const i=[];for(const s of Object.keys(e))if(kr.test(s)){const r={},n=e[s];for(const o in n)r[o]=n[o];i.push({identifiers:Ju(s),keys:Object.keys(r),contents:jw(r,t)})}return i}},FB=class{constructor(e,t,i,s,r,n,o,a,c,l,u,h,f){this.a=e,this.b=t,this.c=i,this.overrideIdentifiers=s,this.d=r,this.f=n,this.g=o,this.h=a,this.i=c,this.j=l,this.k=u,this.l=h,this.m=f}get value(){return Jh(this.c)}n(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get q(){return this.p||(this.p=this.d.inspect(this.a,this.b.overrideIdentifier)),this.p}get defaultValue(){return this.q.merged}get default(){return this.n(this.q)}get s(){return this.r===void 0&&(this.r=this.f?this.f.inspect(this.a):null),this.r}get policyValue(){return this.s?.merged}get policy(){return this.s?.value!==void 0?{value:this.s.value}:void 0}get u(){return this.t===void 0&&(this.t=this.g?this.g.inspect(this.a):null),this.t}get applicationValue(){return this.u?.merged}get application(){return this.n(this.u)}get w(){return this.v||(this.v=this.h.inspect(this.a,this.b.overrideIdentifier)),this.v}get userValue(){return this.w.merged}get user(){return this.n(this.w)}get y(){return this.x||(this.x=this.i.inspect(this.a,this.b.overrideIdentifier)),this.x}get userLocalValue(){return this.y.merged}get userLocal(){return this.n(this.y)}get A(){return this.z||(this.z=this.j.inspect(this.a,this.b.overrideIdentifier)),this.z}get userRemoteValue(){return this.A.merged}get userRemote(){return this.n(this.A)}get D(){return this.B===void 0&&(this.B=this.k?this.k.inspect(this.a,this.b.overrideIdentifier):null),this.B}get workspaceValue(){return this.D?.merged}get workspace(){return this.n(this.D)}get F(){return this.E===void 0&&(this.E=this.l?this.l.inspect(this.a,this.b.overrideIdentifier):null),this.E}get workspaceFolderValue(){return this.F?.merged}get workspaceFolder(){return this.n(this.F)}get H(){return this.G===void 0&&(this.G=this.m.inspect(this.a,this.b.overrideIdentifier)),this.G}get memoryValue(){return this.H.merged}get memory(){return this.n(this.H)}},dA=class KN{constructor(t,i,s,r,n,o,a,c,l,u){this.j=t,this.l=i,this.m=s,this.n=r,this.p=n,this.q=o,this.r=a,this.s=c,this.t=l,this.u=u,this.h=null,this.i=new Ct,this.v=null}getValue(t,i,s){return this.w(t,i,s).getValue(t)}updateValue(t,i,s={}){let r;s.resource?(r=this.t.get(s.resource),r||(r=$l.createEmptyModel(this.u),this.t.set(s.resource,r))):r=this.s,i===void 0?r.removeValue(t):r.setValue(t,i),s.resource||(this.h=null)}inspect(t,i,s){const r=this.w(t,i,s),n=this.A(i.resource,s),o=i.resource?this.t.get(i.resource)||this.s:this.s,a=new Set;for(const c of r.overrides)for(const l of c.identifiers)r.getOverrideValue(t,l)!==void 0&&a.add(l);return new FB(t,i,r.getValue(t),a.size?[...a]:void 0,this.j,this.l.isEmpty()?void 0:this.l,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,s?this.q:void 0,n||void 0,o)}keys(t){const i=this.A(void 0,t);return{default:this.j.keys.slice(0),policy:this.l.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this.q.keys.slice(0),workspaceFolder:i?i.keys.slice(0):[]}}updateDefaultConfiguration(t){this.j=t,this.h=null,this.i.clear()}updatePolicyConfiguration(t){this.l=t}updateApplicationConfiguration(t){this.m=t,this.h=null,this.i.clear()}updateLocalUserConfiguration(t){this.n=t,this.v=null,this.h=null,this.i.clear()}updateRemoteUserConfiguration(t){this.p=t,this.v=null,this.h=null,this.i.clear()}updateWorkspaceConfiguration(t){this.q=t,this.h=null,this.i.clear()}updateFolderConfiguration(t,i){this.r.set(t,i),this.i.delete(t)}deleteFolderConfiguration(t){this.folderConfigurations.delete(t),this.i.delete(t)}compareAndUpdateDefaultConfiguration(t,i){const s=[];if(!i){const{added:r,updated:n,removed:o}=So(this.j,t);i=[...r,...n,...o]}for(const r of i)for(const n of Ju(r)){const o=this.j.getKeysForOverrideIdentifier(n),a=t.getKeysForOverrideIdentifier(n),c=[...a.filter(l=>o.indexOf(l)===-1),...o.filter(l=>a.indexOf(l)===-1),...o.filter(l=>!Ai(this.j.override(n).getValue(l),t.override(n).getValue(l)))];s.push([n,c])}return this.updateDefaultConfiguration(t),{keys:i,overrides:s}}compareAndUpdatePolicyConfiguration(t){const{added:i,updated:s,removed:r}=So(this.l,t),n=[...i,...s,...r];return n.length&&this.updatePolicyConfiguration(t),{keys:n,overrides:[]}}compareAndUpdateApplicationConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.applicationConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateApplicationConfiguration(t),{keys:o,overrides:n}}compareAndUpdateLocalUserConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.localUserConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateLocalUserConfiguration(t),{keys:o,overrides:n}}compareAndUpdateRemoteUserConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.remoteUserConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateRemoteUserConfiguration(t),{keys:o,overrides:n}}compareAndUpdateWorkspaceConfiguration(t){const{added:i,updated:s,removed:r,overrides:n}=So(this.workspaceConfiguration,t),o=[...i,...s,...r];return o.length&&this.updateWorkspaceConfiguration(t),{keys:o,overrides:n}}compareAndUpdateFolderConfiguration(t,i){const s=this.folderConfigurations.get(t),{added:r,updated:n,removed:o,overrides:a}=So(s,i),c=[...r,...n,...o];return(c.length||!s)&&this.updateFolderConfiguration(t,i),{keys:c,overrides:a}}compareAndDeleteFolderConfiguration(t){const i=this.folderConfigurations.get(t);if(!i)throw new Error("Unknown folder");this.deleteFolderConfiguration(t);const{added:s,updated:r,removed:n,overrides:o}=So(i,void 0);return{keys:[...s,...r,...n],overrides:o}}get defaults(){return this.j}get applicationConfiguration(){return this.m}get userConfiguration(){if(!this.v)if(this.p.isEmpty())this.v=this.n;else{const t=this.n.merge(this.p);this.v=new $l(t.contents,t.keys,t.overrides,void 0,this.u)}return this.v}get localUserConfiguration(){return this.n}get remoteUserConfiguration(){return this.p}get workspaceConfiguration(){return this.q}get folderConfigurations(){return this.r}w(t,i,s){let r=this.x(i,s);if(i.overrideIdentifier&&(r=r.override(i.overrideIdentifier)),!this.l.isEmpty()&&this.l.getValue(t)!==void 0){r=r.merge();for(const n of this.l.keys)r.setValue(n,this.l.getValue(n))}return r}x({resource:t},i){let s=this.y();if(i&&t){const r=i.getFolder(t);r&&(s=this.z(r.uri)||s);const n=this.t.get(t);n&&(s=s.merge(n))}return s}y(){return this.h||(this.h=this.j.merge(this.applicationConfiguration,this.userConfiguration,this.q,this.s)),this.h}z(t){let i=this.i.get(t);if(!i){const s=this.y(),r=this.r.get(t);r?(i=s.merge(r),this.i.set(t,i)):i=s}return i}A(t,i){if(i&&t){const s=i.getFolder(t);if(s)return this.r.get(s.uri)}}toData(){return{defaults:{contents:this.j.contents,overrides:this.j.overrides,keys:this.j.keys},policy:{contents:this.l.contents,overrides:this.l.overrides,keys:this.l.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this.q.contents,overrides:this.q.overrides,keys:this.q.keys},folders:[...this.r.keys()].reduce((t,i)=>{const{contents:s,overrides:r,keys:n}=this.r.get(i);return t.push([i,{contents:s,overrides:r,keys:n}]),t},[])}}allKeys(){const t=new Set;return this.j.keys.forEach(i=>t.add(i)),this.userConfiguration.keys.forEach(i=>t.add(i)),this.q.keys.forEach(i=>t.add(i)),this.r.forEach(i=>i.keys.forEach(s=>t.add(s))),[...t.values()]}B(){const t=new Set;return this.j.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.userConfiguration.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.q.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.r.forEach(i=>i.getAllOverrideIdentifiers().forEach(s=>t.add(s))),[...t.values()]}D(t){const i=new Set;return this.j.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s)),this.userConfiguration.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s)),this.q.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s)),this.r.forEach(s=>s.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r))),[...i.values()]}static parse(t,i){const s=this.E(t.defaults,i),r=this.E(t.policy,i),n=this.E(t.application,i),o=this.E(t.userLocal,i),a=this.E(t.userRemote,i),c=this.E(t.workspace,i),l=t.folders.reduce((u,h)=>(u.set(y.revive(h[0]),this.E(h[1],i)),u),new Ct);return new KN(s,r,n,o,a,c,l,$l.createEmptyModel(i),new Ct,i)}static E(t,i){return new $l(t.contents,t.keys,t.overrides,t.raw,i)}},jB=class{constructor(e,t,i,s,r){this.change=e,this.f=t,this.g=i,this.h=s,this.i=r,this.a=`
`,this.b=this.a.charCodeAt(0),this.c=46,this.affectedKeys=new Set,this.j=void 0;for(const n of e.keys)this.affectedKeys.add(n);for(const[,n]of e.overrides)for(const o of n)this.affectedKeys.add(o);this.d=this.a;for(const n of this.affectedKeys)this.d+=n+this.a}get previousConfiguration(){return!this.j&&this.f&&(this.j=dA.parse(this.f.data,this.i)),this.j}affectsConfiguration(e,t){const i=this.a+e,s=this.d.indexOf(i);if(s<0)return!1;const r=s+i.length;if(r>=this.d.length)return!1;const n=this.d.charCodeAt(r);if(n!==this.b&&n!==this.c)return!1;if(t){const o=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.f?.workspace):void 0,a=this.g.getValue(e,t,this.h);return!Ai(o,a)}return!0}};function So(e,t){const{added:i,removed:s,updated:r}=H9(t?.rawConfiguration,e?.rawConfiguration),n=[],o=e?.getAllOverrideIdentifiers()||[],a=t?.getAllOverrideIdentifiers()||[];if(t){const c=a.filter(l=>!o.includes(l));for(const l of c)n.push([l,t.getKeysForOverrideIdentifier(l)])}if(e){const c=o.filter(l=>!a.includes(l));for(const l of c)n.push([l,e.getKeysForOverrideIdentifier(l)])}if(t&&e){for(const c of o)if(a.includes(c)){const l=H9({contents:e.getOverrideValue(void 0,c)||{},keys:e.getKeysForOverrideIdentifier(c)},{contents:t.getOverrideValue(void 0,c)||{},keys:t.getKeysForOverrideIdentifier(c)});n.push([c,[...l.added,...l.removed,...l.updated]])}}return{added:i,removed:s,updated:r,overrides:n}}function H9(e,t){const i=e?t?e.keys.filter(n=>t.keys.indexOf(n)===-1):[...e.keys]:[],s=t?e?t.keys.filter(n=>e.keys.indexOf(n)===-1):[...t.keys]:[],r=[];if(e&&t){for(const n of t.keys)if(e.keys.indexOf(n)!==-1){const o=pp(t.contents,n),a=pp(e.contents,n);Ai(o,a)||r.push(n)}}return{added:i,removed:s,updated:r}}function Am(e,t){if(t){const i=t.split(".");let s=e;for(let r=0;s&&r<i.length;r++)s=s[i[r]];return s}}function UB(e){return e instanceof y}function zB(e){return kt(e)&&e.uri instanceof y&&!!e.languageId&&typeof e.languageId=="string"}function HB(e){return kt(e)&&!e.uri&&!!e.languageId&&typeof e.languageId=="string"}function WB(e){return kt(e)&&e.uri instanceof y&&(!e.name||typeof e.name=="string")&&(!e.index||typeof e.index=="number")}function W9(e){if(UB(e))return{resource:e};if(zB(e))return{resource:e.uri,overrideIdentifier:e.languageId};if(HB(e))return{overrideIdentifier:e.languageId};if(WB(e))return{resource:e.uri};if(e===null)return{resource:null}}var fA=class{constructor(t,i,s){this.a=t.getProxy(Q.MainThreadConfiguration),this.c=i,this.b=s,this.d=new ms,this.e=null}getConfigProvider(){return this.d.wait().then(t=>this.e)}$initializeConfiguration(t){this.e=new _B(this.a,this.c,t,this.b),this.d.open()}$acceptConfigurationChanged(t,i){this.getConfigProvider().then(s=>s.$acceptConfigurationChanged(t,i))}};fA=__decorate([__param(0,Te),__param(1,Ts),__param(2,xe)],fA);var _B=class{constructor(e,t,i,s){this.a=new I,this.b=e,this.f=s,this.c=t,this.e=dA.parse(i,s),this.d=this.k(i.configurationScopes)}get onDidChangeConfiguration(){return this.a&&this.a.event}$acceptConfigurationChanged(e,t){const i={data:this.e.toData(),workspace:this.c.workspace};this.e=dA.parse(e,this.f),this.d=this.k(e.configurationScopes),this.a.fire(this.j(t,i))}getConfiguration(e,t,i){const s=W9(t)||{},r=this.g(this.e.getValue(e,s,this.c.workspace));e&&this.h(e,s,i?.identifier);function n(a){if(a==null)return null;if(typeof a=="boolean")return a?2:5;switch(a){case Qc.Global:return 2;case Qc.Workspace:return 5;case Qc.WorkspaceFolder:return 6}}const o={has(a){return typeof Am(r,a)<"u"},get:(a,c)=>{this.h(e?`${e}.${a}`:a,s,i?.identifier);let l=Am(r,a);if(typeof l>"u")l=c;else{let u;const h=(f,p)=>{if(kt(f)){let g;const v=()=>{u=u||ct(r),g=g||Am(u,p)};return new Proxy(f,{get:(b,S)=>{if(typeof S=="string"&&S.toLowerCase()==="tojson")return v(),()=>g;if(u)return g=g||Am(u,p),g[S];const E=b[S];return typeof S=="string"?h(E,`${p}.${S}`):E},set:(b,S,E)=>(v(),g&&(g[S]=E),!0),deleteProperty:(b,S)=>(v(),g&&delete g[S],!0),defineProperty:(b,S,E)=>(v(),g&&Object.defineProperty(g,S,E),!0)})}return Array.isArray(f)?ct(f):f};l=h(l,a)}return l},update:(a,c,l,u)=>{a=e?`${e}.${a}`:a;const h=n(l);return c!==void 0?this.b.$updateConfigurationOption(h,a,c,s,u):this.b.$removeConfigurationOption(h,a,s,u)},inspect:a=>{a=e?`${e}.${a}`:a;const c=this.e.inspect(a,s,this.c.workspace);if(c)return{key:a,defaultValue:ct(c.policy?.value??c.default?.value),globalLocalValue:ct(c.userLocal?.value),globalRemoteValue:ct(c.userRemote?.value),globalValue:ct(c.user?.value??c.application?.value),workspaceValue:ct(c.workspace?.value),workspaceFolderValue:ct(c.workspaceFolder?.value),defaultLanguageValue:ct(c.default?.override),globalLocalLanguageValue:ct(c.userLocal?.override),globalRemoteLanguageValue:ct(c.userRemote?.override),globalLanguageValue:ct(c.user?.override??c.application?.override),workspaceLanguageValue:ct(c.workspace?.override),workspaceFolderLanguageValue:ct(c.workspaceFolder?.override),languageIds:ct(c.overrideIdentifiers)}}};return typeof r=="object"&&Xr(o,r,!1),Object.freeze(o)}g(e){const t=i=>kt(i)?new Proxy(i,{get:(s,r)=>t(s[r]),set:(s,r,n)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(r)}' of object`)},deleteProperty:(s,r)=>{throw new Error(`TypeError: Cannot delete read only property '${String(r)}' of object`)},defineProperty:(s,r)=>{throw new Error(`TypeError: Cannot define property '${String(r)}' for a readonly object`)},setPrototypeOf:s=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}h(e,t,i){const s=kr.test(e)?5:this.d.get(e),r=i?`[${i.value}] `:"";if(s===5){typeof t?.resource>"u"&&this.f.warn(`${r}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(s===4){t?.resource&&this.f.warn(`${r}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}j(e,t){const i=new jB(e,t,this.e,this.c.workspace,this.f);return Object.freeze({affectsConfiguration:(s,r)=>i.affectsConfiguration(s,W9(r))})}k(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}},bs=W("IExtHostConfiguration"),BB=class{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}},Zh=class eR extends J{static isHostExtension(t,i,s){if(i.getExtensionDescription(t))return!1;const r=s.getExtensionDescription(t);return r?!!((r.main||r.browser)&&r.api==="none"):!1}constructor(t,i){super(),this.n=t,this.c=this.D(new I),this.onDidChange=this.c.event,this.f=0,this.g=i,this.q()}q(){this.g.sort(VB),this.h=new Gn,this.j=[],this.m=new Map;for(const t of this.g){if(this.h.has(t.identifier)){console.error("Extension `"+t.identifier.value+"` is already registered");continue}this.h.set(t.identifier,t),this.j.push(t);const i=this.n.readActivationEvents(t);for(const s of i)this.m.has(s)||this.m.set(s,[]),this.m.get(s).push(t)}}set(t){return this.g=t,this.q(),this.f++,this.c.fire(void 0),{versionId:this.f}}deltaExtensions(t,i){this.g=B9(this.g,i),this.g=this.g.concat(t);const s=eR.r(this.g);return this.g=B9(this.g,s.map(r=>r.identifier)),this.q(),this.f++,this.c.fire(void 0),new BB(this.f,s)}static r(t){const i=new class{constructor(){this.c=new Map,this.d=new Set,this.e=[]}addNode(a){this.d.has(a)||(this.d.add(a),this.e.push(a))}addArc(a,c){this.addNode(a),this.addNode(c),this.c.has(a)?this.c.get(a).push(c):this.c.set(a,[c])}getArcs(a){return this.c.has(a)?this.c.get(a):[]}hasOnlyGoodArcs(a,c){const l=i.getArcs(a);for(let u=0;u<l.length;u++)if(!c.has(l[u]))return!1;return!0}getNodes(){return this.e}},s=new Gn;for(const a of t)if(s.set(a.identifier,a),a.extensionDependencies)for(const c of a.extensionDependencies)i.addArc(it.toKey(a.identifier),it.toKey(c));const r=new Set;i.getNodes().filter(a=>i.getArcs(a).length===0).forEach(a=>r.add(a));const n=i.getNodes().filter(a=>!r.has(a));let o;do{o=!1;for(let a=0;a<n.length;a++){const c=n[a];i.hasOnlyGoodArcs(c,r)&&(n.splice(a,1),a--,r.add(c),o=!0)}}while(o);return n.map(a=>s.get(a))}containsActivationEvent(t){return this.m.has(t)}containsExtension(t){return this.h.has(t)}getExtensionDescriptionsForActivationEvent(t){const i=this.m.get(t);return i?i.slice(0):[]}getAllExtensionDescriptions(){return this.j.slice(0)}getSnapshot(){return new qB(this.f,this.getAllExtensionDescriptions())}getExtensionDescription(t){const i=this.h.get(t);return i||void 0}getExtensionDescriptionByUUID(t){for(const i of this.j)if(i.uuid===t)return i}getExtensionDescriptionByIdOrUUID(t,i){return this.getExtensionDescription(t)??(i?this.getExtensionDescriptionByUUID(i):void 0)}},qB=class{constructor(e,t){this.versionId=e,this.extensions=t}},_9;(function(e){e[e.Builtin=0]="Builtin",e[e.User=1]="User",e[e.Dev=2]="Dev"})(_9||(_9={}));function VB(e,t){const i=e.isBuiltin?0:e.isUnderDevelopment?2:1,s=t.isBuiltin?0:t.isUnderDevelopment?2:1;if(i!==s)return i-s;const r=_e.basename(e.extensionLocation.path),n=_e.basename(t.extensionLocation.path);return r<n?-1:r>n?1:0}function B9(e,t){const i=new Qo(t);return e.filter(s=>!i.has(s.identifier))}var Sm=class tR{static{this.NONE=new tR(!1,-1,-1,-1)}constructor(t,i,s,r){this.startup=t,this.codeLoadingTime=i,this.activateCallTime=s,this.activateResolvedTime=r}},pA=class{constructor(e){this.a=e,this.b=-1,this.c=-1,this.d=-1,this.f=-1,this.g=-1,this.h=-1}j(e,t){return e===-1||t===-1?-1:t-e}build(){return new Sm(this.a,this.j(this.b,this.c),this.j(this.d,this.f),this.j(this.g,this.h))}codeLoadingStart(){this.b=Date.now()}codeLoadingStop(){this.c=Date.now()}activateCallStart(){this.d=Date.now()}activateCallStop(){this.f=Date.now()}activateResolveStart(){this.g=Date.now()}activateResolveStop(){this.h=Date.now()}},Em=class{constructor(e,t,i,s,r,n){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=s,this.exports=r,this.disposable=n}},GB=class extends Em{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,J.None)}},JB=class extends Em{constructor(){super(!1,null,Sm.NONE,{activate:void 0,deactivate:void 0},void 0,J.None)}},xm=class extends Em{constructor(e){super(!0,e,Sm.NONE,{activate:void 0,deactivate:void 0},void 0,J.None)}},gA=class{constructor(t,i,s,r){this.g=r,this.a=t,this.b=i,this.c=s,this.d=new Gn,this.f=Object.create(null)}dispose(){for(const[t,i]of this.d)i.dispose()}async waitForActivatingExtensions(){const t=[];for(const[i,s]of this.d)t.push(s.wait());await Promise.all(t)}isActivated(t){const i=this.d.get(t);return!!(i&&i.value)}getActivatedExtension(t){const i=this.d.get(t);if(!i||!i.value)throw new Error(`Extension '${t.value}' is not known or not activated`);return i.value}async activateByEvent(t,i){if(this.f[t])return;const s=this.a.getExtensionDescriptionsForActivationEvent(t);await this.h(s.map(r=>({id:r.identifier,reason:{startup:i,extensionId:r.identifier,activationEvent:t}}))),this.f[t]=!0}activateById(t,i){const s=this.a.getExtensionDescription(t);if(!s)throw new Error(`Extension '${t.value}' is not known`);return this.h([{id:s.identifier,reason:i}])}async h(t){const i=t.filter(s=>!this.isActivated(s.id)).map(s=>this.j(s));await Promise.all(i.map(s=>s.wait()))}j(t){if(this.d.has(t.id))return this.d.get(t.id);if(this.l(t.id))return this.k(t,null,[],null);const i=this.a.getExtensionDescription(t.id);if(!i){const n=new Error(`Cannot activate unknown extension '${t.id.value}'`),o=this.k(t,null,[],new xm(n));return this.c.onExtensionActivationError(t.id,n,new AD(t.id.value)),o}const s=[],r=typeof i.extensionDependencies>"u"?[]:i.extensionDependencies;for(const n of r){if(this.m(n))continue;const o=this.d.get(n);if(o){s.push(o);continue}if(this.l(n)){s.push(this.j({id:this.b.getExtensionDescription(n).identifier,reason:t.reason}));continue}const a=this.a.getExtensionDescription(n);if(a){if(!a.main&&!a.browser)continue;s.push(this.j({id:a.identifier,reason:t.reason}));continue}const c=i.displayName||i.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${n}'`),u=this.k(t,i.displayName,[],new xm(l));return this.c.onExtensionActivationError(i.identifier,l,new AD(n)),u}return this.k(t,i.displayName,s,null)}k(t,i,s,r){const n=new mA(t.id,i,t.reason,s,r,this.c,this.g);return this.d.set(t.id,n),n}l(t){return Zh.isHostExtension(t,this.a,this.b)}m(t){const i=this.b.getExtensionDescription(t);return i?!i.main&&!i.browser:!1}};gA=__decorate([__param(3,xe)],gA);var mA=class{get value(){return this.h}get friendlyName(){return this.d||this.c.value}constructor(t,i,s,r,n,o,a){this.c=t,this.d=i,this.f=s,this.g=r,this.h=n,this.j=o,this.k=a,this.a=new ms,this.b=!1,this.l()}dispose(){this.b=!0}wait(){return this.a.wait()}async l(){await this.m(),this.a.open()}async m(){if(!this.h){for(;this.g.length>0;){for(let t=0;t<this.g.length;t++){const i=this.g[t];if(i.value&&!i.value.activationFailed){this.g.splice(t,1),t--;continue}if(i.value&&i.value.activationFailed){const s=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${i.friendlyName}' failed to activate`);s.detail=i.value.activationFailedError,this.h=new xm(s),this.j.onExtensionActivationError(this.c,s,null);return}}this.g.length>0&&await Promise.race(this.g.map(t=>t.wait()))}await this.n()}}async n(){try{this.h=await this.j.actualActivateExtension(this.c,this.f)}catch(t){const i=new Error;if(t&&t.name&&(i.name=t.name),t&&t.message?i.message=`Activating extension '${this.c.value}' failed: ${t.message}.`:i.message=`Activating extension '${this.c.value}' failed: ${t}.`,t&&t.stack&&(i.stack=t.stack),this.h=new xm(i),this.b&&ki(t))return;this.j.onExtensionActivationError(this.c,i,null),this.k.error(`Activating extension ${this.c.value} failed due to an error:`),this.k.error(t)}}};mA=__decorate([__param(6,xe)],mA);var q9=class{constructor(e,t){this.c=t,this.b=new I,this.onDidChangeStorage=this.b.event,this.a=e.getProxy(Q.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this.a.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const s=await this.a.$initializeExtensionStorage(e,t);let r;return s&&(r=this.d(e,t,s)),r||i}setValue(e,t,i){return this.a.$setValue(e,t,i)}$acceptValue(e,t,i){const s=this.d(e,t,i);s&&this.b.fire({shared:e,key:t,value:s})}d(e,t,i){try{return JSON.parse(i)}catch(s){this.c.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${s}`)}}},vA=W("IExtHostStorage"),V9=class{constructor(e,t,i){this.h=new Map,this.a=e,this.b=t,this.c=i,this.d=this.c.initializeExtensionStorage(this.b,this.a,Object.create(null)).then(s=>(this.f=s,this)),this.g=this.c.onDidChangeStorage(s=>{s.shared===this.b&&s.key===this.a&&(this.f=s.value)}),this.i=new vr(()=>{const s=this.h;this.h=new Map,(async()=>{try{await this.c.setValue(this.b,this.a,this.f);for(const r of s.values())r.complete()}catch(r){for(const n of s.values())n.error(r)}})()},0)}keys(){return Object.entries(this.f??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this.d}get(e,t){let i=this.f[e];return typeof i>"u"&&(i=t),i}update(e,t){t!==null&&typeof t=="object"?this.f[e]=JSON.parse(JSON.stringify(t)):this.f[e]=t;const i=this.h.get(e);if(i!==void 0)return i.p;const s=new Di;return this.h.set(e,s),this.i.isScheduled()||this.i.schedule(),s.p}dispose(){this.g.dispose()}},ZB=class extends V9{setKeysForSync(e){this.c.registerExtensionStorageKeysToSync({id:this.a,version:this.j.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this.j=e}},Lr,wA=Lr=class{constructor(t,i){this.b=new Map,this.c=new NC,this.a=t.getProxy(Q.MainThreadFileSystem);const s=this;this.value=Object.freeze({async stat(r){try{let n;const o=s.b.get(r.scheme);return o?(await s.a.$ensureActivation(r.scheme),n=await o.impl.stat(r)):n=await s.a.$stat(r),{type:n.type,ctime:n.ctime,mtime:n.mtime,size:n.size,permissions:n.permissions===Er.Readonly?1:void 0}}catch(n){Lr.e(n)}},async readDirectory(r){try{const n=s.b.get(r.scheme);return n?(await s.a.$ensureActivation(r.scheme),(await n.impl.readDirectory(r)).slice()):await s.a.$readdir(r)}catch(n){return Lr.e(n)}},async createDirectory(r){try{const n=s.b.get(r.scheme);return n&&!n.isReadonly?(await s.a.$ensureActivation(r.scheme),await s.d(n.impl,n.extUri,r)):await s.a.$mkdir(r)}catch(n){return Lr.e(n)}},async readFile(r){try{const n=s.b.get(r.scheme);return n?(await s.a.$ensureActivation(r.scheme),(await n.impl.readFile(r)).slice()):(await s.a.$readFile(r)).buffer}catch(n){return Lr.e(n)}},async writeFile(r,n){try{const o=s.b.get(r.scheme);return o&&!o.isReadonly?(await s.a.$ensureActivation(r.scheme),await s.d(o.impl,o.extUri,o.extUri.dirname(r)),await s.c.queueFor(r,()=>Promise.resolve(o.impl.writeFile(r,n,{create:!0,overwrite:!0})))):await s.a.$writeFile(r,_.wrap(n))}catch(o){return Lr.e(o)}},async delete(r,n){try{const o=s.b.get(r.scheme);return o&&!o.isReadonly&&!n?.useTrash?(await s.a.$ensureActivation(r.scheme),await o.impl.delete(r,{recursive:!1,...n})):await s.a.$delete(r,{recursive:!1,useTrash:!1,atomic:!1,...n})}catch(o){return Lr.e(o)}},async rename(r,n,o){try{return await s.a.$rename(r,n,{overwrite:!1,...o})}catch(a){return Lr.e(a)}},async copy(r,n,o){try{return await s.a.$copy(r,n,{overwrite:!1,...o})}catch(a){return Lr.e(a)}},isWritableFileSystem(r){const n=i.getCapabilities(r);if(typeof n=="number")return!(n&2048)}})}async d(t,i,s){const r=[];for(;!i.isEqual(s,i.dirname(s));)try{if(((await t.stat(s)).type&ss.Directory)===0)throw ii.FileExists(`Unable to create folder '${s.scheme===V.file?s.fsPath:s.toString(!0)}' that already exists but is not a directory`);break}catch(n){if(Vf(n)!==de.FileNotFound)throw n;r.push(i.basename(s)),s=i.dirname(s)}for(let n=r.length-1;n>=0;n--){s=i.joinPath(s,r[n]);try{await t.createDirectory(s)}catch(o){if(Vf(o)!==de.FileExists)throw o}}}static e(t){if(t instanceof ii)throw t;if(t instanceof qf)switch(t.code){case de.FileExists:throw ii.FileExists(t.message);case de.FileNotFound:throw ii.FileNotFound(t.message);case de.FileNotADirectory:throw ii.FileNotADirectory(t.message);case de.FileIsADirectory:throw ii.FileIsADirectory(t.message);case de.NoPermissions:throw ii.NoPermissions(t.message);case de.Unavailable:throw ii.Unavailable(t.message);default:throw new ii(t.message,t.name)}if(!(t instanceof Error))throw new ii(String(t));if(t.name==="ENOPRO"||t.message.includes("ENOPRO"))throw ii.Unavailable(t.message);switch(t.name){case de.FileExists:throw ii.FileExists(t.message);case de.FileNotFound:throw ii.FileNotFound(t.message);case de.FileNotADirectory:throw ii.FileNotADirectory(t.message);case de.FileIsADirectory:throw ii.FileIsADirectory(t.message);case de.NoPermissions:throw ii.NoPermissions(t.message);case de.Unavailable:throw ii.Unavailable(t.message);default:throw new ii(t.message,t.name)}}addFileSystemProvider(t,i,s){return this.b.set(t,{impl:i,extUri:s?.isCaseSensitive?tt:$O,isReadonly:!!s?.isReadonly}),se(()=>this.b.delete(t))}getFileSystemProviderExtUri(t){return this.b.get(t)?.extUri??tt}};wA=Lr=__decorate([__param(0,Te),__param(1,bc)],wA);var Yh=W("IExtHostConsumerFileSystem"),bA=W("IExtensionStoragePaths"),yA=class{constructor(t,i,s){this.d=i,this.f=s,this.a=t.workspace??void 0,this.b=t.environment,this.whenReady=this.h().then(r=>this.c=r)}async g(t){return y.joinPath(this.b.workspaceStorageHome,t)}async h(){if(!this.a)return Promise.resolve(void 0);const t=this.a.id,i=await this.g(t);try{return await this.f.value.stat(i),this.d.trace("[ExtHostStorage] storage dir already exists",i),i}catch{}try{return this.d.trace("[ExtHostStorage] creating dir and metadata-file",i),await this.f.value.createDirectory(i),await this.f.value.writeFile(y.joinPath(i,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this.a.id,configuration:y.revive(this.a.configuration)?.toString(),name:this.a.name},void 0,2))),i}catch(s){this.d.error("[ExtHostStorage]",s);return}}workspaceValue(t){if(this.c)return y.joinPath(this.c,t.identifier.value)}globalValue(t){return y.joinPath(this.b.globalStorageHome,t.identifier.value.toLowerCase())}onWillDeactivateAll(){}};yA=__decorate([__param(0,Wt),__param(1,xe),__param(2,Yh)],yA);var YB=W("tunnelService"),Kre=W("sharedTunnelsService"),Ms;(function(e){e.Http="http",e.Https="https"})(Ms||(Ms={}));var Or;(function(e){e.ConstantPrivate="constantPrivate",e.Private="private",e.Public="public"})(Or||(Or={}));function QB(e){return!!e.forwardPort}var Eo;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(Eo||(Eo={}));function XB(e){if(e.scheme!=="http"&&e.scheme!=="https")return;const t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(e.authority);if(t)return{address:t[1],port:+t[2]}}var Qh=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function ja(e){return Qh.indexOf(e)>=0}var Cm=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function fn(e){return Cm.indexOf(e)>=0}function KB(e,t,i,s){if(i===1)return!1;if(i===2&&fn(t)){const r=/(\d+)\.(\d+)\.(\d+)/g.exec(s);if(r?.length===4&&parseInt(r[1])>=18)return!1}return e<1024}var eq=class{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this.b=i,this.a=new I,this.onDidDispose=this.a.event}dispose(){return this.a.fire(),this.b()}},AA=class extends J{constructor(t,i){super(),this.q=t,this.r=i,this.a=new I,this.onTunnelOpened=this.a.event,this.b=new I,this.onTunnelClosed=this.b.event,this.c=new I,this.onAddedTunnelProvider=this.c.event,this.f=new Map,this.h=!1,this.j=!0,this.m=[],this.n=new Set}get hasTunnelProvider(){return!!this.g}get s(){const t=this.r.getValue("remote.localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(t){return this.g=t,t?(this.c.fire(),{dispose:()=>{this.g=void 0,this.h=!1,this.m=[]}}):(this.h=!1,this.m=[],this.c.fire(),{dispose:()=>{}})}setTunnelFeatures(t){this.h=t.elevation,this.m=t.privacyOptions,this.j=t.protocol}get canChangeProtocol(){return this.j}get canElevate(){return this.h}get canChangePrivacy(){return this.m.length>0}get privacyOptions(){return this.m}get tunnels(){return this.t()}async t(){const t=[],i=Array.from(this.f.values());for(const s of i){const r=Array.from(s.values());for(const n of r){const o=await n.value;o&&typeof o!="string"&&t.push(o)}}return t}async dispose(){super.dispose();for(const t of this.f.values()){for(const{value:i}of t.values())await i.then(s=>typeof s!="string"?s?.dispose():void 0);t.clear()}this.f.clear()}setEnvironmentTunnel(t,i,s,r,n){this.y(t,i,Promise.resolve({tunnelRemoteHost:t,tunnelRemotePort:i,localAddress:s,privacy:r,protocol:n,dispose:()=>Promise.resolve()}))}async getExistingTunnel(t,i){(fn(t)||ja(t))&&(t=Qh[0]);const s=this.C(t,i);if(s)return++s.refcount,s.value}openTunnel(t,i,s,r,n,o=!1,a,c){this.q.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${s} on local port ${n}.`);const l=this.g??t;if(!l)return;if(i||(i="localhost"),r||(r=this.s),this.g&&this.n.has(s)){this.q.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.F(l,i,s,r,n,o,a,c);return u?u.then(h=>{if(h){if(typeof h=="string")return this.q.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.z(i,s),h}else{this.q.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.z(i,s);return}this.q.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.u(h);return(h.tunnelRemoteHost!==i||h.tunnelRemotePort!==s)&&this.q.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&h.privacy!==a&&this.q.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this.a.fire(f),f}):(this.q.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}u(t){return{tunnelRemotePort:t.tunnelRemotePort,tunnelRemoteHost:t.tunnelRemoteHost,tunnelLocalPort:t.tunnelLocalPort,localAddress:t.localAddress,privacy:t.privacy,protocol:t.protocol,dispose:async()=>{this.q.trace(`ForwardedPorts: (TunnelService) dispose request for ${t.tunnelRemoteHost}:${t.tunnelRemotePort} `);const i=this.f.get(t.tunnelRemoteHost);if(i){const s=i.get(t.tunnelRemotePort);s&&(s.refcount--,await this.w(t.tunnelRemoteHost,t.tunnelRemotePort,s))}}}}async w(t,i,s){if(s.refcount<=0){this.q.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${t}:${i}.`);const r=s.value.then(async n=>{n&&typeof n!="string"&&(await n.dispose(!0),this.b.fire({host:n.tunnelRemoteHost,port:n.tunnelRemotePort}))});return this.f.has(t)&&this.f.get(t).delete(i),r}}async closeTunnel(t,i){this.q.trace(`ForwardedPorts: (TunnelService) close request for ${t}:${i} `);const s=this.f.get(t);if(s&&s.has(i)){const r=s.get(i);r.refcount=0,await this.w(t,i,r)}}y(t,i,s){this.f.has(t)||this.f.set(t,new Map),this.f.get(t).set(i,{refcount:1,value:s})}async z(t,i){const s=this.f.get(t);if(s){const r=s.get(i),n=r?await r.value:void 0;(!n||typeof n=="string")&&s.delete(i),s.size===0&&this.f.delete(t)}}C(t,i){const s=[t];ja(t)?(s.push(...Qh),s.push(...Cm)):fn(t)&&s.push(...Cm);const r=s.map(n=>this.f.get(n));for(const n of r){const o=n?.get(i);if(o)return o}}canTunnel(t){return!!XB(t)}G(t,i,s,r,n,o,a){this.q.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${s} on local port ${r}.`);const c=s;this.n.add(c);const l=r===void 0?s:r,u={elevationRequired:n?this.isPortPrivileged(l):!1},h={remoteAddress:{host:i,port:s},localAddressPort:r,privacy:o,public:o?o!==Or.Private:void 0,protocol:a},f=t.forwardPort(h,u);return f?(this.y(i,s,f),f.finally(()=>{this.q.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this.n.delete(c)})):this.n.delete(c),f}};AA=__decorate([__param(0,xe),__param(1,rs)],AA);var tq=class extends eq{},SA;(function(e){function t(s){return{remoteAddress:s.remoteAddress,localAddress:s.localAddress,public:!!s.public,privacy:s.privacy??(s.public?Or.Public:Or.Private),protocol:s.protocol}}e.fromApiTunnel=t;function i(s){return{remoteAddress:{host:s.tunnelRemoteHost,port:s.tunnelRemotePort},localAddress:s.localAddress,public:s.privacy!==Or.ConstantPrivate&&s.privacy!==Or.ConstantPrivate,privacy:s.privacy,protocol:s.protocol}}e.fromServiceTunnel=i})(SA||(SA={}));var km=W("IExtHostTunnelService"),$m=class extends J{constructor(t,i,s){super(),this.r=s,this.f=()=>Promise.resolve(!0),this.g=new Map,this.h=new I,this.onDidChangeTunnels=this.h.event,this.n=0,this.q=new Map,this.a=t.getProxy(Q.MainThreadTunnelService)}async openTunnel(t,i){this.r.trace(`ForwardedPorts: (ExtHostTunnelService) ${t.identifier.value} called openTunnel API for ${i.remoteAddress.host}:${i.remoteAddress.port}.`);const s=await this.a.$openTunnel(i,t.displayName);if(s){const r=new tq(s.remoteAddress,s.localAddress,()=>this.a.$closeTunnel(s.remoteAddress));return this.D(r),r}}async getTunnels(){return this.a.$getTunnels()}s(){return this.n++}registerPortsAttributesProvider(t,i){t.portRange===void 0&&t.commandPattern===void 0&&this.r.error("PortAttributesProvider must specify either a portRange or a commandPattern");const s=this.s();return this.q.set(s,{selector:t,provider:i}),this.a.$registerPortsAttributesProvider(t,s),new Pe(()=>{this.q.delete(s),this.a.$unregisterPortsAttributesProvider(s)})}async $providePortAttributes(t,i,s,r,n){const o=[];for(const c of t){const l=this.q.get(c);if(!l)return[];o.push(...await Promise.all(i.map(async u=>{let h;try{h=await l.provider.providePortAttributes({port:u,pid:s,commandLine:r},n)}catch{h=await l.provider.providePortAttributes(u,s,r,n)}return{providedAttributes:h,port:u}})))}const a=o.filter(c=>!!c.providedAttributes);return a.length>0?a.map(c=>({autoForwardAction:c.providedAttributes.autoForwardAction,port:c.port})):[]}async $registerCandidateFinder(t){}registerTunnelProvider(t,i){if(this.b)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this.b=async(r,n)=>await t.provideTunnel(r,n,De.None)??void 0;const s=i.tunnelFeatures?{elevation:!!i.tunnelFeatures?.elevation,privacyOptions:i.tunnelFeatures?.privacyOptions,protocol:i.tunnelFeatures.protocol===void 0?!0:i.tunnelFeatures.protocol}:void 0;return this.a.$setTunnelProvider(s,!0),Promise.resolve(se(()=>{this.b=void 0,this.a.$setTunnelProvider(void 0,!1)}))}hasTunnelProvider(){return this.a.$hasTunnelProvider()}async setTunnelFactory(t,i){if(t){t.candidatePortSource!==void 0&&this.a.$setCandidatePortSource(t.candidatePortSource),t.showCandidatePort&&(this.f=t.showCandidatePort,this.a.$setCandidateFilter());const s=t.tunnelFactory??(i?this.u(i):void 0);if(s){this.b=s;let r=t.tunnelFeatures?.privacyOptions??[];t.tunnelFeatures?.public&&r.length===0&&(r=[{id:"private",label:d(3054,null),themeIcon:"lock"},{id:"public",label:d(3055,null),themeIcon:"eye"}]);const n=t.tunnelFeatures?{elevation:!!t.tunnelFeatures?.elevation,public:!!t.tunnelFeatures?.public,privacyOptions:r,protocol:!0}:void 0;this.a.$setTunnelProvider(n,!!t.tunnelFactory)}}else this.b=void 0;return se(()=>{this.b=void 0})}u(t){}async $closeTunnel(t,i){if(this.g.has(t.host)){const s=this.g.get(t.host);s.has(t.port)&&(i&&s.get(t.port).disposeListener.dispose(),await s.get(t.port).tunnel.dispose(),s.delete(t.port))}}async $onDidTunnelsChange(){this.h.fire()}async $forwardPort(t,i){if(this.b)try{this.r.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const s=this.b(t,i);if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),s!==void 0){const r=await s;if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),r===void 0){this.r.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this.g.has(t.remoteAddress.host)||this.g.set(t.remoteAddress.host,new Map);const n=this.D(r.onDidDispose(()=>(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this.a.$closeTunnel(r.remoteAddress))));return this.g.get(t.remoteAddress.host).set(t.remoteAddress.port,{tunnel:r,disposeListener:n}),SA.fromApiTunnel(r)}else this.r.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(s){if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),s instanceof Error)return s.message}}async $applyCandidateFilter(t){const i=await Promise.all(t.map(r=>this.f(r.host,r.port,r.detail??""))),s=t.filter((r,n)=>i[n]);return this.r.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${t.map(r=>r.port).join(", ")} to ${s.map(r=>r.port).join(", ")}`),s}};$m=__decorate([__param(0,Te),__param(1,Wt),__param(2,xe)],$m);function iq(e){return[...e.entries()]}function sq(e){return e?[...e.entries()]:[]}var rq=class{constructor(e){this.b=e,this.a=new Map}dispose(){for(const e of this.a.values())e.dispose()}startBuffering(e,t,i=5){const s=t(r=>{const n=Oe(r)?r:r.data;let o=this.a.get(e);if(o){o.data.push(n);return}const a=setTimeout(()=>this.flushBuffer(e),i);o={data:[n],timeoutId:a,dispose:()=>{clearTimeout(a),this.flushBuffer(e),s.dispose()}},this.a.set(e,o)});return s}stopBuffering(e){this.a.get(e)?.dispose()}flushBuffer(e){const t=this.a.get(e);t&&(this.a.delete(e),this.b(e,t.data.join("")))}},Ua=(e,t,i,s)=>{let r=t;return{enumerable:!0,configurable:!1,get(){return r},set(n){if(!i(r,n)){const o=r;r=n,e.listener?.(s(n,o))}}}},Il=(e,t)=>e===t,xo={range:(e,t)=>e===t?!0:!e||!t?!1:e.isEqual(t),label:Il,description:Il,sortText:Il,busy:Il,error:Il,canResolveChildren:Il,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.find(s=>i.id===s.id)))},Dl=e=>t=>({op:4,update:e(t)}),nq=(e,t)=>({range:(()=>{let i;const s=Dl(r=>({range:ot.lift(U.from(r))}));return{enumerable:!0,configurable:!1,get(){return i},set(r){e.listener?.({op:6}),xo.range(i,r)||(i=r,e.listener?.(s(r)))}}})(),label:Ua(e,t,xo.label,Dl(i=>({label:i}))),description:Ua(e,void 0,xo.description,Dl(i=>({description:i}))),sortText:Ua(e,void 0,xo.sortText,Dl(i=>({sortText:i}))),canResolveChildren:Ua(e,!1,xo.canResolveChildren,i=>({op:2,state:i})),busy:Ua(e,!1,xo.busy,Dl(i=>({busy:i}))),error:Ua(e,void 0,xo.error,Dl(i=>({error:le.fromStrict(i)||null}))),tags:Ua(e,[],xo.tags,(i,s)=>({op:1,new:i.map(nr.from),old:s.map(nr.from)}))}),oq=e=>{const t=Je.fromString(e.extId),i=new Xh(t.controllerId,t.localId,e.label,y.revive(e.uri)||void 0);return i.range=U.to(e.range||void 0),i.description=e.description||void 0,i.sortText=e.sortText||void 0,i.tags=e.tags.map(s=>nr.to({id:U6(s).tagId})),i},G9=e=>{let t;for(const i of e.tests){const s=oq(i.item);kp(s).parent=t,t=s}return t},Xh=class iR{constructor(t,i,s,r){if(i.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(i)} symbol`);const n=S_(this,t);Object.defineProperties(this,{id:{value:i,enumerable:!0,writable:!1},uri:{value:r,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return n.parent instanceof EA?void 0:n.parent}},children:{value:A_(n,kp,iR),enumerable:!0,writable:!1},...nq(n,s)})}},EA=class extends Xh{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}},aq=class extends w_{constructor(e,t,i){super({controllerId:e,getDocumentVersion:s=>s&&i.getDocument(s)?.version,getApiFor:kp,getChildren:s=>s.children,root:new EA(e,t),toITestItem:yo.from})}},Kh;(function(e){e[e.Desktop=1]="Desktop",e[e.Web=2]="Web"})(Kh||(Kh={}));var J9;(function(e){e[e.VersionMismatch=55]="VersionMismatch",e[e.UnexpectedError=81]="UnexpectedError"})(J9||(J9={}));var Z9;(function(e){e[e.Initialized=0]="Initialized",e[e.Ready=1]="Ready",e[e.Terminate=2]="Terminate"})(Z9||(Z9={}));function Y9(e){const t=_.alloc(1);switch(e){case 0:t.writeUInt8(1,0);break;case 1:t.writeUInt8(2,0);break;case 2:t.writeUInt8(3,0);break}return t}function cq(e,t){if(e.byteLength!==1)return!1;switch(e.readUInt8(0)){case 1:return t===0;case 2:return t===1;case 3:return t===2;default:return!1}}var Q9;(function(e){e.Start="START_NATIVE_LOG",e.End="END_NATIVE_LOG"})(Q9||(Q9={}));var xA=class extends J{constructor(t,i,s){super(),this.n=i,this.a=this.D(new I),this.onDidChangeTelemetryEnabled=this.a.event,this.b=this.D(new I),this.onDidChangeTelemetryConfiguration=this.b.event,this.c={usage:!0,error:!0},this.f=0,this.h=!1,this.m=new Map,this.h=this.n.environment.isExtensionTelemetryLoggingOnly;const r=i.remote.isRemote?"remoteExtHostTelemetry":t?"workerExtHostTelemetry":"extHostTelemetry";this.j=this.D(s.createLogger(r,{name:d(3051,null,this.h?" (Not Sent)":""),hidden:!0,group:a_}))}getTelemetryConfiguration(){return this.f===3}getTelemetryDetails(){return{isCrashEnabled:this.f>=1,isErrorsEnabled:this.c.error?this.f>=2:!1,isUsageEnabled:this.c.usage?this.f>=3:!1}}instantiateLogger(t,i,s){const r=this.getTelemetryDetails(),n=new X9(i,s,t,this.j,this.h,this.getBuiltInCommonProperties(t),{isUsageEnabled:r.isUsageEnabled,isErrorsEnabled:r.isErrorsEnabled}),o=this.m.get(t.identifier.value)??[];return this.m.set(t.identifier.value,[...o,n]),n.apiTelemetryLogger}$initializeTelemetryLevel(t,i,s){this.f=t,this.c=s??{usage:!0,error:!0}}getBuiltInCommonProperties(t){const i=Object.create(null);switch(i["common.extname"]=`${t.publisher}.${t.name}`,i["common.extversion"]=t.version,i["common.vscodemachineid"]=this.n.telemetryInfo.machineId,i["common.vscodesessionid"]=this.n.telemetryInfo.sessionId,i["common.vscodecommithash"]=this.n.commit,i["common.sqmid"]=this.n.telemetryInfo.sqmId,i["common.devDeviceId"]=this.n.telemetryInfo.devDeviceId??this.n.telemetryInfo.machineId,i["common.vscodeversion"]=this.n.version,i["common.vscodereleasedate"]=this.n.date,i["common.isnewappinstall"]=K9(this.n.telemetryInfo.firstSessionDate),i["common.product"]=this.n.environment.appHost,this.n.uiKind){case Kh.Web:i["common.uikind"]="web";break;case Kh.Desktop:i["common.uikind"]="desktop";break;default:i["common.uikind"]="unknown"}return i["common.remotename"]=c_(this.n.remote.authority,this.n),i}$onDidChangeTelemetryLevel(t){this.g=this.getTelemetryConfiguration(),this.f=t;const i=this.getTelemetryDetails();this.m.forEach((s,r)=>{const n=s.filter(o=>!o.isDisposed);n.length===0?this.m.delete(r):this.m.set(r,n)}),this.m.forEach(s=>{for(const r of s)r.updateTelemetryEnablements(i.isUsageEnabled,i.isErrorsEnabled)}),this.g!==this.getTelemetryConfiguration()&&this.a.fire(this.getTelemetryConfiguration()),this.b.fire(this.getTelemetryDetails())}onExtensionError(t,i){const r=this.m.get(t.value)?.filter(o=>!o.isDisposed);if(!r)return this.m.delete(t.value),!1;let n=!1;for(const o of r)o.ignoreUnhandledExtHostErrors||(o.logError(i),n=!0);return n}};xA=__decorate([__param(1,Wt),__param(2,Zn)],xA);var X9=class{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,s,r,n,o){this.g=i,this.h=s,this.i=r,this.j=n,this.a=new I,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this.b=t?.ignoreBuiltInCommonProperties??!1,this.c=t?.additionalCommonProperties,this.f=e,this.d={isUsageEnabled:o.isUsageEnabled,isErrorsEnabled:o.isErrorsEnabled}}updateTelemetryEnablements(e,t){this.e&&(this.d={isUsageEnabled:e,isErrorsEnabled:t},this.a.fire(this.e))}mixInCommonPropsAndCleanData(e){let t=e.properties?e.properties??{}:e;return t=bD(t,[]),this.c&&(t=Xr(t,this.c)),this.b||(t=Xr(t,this.j)),e.properties?e.properties=t:e=t,e}k(e,t){this.f&&(this.g.publisher==="vscode"?e=this.g.name+"/"+e:e=this.g.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this.i||this.f?.sendEventData(e,t),this.h.trace(e,t))}logUsage(e,t){this.d.isUsageEnabled&&this.k(e,t)}logError(e,t){if(!(!this.d.isErrorsEnabled||!this.f))if(typeof e=="string")this.k(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},s=bD(i,[]),r=new Error(typeof s.message=="string"?s.message:void 0,{cause:s.cause});r.stack=typeof s.stack=="string"?s.stack:void 0,r.name=typeof s.name=="string"?s.name:"unknown",t=this.mixInCommonPropsAndCleanData(t||{}),this.i||this.f.sendErrorData(r,t),this.h.trace("exception",t)}}get apiTelemetryLogger(){if(!this.e){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e.d.isUsageEnabled},get isErrorsEnabled(){return e.d.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e.a.event.bind(e)};this.e=Object.freeze(t)}return this.e}get isDisposed(){return!this.f}dispose(){if(this.f?.flush){let e=this.f;this.f=void 0,Promise.resolve(e.flush()).then(e=void 0),this.e=void 0}else this.f=void 0}};function K9(e){const t=Date.now()-new Date(e).getTime();return isNaN(t)?!1:t<1e3*60*60*24}var Im=W("IExtHostTelemetry"),CA=class{#e;#t;#i;constructor(t,i,s){this.b=new Map,this.c=new Map,this.#e=t.getProxy(Q.MainThreadCommands),this.d=i,this.#i=s,this.#t=t.getProxy(Q.MainThreadTelemetry),this.converter=new lq(this,r=>{const n=this.c.get(r);return n?.result===ye.Void?n:void 0},i),this.f=[{processArgument(r){return ei(r)}},{processArgument(r){return gc(r,function(n){if(ot.isIRange(n))return U.to(n);if(ws.isIPosition(n))return et.to(n);if(ot.isIRange(n.range)&&y.isUri(n.uri))return Bi.to(n);if(n instanceof _)return n.buffer.buffer;if(!Array.isArray(n))return n})}}]}registerArgumentProcessor(t){this.f.push(t)}registerApiCommand(t){const i=this.registerCommand(!1,t.id,async(...s)=>{const r=t.args.map((o,a)=>{if(!o.validate(s[a]))throw new Error(`Invalid argument '${o.name}' when running '${t.id}', received: ${typeof s[a]=="object"?JSON.stringify(s[a],null,"	"):s[a]} `);return o.convert(s[a])}),n=await this.executeCommand(t.internalId,...r);return t.result.convert(n,s,this.converter)},void 0,{description:t.description,args:t.args,returns:t.result.description});return this.c.set(t.id,t),new Pe(()=>{i.dispose(),this.c.delete(t.id)})}registerCommand(t,i,s,r,n,o){if(this.d.trace("ExtHostCommands#registerCommand",i),!i.trim().length)throw new Error("invalid id");if(this.b.has(i))throw new Error(`command '${i}' already exists`);return this.b.set(i,{callback:s,thisArg:r,metadata:n,extension:o}),t&&this.#e.$registerCommand(i),new Pe(()=>{this.b.delete(i)&&t&&this.#e.$unregisterCommand(i)})}executeCommand(t,...i){return this.d.trace("ExtHostCommands#executeCommand",t),this.g(t,i,!0)}async g(t,i,s){if(this.b.has(t))return this.#e.$fireCommandActivationEvent(t),this.h(t,i,!1);{let r=!1;const n=gc(i,function(o){if(o instanceof Re)return et.from(o);if(o instanceof ke)return U.from(o);if(o instanceof ns)return Bi.from(o);if($r.isNotebookRange(o))return Rr.from(o);if(o instanceof ArrayBuffer)return r=!0,_.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return r=!0,_.wrap(o);if(o instanceof _)return r=!0,o;if(!Array.isArray(o))return o});try{const o=await this.#e.$executeCommand(t,r?new Si(n):n,s);return ei(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this.g(t,i,!1);throw o}}}async h(t,i,s){const r=this.b.get(t);if(!r)throw new Error("Unknown command");const{callback:n,thisArg:o,metadata:a}=r;if(a?.args)for(let l=0;l<a.args.length;l++)try{Cx(i[l],a.args[l].constraint)}catch{throw new Error(`Running the contributed command: '${t}' failed. Illegal argument '${a.args[l].name}' - ${a.args[l].description}`)}const c=Qi.create();try{return await n.apply(o,i)}catch(l){if(t===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...i);u&&(t=u.command)}if(ki(l)||this.d.error(l,t,r.extension?.identifier),!s)throw l;if(r.extension?.identifier){const u=this.#i.onExtensionError(r.extension.identifier,l);this.d.trace("forwarded error to extension?",u,r.extension?.identifier)}throw new class extends Error{constructor(){super(yr(l)),this.id=t,this.source=r.extension?.displayName??r.extension?.name}}}finally{this.j(r,t,c.elapsed())}}j(t,i,s){t.extension&&(i.startsWith("code.copilot.logStructured")||this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:t.extension.identifier.value,id:new Uw(i),duration:s}))}$executeContributedCommand(t,...i){this.d.trace("ExtHostCommands#$executeContributedCommand",t);const s=this.b.get(t);return s?(i=i.map(r=>this.f.reduce((n,o)=>o.processArgument(n,s.extension),r)),this.h(t,i,!0)):Promise.reject(new Error(`Contributed command '${t}' does not exist.`))}getCommands(t=!1){return this.d.trace("ExtHostCommands#getCommands",t),this.#e.$getCommands().then(i=>(t&&(i=i.filter(s=>s[0]!=="_")),i))}$getContributedCommandMetadata(){const t=Object.create(null);for(const[i,s]of this.b){const{metadata:r}=s;r&&(t[i]=r)}return Promise.resolve(t)}};CA=__decorate([__param(0,Te),__param(1,xe),__param(2,Im)],CA);var Ns=W("IExtHostCommands"),lq=class{constructor(e,t,i){this.d=e,this.f=t,this.g=i,this.delegatingCommandId=`__vsc${At()}`,this.b=new Map,this.c=0,this.d.registerCommand(!0,this.delegatingCommandId,this.h,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const s=this.f(e.command);if(s)i.id=s.internalId,i.arguments=s.args.map((r,n)=>r.convert(e.arguments&&e.arguments[n]));else if(au(e.arguments)){const r=`${e.command} /${++this.c}`;this.b.set(r,e),t.add(se(()=>{this.b.delete(r),this.g.trace("CommandsConverter#DISPOSE",r)})),i.$ident=r,i.id=this.delegatingCommandId,i.arguments=[r],this.g.trace("CommandsConverter#CREATE",e.command,r)}return i}fromInternal(e){return typeof e.$ident=="string"?this.b.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this.b.get(e[0])}h(...e){const t=this.getActualCommand(...e);return this.g.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this.d.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}},q=class us{static{this.Uri=new us("uri","Uri of a text document",t=>y.isUri(t),t=>t)}static{this.Position=new us("position","A position in a text document",t=>Re.isPosition(t),et.from)}static{this.Range=new us("range","A range in a text document",t=>ke.isRange(t),U.from)}static{this.Selection=new us("selection","A selection in a text document",t=>Ir.isSelection(t),sr.from)}static{this.Number=new us("number","",t=>typeof t=="number",t=>t)}static{this.String=new us("string","",t=>typeof t=="string",t=>t)}static Arr(t){return new us(`${t.name}_array`,`Array of ${t.name}, ${t.description}`,i=>Array.isArray(i)&&i.every(s=>t.validate(s)),i=>i.map(s=>t.convert(s)))}static{this.CallHierarchyItem=new us("item","A call hierarchy item",t=>t instanceof Qw,Pa.from)}static{this.TypeHierarchyItem=new us("item","A type hierarchy item",t=>t instanceof Mb,Ma.from)}static{this.TestItem=new us("testItem","A VS Code TestItem",t=>t instanceof Xh,yo.from)}static{this.TestProfile=new us("testProfile","A VS Code test profile",t=>t instanceof BD,$y.from)}constructor(t,i,s,r){this.name=t,this.description=i,this.validate=s,this.convert=r}optional(){return new us(this.name,`(optional) ${this.description}`,t=>t==null||this.validate(t),t=>t===void 0?void 0:t===null?null:this.convert(t))}with(t,i){return new us(t??this.name,i??this.description,this.validate,this.convert)}},ye=class sR{static{this.Void=new sR("no result",t=>t)}constructor(t,i){this.description=t,this.convert=i}},Se=class{constructor(e,t,i,s,r){this.id=e,this.internalId=t,this.description=i,this.args=s,this.result=r}},pn=W("IExtHostTerminalService"),kA=class extends J{constructor(e,t,i,s){super(),this.s=e,this._id=t,this.u=i,this.w=s,this.a=!1,this.m={isInteractedWith:!1,shell:void 0},this.isOpen=!1,this.q=this.D(new I),this.onWillDispose=this.q.event,this.u=Object.freeze(this.u),this.b=new Promise(n=>this.g=n);const r=this;this.value={get name(){return r.w||""},get processId(){return r.b},get creationOptions(){return r.u},get exitStatus(){return r.j},get state(){return r.m},get selection(){return r.n},get shellIntegration(){return r.shellIntegration},sendText(n,o=!0){r.z(),r.s.$sendText(r._id,n,o)},show(n){r.z(),r.s.$show(r._id,n)},hide(){r.z(),r.s.$hide(r._id)},dispose(){r.a||(r.a=!0,r.s.$dispose(r._id))},get dimensions(){if(!(r.f===void 0||r.h===void 0))return{columns:r.f,rows:r.h}}}}dispose(){this.q.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this.s.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:t8(e.iconPath)??void 0,color:yc.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:t?.forceShellIntegration??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this.y(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0,shellIntegrationNonce:e.shellIntegrationNonce??void 0})}async createExtensionTerminal(e,t,i,s,r,n){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this.s.$createTerminal(this._id,{name:this.w,isExtensionCustomPtyTerminal:!0,icon:s,color:yc.isThemeColor(r)?r.id:void 0,location:t?.location||this.y(e,i),isTransient:!0,shellIntegrationNonce:n??void 0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}y(e,t){return typeof e=="object"?Dn(e,{parentTerminal:!0})&&e.parentTerminal&&t?{parentTerminal:t}:Dn(e,{viewColumn:!0})?{viewColumn:si.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}z(){if(this.a)throw new Error("Terminal has already been disposed")}set name(e){this.w=e}setExitStatus(e,t){this.j=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this.f&&t===this.h||e===0||t===0?!1:(this.f=e,this.h=t,!0)}setInteractedWith(){return this.m.isInteractedWith?!1:(this.m={...this.m,isInteractedWith:!0},!0)}setShellType(e){return this.m.shell!==e?(this.m={...this.m,shell:e},!0):!1}setSelection(e){this.n=e}_setProcessId(e){this.g?(this.g(e),this.g=void 0):this.b.then(t=>{t!==e&&(this.b=Promise.resolve(e))})}},$A=class{get onProcessReady(){return this.b.event}constructor(e){this.g=e,this.id=0,this.shouldPersist=!1,this.a=new I,this.onProcessData=this.a.event,this.b=new I,this.d=new I,this.onDidChangeProperty=this.d.event,this.f=new I,this.onProcessExit=this.f.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this.g.close()}input(e){this.g.handleInput?.(e)}sendSignal(e){}resize(e,t){this.g.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this.g.onDidWrite(t=>this.a.fire(t)),this.g.onDidClose?.((t=void 0)=>{this.f.fire(t===void 0?void 0:t)}),this.g.onDidOverrideDimensions?.(t=>{t&&this.d.fire({type:"overrideDimensions",value:{cols:t.columns,rows:t.rows}})}),this.g.onDidChangeName?.(t=>{this.d.fire({type:"title",value:t})}),this.g.open(e||void 0),e&&this.g.setDimensions?.(e),this.b.fire({pid:-1,cwd:"",windowsPty:void 0})}},uq=1,Dm=class extends J{get activeTerminal(){return this.b?.value}get terminals(){return this.f.map(t=>t.value)}constructor(t,i,s){super(),this.R=i,this.f=[],this.g=new Map,this.h={},this.j={},this.m={},this.n=new Map,this.u=this.D(new Hs),this.y=new Set,this.z=new Map,this.C=new Map,this.F=new Map,this.G=new Map,this.H=new Map,this.I=new I,this.onDidCloseTerminal=this.I.event,this.J=new I,this.onDidOpenTerminal=this.J.event,this.L=new I,this.onDidChangeActiveTerminal=this.L.event,this.M=new I,this.onDidChangeTerminalDimensions=this.M.event,this.N=new I,this.onDidChangeTerminalState=this.N.event,this.O=new I,this.onDidChangeShell=this.O.event,this.P=new I({onWillAddFirstListener:()=>this.a.$startSendingDataEvents(),onDidRemoveLastListener:()=>this.a.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this.P.event,this.Q=new I({onWillAddFirstListener:()=>this.a.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this.a.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this.Q.event,this.a=s.getProxy(Q.MainThreadTerminalService),this.w=new rq(this.a.$sendProcessData),this.a.$registerProcessSupport(t),this.R.registerArgumentProcessor({processArgument:r=>{const n=o=>this.getTerminalById(o.instanceId)?.value;switch(r?.$mid){case 15:return n(r);default:{if(Array.isArray(r))for(let o=0;o<r.length&&r[o].$mid===15;o++)r[o]=n(r[o]);return r}}}}),this.D({dispose:()=>{for(const[r,n]of this.g)n.shutdown(!0)}})}getDefaultShell(t){return(t?this.s:this.q)?.path||""}getDefaultShellArgs(t){return(t?this.s:this.q)?.args||[]}createExtensionTerminal(t,i){const s=new kA(this.a,At(),t,t.name),r=new $A(t.pty);return s.createExtensionTerminal(t.location,i,this.S(t,i).resolvedExtHostIdentifier,t8(t.iconPath),dq(t.color),t.shellIntegrationNonce).then(n=>{const o=this.U(n,r);this.h[n]=o}),this.f.push(s),s.value}S(t,i){if(i=i||{},t.location&&typeof t.location=="object"&&Dn(t.location,{parentTerminal:!0})){const s=t.location.parentTerminal;if(s){const r=this.f.find(n=>n.value===s);r&&(i.resolvedExtHostIdentifier=r._id)}}else t.location&&typeof t.location!="object"?i.location=t.location:i.location&&typeof i.location=="object"&&Dn(i.location,{splitActiveTerminal:!0})&&(i.location={splitActiveTerminal:!0});return i}attachPtyToTerminal(t,i){if(!this.getTerminalById(t))throw new Error(`Cannot resolve terminal with id ${t} for virtual process`);const r=new $A(i),n=this.U(t,r);this.h[t]=n}async $acceptActiveTerminalChanged(t){const i=this.b;if(t===null){this.b=void 0,i!==this.b&&this.L.fire(this.b);return}const s=this.getTerminalById(t);s&&(this.b=s,i!==this.b&&this.L.fire(this.b.value))}async $acceptTerminalProcessData(t,i){const s=this.getTerminalById(t);s&&this.P.fire({terminal:s.value,data:i})}async $acceptTerminalDimensions(t,i,s){const r=this.getTerminalById(t);r&&r.setDimensions(i,s)&&this.M.fire({terminal:r.value,dimensions:r.value.dimensions})}async $acceptDidExecuteCommand(t,i){const s=this.getTerminalById(t);s&&this.Q.fire({terminal:s.value,...i})}async $acceptTerminalMaximumDimensions(t,i,s){this.g.get(t)?.resize(i,s)}async $acceptTerminalTitleChange(t,i){const s=this.getTerminalById(t);s&&(s.name=i)}async $acceptTerminalClosed(t,i,s){const r=this.Y(this.f,t);if(r!==null){const n=this.f.splice(r,1)[0];n.setExitStatus(i,s),this.I.fire(n.value)}}$acceptTerminalOpened(t,i,s,r){if(i){const a=this.Y(this.f,i);if(a!==null){this.f[a]._id=t,this.J.fire(this.terminals[a]),this.f[a].isOpen=!0;return}}const n={name:r.name,shellPath:r.executable,shellArgs:r.args,cwd:typeof r.cwd=="string"?r.cwd:y.revive(r.cwd),env:r.env,hideFromUser:r.hideFromUser},o=new kA(this.a,t,n,s);this.f.push(o),this.J.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(t,i){this.getTerminalById(t)?._setProcessId(i)}async $startExtensionTerminal(t,i){const s=this.getTerminalById(t);if(!s)return{message:d(3052,null,t)};s.isOpen||await new Promise(n=>{const o=this.onDidOpenTerminal(async a=>{a===s.value&&(o.dispose(),n())})});const r=this.g.get(t);r?r.startSendingEvents(i):this.j[t]={initialDimensions:i}}U(t,i){const s=new X;s.add(i.onProcessReady(n=>this.a.$sendProcessReady(t,n.pid,n.cwd,n.windowsPty))),s.add(i.onDidChangeProperty(n=>this.a.$sendProcessProperty(t,n))),this.w.startBuffering(t,i.onProcessData),s.add(i.onProcessExit(n=>this.W(t,n))),this.g.set(t,i);const r=this.j[t];return r&&i instanceof $A&&(i.startSendingEvents(r.initialDimensions),delete this.j[t]),s}$acceptProcessAckDataEvent(t,i){this.g.get(t)?.acknowledgeDataEvent(i)}$acceptProcessInput(t,i){this.g.get(t)?.input(i)}$acceptTerminalInteraction(t){const i=this.getTerminalById(t);i?.setInteractedWith()&&this.N.fire(i.value)}$acceptTerminalSelection(t,i){this.getTerminalById(t)?.setSelection(i)}$acceptProcessResize(t,i,s){try{this.g.get(t)?.resize(i,s)}catch(r){if(r.code!=="EPIPE"&&r.code!=="ERR_IPC_CHANNEL_CLOSED")throw r}}$acceptProcessShutdown(t,i){this.g.get(t)?.shutdown(i)}$acceptProcessRequestInitialCwd(t){this.g.get(t)?.getInitialCwd().then(i=>this.a.$sendProcessProperty(t,{type:"initialCwd",value:i}))}$acceptProcessRequestCwd(t){this.g.get(t)?.getCwd().then(i=>this.a.$sendProcessProperty(t,{type:"cwd",value:i}))}$acceptProcessRequestLatency(t){return Promise.resolve(t)}registerProfileProvider(t,i,s){if(this.C.has(i))throw new Error(`Terminal profile provider "${i}" already registered`);return this.C.set(i,s),this.a.$registerProfileProvider(i,t.identifier.value),new Pe(()=>{this.C.delete(i),this.a.$unregisterProfileProvider(i)})}registerTerminalCompletionProvider(t,i,...s){if(this.z.has(t.identifier.value))throw new Error(`Terminal completion provider "${t.identifier.value}" already registered`);return this.z.set(t.identifier.value,i),this.a.$registerCompletionProvider(t.identifier.value,t.identifier.value,...s),new Pe(()=>{this.z.delete(t.identifier.value),this.a.$unregisterCompletionProvider(t.identifier.value)})}async $provideTerminalCompletions(t,i){const s=new Ke().token;if(s.isCancellationRequested||!this.activeTerminal)return;const r=this.z.get(t);if(!r)return;const n=await r.provideTerminalCompletions(this.activeTerminal,i,s);if(n==null)return;const o=!ze||this.activeTerminal.state?.shell==="gitbash"?"/":"\\";return Uy.from(n,o)}$acceptTerminalShellType(t,i){const s=this.getTerminalById(t);s?.setShellType(i)&&this.N.fire(s.value)}registerTerminalQuickFixProvider(t,i,s){if(this.F.has(t))throw new Error(`Terminal quick fix provider "${t}" is already registered`);return this.F.set(t,s),this.a.$registerQuickFixProvider(t,i),new Pe(()=>{this.F.delete(t),this.a.$unregisterQuickFixProvider(t)})}async $provideTerminalQuickFixes(t,i){const s=new Ke().token;if(s.isCancellationRequested)return;const r=this.F.get(t);if(!r)return;const n=await r.provideTerminalQuickFixes(i,s);if(n===null||Array.isArray(n)&&n.length===0)return;const o=new X;if(this.u.value=o,!Array.isArray(n))return n?cm.from(n,this.R.converter,o):void 0;const a=[];for(const c of n){const l=cm.from(c,this.R.converter,o);l&&a.push(l)}return a}async $createContributedProfileTerminal(t,i){const s=new Ke().token;let r=await this.C.get(t)?.provideTerminalProfile(s);if(!s.isCancellationRequested){if(r&&!Dn(r,{options:!0})&&(r={options:r}),!r||!Dn(r,{options:!0}))throw new Error(`No terminal profile options provided for id "${t}"`);if(Dn(r.options,{pty:!0})){this.createExtensionTerminal(r.options,i);return}this.createTerminalFromOptions(r.options,i)}}registerLinkProvider(t){return this.y.add(t),this.y.size===1&&this.a.$startLinkProvider(),new Pe(()=>{this.y.delete(t),this.y.size===0&&this.a.$stopLinkProvider()})}async $provideLinks(t,i){const s=this.getTerminalById(t);if(!s)return[];this.G.delete(t),this.H.get(t)?.dispose(!0);const n=new Ke;this.H.set(t,n);const o=[],a={terminal:s.value,line:i},c=[];for(const h of this.y)c.push(Hn.withAsyncBody(async f=>{n.token.onCancellationRequested(()=>f({provider:h,links:[]}));const p=await h.provideTerminalLinks(a,n.token)||[];n.token.isCancellationRequested||f({provider:h,links:p})}));const l=await Promise.all(c);if(n.token.isCancellationRequested)return[];const u=new Map;for(const h of l)h&&h.links.length>0&&o.push(...h.links.map(f=>{const p={id:uq++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(p.id,{provider:h.provider,link:f}),p}));return this.G.set(t,u),o}$activateLink(t,i){const s=this.G.get(t)?.get(i);s&&s.provider.handleTerminalLink(s.link)}W(t,i){this.w.stopBuffering(t),this.g.delete(t),delete this.j[t];const s=this.h[t];s&&(s.dispose(),delete this.h[t]),this.a.$sendProcessExit(t,i)}getTerminalById(t){return this.X(this.f,t)}getTerminalIdByApiObject(t){const i=this.f.findIndex(s=>s.value===t);return i>=0?i:null}X(t,i){const s=this.Y(t,i);return s!==null?t[s]:null}Y(t,i){const s=t.findIndex(r=>r._id===i);return s>=0?s:null}getEnvironmentVariableCollection(t){let i=this.n.get(t.identifier.value);return i||(i=this.D(new e8),this.$(t.identifier.value,i)),i.getScopedEnvironmentVariableCollection(void 0)}Z(t,i){const s=iq(i.map),r=sq(i.descriptionMap);this.a.$setEnvironmentVariableCollection(t,i.persistent,s.length===0?void 0:s,r)}$initEnvironmentVariableCollections(t){t.forEach(i=>{const s=i[0],r=this.D(new e8(i[1]));this.$(s,r)})}$acceptDefaultProfile(t,i){const s=this.q;this.q=t,this.s=i,s?.path!==t.path&&this.O.fire(t.path)}$(t,i){this.n.set(t,i),this.D(i.onDidChangeCollection(()=>{this.Z(t,i)}))}};Dm=__decorate([__param(1,Ns),__param(2,Te)],Dm);var e8=class extends J{get persistent(){return this.b}set persistent(e){this.b=e,this.f.fire()}get onDidChangeCollection(){return this.f&&this.f.event}constructor(e){super(),this.map=new Map,this.a=new Map,this.descriptionMap=new Map,this.b=!0,this.f=new I,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.j(e);let i=this.a.get(t);return i||(i=new hq(this,e),this.a.set(t,i),this.D(i.onDidChangeCollection(()=>this.f.fire()))),i}replace(e,t,i,s){this.g(e,{value:t,type:Fc.Replace,options:i??{applyAtProcessCreation:!0},scope:s})}append(e,t,i,s){this.g(e,{value:t,type:Fc.Append,options:i??{applyAtProcessCreation:!0},scope:s})}prepend(e,t,i,s){this.g(e,{value:t,type:Fc.Prepend,options:i??{applyAtProcessCreation:!0},scope:s})}g(e,t){if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.h(e,t.scope),s=this.map.get(i),r=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!s||s.value!==t.value||s.type!==t.type||s.options?.applyAtProcessCreation!==r.applyAtProcessCreation||s.options?.applyAtShellIntegration!==r.applyAtShellIntegration||s.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){const n=this.h(e,t.scope),o={variable:e,...t,options:r};this.map.set(n,o),this.f.fire()}}get(e,t){const i=this.h(e,t),s=this.map.get(i);return s?i8(s):void 0}h(e,t){const i=this.j(t);return i.length?`${e}:::${i}`:e}j(e){return this.m(e?.workspaceFolder)??""}m(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,s]of this.map)this.j(s.scope)===this.j(e)&&t.set(s.variable,i8(s));return t}delete(e,t){const i=this.h(e,t);this.map.delete(i),this.f.fire()}clear(e){if(e?.workspaceFolder){for(const[t,i]of this.map)i.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.n(e)}else this.map.clear(),this.descriptionMap.clear();this.f.fire()}setDescription(e,t){const i=this.j(t),s=this.descriptionMap.get(i);if(!s||s.description!==e){let r;typeof e=="string"?r=e:r=e?.value.split(`

`)[0];const n={description:r,scope:t};this.descriptionMap.set(i,n),this.f.fire()}}getDescription(e){const t=this.j(e);return this.descriptionMap.get(t)?.description}n(e){const t=this.j(e);this.descriptionMap.delete(t)}},hq=class{get persistent(){return this.b.persistent}set persistent(e){this.b.persistent=e}get onDidChangeCollection(){return this.a&&this.a.event}constructor(e,t){this.b=e,this.d=t,this.a=new I}getScoped(e){return this.b.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.b.replace(e,t,i,this.d)}append(e,t,i){this.b.append(e,t,i,this.d)}prepend(e,t,i){this.b.prepend(e,t,i,this.d)}get(e){return this.b.get(e,this.d)}forEach(e,t){this.b.getVariableMap(this.d).forEach((i,s)=>e.call(t,s,i,this),this.d)}[Symbol.iterator](){return this.b.getVariableMap(this.d).entries()}delete(e){this.b.delete(e,this.d),this.a.fire(void 0)}clear(){this.b.clear(this.d)}set description(e){this.b.setDescription(e,this.d)}get description(){return this.b.getDescription(this.d)}},IA=class extends Dm{constructor(t,i){super(!1,t,i)}createTerminal(t,i,s){throw new I1}createTerminalFromOptions(t,i){throw new I1}};IA=__decorate([__param(0,Ns),__param(1,Te)],IA);function t8(e){if(!(!e||typeof e=="string"))return Dn(e,{id:!0})?{id:e.id,color:e.color}:e}function dq(e){return yc.isThemeColor(e)?e:void 0}function i8(e){const t={...e};return delete t.scope,t.options=t.options??void 0,t}var fq=W("progressService"),s8;(function(e){e[e.Explorer=1]="Explorer",e[e.Scm=3]="Scm",e[e.Extensions=5]="Extensions",e[e.Window=10]="Window",e[e.Notification=15]="Notification",e[e.Dialog=20]="Dialog"})(s8||(s8={}));var ane=Object.freeze({total(){},worked(){},done(){}}),Pm=class{static{this.None=Object.freeze({report(){}})}get value(){return this.a}constructor(e){this.b=e}report(e){this.a=e,this.b(this.a)}},r8=class extends J{constructor(t,i){super(),this.a=new Di,i.withProgress(t,s=>(this.b=s,this.c&&s.report(this.c),this.a.p)),this.D(se(()=>this.a.complete()))}report(t){this.b?this.b.report(t):this.c=t}};r8=__decorate([__param(1,fq)],r8);var lne=W("editorProgressService"),pq={label:d(7260,null),order:Number.MAX_SAFE_INTEGER},n8="__";function gq(e){return typeof e=="object"&&e!==null&&"wwwAuthenticate"in e&&typeof e.wwwAuthenticate=="string"}var mq=W("IAuthenticationService"),une=W("IAuthenticationExtensionsService"),DA="/.well-known",vq=`${DA}/oauth-protected-resource`,wq=`${DA}/oauth-authorization-server`,PA=`${DA}/openid-configuration`,TA=" ",o8;(function(e){e.InvalidRequest="invalid_request",e.InvalidClient="invalid_client",e.InvalidGrant="invalid_grant",e.UnauthorizedClient="unauthorized_client",e.UnsupportedGrantType="unsupported_grant_type",e.InvalidScope="invalid_scope"})(o8||(o8={}));var a8;(function(e){e.AuthorizationPending="authorization_pending",e.SlowDown="slow_down",e.AccessDenied="access_denied",e.ExpiredToken="expired_token"})(a8||(a8={}));var c8;(function(e){e.InvalidRedirectUri="invalid_redirect_uri",e.InvalidClientMetadata="invalid_client_metadata",e.InvalidSoftwareStatement="invalid_software_statement",e.UnapprovedSoftwareStatement="unapproved_software_statement"})(c8||(c8={}));function bq(e){if(typeof e!="object"||e===null)return!1;const t=e;return!(!t.resource||t.scopes_supported!==void 0&&!Array.isArray(t.scopes_supported))}var yq=["issuer","authorization_endpoint","token_endpoint","registration_endpoint","jwks_uri"];function Aq(e){if(typeof e!="object"||e===null)return!1;const t=e;if(!t.issuer)throw new Error("Authorization server metadata must have an issuer");for(const i of yq)if(t[i]){if(typeof t[i]!="string")throw new Error(`Authorization server metadata '${i}' must be a string`);if(!t[i].startsWith("https://")&&!t[i].startsWith("http://"))throw new Error(`Authorization server metadata '${i}' must start with http:// or https://`)}return!0}function Sq(e){return typeof e!="object"||e===null?!1:e.client_id!==void 0}function MA(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.access_token!==void 0&&t.token_type!==void 0}function Eq(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.device_code!==void 0&&t.user_code!==void 0&&t.verification_uri!==void 0&&t.expires_in!==void 0}function l8(e){return typeof e!="object"||e===null?!1:e.error!==void 0}function xq(e){return typeof e!="object"||e===null?!1:e.error!==void 0}function Cq(e){return{issuer:e.toString(),authorization_endpoint:new URL("/authorize",e).toString(),token_endpoint:new URL("/token",e).toString(),registration_endpoint:new URL("/register",e).toString(),response_types_supported:["code","id_token","id_token token"]}}var u8=["authorization_code","refresh_token","urn:ietf:params:oauth:grant-type:device_code"],h8=33418;async function d8(e,t,i){if(!e.registration_endpoint)throw new Error("Server does not support dynamic registration");const s={client_name:t,client_uri:"https://code.visualstudio.com",grant_types:e.grant_types_supported?e.grant_types_supported.filter(o=>u8.includes(o)):u8,response_types:["code"],redirect_uris:["https://insiders.vscode.dev/redirect","https://vscode.dev/redirect","http://127.0.0.1/",`http://127.0.0.1:${h8}/`],scope:i?.join(TA),token_endpoint_auth_method:"none",application_type:"native"},r=await fetch(e.registration_endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const o=await r.text();let a=o;try{const c=JSON.parse(o);xq(c)&&(a=`${c.error}${c.error_description?`: ${c.error_description}`:""}`)}catch{}throw new Error(`Registration to ${e.registration_endpoint} failed: ${a}`)}const n=await r.json();if(Sq(n))return n;throw new Error(`Invalid authorization dynamic client registration response: ${JSON.stringify(n)}`)}function f8(e){const t=[],i=[];let s="",r=!1;for(let o=0;o<e.length;o++){const a=e[o];a==='"'?(r=!r,s+=a):a===","&&!r?(s.trim()&&i.push(s.trim()),s=""):s+=a}s.trim()&&i.push(s.trim());let n;for(const o of i)if(!o.includes("="))n&&t.push(n),n={scheme:o.trim(),params:{}};else{const c=o.indexOf(" ");if(c>0){const l=o.substring(0,c),u=o.substring(c+1);if(!l.includes("=")&&u.includes("=")){n&&t.push(n),n={scheme:l.trim(),params:{}};const h=u.indexOf("=");if(h>0){const f=u.substring(0,h).trim(),p=u.substring(h+1).trim().replace(/^"|"$/g,"");f&&p!==void 0&&(n.params[f]=p)}continue}}if(n){const l=o.indexOf("=");if(l>0){const u=o.substring(0,l).trim(),h=o.substring(l+1).trim().replace(/^"|"$/g,"");u&&h!==void 0&&(n.params[u]=h)}}}return n&&t.push(n),t}function p8(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid JWT token format: token must have three parts separated by dots");const[i,s,r]=t;try{if(typeof JSON.parse(Wn(i).toString())!="object")throw new Error("Invalid JWT token format: header is not a JSON object");const o=JSON.parse(Wn(s).toString());if(typeof o!="object")throw new Error("Invalid JWT token format: payload is not a JSON object");return o}catch(n){throw n instanceof Error?new Error(`Failed to parse JWT token: ${n.message}`):new Error("Failed to parse JWT token")}}function kq(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;const i=[...e].sort(),s=[...t].sort();return i.every((r,n)=>r===s[n])}async function $q(e,t,i={}){const{sameOriginHeaders:s={},fetch:r=fetch}=i,n=new URL(e),o=async(u,h)=>{let f={Accept:"application/json"};new URL(u).origin===n.origin&&(f={...f,...s});const g=await r(u,{method:"GET",headers:f});if(g.status!==200){let b;try{b=await g.text()}catch{b=g.statusText}throw new Error(`Failed to fetch resource metadata from ${u}: ${g.status} ${b}`)}const v=await g.json();if(bq(v)){const b=new URL(v.resource).toString(),S=new URL(h).toString();if(b!==S)throw new Error(`Protected Resource Metadata 'resource' property value "${b}" does not match expected value "${S}" for URL ${u}. Per RFC 9728, these MUST match. See https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`);return v}else throw new Error(`Invalid resource metadata from ${u}. Expected to follow shape of https://datatracker.ietf.org/doc/html/rfc9728#name-protected-resource-metadata (Hints: is scopes_supported an array? Is resource a string?). Current payload: ${JSON.stringify(v)}`)},a=[];if(t)try{return{metadata:await o(t,e),discoveryUrl:t,errors:a}}catch(u){a.push(u instanceof Error?u:new Error(String(u)))}const c=n.pathname!=="/",l=`${n.origin}${vq}`;if(c){const u=`${l}${n.pathname}`;try{return{metadata:await o(u,e),discoveryUrl:u,errors:a}}catch(h){a.push(h instanceof Error?h:new Error(String(h)))}}try{return{metadata:await o(l,n.origin),discoveryUrl:l,errors:a}}catch(u){a.push(u instanceof Error?u:new Error(String(u)))}throw a.length===1?a[0]:new AggregateError(a,"Failed to fetch resource metadata from all attempted URLs")}async function Iq(e){if(e.status===200)try{const t=await e.json();if(Aq(t))return t}catch{}}async function Dq(e){try{return await e.text()}catch{return e.statusText}}async function Pq(e,t={}){const{additionalHeaders:i={},fetch:s=fetch}=t,r=new URL(e),n=r.pathname==="/"?"":r.pathname,o=[],a=async f=>{try{const p=await s(f,{method:"GET",headers:{...i,Accept:"application/json"}}),g=await Iq(p);if(g)return g;o.push(new Error(`Failed to fetch authorization server metadata from ${f}: ${p.status} ${await Dq(p)}`));return}catch(p){o.push(p instanceof Error?p:new Error(String(p)));return}},c=new URL(wq,e).toString()+n;let l=await a(c);if(l)return{metadata:l,discoveryUrl:c,errors:o};const u=new URL(PA,e).toString()+n;if(l=await a(u),l)return{metadata:l,discoveryUrl:u,errors:o};const h=e.endsWith("/")?e+PA.substring(1):e+PA;if(l=await a(h),l)return{metadata:l,discoveryUrl:h,errors:o};throw o.length===1?o[0]:new AggregateError(o,"Failed to fetch authorization server metadata from all attempted URLs")}var NA,RA=class{static{NA=this}static{this.a={focused:!0,active:!0}}getState(){const t=this.f;return{get focused(){return t.focused},get active(){return t.active}}}constructor(t,i){this.c=new I,this.onDidChangeWindowState=this.c.event,this.f=NA.a,t.handle&&(this.d=Wn(t.handle).buffer),this.b=i.getProxy(Q.MainThreadWindow),this.b.$getInitialState().then(({isFocused:s,isActive:r})=>{this.onDidChangeWindowProperty("focused",s),this.onDidChangeWindowProperty("active",r)})}get nativeHandle(){return this.d}$onDidChangeActiveNativeWindowHandle(t){this.d=t?Wn(t).buffer:void 0}$onDidChangeWindowFocus(t){this.onDidChangeWindowProperty("focused",t)}$onDidChangeWindowActive(t){this.onDidChangeWindowProperty("active",t)}onDidChangeWindowProperty(t,i){i!==this.f[t]&&(this.f={...this.f,[t]:i},this.c.fire(this.f))}openUri(t,i){let s;if(typeof t=="string"){s=t;try{t=y.parse(t)}catch{return Promise.reject(`Invalid uri - '${t}'`)}}return ac(t.scheme)?Promise.reject("Invalid scheme - cannot be empty"):t.scheme===V.command?Promise.reject(`Invalid scheme '${t.scheme}'`):this.b.$openUri(t,s,i)}async asExternalUri(t,i){if(ac(t.scheme))return Promise.reject("Invalid scheme - cannot be empty");const s=await this.b.$asExternalUri(t,i);return y.from(s)}};RA=NA=__decorate([__param(0,Wt),__param(1,Te)],RA);var Tm=W("IExtHostWindow"),LA,OA=class{static{LA=this}static{this.a=0}constructor(t){this.c=new Qo,this.d=new Map,this.b=t.getProxy(Q.MainThreadUrls)}registerUriHandler(t,i){const s=t.identifier;if(this.c.has(s))throw new Error(`Protocol handler already registered for extension ${s}`);const r=LA.a++;return this.c.add(s),this.d.set(r,i),this.b.$registerUriHandler(r,s,t.displayName||t.name),se(()=>{this.c.delete(s),this.d.delete(r),this.b.$unregisterUriHandler(r)})}$handleExternalUri(t,i){const s=this.d.get(t);if(!s)return Promise.resolve(void 0);try{s.handleUri(y.revive(i))}catch(r){pt(r)}return Promise.resolve(void 0)}async createAppUri(t){return y.revive(await this.b.$createAppUri(t))}};OA=LA=__decorate([__param(0,Te)],OA);var Mm=W("IExtHostUrlsService"),Nm=W("IExtHostProgress"),FA=class{constructor(t){this.b=0,this.c=new Map,this.a=t.getProxy(Q.MainThreadProgress)}async withProgress(t,i,s){const r=this.b++,{title:n,location:o,cancellable:a}=i,c={label:t.displayName||t.name,id:t.identifier.value};return this.a.$startProgress(r,{location:Hg.from(o),title:n,source:c,cancellable:a},t.isUnderDevelopment?void 0:t.identifier.value).catch(Yd),this.d(r,s,!!a)}async withProgressFromSource(t,i,s){const r=this.b++,{title:n,location:o,cancellable:a}=i;return this.a.$startProgress(r,{location:Hg.from(o),title:n,source:t,cancellable:a},void 0).catch(Yd),this.d(r,s,!!a)}d(t,i,s){let r;s&&(r=new Ke,this.c.set(t,r));const n=a=>{this.a.$progressEnd(a),this.c.delete(a),r?.dispose()};let o;try{o=i(new g8(this.a,t),s&&r?r.token:De.None)}catch(a){throw n(t),a}return o.then(a=>n(t),a=>n(t)),o}$acceptProgressCanceled(t){const i=this.c.get(t);i&&(i.cancel(),this.c.delete(t))}};FA=__decorate([__param(0,Te)],FA);function Tq(e,t){return e.message=t.message,typeof t.increment=="number"&&(typeof e.increment=="number"?e.increment+=t.increment:e.increment=t.increment),e}var g8=class extends Pm{constructor(e,t){super(i=>this.throttledReport(i)),this.c=e,this.d=t}throttledReport(e){this.c.$progressReport(this.d,e)}};__decorate([$F(100,(e,t)=>Tq(e,t),()=>Object.create(null))],g8.prototype,"throttledReport",null);var jA=W("IExtHostAuthentication"),UA=class{constructor(t,i,s,r,n,o,a){this.l=i,this.m=s,this.n=r,this.o=n,this.p=o,this.q=a,this.c=Rm,this.f=new Map,this.g=new i0,this.h=new I,this.j=new Mq,this.k=new I,this.d=t.getProxy(Q.MainThreadAuthentication)}getExtensionScopedSessionsEvent(t){const i=t.toLowerCase();return Ie.chain(this.h.event,s=>s.filter(r=>!r.extensionIdFilter||r.extensionIdFilter.includes(i)).map(r=>({provider:r.provider})))}async getSession(t,i,s,r={}){const n=it.toKey(t.identifier),a=Object.keys(r).map(l=>{switch(l){case"account":return`${l}:${r.account?.id}`;case"createIfNone":case"forceNewSession":{const u=typeof r[l]=="boolean"?`${r[l]}`:`'${r[l]?.detail}/${r[l]?.learnMore?.toString()}'`;return`${l}:${u}`}case"authorizationServer":return`${l}:${r.authorizationServer?.toString(!0)}`;default:return`${l}:${!!r[l]}`}}).sort().join(", ");let c;if(gq(s)){const l=s,u=l.wwwAuthenticate,h=l.fallbackScopes?[...l.fallbackScopes].sort().join(" "):"";c=`${n} ${i} challenge:${u} ${h} ${a}`}else{const l=[...s].sort().join(" ");c=`${n} ${i} ${l} ${a}`}return await this.j.getOrCreate(c,async()=>{await this.d.$ensureProvider(i);const l=t.displayName||t.name;return this.d.$getSession(i,s,n,l,r)})}async getAccounts(t){return await this.d.$ensureProvider(t),await this.d.$getAccounts(t)}registerAuthenticationProvider(t,i,s,r){return this.g.queue(t,async()=>{if(this.f.get(t)){this.q.error(`An authentication provider with id '${t}' is already registered. The existing provider will not be replaced.`);return}const n=s.onDidChangeSessions(o=>this.d.$sendDidChangeSessions(t,o));this.f.set(t,{label:i,provider:s,disposable:n,options:r??{supportsMultipleAccounts:!1}}),await this.d.$registerAuthenticationProvider({id:t,label:i,supportsMultipleAccounts:r?.supportsMultipleAccounts??!1,supportedAuthorizationServers:r?.supportedAuthorizationServers,supportsChallenges:r?.supportsChallenges})}),new Pe(()=>{this.g.queue(t,async()=>{const n=this.f.get(t);n&&(n.disposable?.dispose(),this.f.delete(t),await this.d.$unregisterAuthenticationProvider(t))})})}$createSession(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r)return s.authorizationServer=y.revive(s.authorizationServer),await r.provider.createSession(i,s);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$removeSession(t,i){return this.g.queue(t,async()=>{const s=this.f.get(t);if(s)return await s.provider.removeSession(i);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$getSessions(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r)return s.authorizationServer=y.revive(s.authorizationServer),await r.provider.getSessions(i,s);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$getSessionsFromChallenges(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r){const n=r.provider;if(typeof n.getSessionsFromChallenges=="function")return s.authorizationServer=y.revive(s.authorizationServer),await n.getSessionsFromChallenges(i,s);throw new Error(`Authentication provider with handle: ${t} does not support getSessionsFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$createSessionFromChallenges(t,i,s){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r){const n=r.provider;if(typeof n.createSessionFromChallenges=="function")return s.authorizationServer=y.revive(s.authorizationServer),await n.createSessionFromChallenges(i,s);throw new Error(`Authentication provider with handle: ${t} does not support createSessionFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$onDidChangeAuthenticationSessions(t,i,s){return t.startsWith(n8)||this.h.fire({provider:{id:t,label:i},extensionIdFilter:s}),Promise.resolve()}$onDidUnregisterAuthenticationProvider(t){return this.g.queue(t,async()=>{const i=this.f.get(t);i&&(i.disposable?.dispose(),this.f.delete(t))})}async $registerDynamicAuthProvider(t,i,s,r,n,o){if(!r){const c=y.revive(t);if(i.registration_endpoint)try{const l=await d8(i,this.l.environment.appName,s?.scopes_supported);r=l.client_id,n=l.client_secret}catch(l){this.q.warn(`Dynamic registration failed for ${c.toString()}: ${l.message}. Prompting user for client ID and client secret...`)}if(!r){this.q.info(`Prompting user for client registration details for ${c.toString()}`);const l=await this.d.$promptForClientRegistration(c.toString());if(!l)throw new Error("User did not provide client details");r=l.clientId,n=l.clientSecret,this.q.info(`User provided client registration for ${c.toString()}`),n?this.q.trace(`User provided client secret for ${c.toString()}`):this.q.trace(`User did not provide client secret for ${c.toString()}`)}}const a=new this.c(this.m,this.n,this.l,this.o,this.p,this.d,y.revive(t),i,s,r,n,this.k,o||[]);return await this.g.queue(a.id,async()=>{this.f.set(a.id,{label:a.label,provider:a,disposable:Pe.from(a,a.onDidChangeSessions(c=>this.d.$sendDidChangeSessions(a.id,c)),a.onDidChangeClientId(()=>this.d.$sendDidChangeDynamicProviderInfo({providerId:a.id,clientId:a.clientId,clientSecret:a.clientSecret}))),options:{supportsMultipleAccounts:!0}}),await this.d.$registerDynamicAuthenticationProvider({id:a.id,label:a.label,supportsMultipleAccounts:!0,authorizationServer:t,resourceServer:s?y.parse(s.resource):void 0,clientId:a.clientId,clientSecret:a.clientSecret})}),a.id}async $onDidChangeDynamicAuthProviderTokens(t,i,s){this.k.fire({authProviderId:t,clientId:i,tokens:s})}};UA=__decorate([__param(0,Te),__param(1,Wt),__param(2,Tm),__param(3,Mm),__param(4,Nm),__param(5,Zn),__param(6,xe)],UA);var Mq=class{constructor(){this.c=new Map}getOrCreate(e,t){const i=this.c.get(e);if(i)return i;const s=t().finally(()=>this.c.delete(e));return this.c.set(e,s),s}},Rm=class{constructor(t,i,s,r,n,o,a,c,l,u,h,f,p){this.k=t,this.l=i,this.m=s,this.n=r,this.o=o,this.authorizationServer=a,this.p=c,this.q=l,this.r=u,this.s=h,this.c=new I,this.onDidChangeSessions=this.c.event,this.d=new I,this.onDidChangeClientId=this.d.event;const g=a.toString(!0);this.id=l?.resource?g+" "+l?.resource:g,this.label=l?.resource_name??this.authorizationServer.authority,this.h=n.createLogger(this.id,{name:`Auth: ${this.label}`}),this.j=new X,this.j.add(this.c);const v=Ie.chain(f.event,b=>b.filter(S=>S.authProviderId===this.id&&S.clientId===u).map(S=>S.tokens));this.f=this.j.add(new Nq({onDidChange:v,set:b=>o.$setSessionsForDynamicAuthProvider(this.id,this.clientId,b)},p,this.h)),this.j.add(this.f.onDidChangeSessions(b=>this.c.fire(b))),this.g=[],c.authorization_endpoint&&this.g.push({label:d(3033,null),handler:(b,S,E)=>this.u(b,S,E)})}get clientId(){return this.r}get clientSecret(){return this.s}async getSessions(t,i){if(this.h.info(`Getting sessions for scopes: ${t?.join(" ")??"all"}`),!t)return this.f.sessions;const s=[...t].sort(),r=t.join(" ");let n=this.f.sessions.filter(o=>$i([...o.scopes].sort(),s));if(this.h.info(`Found ${n.length} sessions for scopes: ${r}`),n.length){const o=[],a=[],c=new Map(this.f.tokens.map(l=>[l.access_token,l]));for(const l of n){const u=c.get(l.accessToken);if(u&&u.expires_in){const h=Date.now(),f=u.expires_in*1e3;if(h>u.created_at+f-300*1e3){if(this.h.info(`Token for session ${l.id} is about to expire, refreshing...`),a.push(u),!u.refresh_token){this.h.warn(`No refresh token available for scopes ${l.scopes.join(" ")}. Throwing away token.`);continue}try{const p=await this.z(u.refresh_token);p.scope!==r&&(this.h.warn(`Token scopes '${p.scope}' do not match requested scopes '${r}'. Overwriting token with what was requested...`),p.scope=r),this.h.info(`Successfully created a new token for scopes ${l.scopes.join(" ")}.`),o.push(p)}catch(p){this.h.error(`Failed to refresh token: ${p}`)}}}}return(o.length||a.length)&&(this.f.update({added:o,removed:a}),n=this.f.sessions.filter(l=>$i([...l.scopes].sort(),s))),this.h.info(`Found ${n.length} sessions for scopes: ${r}`),n}return[]}async createSession(t,i){this.h.info(`Creating session for scopes: ${t.join(" ")}`);let s;for(let n=0;n<this.g.length;n++){const{handler:o}=this.g[n];try{if(s=await this.n.withProgressFromSource({label:this.label,id:this.id},{location:fo.Notification,title:d(3034,null,this.label),cancellable:!0},(a,c)=>o(t,a,c)),s)break}catch(a){const c=this.g[n+1]?.label;if(!c)break;const l=ki(a)?d(3035,null,this.label,c):d(3036,null,this.label,c);if(!await this.o.$showContinueNotification(l))throw new dt;this.h.error(`Failed to create token via flow '${c}': ${a}`)}}if(!s)throw new Error("Failed to create authentication token");s.scope!==t.join(" ")&&(this.h.warn(`Token scopes '${s.scope}' do not match requested scopes '${t.join(" ")}'. Overwriting token with what was requested...`),s.scope=t.join(" ")),this.f.update({added:[{...s,created_at:Date.now()}],removed:[]});const r=this.f.sessions.find(n=>n.accessToken===s.access_token);return this.h.info(`Created ${s.refresh_token?"refreshable":"non-refreshable"} session for scopes: ${s.scope}${s.expires_in?` that expires in ${s.expires_in} seconds`:""}`),r}async removeSession(t){this.h.info(`Removing session with id: ${t}`);const i=this.f.sessions.find(r=>r.id===t);if(!i){this.h.error(`Session with id ${t} not found`);return}const s=this.f.tokens.find(r=>r.access_token===i.accessToken);if(!s){this.h.error(`Failed to retrieve token for removed session: ${i.id}`);return}this.f.update({added:[],removed:[s]}),this.h.info(`Removed token for session: ${i.id} with scopes: ${i.scopes.join(" ")}`)}dispose(){this.j.dispose()}async u(t,i,s){if(!this.p.authorization_endpoint)throw new Error("Authorization Endpoint required");if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const r=this.v(64),n=await this.w(r),o=this.v(32),a=y.parse(`${this.m.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/authorize?nonce=${o}`);let c;try{c=await this.l.createAppUri(a)}catch(b){throw new Error(`Failed to create external URI: ${b}`)}const l=new URL(this.p.authorization_endpoint);l.searchParams.append("client_id",this.r),l.searchParams.append("response_type","code"),l.searchParams.append("state",c.toString()),l.searchParams.append("code_challenge",n),l.searchParams.append("code_challenge_method","S256");const u=t.join(" ");u&&l.searchParams.append("scope",u),this.q?.resource&&l.searchParams.append("resource",this.q.resource);const h="https://vscode.dev/redirect";l.searchParams.append("redirect_uri",h);const f=this.x(a);if(this.h.info(`Opening authorization URL for scopes: ${u}`),this.h.trace(`Authorization URL: ${l.toString()}`),!await this.k.openUri(l.toString(),{}))throw new dt;i.report({message:d(3037,null)});let g;try{g=(await wf(f,s)).code}catch(b){throw ki(b)?(this.h.info("Authorization code request was cancelled by the user."),b):(this.h.error(`Failed to receive authorization code: ${b}`),new Error(`Failed to receive authorization code: ${b}`))}return this.h.info(`Authorization code received for scopes: ${u}`),await this.y(g,r,h)}v(t){const i=new Uint8Array(t);return crypto.getRandomValues(i),Array.from(i).map(s=>s.toString(16).padStart(2,"0")).join("").substring(0,t)}async w(t){const s=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",s);return _n(_.wrap(new Uint8Array(r)),!1,!1).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async x(t){const i=await this.o.$waitForUriHandler(t),s=/[?&]code=([^&]+)/.exec(i.query||"");if(!s||s.length<2)throw new Error("Authentication failed: No authorization code received");return{code:s[1]}}async y(t,i,s){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const r=new URLSearchParams;r.append("client_id",this.r),r.append("grant_type","authorization_code"),r.append("code",t),r.append("redirect_uri",s),r.append("code_verifier",i),this.q?.resource&&r.append("resource",this.q.resource),this.s&&r.append("client_secret",this.s),this.h.info("Exchanging authorization code for token..."),this.h.trace(`Url: ${this.p.token_endpoint}`),this.h.trace(`Token request body: ${r.toString()}`);let n;try{n=await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:r.toString()})}catch(a){throw this.h.error(`Failed to exchange authorization code for token: ${a}`),new Error(`Failed to exchange authorization code for token: ${a}`)}if(!n.ok){const a=await n.text();throw new Error(`Token exchange failed: ${n.status} ${n.statusText} - ${a}`)}const o=await n.json();if(MA(o))return this.h.info("Successfully exchanged authorization code for token."),o;throw l8(o)&&o.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Invalid authorization token response: ${JSON.stringify(o)}`)}async z(t){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const i=new URLSearchParams;i.append("client_id",this.r),i.append("grant_type","refresh_token"),i.append("refresh_token",t),this.q?.resource&&i.append("resource",this.q.resource),this.s&&i.append("client_secret",this.s);const r=await(await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:i.toString()})).json();if(MA(r))return{...r,created_at:Date.now()};throw l8(r)&&r.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Invalid authorization token response: ${JSON.stringify(r)}`)}async A(){try{const t=await d8(this.p,this.m.environment.appName,this.q?.scopes_supported);this.r=t.client_id,this.s=t.client_secret,this.d.fire()}catch(t){this.h.info(`Dynamic registration failed for ${this.authorizationServer.toString()}: ${t}. Prompting user for client ID and client secret.`);try{const i=await this.o.$promptForClientRegistration(this.authorizationServer.toString());if(!i)throw new Error("User did not provide client details");this.r=i.clientId,this.s=i.clientSecret,this.h.info(`User provided client ID for ${this.authorizationServer.toString()}`),i.clientSecret?this.h.info(`User provided client secret for ${this.authorizationServer.toString()}`):this.h.info(`User did not provide client secret for ${this.authorizationServer.toString()} (optional)`),this.d.fire()}catch{throw this.h.error(`Failed to fetch new client ID and user did not provide one: ${t}`),new Error(`Failed to fetch new client ID and user did not provide one: ${t}`)}}}};Rm=__decorate([__param(0,Tm),__param(1,Mm),__param(2,Wt),__param(3,Nm),__param(4,Zn)],Rm);var Nq=class{constructor(e,t,i){this.h=e,this.j=i,this.f=new I,this.onDidChangeSessions=this.f.event,this.g=new X,this.c=PI("tokens",t),this.d=NI({equalsFn:(s,r)=>$i(s,r,(n,o)=>n.accessToken===o.accessToken)},s=>this.c.read(s).map(r=>this.l(r))),this.g.add(this.k()),this.g.add(this.h.onDidChange(s=>this.c.set(s,void 0)))}get tokens(){return this.c.get()}get sessions(){return this.d.get()}dispose(){this.g.dispose()}update({added:e,removed:t}){this.j.trace(`Updating tokens: added ${e.length}, removed ${t.length}`);const i=[...this.c.get()];for(const s of t){const r=i.findIndex(n=>n.access_token===s.access_token);r!==-1&&i.splice(r,1)}for(const s of e){const r=i.findIndex(n=>n.access_token===s.access_token);r===-1?i.push(s):i[r]=s}(e.length||t.length)&&(this.c.set(i,void 0),this.h.set(i)),this.j.trace(`Tokens updated: ${i.length} tokens stored.`)}k(){let e=[];return Qf(t=>{this.j.trace("Checking for session changes...");const i=this.d.read(t);if(e===i){this.j.trace("No session changes detected.");return}if(!i||i.length===0){this.j.trace("All sessions removed."),e.length>0&&(this.f.fire({added:[],removed:e,changed:[]}),e=[]);return}const s=[],r=[];for(const n of i)e.some(a=>a.accessToken===n.accessToken)||s.push(n);for(const n of e)i.some(a=>a.accessToken===n.accessToken)||r.push(n);(s.length>0||r.length>0)&&(this.j.trace(`Sessions changed: added ${s.length}, removed ${r.length}`),this.f.fire({added:s,removed:r,changed:[]})),e=i})}l(e){let t;if(e.id_token)try{t=p8(e.id_token)}catch{}if(!t)try{t=p8(e.access_token)}catch{}const i=e.scope?e.scope.split(" "):t?.scope?t.scope.split(" "):[];return{id:D0(e.access_token,0).toString(),accessToken:e.access_token,account:{id:t?.sub||"unknown",label:t?.preferred_username||t?.name||t?.email||"MCP"},scopes:i,idToken:e.id_token}}},zA,HA=W("IExtHostLanguageModels"),Rq=class{constructor(){this.a=new HO,this.b=!1;const e=this,[t,i]=HC.tee(e.a.asyncIterable);this.apiObject={get stream(){return t},get text(){return i.map(s=>{if(s instanceof Xt)return s.value}).coalesce()}}}handleResponsePart(e){if(this.b)return;const t=[];for(const i of ai.wrap(e)){let s;i.type==="text"?s=new Xt(i.value,i.audience):i.type==="thinking"?s=new ll(i.value,i.id,i.metadata):i.type==="data"?s=new Li(i.data.buffer,i.mimeType,i.audience):s=new ka(i.toolCallId,i.name,i.parameters),t.push(s)}this.a.emitMany(t)}reject(e){this.b=!0,this.a.reject(e)}resolve(){this.b=!0,this.a.resolve()}},WA=class{static{zA=this}static{this.a=1}constructor(t,i,s){this.o=i,this.p=s,this.c=new I,this.d=new I,this.onDidChangeProviders=this.d.event,this.f=new I,this.onDidChangeModelProxyAvailability=this.f.event,this.g=new Map,this.h=new Map,this.j=new Gn,this.k=new Map,this.l=new Map,this.y=new Set,this.b=t.getProxy(Q.MainThreadLanguageModels)}dispose(){this.c.dispose(),this.d.dispose(),this.f.dispose()}registerLanguageModelChatProvider(t,i,s){this.g.set(i,{extension:t,provider:s}),this.b.$registerLanguageModelProvider(i);let r;return s.onDidChangeLanguageModelChatInformation&&(r=s.onDidChangeLanguageModelChatInformation(()=>{this.b.$onLMProviderChange(i)})),se(()=>{this.g.delete(i),this.h.forEach((n,o)=>{n.metadata.vendor===i&&this.h.delete(o)}),r?.dispose(),this.b.$unregisterProvider(i)})}q(t,i,s){return i?`${t}/${i}/${s}`:`${t}/${s}`}r(t){const i=t.indexOf("/");return i===-1?void 0:t.substring(0,i)}async $provideLanguageModelChatInfo(t,i,s){const r=this.g.get(t);if(!r)return[];const n=await r.provider.provideLanguageModelChatInformation({silent:i.silent,configuration:i.configuration},s)??[],o=n.map(a=>{let c;a.requiresAuthorization&&qe(r.extension,"chatProvider")&&(c={providerLabel:r.extension.displayName||r.extension.name,accountLabel:typeof a.requiresAuthorization=="object"?a.requiresAuthorization.label:void 0}),a.capabilities.editTools&&T(r.extension,"chatProvider");const l={};if(qe(r.extension,"chatProvider")){if(a.isDefault===!0)for(const u of Object.values(ti))typeof u=="string"&&(l[u]=!0);else if(typeof a.isDefault=="object")for(const u of Object.keys(a.isDefault)){const h=parseInt(u);l[qh.from(h)]=a.isDefault[h]}}return{metadata:{extension:r.extension.identifier,id:a.id,vendor:t,name:a.name??"",family:a.family??"",detail:a.detail,tooltip:a.tooltip,version:a.version,multiplier:a.multiplier,maxInputTokens:a.maxInputTokens,maxOutputTokens:a.maxOutputTokens,auth:c,isDefaultForLocation:l,isUserSelectable:a.isUserSelectable,statusIcon:a.statusIcon,modelPickerCategory:a.category??pq,capabilities:a.capabilities?{vision:a.capabilities.imageInput,editTools:a.capabilities.editTools,toolCalling:!!a.capabilities.toolCalling,agentMode:!!a.capabilities.toolCalling}:void 0},identifier:this.q(t,i.group,a.id)}});this.h.forEach((a,c)=>{a.metadata.vendor===t&&a.group===i.group&&this.h.delete(c)});for(let a=0;a<o.length;a++)this.h.set(o[a].identifier,{group:i.group,metadata:o[a].metadata,info:n[a]});return o}async $startChatRequest(t,i,s,r,n,o){const a=this.h.get(t);if(!a)throw new Error("Model not found");const c=this.g.get(a.metadata.vendor);if(!c)throw new Error(`Language model provider for '${a.metadata.id}' not found.`);const l=[],u=()=>{l.length>0&&(this.b.$reportResponsePart(i,new Si(l)),l.length=0)},h=new vr(u,30),f=v=>{l.push(v)>30?(u(),h.cancel()):h.schedule()},p=new Pm(async v=>{if(o.isCancellationRequested){this.o.warn(`[CHAT](${c.extension.identifier.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let b;if(v instanceof ka?b={type:"tool_use",name:v.name,parameters:v.input,toolCallId:v.callId}:v instanceof Xt?b={type:"text",value:v.value,audience:v.audience}:v instanceof Li?b={type:"data",mimeType:v.mimeType,data:_.wrap(v.data),audience:v.audience}:v instanceof ll&&(b={type:"thinking",value:v.value,id:v.id,metadata:v.metadata}),!b){this.o.warn(`[CHAT](${c.extension.identifier.value}) UNKNOWN part ${JSON.stringify(v)}`);return}f(b)});let g;try{g=c.provider.provideLanguageModelChatResponse(a.info,r.value.map(Jg.to),{...n,modelOptions:n.modelOptions??{},requestInitiator:it.toKey(s),toolMode:n.toolMode??kg.Auto},p,o)}catch(v){throw v}Promise.resolve(g).then(()=>{u(),this.b.$reportResponseDone(i,void 0)},v=>{u(),this.b.$reportResponseDone(i,tc(v))})}$provideTokenLength(t,i,s){const r=this.h.get(t);if(!r)return Promise.resolve(0);const n=this.g.get(r.metadata.vendor);return n?Promise.resolve(n.provider.provideTokenCount(r.info,i,s)):Promise.resolve(0)}async getDefaultLanguageModel(t,i){let s;i&&await this.selectLanguageModels(t,{});for(const[r,n]of this.h)if(n.metadata.isDefaultForLocation[ti.Chat]){s=r;break}return!s&&!i?this.getDefaultLanguageModel(t,!0):this.getLanguageModelByIdentifier(t,s)}async getLanguageModelByIdentifier(t,i){if(!i)return;let s=this.h.get(i);if(!s){this.o.warn(`[LanguageModelProxy](${t.identifier.value}) Could not find model '${i}' in local cache. Trying to resolve model again.`);const n=this.r(i);if(!n){this.o.warn(`[LanguageModelProxy](${t.identifier.value}) Could not extract vendor from model identifier '${i}'.`);return}if(await this.selectLanguageModels(t,{vendor:n}),s=this.h.get(i),!s){this.o.warn(`[LanguageModelProxy](${t.identifier.value}) Could not find model '${i}' in local cache after re-resolving models.`);return}}this.v(t.identifier,s.metadata)&&await this.w(s.metadata);let r;if(!r){const n=this;r={id:s.info.id,vendor:s.metadata.vendor,family:s.info.family,version:s.info.version,name:s.info.name,capabilities:{supportsImageToText:s.metadata.capabilities?.vision??!1,supportsToolCalling:!!s.metadata.capabilities?.toolCalling,editToolsHint:s.metadata.capabilities?.editTools},maxInputTokens:s.metadata.maxInputTokens,countTokens(o,a){if(!n.h.has(i))throw cn.NotFound(i);return n.x(i,o,a??De.None)},sendRequest(o,a,c){if(!n.h.has(i))throw cn.NotFound(i);return n.s(t,i,o,a??{},c??De.None)}},Object.freeze(r)}return r}async selectLanguageModels(t,i){const s=await this.b.$selectChatModels({...i,extension:t.identifier}),r=[],n=s.map(a=>this.getLanguageModelByIdentifier(t,a)),o=await Promise.all(n);for(const a of o)a&&r.push(a);return r}async s(t,i,s,r,n){const o=this.t(t,s),a=t.identifier,c=this.h.get(i)?.metadata;if(!c||!this.h.has(i))throw cn.NotFound(`Language model '${i}' is unknown.`);if(this.v(a,c)&&(!await this.u(t,{identifier:c.extension,displayName:c.auth.providerLabel},r.justification,!1)||!this.j.get(a)?.has(c.extension)))throw cn.NoPermissions(`Language model '${i}' cannot be used by '${a.value}'.`);const l=Math.random()*1e6|0,u=new Rq;this.k.set(l,{languageModelId:i,res:u});try{await this.b.$tryStartChatRequest(a,i,l,new Si(o),r,n)}catch(h){throw this.k.delete(l),cn.tryDeserialize(h)??h}return u.apiObject}t(t,i){const s=[];for(const r of i)r.role===os.System&&T(t,"languageModelSystem"),s.push(Jg.from(r));return s}async $acceptResponsePart(t,i){const s=this.k.get(t);s&&s.res.handleResponsePart(i.value)}async $acceptResponseDone(t,i){const s=this.k.get(t);s&&(this.k.delete(t),i?s.res.reject(cn.tryDeserialize(i)??fx(i)):s.res.resolve())}async u(t,i,s,r){const n=n8+i.identifier.value;if(await this.p.getSession(t,n,[],{silent:!0}))return this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0;if(r)return!1;try{const a=s?d(3043,null,i.displayName,s):void 0;return await this.p.getSession(t,n,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0}catch{return!1}}v(t,i){return!!i.auth&&!it.equals(i.extension,t)}async w(t){if(t.auth)for(const i of this.y)try{await this.u(i,{identifier:t.extension,displayName:""},void 0,!0)}catch(s){this.o.error("Fake Auth request failed"),this.o.error(s)}}async x(t,i,s){const r=this.h.get(t);if(!r)throw cn.NotFound(`Language model '${t}' is unknown.`);return this.g.get(r.metadata.vendor)?.provider.provideTokenCount(r.info,i,s)??0}$updateModelAccesslist(t){const i=new Array;for(const{from:s,to:r,enabled:n}of t){const o=this.j.get(s)??new Qo;if(o.has(r)!==n){n?o.add(r):o.delete(r),this.j.set(s,o);const c={from:s,to:r};i.push(c),this.c.fire(c)}}}createLanguageModelAccessInformation(t){this.y.add(t);const i=Ie.signal(Ie.filter(this.c.event,r=>it.equals(r.from,t.identifier))),s=Ie.signal(this.d.event);return{get onDidChange(){return Ie.any(i,s)},canSendRequest(r){return!0}}}fileIsIgnored(t,i,s=De.None){return T(t,"chatParticipantAdditions"),this.b.$fileIsIgnored(i,s)}get isModelProxyAvailable(){return!!this.n}async getModelProxy(t){if(T(t,"languageModelProxy"),!this.n)throw this.o.trace("[LanguageModelProxy] No LanguageModelProxyProvider registered"),new Error("No language model proxy provider is registered.");const i=it.toKey(t.identifier);try{const s=await Promise.resolve(this.n.provideModelProxy(i,De.None));if(!s)throw this.o.warn(`[LanguageModelProxy] Provider returned no proxy for ${i}`),new Error("Language model proxy is not available.");return s}catch(s){throw this.o.error(`[LanguageModelProxy] Provider failed to return proxy for ${i}`,s),s}}async $isFileIgnored(t,i,s){const r=this.l.get(t);if(!r)throw new Error("Unknown LanguageModelIgnoredFileProvider");return await r.provideFileIgnored(y.revive(i),s)??!1}registerIgnoredFileProvider(t,i){T(t,"chatParticipantPrivate");const s=zA.a++;return this.b.$registerFileIgnoreProvider(s),this.l.set(s,i),se(()=>{this.b.$unregisterFileIgnoreProvider(s),this.l.delete(s)})}registerLanguageModelProxyProvider(t,i){return T(t,"chatParticipantPrivate"),this.n=i,this.f.fire(),se(()=>{this.n===i&&(this.n=void 0,this.f.fire())})}};WA=zA=__decorate([__param(0,Te),__param(1,xe),__param(2,jA)],WA);var Lq=60,Oq=Lq*60,_A=Oq*24,vne=_A*7,wne=_A*30,bne=_A*365;function Fq(e){return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var Lm={DateTimeFormat(e,t){return new Rt(()=>{try{return new Intl.DateTimeFormat(e,t)}catch{return new Intl.DateTimeFormat(void 0,t)}})},Collator(e,t){return new Rt(()=>{try{return new Intl.Collator(e,t)}catch{return new Intl.Collator(void 0,t)}})},Segmenter(e,t){return new Rt(()=>{try{return new Intl.Segmenter(e,t)}catch{return new Intl.Segmenter(void 0,t)}})},Locale(e,t){return new Rt(()=>{try{return new Intl.Locale(e,t)}catch{return new Intl.Locale(Tn,t)}})},NumberFormat(e,t){return new Rt(()=>{try{return new Intl.NumberFormat(e,t)}catch{return new Intl.NumberFormat(void 0,t)}})}},m8;(function(e){e[e.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",e[e.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",e[e.MAX_UINT_8=255]="MAX_UINT_8",e[e.MAX_UINT_16=65535]="MAX_UINT_16",e[e.MAX_UINT_32=4294967295]="MAX_UINT_32",e[e.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(m8||(m8={}));function v8(e){return e<0?0:e>255?255:e|0}function Pl(e){return e<0?0:e>4294967295?4294967295:e|0}var w8=class rR{constructor(t){const i=v8(t);this.c=i,this.a=rR.d(i),this.b=new Map}static d(t){const i=new Uint8Array(256);return i.fill(t),i}set(t,i){const s=v8(i);t>=0&&t<256?this.a[t]=s:this.b.set(t,s)}get(t){return t>=0&&t<256?this.a[t]:this.b.get(t)||this.c}clear(){this.a.fill(this.c),this.b.clear()}},b8;(function(e){e[e.False=0]="False",e[e.True=1]="True"})(b8||(b8={}));var y8;(function(e){e[e.Regular=0]="Regular",e[e.Whitespace=1]="Whitespace",e[e.WordSeparator=2]="WordSeparator"})(y8||(y8={}));var jq=class extends w8{constructor(e,t){super(0),this.e=null,this.f=null,this.g=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this.e=Lm.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this.e=null;for(let i=0,s=e.length;i<s;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const s of this.h(e)){if(s.index>t)break;i=s}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this.h(e))if(!(i.index<t))return i;return null}h(e){return this.e?this.f===e?this.g:(this.f=e,this.g=this.j(this.e.value.segment(e)),this.g):[]}j(e){const t=[];for(const i of e)this.k(i)&&t.push(i);return t}k(e){return!!e.isWordLike}},A8=new ic(10);function Uq(e,t){const i=`${e}/${t.join(",")}`;let s=A8.get(i);return s||(s=new jq(e,t),A8.set(i,s)),s}var BA;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"})(BA||(BA={}));var S8;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(S8||(S8={}));var E8;(function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"})(E8||(E8={}));var x8;(function(e){e[e.Normal=1]="Normal",e[e.Underlined=2]="Underlined"})(x8||(x8={}));var C8;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(C8||(C8={}));var k8;(function(e){e[e.Both=0]="Both",e[e.Right=1]="Right",e[e.Left=2]="Left",e[e.None=3]="None"})(k8||(k8={}));var $8;(function(e){e[e.TextDefined=0]="TextDefined",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})($8||($8={}));var I8;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(I8||(I8={}));var D8;(function(e){e[e.LF=0]="LF",e[e.CRLF=1]="CRLF"})(D8||(D8={}));var qA=class{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}},P8;(function(e){e[e.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",e[e.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",e[e.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",e[e.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(P8||(P8={}));var T8;(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.None=2]="None",e[e.LeftOfInjectedText=3]="LeftOfInjectedText",e[e.RightOfInjectedText=4]="RightOfInjectedText"})(T8||(T8={}));var M8;(function(e){e[e.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(M8||(M8={}));var zq=class{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}},Hq=class{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}},N8=class{constructor(e,t,i,s){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=s}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=R8(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=Xx(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new zq(t,this.wordSeparators?Uq(this.wordSeparators,[]):null,i?this.searchString:null)}};function R8(e){if(!e||e.length===0)return!1;for(let t=0,i=e.length;t<i;t++){const s=e.charCodeAt(t);if(s===10)return!0;if(s===92){if(t++,t>=i)break;const r=e.charCodeAt(t);if(r===110||r===114||r===87)return!0}}return!1}function L8(e,t,i){if(!i)return new qA(e,null);const s=[];for(let r=0,n=t.length;r<n;r++)s[r]=t[r];return new qA(e,s)}function Wq(e,t,i,s,r){if(s===0)return!0;const n=t.charCodeAt(s-1);if(e.get(n)!==0||n===13||n===10)return!0;if(r>0){const o=t.charCodeAt(s);if(e.get(o)!==0)return!0}return!1}function _q(e,t,i,s,r){if(s+r===i)return!0;const n=t.charCodeAt(s+r);if(e.get(n)!==0||n===13||n===10)return!0;if(r>0){const o=t.charCodeAt(s+r-1);if(e.get(o)!==0)return!0}return!1}function O8(e,t,i,s,r){return Wq(e,t,i,s,r)&&_q(e,t,i,s,r)}var Bq=class{constructor(e,t){this._wordSeparators=e,this.a=t,this.b=-1,this.c=0}reset(e){this.a.lastIndex=e,this.b=-1,this.c=0}next(e){const t=e.length;let i;do{if(this.b+this.c===t||(i=this.a.exec(e),!i))return null;const s=i.index,r=i[0].length;if(s===this.b&&r===this.c){if(r===0){sC(e,t,this.a.lastIndex)>65535?this.a.lastIndex+=2:this.a.lastIndex+=1;continue}return null}if(this.b=s,this.c=r,!this._wordSeparators||O8(this._wordSeparators,e,t,s,r))return i}while(i);return null}},F8=W("IUriIdentityService");function j8(e){return e.scheme!==V.file&&e.scheme!==V.vscodeRemote}function qq(e){if(e.folders.length)return e.folders.every(t=>j8(t.uri))?e.folders[0].uri:void 0;if(e.configuration&&j8(e.configuration))return e.configuration}function Vq(e){return qq(e)?.scheme}var VA=W("environmentService"),Gq=VA,GA=VA,U8=W("remoteAgentService"),yne=new class{constructor(){this.maxSampleCount=5,this.sampleDelay=2e3,this.initial=[],this.maxInitialCount=3,this.average=[],this.maxAverageCount=100,this.highLatencyMultiple=2,this.highLatencyMinThreshold=500,this.highLatencyMaxThreshold=1500,this.lastMeasurement=void 0}get latency(){return this.lastMeasurement}async measure(e){let t=1/0;for(let s=0;s<this.maxSampleCount;s++){const r=await e.getRoundTripTime();if(r===void 0)return;t=Math.min(t,r/2),await Kt(this.sampleDelay)}this.average.push(t),this.average.length>this.maxAverageCount&&this.average.shift();let i;return this.initial.length<this.maxInitialCount?this.initial.push(t):i=this.initial.reduce((s,r)=>s+r,0)/this.initial.length,this.lastMeasurement={initial:i,current:t,average:this.average.reduce((s,r)=>s+r,0)/this.average.length,high:typeof i>"u"?!1:t>this.highLatencyMaxThreshold||t>this.highLatencyMinThreshold&&t>i*this.highLatencyMultiple},this.lastMeasurement}},JA,Jq=W("pathService"),z8=JA=class{constructor(t,i,s,r){this.d=t,this.e=i,this.f=s,this.g=r,this.a=(async()=>(await this.e.getEnvironment())?.os||Nn)(),this.b=(async()=>{const n=await this.e.getEnvironment();return this.c=n?.userHome??t})()}hasValidBasename(t,i,s){return typeof i=="string"||typeof i>"u"?this.a.then(r=>this.h(t,r,i)):this.h(t,i,s)}h(t,i,s){return t.scheme===V.file||t.scheme===V.vscodeRemote?aO(s??ji(t),i===1):!0}get defaultUriScheme(){return JA.findDefaultUriScheme(this.f,this.g)}static findDefaultUriScheme(t,i){if(t.remoteAuthority)return V.vscodeRemote;const s=Vq(i.getWorkspace());if(s)return s;const r=i.getWorkspace().folders[0];if(r)return r.uri.scheme;const n=i.getWorkspace().configuration;return n?n.scheme:V.file}userHome(t){return t?.preferLocal?this.d:this.b}get resolvedUserHome(){return this.c}get path(){return this.a.then(t=>t===1?Yt:_e)}async fileURI(t){let i="";if(await this.a===1&&(t=t.replace(/\\/g,"/")),t[0]==="/"&&t[1]==="/"){const r=t.indexOf("/",2);r===-1?(i=t.substring(2),t="/"):(i=t.substring(2,r),t=t.substring(r)||"/")}return y.from({scheme:V.file,authority:i,path:t,query:"",fragment:""})}};z8=JA=__decorate([__param(1,U8),__param(2,GA),__param(3,Iu)],z8);function Zq(e){return typeof e=="object"&&"uri"in e&&"pattern"in e}var H8=class{constructor(t,i,s,r,n,o){this.a=t,this.b=i,this.c=s,this.d=r,this.f=n,this.g=o}aiText(t,i,s={}){return{...this.j(i?.map(B0),s),type:3,contentPattern:t}}text(t,i,s={}){t=this.h(t,s);const r=this.a.getValue(),n=i&&i.some(a=>!this.a.getValue({resource:a}).search.useRipgrep);return{...this.j(i?.map(B0),s),type:2,contentPattern:t,previewOptions:s.previewOptions,maxFileSize:s.maxFileSize,usePCRE2:r.search.usePCRE2||n||!1,surroundingContext:s.surroundingContext,userDisabledExcludesAndIgnoreFiles:s.disregardExcludeSettings&&s.disregardIgnoreFiles}}h(t,i){const s=this.a.getValue();t.isRegExp&&(t.pattern=t.pattern.replace(/\r?\n/g,"\\n"));const r={...t,wordSeparators:s.editor.wordSeparators};return this.l(t,i)&&(r.isCaseSensitive=!0),this.m(t)&&(r.isMultiline=!0),i.notebookSearchConfig?.includeMarkupInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownInput=i.notebookSearchConfig.includeMarkupInput),i.notebookSearchConfig?.includeMarkupPreview&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookMarkdownPreview=i.notebookSearchConfig.includeMarkupPreview),i.notebookSearchConfig?.includeCodeInput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellInput=i.notebookSearchConfig.includeCodeInput),i.notebookSearchConfig?.includeOutput&&(r.notebookInfo||(r.notebookInfo={}),r.notebookInfo.isInNotebookCellOutput=i.notebookSearchConfig.includeOutput),r}file(t,i={}){return{...this.j(t,i),type:1,filePattern:i.filePattern?i.filePattern.trim():i.filePattern,exists:i.exists,sortByScore:i.sortByScore,cacheKey:i.cacheKey,shouldGlobMatchFilePattern:i.shouldGlobSearch}}i(t,i){if(!t)return{};if(Array.isArray(t)){if(t=t.filter(s=>s.length>0).map(Om),!t.length)return{}}else t=Om(t);return i?this.parseSearchPaths(t):{pattern:ZA(...Array.isArray(t)?t:[t])}}j(t=[],i={}){let s=Array.isArray(i.excludePattern)?i.excludePattern.map(u=>u.pattern).flat():i.excludePattern;s=s?.length===1?s[0]:s;const r=this.i(i.includePattern,i.expandPatterns),n=this.i(s,i.expandPatterns),o=t.length>1,a=(r.searchPaths&&r.searchPaths.length?r.searchPaths.map(u=>this.t(u,i,n)):t.map(u=>this.u(u,i,n,o))).filter(u=>!!u),c={_reason:i._reason,folderQueries:a,usingSearchPaths:!!(r.searchPaths&&r.searchPaths.length),extraFileResources:i.extraFileResources,excludePattern:n.pattern,includePattern:r.pattern,ignoreGlobCase:i.ignoreGlobCase,onlyOpenEditors:i.onlyOpenEditors,maxResults:i.maxResults,onlyFileScheme:i.onlyFileScheme};if(i.onlyOpenEditors){const u=yt(this.c.groups.flatMap(p=>p.editors.map(g=>g.resource)));this.d.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const h=u.filter(p=>E9(c,p.fsPath)),f=this.k(h);return this.d.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(f)),{...c,...f}}const l=i.extraFileResources&&i.extraFileResources.filter(u=>E9(c,u.fsPath));return c.extraFileResources=l&&l.length?l:void 0,c}k(t){const i=[],s=new Ct,r={};let n=!1;return t.forEach(o=>{if(o.scheme===V.walkThrough)return;if(IO(o)){const c=this.b.getWorkspaceFolder(o)?.uri??this.g.extUri.dirname(o);let l=s.get(c);l||(n=!0,l={folder:c,includePattern:{}},i.push(l),s.set(c,l));const u=oc(c.fsPath,o.fsPath);sc(l.includePattern)[W8(u.replace(/\\/g,"/"))]=!0}else o.fsPath&&(n=!0,r[W8(o.fsPath)]=!0)}),{folderQueries:i,includePattern:r,usingSearchPaths:!0,excludePattern:n?void 0:{"**/*":!0}}}l(t,i){if(i.isSmartCase){if(t.isRegExp){if(aC(t.pattern,!0))return!0}else if(aC(t.pattern))return!0}return!!t.isCaseSensitive}m(t){return t.isMultiline||t.isRegExp&&R8(t.pattern)||t.pattern.indexOf(`
`)>=0?!0:!!t.isMultiline}parseSearchPaths(t){const i=h=>Cs(h)||/^\.\.?([\/\\]|$)/.test(h),r=(Array.isArray(t)?t:Qq(t)).map(h=>{const f=this.f.resolvedUserHome;return f?Jf(h,f.scheme===V.file?f.fsPath:f.path):h}),n=x1(r,h=>i(h)?"searchPaths":"exprSegments"),o=(n.exprSegments||[]).map(h=>Fn(h,"/")).map(h=>Fn(h,"\\")).map(h=>(h[0]==="."&&(h="*"+h),Xq(h))),a={},c=this.o(n.searchPaths||[]);c&&c.length&&(a.searchPaths=c);const l=o.flat(),u=ZA(...l);return u&&(a.pattern=u),a}n(t,i){return i.disregardExcludeSettings?void 0:oB(t,!i.disregardSearchExcludeSettings)}o(t){if(!t||!t.length)return[];const i=t.flatMap(r=>{let{pathPortion:n,globPortion:o}=Yq(r);return o&&(o=YA(o)),this.q(n).flatMap(c=>this.r(c,o))}),s=new Map;return i.forEach(r=>{const n=r.searchPath.toString(),o=s.get(n);o?r.pattern&&(o.pattern=o.pattern||{},o.pattern[r.pattern]=!0):s.set(n,{searchPath:r.searchPath,pattern:r.pattern?ZA(r.pattern):void 0})}),Array.from(s.values())}q(t){if(Cs(t)){const i=this.b.getWorkspace().folders;return i[0]&&i[0].uri.scheme!==V.file?[{searchPath:i[0].uri.with({path:t})}]:[{searchPath:y.file(Yr(t))}]}if(this.b.getWorkbenchState()===2){const i=this.b.getWorkspace().folders[0].uri;if(t=Om(t),t.startsWith("../")||t===".."){const r=_e.resolve(i.path,t);return[{searchPath:i.with({path:r})}]}const s=YA(t);return[{searchPath:i,pattern:s}]}else{if(t==="./"||t===".\\")return[];{const i=t.replace(/^\.[\/\\]/,""),r=this.b.getWorkspace().folders.map(n=>{const o=i.match(new RegExp(`^${On(n.name)}(?:/(.*)|$)`));return o?{match:o,folder:n}:null}).filter(ps);if(r.length)return r.map(n=>{const o=n.match[1];return{searchPath:n.folder.uri,pattern:o&&YA(o)}});{const n=t.match(/\.[\/\\](.+)[\/\\]?/),o=n?n[1]:t,a=d(16514,null,o);throw new Error(a)}}}}r(t,i){const s=t.pattern&&i?`${t.pattern}/${i}`:t.pattern||i,r=[{searchPath:t.searchPath,pattern:s}];return s&&!s.endsWith("**")&&r.push({searchPath:t.searchPath,pattern:s+"/**"}),r}t(t,i,s){const r=this.u(B0(t.searchPath),i,s,!1);return r?{...r,includePattern:t.pattern}:null}u(t,i,s,r){let n;const o=y.isUri(t)?t:t.uri;let a=i.excludePattern?.map(p=>{const g=i.excludePattern&&Zq(p)?p.uri:void 0;return!g||!(y.isUri(t)&&this.g.extUri.isEqual(t,g))?g:void 0});if(a?.length||(a=[void 0]),s.searchPaths){const p=s.searchPaths.filter(g=>hc(g.searchPath,o))[0];if(p&&!p.pattern)return null;p&&(n=p.pattern)}const c=this.a.getValue({resource:o}),u={...this.n(c,i)||{},...n||{}},h=y.isUri(t)?ji(t):t.name,f=a.map(p=>Object.keys(u).length>0?{folder:p,pattern:u}:void 0).filter(p=>p);return{folder:o,folderName:r?h:void 0,excludePattern:f,fileEncoding:c.files&&c.files.encoding,disregardIgnoreFiles:typeof i.disregardIgnoreFiles=="boolean"?i.disregardIgnoreFiles:!c.search.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof i.disregardGlobalIgnoreFiles=="boolean"?i.disregardGlobalIgnoreFiles:!c.search.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof i.disregardParentIgnoreFiles=="boolean"?i.disregardParentIgnoreFiles:!c.search.useParentIgnoreFiles,ignoreSymlinks:typeof i.ignoreSymlinks=="boolean"?i.ignoreSymlinks:!c.search.followSymlinks,ignoreGlobCase:i.ignoreGlobCase}}};H8=__decorate([__param(0,rs),__param(1,Iu),__param(2,qW),__param(3,xe),__param(4,Jq),__param(5,F8)],H8);function Yq(e){const t=e.match(/[\*\{\}\(\)\[\]\?]/);if(t){const i=t.index,s=e.substr(0,i).match(/[/|\\][^/\\]*$/);if(s){let r=e.substr(0,s.index);return r.match(/[/\\]/)||(r+="/"),{pathPortion:r,globPortion:e.substr((s.index||0)+1)}}}return{pathPortion:e}}function ZA(...e){return e.length?e.reduce((t,i)=>(t[i]=!0,t),Object.create(null)):void 0}function Qq(e){return Mc(e,",").map(t=>t.trim()).filter(t=>!!t.length)}function Xq(e){return[`**/${e}/**`,`**/${e}`].map(i=>i.replace(/\*\*\/\*\*/g,"**"))}function Om(e){return e.replace(/\\/g,"/")}function YA(e){return Om(e).replace(/^\.\//,"").replace(/\/+$/g,"")}function W8(e){return e.replace(/([?*[\]])/g,"[$1]")}var Kq=7e3;function eV(e,t){const i=t.activationEvents;if(!i)return Promise.resolve(void 0);const s=[],r=[];for(const u of i)if(/^workspaceContains:/.test(u)){const h=u.substr(18);h.indexOf("*")>=0||h.indexOf("?")>=0||e.forceUsingSearch?r.push(h):s.push(h)}if(s.length===0&&r.length===0)return Promise.resolve(void 0);const{promise:n,resolve:o}=TC(),a=u=>o({activationEvent:u}),c=Promise.all(s.map(u=>tV(e,u,a))).then(()=>{}),l=iV(e,t.identifier,r,a);return Promise.all([c,l]).then(()=>{o(void 0)}),n}async function tV(e,t,i){for(const s of e.folders)if(await e.exists(Lt(y.revive(s),t))){i(`workspaceContains:${t}`);return}}async function iV(e,t,i,s){if(i.length===0)return Promise.resolve(void 0);const r=new Ke,n=e.checkExists(e.folders,i,r.token),o=setTimeout(async()=>{r.cancel(),e.logService.info(`Not activating extension '${t.value}': Timed out while searching for 'workspaceContains' pattern ${i.join(",")}`)},Kq);let a=!1;try{a=await n}catch(c){ki(c)||pt(c)}r.dispose(),clearTimeout(o),a&&s(`workspaceContains:${i.join(",")}`)}var _8=class{constructor(e){this.b=new I,this.onDidChangePassword=this.b.event,this.a=e.getProxy(Q.MainThreadSecretState)}async $onDidChangePassword(e){this.b.fire(e)}get(e,t){return this.a.$getPassword(e,t)}store(e,t,i){return this.a.$setPassword(e,t,i)}delete(e,t){return this.a.$deletePassword(e,t)}keys(e){return this.a.$getKeys(e)}},QA=W("IExtHostSecretState"),sV=class{#e;constructor(e,t){this.disposables=new X,this.a=it.toKey(e.identifier),this.#e=t,this.onDidChange=Ie.map(Ie.filter(this.#e.onDidChangePassword,i=>i.extensionId===this.a),i=>({key:i.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#e.get(this.a,e)}store(e,t){return this.#e.store(this.a,e,t)}delete(e){return this.#e.delete(this.a,e)}keys(){return this.#e.keys(this.a)||[]}},XA=class{constructor(t,i,s){this.f=s,this.d=new Map,this.a=i.getProxy(Q.MainThreadLocalization),this.b=t.environment.appLanguage,this.c=this.b===Tn}getMessage(t,i){const{message:s,args:r,comment:n}=i;if(this.c)return Qx(s,r??{});let o=s;n&&n.length>0&&(o+=`/${Array.isArray(n)?n.join(""):n}`);const a=this.d.get(t)?.contents[o];return a||this.f.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),Qx(a??s,r??{})}getBundle(t){return this.d.get(t)?.contents}getBundleUri(t){return this.d.get(t)?.uri}async initializeLocalizedMessages(t){if(this.c||!t.l10n&&!t.isBuiltin||this.d.has(t.identifier.value))return;let i;const s=await this.g(t);if(!s){this.f.error(`No bundle location found for extension ${t.identifier.value}`);return}try{const r=await this.a.$fetchBundleContents(s),n=JSON.parse(r);i=t.isBuiltin?n.contents?.bundle:n}catch(r){this.f.error(`Failed to load translations for ${t.identifier.value} from ${s}: ${r.message}`);return}i&&this.d.set(t.identifier.value,{contents:i,uri:s})}async g(t){if(t.isBuiltin){const i=await this.a.$fetchBuiltInBundleUri(t.identifier.value,this.b);return y.revive(i)}return t.l10n?y.joinPath(t.extensionLocation,t.l10n,`bundle.l10n.${this.b}.json`):void 0}};XA=__decorate([__param(0,Wt),__param(1,Te),__param(2,xe)],XA);var KA=W("IExtHostLocalizationService"),e4=W("IExtHostManagedSockets"),t4=class{constructor(t){this.b=0,this.c=null,this.d=new Map,this.a=t.getProxy(Q.MainThreadManagedSockets)}setFactory(t,i){for(const s of this.d.values())s.dispose();this.c&&this.a.$unregisterSocketFactory(this.c.socketFactoryId),this.c=new rV(t,i),this.a.$registerSocketFactory(this.c.socketFactoryId)}async $openRemoteSocket(t){if(!this.c||this.c.socketFactoryId!==t)throw new Error(`No socket factory with id ${t}`);const i=++this.b,s=await this.c.makeConnection(),r=new X;return this.d.set(i,new nV(i,s,r)),r.add(se(()=>this.d.delete(i))),r.add(s.onDidEnd(()=>{this.a.$onDidManagedSocketEnd(i),r.dispose()})),r.add(s.onDidClose(n=>{this.a.$onDidManagedSocketClose(i,n?.stack??n?.message),r.dispose()})),r.add(s.onDidReceiveMessage(n=>this.a.$onDidManagedSocketHaveData(i,_.wrap(n)))),i}$remoteSocketWrite(t,i){this.d.get(t)?.actual.send(i.buffer)}$remoteSocketEnd(t){const i=this.d.get(t);i&&(i.actual.end(),i.dispose())}async $remoteSocketDrain(t){await this.d.get(t)?.actual.drain?.()}};t4=__decorate([__param(0,Te)],t4);var rV=class{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}},nV=class extends J{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this.D(i)}},i4,B8=W("IHostUtils"),s4=i4=class extends J{constructor(t,i,s,r,n,o,a,c,l,u,h,f,p){super(),this.Y=f,this.Z=p,this.a=this.D(new I),this.onDidChangeRemoteConnectionData=this.a.event,this.R=new Map,this.W=!1,this.c=i,this.g=s,this.f=a,this.j=r,this.m=n,this.q=o,this.s=l,this.t=u,this.u=h,this.w=this.g.getProxy(Q.MainThreadWorkspace),this.y=this.g.getProxy(Q.MainThreadTelemetry),this.z=this.g.getProxy(Q.MainThreadExtensionService),this.C=new ms,this.F=new ms,this.G=new ms,this.H=new ms,this.I=new aV(this.f.extensions.activationEvents),this.L=new Zh(this.I,this.f.extensions.allExtensions);const g=new Qo(this.f.extensions.myExtensions);this.J=new Zh(this.I,G8(this.L,g)),Uo&&(this.q.info(`Creating extension host with the following global extensions: ${Tl(this.L)}`),this.q.info(`Creating extension host with the following local extensions: ${Tl(this.J)}`)),this.M=new q9(this.g,this.q),this.N=new _8(this.g),this.O=c,this.h=this.B.add(t.createChild(new H0([vA,this.M],[QA,this.N]))),this.P=this.D(new gA(this.J,this.L,{onExtensionActivationError:(v,b,S)=>{this.z.$onExtensionActivationError(v,tc(b),S)},actualActivateExtension:async(v,b)=>{if(Zh.isHostExtension(v,this.J,this.L))return await this.z.$activateExtension(v,b),new JB;const S=this.J.getExtensionDescription(v);return this.fb(S,b)}},this.q)),this.Q=null,this.S=Object.create(null),this.U=!1,this.X=this.f.remote.connectionData}getRemoteConnectionData(){return this.X}async initialize(){try{await this.wb(),this.C.open(),await this.j.waitForInitializeCall(),Ht("code/extHost/ready"),this.F.open(),this.f.autoStart&&this.tb()}catch(t){pt(t)}}async $(){this.O.onWillDeactivateAll();let t=[];try{t=this.J.getAllExtensionDescriptions().map(n=>n.identifier).filter(n=>this.isActivated(n)).map(n=>this.eb(n))}catch{}await Promise.all(t)}terminate(t,i=0){if(this.W)return;this.W=!0,this.q.info(`Extension host terminating: ${t}`),this.q.flush(),this.t.dispose(),this.P.dispose(),C1(r=>{this.q.error(r)}),this.g.dispose();const s=this.$();Promise.race([Kt(5e3),s]).finally(()=>{this.c.pid?this.q.info(`Extension host with pid ${this.c.pid} exiting with code ${i}`):this.q.info(`Extension host exiting with code ${i}`),this.q.flush(),this.q.dispose(),this.c.exit(i)})}isActivated(t){return this.G.isOpen()?this.P.isActivated(t):!1}async getExtension(t){const i=await this.z.$getExtension(t);return i&&{...i,identifier:new it(i.identifier.value),extensionLocation:y.revive(i.extensionLocation)}}ab(t,i){return this.P.activateByEvent(t,i)}bb(t,i){return this.P.activateById(t,i)}activateByIdWithErrors(t,i){return this.bb(t,i).then(()=>{const s=this.P.getActivatedExtension(t);if(s.activationFailed)return Promise.reject(s.activationFailedError)})}getExtensionRegistry(){return this.G.wait().then(t=>this.J)}getExtensionExports(t){if(this.G.isOpen())return this.P.getActivatedExtension(t).exports;try{return this.P.getActivatedExtension(t).exports}catch{return null}}async cb(t){if(t.scheme===V.file&&this.c.fsRealpath){const i=t.fsPath;this.R.has(i)||this.R.set(i,this.c.fsRealpath(i));const s=await this.R.get(i);return y.file(s)}return t}async getExtensionPathIndex(){return this.Q||(this.Q=this.db(this.J.getAllExtensionDescriptions()).then(t=>new oV(t))),this.Q}async db(t){const i=Yn.forUris(s=>e0.ignorePathCasing(s));return await Promise.all(t.map(async s=>{if(this.xb(s)){const r=await this.cb(s.extensionLocation);i.set(r,s)}})),i}eb(t){let i=Promise.resolve(void 0);if(!this.G.isOpen()||!this.P.isActivated(t))return i;const s=this.P.getActivatedExtension(t);if(!s)return i;try{typeof s.module.deactivate=="function"&&(i=Promise.resolve(s.module.deactivate()).then(void 0,r=>(this.q.error(r),Promise.resolve(void 0))))}catch(r){this.q.error(`An error occurred when deactivating the extension '${t.value}':`),this.q.error(r)}try{s.disposable.dispose()}catch(r){this.q.error(`An error occurred when disposing the subscriptions for extension '${t.value}':`),this.q.error(r)}return i}async fb(t,i){return this.f.remote.isRemote?this.z.$onWillActivateExtension(t.identifier):await this.z.$onWillActivateExtension(t.identifier),this.hb(t,i).then(s=>{const r=s.activationTimes;return this.z.$onDidActivateExtension(t.identifier,r.codeLoadingTime,r.activateCallTime,r.activateResolvedTime,i),this.gb(t,i,"success",r),s},s=>{throw this.gb(t,i,"failure"),s})}gb(t,i,s,r){const n=V8(t,i);this.y.$publicLog2("extensionActivationTimes",{...n,...r||{},outcome:s})}hb(t,i){const s=V8(t,i);this.y.$publicLog2("activatePlugin",s);const r=this.xb(t);if(!r)return Promise.resolve(new GB(Sm.NONE));this.q.info(`ExtensionService#_doActivateExtension ${t.identifier.value}, startup: ${i.startup}, activationEvent: '${i.activationEvent}'${t.identifier.value!==i.extensionId.value?`, root cause: ${i.extensionId.value}`:""}`),this.q.flush();const n=this.vb(t),o=new X,a=new pA(i.startup);return Promise.all([n?this.zb(t,Lt(t.extensionLocation,r),a):this.yb(t,Lt(t.extensionLocation,r),a),this.ib(t,o)]).then(c=>(Ht(`code/extHost/willActivateExtension/${t.identifier.value}`),i4.jb(this.q,t.identifier,c[0],c[1],o,a))).then(c=>(Ht(`code/extHost/didActivateExtension/${t.identifier.value}`),c))}ib(t,i){const s=this.Z.createLanguageModelAccessInformation(t),r=i.add(new ZB(t,this.M)),n=i.add(new V9(t.identifier.value,!1,this.M)),o=i.add(new sV(t,this.N)),a=t.isUnderDevelopment?this.f.environment.extensionTestsLocationURI?nl.Test:nl.Development:nl.Production,c=this.f.remote.isRemote?xa.Workspace:xa.UI;return this.q.trace(`ExtensionService#loadExtensionContext ${t.identifier.value}`),Promise.all([r.whenReady,n.whenReady,this.O.whenReady]).then(()=>{const l=this;let u,h;const f=qe(t,"ipc")?this.f.messagePorts?.get(it.toKey(t.identifier)):void 0;return Object.freeze({globalState:r,workspaceState:n,secrets:o,subscriptions:[],get languageModelAccessInformation(){return s},get extensionUri(){return t.extensionLocation},get extensionPath(){return t.extensionLocation.fsPath},asAbsolutePath(p){return Ge(t.extensionLocation.fsPath,p)},get storagePath(){return l.O.workspaceValue(t)?.fsPath},get globalStoragePath(){return l.O.globalValue(t).fsPath},get logPath(){return Ge(l.f.logsLocation.fsPath,t.identifier.value)},get logUri(){return y.joinPath(l.f.logsLocation,t.identifier.value)},get storageUri(){return l.O.workspaceValue(t)},get globalStorageUri(){return l.O.globalValue(t)},get extensionMode(){return a},get extension(){return u===void 0&&(u=new ed(l,t.identifier,t,c,!1)),u},get extensionRuntime(){return T(t,"extensionRuntime"),l.extensionRuntime},get environmentVariableCollection(){return l.t.getEnvironmentVariableCollection(t)},get messagePassingProtocol(){if(!h){if(!f)return;const p=Ie.buffer(Ie.fromDOMEventEmitter(f,"message",g=>g.data));f.start(),h={onDidReceiveMessage:p,postMessage:f.postMessage.bind(f)}}return h}})})}static jb(t,i,s,r,n,o){return s=s||{activate:void 0,deactivate:void 0},this.kb(t,i,s,r,o).then(a=>new Em(!1,null,o.build(),s,a,se(()=>{n.dispose(),Yi(r.subscriptions)})))}static kb(t,i,s,r,n){if(typeof s.activate=="function")try{n.activateCallStart(),t.trace(`ExtensionService#_callActivateOptional ${i.value}`);const o=s.activate.apply(globalThis,[r]);return n.activateCallStop(),n.activateResolveStart(),Promise.resolve(o).then(a=>(n.activateResolveStop(),a))}catch(o){return Promise.reject(o)}else return Promise.resolve(s)}lb(t,i){this.bb(t.identifier,{startup:!1,extensionId:t.identifier,activationEvent:i}).then(void 0,s=>{this.q.error(s)})}mb(t,i=0){const r=Date.now();Wx(()=>{for(let n=i;n<t.length;n+=1){const o=t[n];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-r>50){this.mb(t,n);break}else this.lb(o,a)}})}nb(){this.z.$setPerformanceMarks(cF()),this.m.getConfigProvider().then(t=>{const i=t.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),s=this.J.getAllExtensionDescriptions();if(i)this.mb(s);else for(const r of s)if(r.activationEvents)for(const n of r.activationEvents)n==="onStartupFinished"&&this.lb(r,n)})}ob(){const t=this.ab("*",!0).then(void 0,o=>{this.q.error(o)});this.D(this.j.onDidChangeWorkspace(o=>this.pb(o.added)));const i=this.j.workspace?this.j.workspace.folders:[],s=this.pb(i),r=this.rb(),n=Promise.all([r,t,s]).then(()=>{});return Promise.race([n,Kt(1e4)]).then(()=>{this.nb()}),n}pb(t){return t.length===0?Promise.resolve(void 0):Promise.all(this.J.getAllExtensionDescriptions().map(i=>this.qb(t,i))).then(()=>{})}async qb(t,i){if(this.isActivated(i.identifier))return;const s=!this.f.remote.isRemote&&!!this.f.remote.authority,r={logService:this.q,folders:t.map(o=>o.uri),forceUsingSearch:s||!this.c.fsExists,exists:o=>this.c.fsExists(o.fsPath),checkExists:(o,a,c)=>this.w.$checkExists(o,a,c)},n=await eV(r,i);if(n)return this.bb(i.identifier,{startup:!0,extensionId:i.identifier,activationEvent:n.activationEvent}).then(void 0,o=>this.q.error(o))}async rb(){if(this.f.remote.authority)return this.ab(`onResolveRemoteAuthority:${this.f.remote.authority}`,!1)}async $extensionTestsExecute(){await this.H.wait();try{return await this.sb()}catch(t){throw console.error(t),t}}async sb(){const{extensionDevelopmentLocationURI:t,extensionTestsLocationURI:i}=this.f.environment;if(!t||!i)throw new Error(d(3039,null));const s=(await this.getExtensionPathIndex()).findSubstr(i),n=await(this.vb(s,i.path)?this.zb(null,i,new pA(!1)):this.yb(null,i,new pA(!1)));if(!n||typeof n.run!="function")throw new Error(d(3040,null,i.toString()));return new Promise((o,a)=>{const c=(h,f)=>{h?(Uo&&this.q.error("Test runner called back with error",h),a(h)):(Uo&&(f?this.q.info(`Test runner called back with ${f} failures.`):this.q.info("Test runner called back with successful outcome.")),o(typeof f=="number"&&f>0?1:0))},l=_s(i),u=n.run(l,c);u&&u.then&&u.then(()=>{Uo&&this.q.info("Test runner finished successfully."),o(0)}).catch(h=>{Uo&&this.q.error("Test runner finished with error",h),a(h instanceof Error&&h.stack?h.stack:String(h))})})}tb(){if(this.U)throw new Error("Extension host is already started!");return this.U=!0,this.F.wait().then(()=>this.G.open()).then(()=>Promise.race([this.P.waitForActivatingExtensions(),Kt(1e3)])).then(()=>this.ob()).then(()=>{this.H.open(),this.q.info("Eager extensions activated")})}registerRemoteAuthorityResolver(t,i){return this.S[t]=i,se(()=>{delete this.S[t]})}async getRemoteExecServer(t){const{resolver:i}=await this.ub(t);return i?.resolveExecServer?.(t,{resolveAttempt:0})}async ub(t){const i=t.indexOf("+");if(i===-1)throw new Oc("Not an authority that can be resolved!",Wi.InvalidAuthority);const s=t.substr(0,i);return await this.C.wait(),await this.ab(`onResolveRemoteAuthority:${s}`,!1),{authorityPrefix:s,resolver:this.S[s]}}async $resolveAuthority(t,i){const s=Qi.create(!1),r=()=>`[resolveAuthority(${ID(t)},${i})][${s.elapsed()}ms] `,n=E=>this.q.info(`${r()}${E}`),o=E=>this.q.warn(`${r()}${E}`),a=(E,k=void 0)=>this.q.error(`${r()}${E}`,k),c=E=>{if(E instanceof Oc)return{type:"error",error:{code:E._code,message:E._message,detail:E._detail}};throw E},l=async E=>{n(`activating resolver for ${E}...`);const{resolver:k,authorityPrefix:O}=await this.ub(E);if(!k)throw a(`no resolver for ${O}`),new Oc(`No remote extension installed to resolve ${O}.`,Wi.NoResolverFound);return{resolver:k,authorityPrefix:O,remoteAuthority:E}},u=t.split(/@|%40/g).reverse();n(`activating remote resolvers ${u.join(" -> ")}`);let h;try{h=await Promise.all(u.map(l)).catch(async E=>{if(!(E instanceof Oc)||E._code!==Wi.InvalidAuthority)throw E;return o(`resolving nested authorities failed: ${E.message}`),[await l(t)]})}catch(E){return c(E)}const f=new LC;f.cancelAndSet(()=>n("waiting..."),1e3);let p,g;for(const[E,{authorityPrefix:k,resolver:O,remoteAuthority:F}]of h.entries())try{if(E===h.length-1)n("invoking final resolve()..."),Ht(`code/extHost/willResolveAuthority/${k}`),p=await O.resolve(F,{resolveAttempt:i,execServer:g}),Ht(`code/extHost/didResolveAuthorityOK/${k}`),n("setting tunnel factory..."),this.D(await this.s.setTunnelFactory(O,Mp.isManagedResolvedAuthority(p)?p:void 0));else{if(n(`invoking resolveExecServer() for ${F}`),Ht(`code/extHost/willResolveExecServer/${k}`),g=await O.resolveExecServer?.(F,{resolveAttempt:i,execServer:g}),!g)throw new Oc(`Exec server was not available for ${F}`,Wi.NoResolverFound);Ht(`code/extHost/didResolveExecServerOK/${k}`)}}catch(G){return Ht(`code/extHost/didResolveAuthorityError/${k}`),a("returned an error",G),f.dispose(),c(G)}f.dispose();const v={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?!0:p.tunnelFeatures.protocol}:void 0},b={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};n(`returned ${Mp.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let S;if(Mp.isManagedResolvedAuthority(p)){const E=i;this.Y.setFactory(E,p.makeConnection),S={authority:t,connectTo:new $D(E),connectionToken:p.connectionToken}}else S={authority:t,connectTo:new x_(p.host,p.port),connectionToken:p.connectionToken};return{type:"ok",value:{authority:S,options:b,tunnelInformation:v}}}async $getCanonicalURI(t,i){this.q.info(`$getCanonicalURI invoked for authority (${ID(t)})`);const{resolver:s}=await this.ub(t);if(!s)return null;const r=y.revive(i);if(typeof s.getCanonicalURI>"u")return r;const n=await wi(()=>s.getCanonicalURI(r));return n||r}async $startExtensionHost(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:s}=q8(this.I,this.L,this.J,t),r=await this.db(s);return(await this.getExtensionPathIndex()).setSearchTree(r),this.L.set(i.getAllExtensionDescriptions()),this.J.set(s),Uo&&(this.q.info(`$startExtensionHost: global extensions: ${Tl(this.L)}`),this.q.info(`$startExtensionHost: local extensions: ${Tl(this.J)}`)),this.tb()}$activateByEvent(t,i){return i===1?this.C.wait().then(s=>this.ab(t,!1)):this.G.wait().then(s=>this.ab(t,!1))}async $activate(t,i){return await this.G.wait(),this.J.getExtensionDescription(t)?(await this.bb(t,i),!0):!1}async $deltaExtensions(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:s}=q8(this.I,this.L,this.J,t),r=await this.db(s);return(await this.getExtensionPathIndex()).setSearchTree(r),this.L.set(i.getAllExtensionDescriptions()),this.J.set(s),Uo&&(this.q.info(`$deltaExtensions: global extensions: ${Tl(this.L)}`),this.q.info(`$deltaExtensions: local extensions: ${Tl(this.J)}`)),Promise.resolve(void 0)}async $test_latency(t){return t}async $test_up(t){return t.byteLength}async $test_down(t){const i=_.alloc(t),s=Math.random()%256;for(let r=0;r<t;r++)i.writeUInt8(s,r);return i}async $updateRemoteConnectionData(t){this.X=t,this.a.fire()}vb(t,i){return i??=t?this.xb(t):i,i?.endsWith(".mjs")||t?.type==="module"&&!i?.endsWith(".cjs")}};s4=i4=__decorate([__param(0,Yo),__param(1,B8),__param(2,Te),__param(3,Ts),__param(4,bs),__param(5,xe),__param(6,Wt),__param(7,bA),__param(8,km),__param(9,pn),__param(10,KA),__param(11,e4),__param(12,HA)],s4);function q8(e,t,i,s){e.addActivationEvents(s.addActivationEvents);const r=new Zh(e,t.getAllExtensionDescriptions());r.deltaExtensions(s.toAdd,s.toRemove);const n=new Qo(i.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of s.myToRemove)n.delete(a);for(const a of s.myToAdd)n.add(a);const o=G8(r,n);return{globalRegistry:r,myExtensions:o}}function V8(e,t){return{id:e.identifier.value,name:e.name,extensionVersion:e.version,publisherDisplayName:e.publisher,activationEvents:e.activationEvents?e.activationEvents.join(","):null,isBuiltin:e.isBuiltin,reason:t.activationEvent,reasonId:t.extensionId.value}}function Tl(e){return e.getAllExtensionDescriptions().map(t=>t.identifier.value).join(",")}var gn=W("IExtHostExtensionService"),ed=class{#e;#t;#i;constructor(e,t,i,s,r){this.#e=e,this.#t=t,this.#i=i.identifier,this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=Yr(_s(i.extensionLocation)),this.packageJSON=i,this.extensionKind=s,this.isFromDifferentExtensionHost=r}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await this.#e.activateByIdWithErrors(this.#i,{startup:!1,extensionId:this.#t,activationEvent:"api"}),this.exports}};function G8(e,t){return e.getAllExtensionDescriptions().filter(i=>t.has(i.identifier))}var oV=class{constructor(e){this.a=e}setSearchTree(e){this.a=e}findSubstr(e){return this.a.findSubstr(e)}forEach(e){return this.a.forEach(e)}},aV=class{constructor(e){this.a=new Gn,this.addActivationEvents(e)}readActivationEvents(e){return this.a.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this.a.set(t,e[t])}},Ml=W("IExtHostApiDeprecationService"),r4=class{constructor(t,i){this.c=i,this.a=new Set,this.b=t.getProxy(Q.MainThreadTelemetry)}report(t,i,s){const r=this.d(t,i);this.a.has(r)||(this.a.add(r),i.isUnderDevelopment&&this.c.warn(`[Deprecation Warning] '${t}' is deprecated. ${s}`),this.b.$publicLog2("extHostDeprecatedApiUsage",{extensionId:i.identifier.value,apiId:t}))}d(t,i){return`${t}-${i.identifier.value}`}};r4=__decorate([__param(0,Te),__param(1,xe)],r4);var $ne=Object.freeze(new class{report(e,t,i){}}),J8=class{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(xe),s=e.get(Te).getProxy(Q.MainThreadErrors);C1(r=>{t.error(r);const n=tc(r);s.$onUnexpectedError(n)})}static async installFullHandler(e){const t=e.get(xe),i=e.get(Te),s=e.get(gn),r=e.get(Im),n=e.get(Ml),o=i.getProxy(Q.MainThreadExtensionService),a=i.getProxy(Q.MainThreadErrors),c=await s.getExtensionRegistry(),l=await s.getExtensionPathIndex(),u=new WeakMap;function h(g,v){if(u.has(g))return u.get(g).stack;let b="",S,E;for(const O of v)b+=`
	at ${O.toString()}`,E=O.getFileName(),!S&&E&&(S=l.findSubstr(y.file(E)));const k=`${g.name||"Error"}: ${g.message||""}${b}`;return u.set(g,{extensionIdentifier:S?.identifier,stack:k}),k}const f=Symbol("prepareStackTrace wrapped");let p=h;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return p},set(g){if(g===h||!g||g[f]){p=g||h;return}p=function(v,b){return h(v,b),g.call(Error,v,b)},Object.assign(p,{[f]:!0})}}),C1(g=>{k1.is(g)||t.error(g);const v=tc(g);let b;if(g instanceof w5?b=g.extension:b=u.get(g)?.extensionIdentifier,!!b)if(k1.is(g)){const S=c.getExtensionDescription(b);S&&n.report(g.name,S,`${g.message}
 FROM: ${g.stack}`)}else{o.$onExtensionRuntimeError(b,v);const S=r.onExtensionError(b,g);t.trace("forwarded error to extension?",S,b)}}),ru.addListener(g=>{a.$onUnexpectedError(g)})}},cV=class nR{constructor(t,i,s,r,n){this.a=s,this.b=new uU(t,null,r),i=nR.e(i,this.b);const o=new H0(...RU());o.set(Wt,{_serviceBrand:void 0,...i,messagePorts:n}),o.set(Te,new jU(this.b)),o.set(ku,new UU(r)),o.set(B8,s);const a=new FU(o,!0);a.invokeFunction(J8.installEarlyHandler),this.d=a.invokeFunction(c=>c.get(xe)),Ht("code/extHost/didCreateServices"),this.a.pid?this.d.info(`Extension host with pid ${this.a.pid} started`):this.d.info("Extension host started"),this.d.trace("initData",i),this.c=a.invokeFunction(c=>c.get(gn)),this.c.initialize(),a.invokeFunction(J8.installFullHandler)}async asBrowserUri(t){const i=this.b.getProxy(Q.MainThreadExtensionService);return y.revive(await i.$asBrowserUri(t))}terminate(t){this.c.terminate(t)}static e(t,i){t.extensions.allExtensions.forEach(r=>{r.extensionLocation=y.revive(i.transformIncomingURIs(r.extensionLocation))}),t.environment.appRoot=y.revive(i.transformIncomingURIs(t.environment.appRoot));const s=t.environment.extensionDevelopmentLocationURI;return s&&(t.environment.extensionDevelopmentLocationURI=s.map(r=>y.revive(i.transformIncomingURIs(r)))),t.environment.extensionTestsLocationURI=y.revive(i.transformIncomingURIs(t.environment.extensionTestsLocationURI)),t.environment.globalStorageHome=y.revive(i.transformIncomingURIs(t.environment.globalStorageHome)),t.environment.workspaceStorageHome=y.revive(i.transformIncomingURIs(t.environment.workspaceStorageHome)),t.nlsBaseUrl=y.revive(i.transformIncomingURIs(t.nlsBaseUrl)),t.logsLocation=y.revive(i.transformIncomingURIs(t.logsLocation)),t.workspace=i.transformIncomingURIs(t.workspace),t}};function lV(e){return{transformIncoming:t=>t.scheme==="vscode-remote"?{scheme:"file",path:t.path,query:t.query,fragment:t.fragment}:t.scheme==="file"?{scheme:"vscode-local",path:t.path,query:t.query,fragment:t.fragment}:t,transformOutgoing:t=>t.scheme==="file"?{scheme:"vscode-remote",authority:e,path:t.path,query:t.query,fragment:t.fragment}:t.scheme==="vscode-local"?{scheme:"file",path:t.path,query:t.query,fragment:t.fragment}:t,transformOutgoingScheme:t=>t==="file"?"vscode-remote":t==="vscode-local"?"file":t}}function uV(e){return new sU(lV(e))}var Z8;(function(e){e[e.IPC=1]="IPC",e[e.Socket=2]="Socket",e[e.MessagePort=3]="MessagePort"})(Z8||(Z8={}));var Fm=class oR{static{this.ENV_KEY="VSCODE_EXTHOST_IPC_HOOK"}constructor(t){this.pipeName=t,this.type=1}serialize(t){t[oR.ENV_KEY]=this.pipeName}},n4=class aR{constructor(){this.type=2}static{this.ENV_KEY="VSCODE_EXTHOST_WILL_SEND_SOCKET"}serialize(t){t[aR.ENV_KEY]="1"}},o4=class cR{constructor(){this.type=3}static{this.ENV_KEY="VSCODE_WILL_SEND_MESSAGE_PORT"}serialize(t){t[cR.ENV_KEY]="1"}};function hV(e){delete e[Fm.ENV_KEY],delete e[n4.ENV_KEY],delete e[o4.ENV_KEY]}function dV(e){if(e[Fm.ENV_KEY])return a4(e,new Fm(e[Fm.ENV_KEY]));if(e[n4.ENV_KEY])return a4(e,new n4);if(e[o4.ENV_KEY])return a4(e,new o4);throw new Error("No connection information defined in environment!")}function a4(e,t){return hV(e),t}var Ine=new C("inOutput",!1),Dne=new C("activeLogOutput",!1),Pne=new C("activeLogOutput.isLog",!1),Tne=new C("activeLogOutput.levelSettable",!1),Mne=new C("activeLogOutput.level",""),Nne=new C("activeLogOutput.levelIsDefault",!1),Rne=new C("outputView.scrollLock",!1),Lne=new C("activeOutputChannel",""),One=new C("output.filter.trace",!0),Fne=new C("output.filter.debug",!0),jne=new C("output.filter.info",!0),Une=new C("output.filter.warning",!0),zne=new C("output.filter.error",!0),Hne=new C("outputFilterFocus",!1),Wne=new C("output.filter.categories",""),_ne=W("outputService"),td;(function(e){e[e.Append=1]="Append",e[e.Replace=2]="Replace",e[e.Clear=3]="Clear"})(td||(td={}));var fV={OutputChannels:"workbench.contributions.outputChannels"};function pV(e){return Array.isArray(e.source)}var gV=class extends J{constructor(){super(...arguments),this.a=new Map,this.b=this.D(new I),this.onDidRegisterChannel=this.b.event,this.c=this.D(new I),this.onDidRemoveChannel=this.c.event,this.f=this.D(new I),this.onDidUpdateChannelSources=this.f.event}registerChannel(e){this.a.has(e.id)||(this.a.set(e.id,e),this.b.fire(e.id))}getChannels(){const e=[];return this.a.forEach(t=>e.push(t)),e}getChannel(e){return this.a.get(e)}updateChannelSources(e,t){const i=this.a.get(e);i&&pV(i)&&(i.source=t,this.f.fire(i))}removeChannel(e){const t=this.a.get(e);t&&(this.a.delete(e),this.c.fire(t))}};Qt.add(fV.OutputChannels,new gV);var Y8=class extends z0{constructor(e,t,i,s,r){super(),this.id=e,this.name=t,this.q=i,this.r=s,this.extension=r,this.n=0,this.visible=!1,this.setLevel(i.getLevel()),this.D(i.onDidChangeLogLevel(n=>this.setLevel(n))),this.D(se(()=>this.r.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.n;this.q.flush(),this.r.$update(this.id,td.Clear,e)}replace(e){const t=this.n;this.info(e),this.r.$update(this.id,td.Replace,t),this.visible&&this.q.flush()}show(e,t){this.q.flush(),this.r.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.r.$close(this.id)}m(e,t){this.n+=_.fromString(t).byteLength,PU(this.q,e,t),this.visible&&(this.q.flush(),this.r.$update(this.id,td.Append))}},mV=class extends Y8{appendLine(e){this.append(e)}},c4=class{constructor(t,i,s,r,n,o){this.j=i,this.k=s,this.l=r,this.m=n,this.n=o,this.d=new Ct,this.f=new Ct,this.g=1,this.h=new Map,this.i=null,this.a=t.getProxy(Q.MainThreadOutputService),this.b=this.l.extUri.joinPath(i.logsLocation,`output_logging_${Fq(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(t){this.i=t;for(const[i,s]of this.h)s.visible=i===this.i}createOutputChannel(t,i,s){if(t=t.trim(),!t)throw new Error("illegal argument `name`. must not be falsy");const r=typeof i=="object"&&i.log,n=Oe(i)?i:void 0;if(Oe(n)&&!n.trim())throw new Error("illegal argument `languageId`. must not be empty");const o=new X;let a,c=this.j.environment.extensionLogLevel?.find(([u])=>it.equals(s.identifier,u))?.[1],l;if(r){const u=this.l.extUri.joinPath(this.j.logsLocation,s.identifier.value);l=this.l.extUri.joinPath(u,`${t.replace(/[\\/:\*\?"<>\|]/g,"")}.log`);const h=this.f.get(l);if(h)return h;const f=this.m.getRegisteredLogger(l);f?.logLevel!==void 0&&(c=f.logLevel),a=this.p(t,l,c,s,o)}else a=this.o(t,n,s,o);if(a.then(u=>{this.h.set(u.id,u),u.visible=u.id===this.i,o.add(se(()=>{this.h.delete(u.id),l&&this.f.delete(l)}))}),l){const u=this.s(t,c??this.n.getLevel(),a,o);return this.f.set(l,u),u}return this.r(t,a,o)}async o(t,i,s,r){this.c||(this.c=this.k.value.createDirectory(this.b).then(()=>this.b));const n=await this.c,o=this.l.extUri.joinPath(n,`${this.g++}-${t.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),a=r.add(this.m.createLogger(o,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0})),c=await this.a.$register(t,o,i,s.identifier.value);return r.add(se(()=>this.m.deregisterLogger(o))),new Y8(c,t,a,this.a,s)}async p(t,i,s,r,n){await this.q(i);const o=`${r.identifier.value}.${this.l.extUri.basename(i)}`,a=n.add(this.m.createLogger(i,{id:o,name:t,logLevel:s,extensionId:r.identifier.value}));return n.add(se(()=>this.m.deregisterLogger(i))),new mV(o,t,a,this.a,r)}q(t){const i=this.l.extUri.dirname(t);let s=this.d.get(i);return s||this.d.set(i,s=(async()=>{try{await this.k.value.createDirectory(i)}catch(r){if(Vf(r)!==de.FileExists)throw r}})()),s}r(t,i,s){const r=()=>{if(s.isDisposed)throw new Error("Channel has been closed")};return i.then(n=>s.add(n)),{get name(){return t},append(n){r(),i.then(o=>o.append(n))},appendLine(n){r(),i.then(o=>o.appendLine(n))},clear(){r(),i.then(n=>n.clear())},replace(n){r(),i.then(o=>o.replace(n))},show(n,o){r(),i.then(a=>a.show(n,o))},hide(){r(),i.then(n=>n.hide())},dispose(){s.dispose()}}}s(t,i,s,r){const n=()=>{if(r.isDisposed)throw new Error("Channel has been closed")},o=r.add(new I);function a(c){i=c,o.fire(c)}return s.then(c=>{c.logLevel!==i&&a(c.logLevel),r.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.r(t,s,r),get logLevel(){return i},onDidChangeLogLevel:o.event,trace(c,...l){n(),s.then(u=>u.trace(c,...l))},debug(c,...l){n(),s.then(u=>u.debug(c,...l))},info(c,...l){n(),s.then(u=>u.info(c,...l))},warn(c,...l){n(),s.then(u=>u.warn(c,...l))},error(c,...l){n(),s.then(u=>u.error(c,...l))}}}};c4=__decorate([__param(0,Te),__param(1,Wt),__param(2,Yh),__param(3,bc),__param(4,Zn),__param(5,xe)],c4);var Q8=W("IExtHostOutputService"),id,l4=class{static{id=this}static{this.c=0}static{this.d=250}constructor(t,i){this.h=i,this.f=new Map,this.g=t.getProxy(Q.MainThreadDecorations)}registerFileDecorationProvider(t,i){const s=id.c++;this.f.set(s,{provider:t,extensionDescription:i}),this.g.$registerDecorationProvider(s,i.identifier.value);const r=t.onDidChangeFileDecorations&&t.onDidChangeFileDecorations(n=>{if(!n){this.g.$onDidChange(s,null);return}const o=Es(n);if(o.length<=id.d){this.g.$onDidChange(s,o);return}this.h.warn("[Decorations] CAPPING events from decorations provider",i.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:O2(u.path,"/")})),c=SL(a,(u,h)=>u.rank-h.rank||_o(u.uri.path,h.uri.path)),l=[];e:for(const u of c){let h;for(const f of u){const p=Fi(f.uri.path);if(h!==p&&(h=p,l.push(f.uri)>=id.d))break e}}this.g.$onDidChange(s,l)});return new Pe(()=>{r?.dispose(),this.g.$unregisterDecorationProvider(s),this.f.delete(s)})}async $provideDecorations(t,i,s){if(!this.f.has(t))return Object.create(null);const r=Object.create(null),{provider:n,extensionDescription:o}=this.f.get(t);return await Promise.all(i.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(n.provideFileDecoration(y.revive(c),s));if(!u)return;try{xb.validate(u),u.badge&&typeof u.badge!="string"&&T(o,"codiconDecoration"),r[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(h){this.h.warn(`INVALID decoration from extension '${o.identifier.value}': ${h}`)}}catch(c){this.h.error(c)}})),r}};l4=id=__decorate([__param(0,Te),__param(1,xe)],l4);var X8=W("IExtHostDecorations"),vV=class{constructor(e){this.a=e,this.b=new Uint32Array(e.length),this.c=new Int32Array(1),this.c[0]=-1}getCount(){return this.a.length}insertValues(e,t){e=Pl(e);const i=this.a,s=this.b,r=t.length;return r===0?!1:(this.a=new Uint32Array(i.length+r),this.a.set(i.subarray(0,e),0),this.a.set(i.subarray(e),e+r),this.a.set(t,e),e-1<this.c[0]&&(this.c[0]=e-1),this.b=new Uint32Array(this.a.length),this.c[0]>=0&&this.b.set(s.subarray(0,this.c[0]+1)),!0)}setValue(e,t){return e=Pl(e),t=Pl(t),this.a[e]===t?!1:(this.a[e]=t,e-1<this.c[0]&&(this.c[0]=e-1),!0)}removeValues(e,t){e=Pl(e),t=Pl(t);const i=this.a,s=this.b;if(e>=i.length)return!1;const r=i.length-e;return t>=r&&(t=r),t===0?!1:(this.a=new Uint32Array(i.length-t),this.a.set(i.subarray(0,e),0),this.a.set(i.subarray(e+t),e),this.b=new Uint32Array(this.a.length),e-1<this.c[0]&&(this.c[0]=e-1),this.c[0]>=0&&this.b.set(s.subarray(0,this.c[0]+1)),!0)}getTotalSum(){return this.a.length===0?0:this.d(this.a.length-1)}getPrefixSum(e){return e<0?0:(e=Pl(e),this.d(e))}d(e){if(e<=this.c[0])return this.b[e];let t=this.c[0]+1;t===0&&(this.b[0]=this.a[0],t++),e>=this.a.length&&(e=this.a.length-1);for(let i=t;i<=e;i++)this.b[i]=this.b[i-1]+this.a[i];return this.c[0]=Math.max(this.c[0],e),this.b[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.a.length-1,s=0,r=0,n=0;for(;t<=i;)if(s=t+(i-t)/2|0,r=this.b[s],n=r-this.a[s],e<n)i=s-1;else if(e>=r)t=s+1;else break;return new wV(s,e-n)}},wV=class{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}},bV=class{constructor(e,t,i,s){this.a=e,this.b=t,this.c=i,this.d=s,this.f=null,this.g=null}dispose(){this.b.length=0}get version(){return this.d}getText(){return this.g===null&&(this.g=this.b.join(this.c)),this.g}onEvents(e){e.eol&&e.eol!==this.c&&(this.c=e.eol,this.f=null);const t=e.changes;for(const i of t)this.k(i.range),this.l(new ws(i.range.startLineNumber,i.range.startColumn),i.text);this.d=e.versionId,this.g=null}h(){if(!this.f){const e=this.c.length,t=this.b.length,i=new Uint32Array(t);for(let s=0;s<t;s++)i[s]=this.b[s].length+e;this.f=new vV(i)}}j(e,t){this.b[e]=t,this.f&&this.f.setValue(e,this.b[e].length+this.c.length)}k(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this.j(e.startLineNumber-1,this.b[e.startLineNumber-1].substring(0,e.startColumn-1)+this.b[e.startLineNumber-1].substring(e.endColumn-1));return}this.j(e.startLineNumber-1,this.b[e.startLineNumber-1].substring(0,e.startColumn-1)+this.b[e.endLineNumber-1].substring(e.endColumn-1)),this.b.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this.f&&this.f.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}l(e,t){if(t.length===0)return;const i=eC(t);if(i.length===1){this.j(e.lineNumber-1,this.b[e.lineNumber-1].substring(0,e.column-1)+i[0]+this.b[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this.b[e.lineNumber-1].substring(e.column-1),this.j(e.lineNumber-1,this.b[e.lineNumber-1].substring(0,e.column-1)+i[0]);const s=new Uint32Array(i.length-1);for(let r=1;r<i.length;r++)this.b.splice(e.lineNumber+r-1,0,i[r]),s[r-1]=i[r].length+this.c.length;this.f&&this.f.insertValues(e.lineNumber,s)}},u4=new Map;function yV(e,t){t?u4.set(e,t):u4.delete(e)}function AV(e){return u4.get(e)}var SV=class extends bV{constructor(e,t,i,s,r,n,o,a,c=!0){super(t,i,s,r),this.o=e,this.p=n,this.q=o,this.r=a,this.s=c,this.n=!1}dispose(){Ii(!this.n),this.n=!0,this.q=!1}equalLines(e){return $i(this.b,e)}get document(){if(!this.m){const e=this;this.m={get uri(){return e.a},get fileName(){return e.a.fsPath},get isUntitled(){return e.a.scheme===V.untitled},get languageId(){return e.p},get version(){return e.d},get isClosed(){return e.n},get isDirty(){return e.q},get encoding(){return e.r},save(){return e.t()},getText(t){return t?e.u(t):e.getText()},get eol(){return e.c===`
`?er.LF:er.CRLF},get lineCount(){return e.b.length},lineAt(t){return e.v(t)},offsetAt(t){return e.w(t)},positionAt(t){return e.x(t)},validateRange(t){return e.y(t)},validatePosition(t){return e.z(t)},getWordRangeAtPosition(t,i){return e.A(t,i)},[Symbol.for("debug.description")](){return`TextDocument(${e.a.toString()})`}}}return Object.freeze(this.m)}_acceptLanguageId(e){Ii(!this.n),this.p=e}_acceptIsDirty(e){Ii(!this.n),this.q=e}_acceptEncoding(e){Ii(!this.n),this.r=e}t(){return this.n?Promise.reject(new Error("Document has been closed")):this.o.$trySaveDocument(this.a)}u(e){const t=this.y(e);if(t.isEmpty)return"";if(t.isSingleLine)return this.b[t.start.line].substring(t.start.character,t.end.character);const i=this.c,s=t.start.line,r=t.end.line,n=[];n.push(this.b[s].substring(t.start.character));for(let o=s+1;o<r;o++)n.push(this.b[o]);return n.push(this.b[r].substring(0,t.end.character)),n.join(i)}v(e){let t;if(e instanceof Re?t=e.line:typeof e=="number"?t=e:!this.s&&Re.isPosition(e)&&(t=e.line),typeof t!="number"||t<0||t>=this.b.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new EV(t,this.b[t],t===this.b.length-1)}w(e){return e=this.z(e),this.h(),this.f.getPrefixSum(e.line-1)+e.character}x(e){e=Math.floor(e),e=Math.max(0,e),this.h();const t=this.f.getIndexOf(e),i=this.b[t.index].length;return new Re(t.index,Math.min(t.remainder,i))}y(e){if(this.s){if(!(e instanceof ke))throw new Error("Invalid argument")}else if(!ke.isRange(e))throw new Error("Invalid argument");const t=this.z(e.start),i=this.z(e.end);return t===e.start&&i===e.end?e:new ke(t.line,t.character,i.line,i.character)}z(e){if(this.s){if(!(e instanceof Re))throw new Error("Invalid argument")}else if(!Re.isPosition(e))throw new Error("Invalid argument");if(this.b.length===0)return e.with(0,0);let{line:t,character:i}=e,s=!1;if(t<0)t=0,i=0,s=!0;else if(t>=this.b.length)t=this.b.length-1,i=this.b[t].length,s=!0;else{const r=this.b[t].length;i<0?(i=0,s=!0):i>r&&(i=r,s=!0)}return s?new Re(t,i):e}A(e,t){const i=this.z(e);if(!t)t=AV(this.p);else if(Kx(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const s=Nk(i.character+1,Tk(t),this.b[i.line],0);if(s)return new ke(i.line,s.startColumn-1,i.line,s.endColumn-1)}},EV=class{constructor(e,t,i){this.a=e,this.b=t,this.c=i}get lineNumber(){return this.a}get text(){return this.b}get range(){return new ke(this.a,0,this.a,this.b.length)}get rangeIncludingLineBreak(){return this.c?this.range:new ke(this.a,0,this.a+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this.b)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this.b.length}},jm=class{constructor(e){this.a=e,this.b=0}nextId(){return this.a+ ++this.b}},Vne=new jm("id#"),xV=class lR{static{this.c=new jm("TextEditorDecorationType")}constructor(t,i,s){const r=lR.c.nextId();t.$registerTextEditorDecorationType(i.identifier,r,uy.from(s)),this.value=Object.freeze({key:r,dispose(){t.$removeTextEditorDecorationType(r)}})}},CV=class{constructor(e,t){this.g=[],this.h=void 0,this.j=!1,this.c=e,this.d=e.version,this.e=t.undoStopBefore,this.f=t.undoStopAfter}finalize(){return this.j=!0,{documentVersionId:this.d,edits:this.g,setEndOfLine:this.h,undoStopBefore:this.e,undoStopAfter:this.f}}k(){if(this.j)throw new Error("Edit is only valid while callback runs")}replace(e,t){this.k();let i=null;if(e instanceof Re)i=new ke(e,e);else if(e instanceof ke)i=e;else throw new Error("Unrecognized location");this.l(i,t,!1)}insert(e,t){this.k(),this.l(new ke(e,e),t,!0)}delete(e){this.k();let t=null;if(e instanceof ke)t=e;else throw new Error("Unrecognized location");this.l(t,null,!0)}l(e,t,i){const s=this.c.validateRange(e);this.g.push({range:s,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this.k(),e!==er.LF&&e!==er.CRLF)throw Me("endOfLine");this.h=e}},kV=class{constructor(e,t,i,s){this.c=e,this.d=t,this._accept(i),this.e=s;const r=this;this.value={get tabSize(){return r.f},set tabSize(n){r.n(n)},get indentSize(){return r.g},set indentSize(n){r.p(n)},get insertSpaces(){return r.j},set insertSpaces(n){r.s(n)},get cursorStyle(){return r.k},set cursorStyle(n){r.t(n)},get lineNumbers(){return r.l},set lineNumbers(n){r.u(n)}}}_accept(e){this.f=e.tabSize,this.g=e.indentSize,this.h=e.originalIndentSize,this.j=e.insertSpaces,this.k=e.cursorStyle,this.l=fl.to(e.lineNumbers)}m(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}n(e){const t=this.m(e);if(t!==null){if(typeof t=="number"){if(this.f===t)return;this.f=t}this.v("setTabSize",this.c.$trySetOptions(this.d,{tabSize:t}))}}o(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}p(e){const t=this.o(e);if(t!==null){if(typeof t=="number"){if(this.h===t)return;this.g=t,this.h=t}this.v("setIndentSize",this.c.$trySetOptions(this.d,{indentSize:t}))}}q(e){return e==="auto"?"auto":e==="false"?!1:!!e}s(e){const t=this.q(e);if(typeof t=="boolean"){if(this.j===t)return;this.j=t}this.v("setInsertSpaces",this.c.$trySetOptions(this.d,{insertSpaces:t}))}t(e){this.k!==e&&(this.k=e,this.v("setCursorStyle",this.c.$trySetOptions(this.d,{cursorStyle:e})))}u(e){this.l!==e&&(this.l=e,this.v("setLineNumbers",this.c.$trySetOptions(this.d,{lineNumbers:fl.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const s=this.m(e.tabSize);s==="auto"?(i=!0,t.tabSize=s):typeof s=="number"&&this.f!==s&&(this.f=s,i=!0,t.tabSize=s)}if(typeof e.indentSize<"u"){const s=this.o(e.indentSize);s==="tabSize"?(i=!0,t.indentSize=s):typeof s=="number"&&this.h!==s&&(this.g=s,this.h=s,i=!0,t.indentSize=s)}if(typeof e.insertSpaces<"u"){const s=this.q(e.insertSpaces);s==="auto"?(i=!0,t.insertSpaces=s):this.j!==s&&(this.j=s,i=!0,t.insertSpaces=s)}typeof e.cursorStyle<"u"&&this.k!==e.cursorStyle&&(this.k=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this.l!==e.lineNumbers&&(this.l=e.lineNumbers,i=!0,t.lineNumbers=fl.from(e.lineNumbers)),i&&this.v("setOptions",this.c.$trySetOptions(this.d,t))}v(e,t){t.catch(i=>{this.e.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this.e.warn(i)})}},$V=class{constructor(e,t,i,s,r,n,o,a){this.id=e,this.k=t,this.l=i,this.g=!1,this.h=new Set,this.c=r,this.d=new kV(this.k,this.id,n,i),this.e=o,this.f=a;const c=this;this.value=Object.freeze({get document(){return s.value},set document(l){throw new No("document")},get selection(){return c.c&&c.c[0]},set selection(l){if(!(l instanceof Ir))throw Me("selection");c.c=[l],c.m()},get selections(){return c.c},set selections(l){if(!Array.isArray(l)||l.some(u=>!(u instanceof Ir)))throw Me("selections");l.length===0&&(l=[new Ir(0,0,0,0)]),c.c=l,c.m()},get visibleRanges(){return c.e},set visibleRanges(l){throw new No("visibleRanges")},get diffInformation(){return c.j},get options(){return c.d.value},set options(l){c.g||c.d.assign(l)},get viewColumn(){return c.f},set viewColumn(l){throw new No("viewColumn")},edit(l,u={undoStopBefore:!0,undoStopAfter:!0}){if(c.g)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const h=new CV(s.value,u);return l(h),c.n(h)},insertSnippet(l,u,h={undoStopBefore:!0,undoStopAfter:!0}){if(c.g)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let f;if(!u||Array.isArray(u)&&u.length===0)f=c.c.map(p=>U.from(p));else if(u instanceof Re){const{lineNumber:p,column:g}=et.from(u);f=[{startLineNumber:p,startColumn:g,endLineNumber:p,endColumn:g}]}else if(u instanceof ke)f=[U.from(u)];else{f=[];for(const p of u)if(p instanceof ke)f.push(U.from(p));else{const{lineNumber:g,column:v}=et.from(p);f.push({startLineNumber:g,startColumn:v,endLineNumber:g,endColumn:v})}}return h.keepWhitespace===void 0&&(h.keepWhitespace=!1),t.$tryInsertSnippet(e,s.value.version,l.value,f,h)},setDecorations(l,u){const h=u.length===0;h&&!c.h.has(l.key)||(h?c.h.delete(l.key):c.h.add(l.key),c.o(()=>{if(l9(u))return t.$trySetDecorations(e,l.key,iB(u));{const f=new Array(4*u.length);for(let p=0,g=u.length;p<g;p++){const v=u[p];f[4*p]=v.start.line+1,f[4*p+1]=v.start.character+1,f[4*p+2]=v.end.line+1,f[4*p+3]=v.end.character+1}return t.$trySetDecorationsFast(e,l.key,f)}}))},revealRange(l,u){c.o(()=>t.$tryRevealRange(e,U.from(l),u||Hp.Default))},show(l){t.$tryShowEditor(e,si.from(l))},hide(){t.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){Ii(!this.g),this.g=!0}_acceptOptions(e){Ii(!this.g),this.d._accept(e)}_acceptVisibleRanges(e){Ii(!this.g),this.e=e}_acceptViewColumn(e){Ii(!this.g),this.f=e}_acceptSelections(e){Ii(!this.g),this.c=e}_acceptDiffInformation(e){Ii(!this.g),this.j=e}async m(){const e=this.c.map(sr.from);return await this.o(()=>this.k.$trySetSelections(this.id,e)),this.value}n(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(r=>r.range);i.sort((r,n)=>r.end.line===n.end.line?r.end.character===n.end.character?r.start.line===n.start.line?r.start.character-n.start.character:r.start.line-n.start.line:r.end.character-n.end.character:r.end.line-n.end.line);for(let r=0,n=i.length-1;r<n;r++){const o=i[r].end;if(i[r+1].start.isBefore(o))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const s=t.edits.map(r=>({range:U.from(r.range),text:r.text,forceMoveMarkers:r.forceMoveMarkers}));return this.k.$tryApplyEdits(this.id,t.documentVersionId,s,{setEndOfLine:typeof t.setEndOfLine=="number"?pl.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}o(e){return this.g?(this.l.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this.l.warn(t),null))}},IV=class{constructor(e){this.value=e,this.a=0}ref(){this.a++}unref(){return--this.a===0}},h4=class{constructor(t,i){this.h=t,this.i=i,this.a=null,this.b=new Map,this.c=new Ct,this.d=new I,this.e=new I,this.f=new I,this.g=new I,this.onDidAddDocuments=this.d.event,this.onDidRemoveDocuments=this.e.event,this.onDidChangeVisibleTextEditors=this.f.event,this.onDidChangeActiveTextEditor=this.g.event}$acceptDocumentsAndEditorsDelta(t){this.acceptDocumentsAndEditorsDelta(t)}acceptDocumentsAndEditorsDelta(t){const i=[],s=[],r=[];if(t.removedDocuments)for(const n of t.removedDocuments){const o=y.revive(n),a=this.c.get(o);a?.unref()&&(this.c.delete(o),i.push(a.value))}if(t.addedDocuments)for(const n of t.addedDocuments){const o=y.revive(n.uri);let a=this.c.get(o);if(a&&o.scheme!==V.vscodeNotebookCell&&o.scheme!==V.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new IV(new SV(this.h.getProxy(Q.MainThreadDocuments),o,n.lines,n.EOL,n.versionId,n.languageId,n.isDirty,n.encoding)),this.c.set(o,a),s.push(a.value)),a.ref()}if(t.removedEditors)for(const n of t.removedEditors){const o=this.b.get(n);this.b.delete(n),o&&r.push(o)}if(t.addedEditors)for(const n of t.addedEditors){const o=y.revive(n.documentUri);Ii(this.c.has(o),`document '${o}' does not exist`),Ii(!this.b.has(n.id),`editor '${n.id}' already exists!`);const a=this.c.get(o).value,c=new $V(n.id,this.h.getProxy(Q.MainThreadTextEditors),this.i,new Rt(()=>a.document),n.selections.map(sr.to),n.options,n.visibleRanges.map(l=>U.to(l)),typeof n.editorPosition=="number"?si.to(n.editorPosition):void 0);this.b.set(n.id,c)}t.newActiveEditor!==void 0&&(Ii(t.newActiveEditor===null||this.b.has(t.newActiveEditor),`active editor '${t.newActiveEditor}' does not exist`),this.a=t.newActiveEditor),Yi(i),Yi(r),t.removedDocuments&&this.e.fire(i),t.addedDocuments&&this.d.fire(s),(t.removedEditors||t.addedEditors)&&this.f.fire(this.allEditors().map(n=>n.value)),t.newActiveEditor!==void 0&&this.g.fire(this.activeEditor())}getDocument(t){return this.c.get(t)?.value}allDocuments(){return ai.map(this.c.values(),t=>t.value)}getEditor(t){return this.b.get(t)}activeEditor(t){if(!this.a)return;const i=this.b.get(this.a);return t?i:i?.value}allEditors(){return[...this.b.values()]}};h4=__decorate([__param(0,Te),__param(1,xe)],h4);var za=W("IExtHostDocumentsAndEditors"),sd=W("productService"),DV="vscode://schemas/vscode-product",PV={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},agentSessionsWorkspace:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.agentSessionsWorkspace.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiSettingsSearch:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authIssuers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authIssuers.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authProviderSpecific:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authProviderSpecific.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},authenticationChallenges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authenticationChallenges.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatContextProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatContextProvider.d.ts"},chatHooks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatHooks.d.ts",version:6},chatOutputRenderer:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatOutputRenderer.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:13},chatPromptFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatPromptFiles.d.ts",version:1},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts",version:4},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatSessionsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatSessionsProvider.d.ts",version:3},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribChatEditorInlineGutterMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribChatEditorInlineGutterMenu.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribLanguageModelToolSets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLanguageModelToolSets.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlArtifactGroupMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactGroupMenu.d.ts"},contribSourceControlArtifactMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},css:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.css.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},dataChannels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.dataChannels.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:4},devDeviceId:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.devDeviceId.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},envIsAppPortable:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.envIsAppPortable.d.ts"},extensionAffinity:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionAffinity.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelProxy:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelProxy.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageModelThinkingPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelThinkingPart.d.ts",version:1},languageModelToolResultAudience:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolResultAudience.d.ts"},languageModelToolSupportsModel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolSupportsModel.d.ts",version:1},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},markdownAlertSyntax:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.markdownAlertSyntax.d.ts"},mcpServerDefinitions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpServerDefinitions.d.ts"},mcpToolDefinitions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpToolDefinitions.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},remoteCodingAgents:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.remoteCodingAgents.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmArtifactProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmArtifactProvider.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmProviderOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmProviderOptions.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskExecutionTerminal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskExecutionTerminal.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textDocumentChangeReason:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textDocumentChangeReason.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},toolProgress:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts"},treeItemMarkdownLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeItemMarkdownLabel.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},Um=Object.freeze(PV),d4=Qt.as(gp.JSONContribution),TV=class p1{static a(t){const i=new Qo;for(let s=0,r=t.length;s<r;s++)i.add(t[s].description.identifier);return i}static compute(t,i){if(!t||!t.length)return new p1(i,[]);if(!i||!i.length)return new p1([],t);const s=this.a(t),r=this.a(i),n=i.filter(a=>!s.has(a.description.identifier)),o=t.filter(a=>!r.has(a.description.identifier));return new p1(n,o)}constructor(t,i){this.added=t,this.removed=i}},MV=class{constructor(e,t,i){this.name=e,this.defaultExtensionKind=t,this.canHandleResolver=i,this.a=null,this.b=null,this.c=null}setHandler(e){if(this.a!==null)throw new Error("Handler already set!");return this.a=e,this.d(),{dispose:()=>{this.a=null}}}acceptUsers(e){this.c=TV.compute(this.b,e),this.b=e,this.d()}d(){if(!(this.a===null||this.b===null||this.c===null))try{this.a(this.b,this.c)}catch(e){pt(e)}}},NV={type:"string",enum:["ui","workspace"],enumDescriptions:[d(16203,null),d(16204,null)]},K8="vscode://schemas/vscode-extensions",f4={properties:{engines:{type:"object",description:d(16205,null),properties:{vscode:{type:"string",description:d(16206,null),default:"^1.22.0"}}},publisher:{description:d(16207,null),type:"string"},displayName:{description:d(16208,null),type:"string"},categories:{description:d(16209,null),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:g5},{type:"string",const:"Languages",deprecationMessage:d(16210,null)}]}},galleryBanner:{type:"object",description:d(16211,null),properties:{color:{description:d(16212,null),type:"string"},theme:{description:d(16213,null),type:"string",enum:["dark","light"]}}},contributes:{description:d(16214,null),type:"object",properties:{},default:{}},preview:{type:"boolean",description:d(16215,null)},enableProposedApi:{type:"boolean",deprecationMessage:d(16216,null)},enabledApiProposals:{markdownDescription:d(16217,null),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Um).map(e=>e),markdownEnumDescriptions:Object.values(Um).map(e=>e.proposal)}},api:{markdownDescription:d(16218,null),type:"string",enum:["none"],enumDescriptions:[d(16219,null)]},activationEvents:{description:d(16220,null),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:d(16221,null),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:d(16222,null),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:d(16223,null),body:"onCommand:${2:commandId}"},{label:"onDebug",description:d(16224,null),body:"onDebug"},{label:"onDebugInitialConfigurations",description:d(16225,null),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:d(16226,null),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:d(16227,null),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:d(16228,null),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:d(16229,null),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:d(16230,null),body:"onStartupFinished"},{label:"onTaskType",description:d(16231,null),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:d(16232,null),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:d(16233,null),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:d(16234,null),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:d(16235,null)},{label:"onUri",body:"onUri",description:d(16236,null)},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:d(16237,null)},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:d(16238,null)},{label:"onNotebook",body:"onNotebook:${1:type}",description:d(16239,null)},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:d(16240,null)},{label:"onRenderer",description:d(16241,null),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:d(16242,null)},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:d(16243,null)},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:d(16244,null)},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:d(16245,null)},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:d(16246,null)},{label:"onChatContextProvider",body:"onChatContextProvider:${1:contextProviderId}",description:d(16247,null)},{label:"onLanguageModelChatProvider",body:"onLanguageModelChatProvider:${1:vendor}",description:d(16248,null)},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:d(16249,null)},{label:"onTerminal",body:"onTerminal:{1:shellType}",description:d(16250,null)},{label:"onTerminalShellIntegration",body:"onTerminalShellIntegration:${1:shellType}",description:d(16251,null)},{label:"onMcpCollection",description:d(16252,null),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:d(16253,null),body:"*"}]}},badges:{type:"array",description:d(16254,null),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:d(16255,null)},href:{type:"string",description:d(16256,null)},description:{type:"string",description:d(16257,null)}}}},markdown:{type:"string",description:d(16258,null),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:d(16259,null),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:d(16260,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:xp}},extensionAffinity:{description:d(16261,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:xp}},extensionPack:{description:d(16262,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:xp}},extensionKind:{description:d(16263,null),type:"array",items:NV,default:["workspace"],defaultSnippets:[{body:["ui"],description:d(16264,null)},{body:["workspace"],description:d(16265,null)},{body:["ui","workspace"],description:d(16266,null)},{body:["workspace","ui"],description:d(16267,null)},{body:[],description:d(16268,null)}]},capabilities:{description:d(16269,null),type:"object",properties:{virtualWorkspaces:{description:d(16270,null),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:d(16271,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[d(16272,null),d(16273,null),d(16274,null)]},description:{type:"string",markdownDescription:d(16275,null)}}},untrustedWorkspaces:{description:d(16276,null),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:d(16277,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[d(16278,null),d(16279,null),d(16280,null)]},restrictedConfigurations:{description:d(16281,null),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:d(16282,null)}}}}},sponsor:{description:d(16283,null),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:d(16284,null),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:d(16285,null),type:"string"},"vscode:uninstall":{description:d(16286,null),type:"string"}}},icon:{type:"string",description:d(16287,null)},l10n:{type:"string",description:d(16288,null)},pricing:{type:"string",markdownDescription:d(16289,null),enum:["Free","Trial"],default:"Free"}}},RV=class{constructor(){this.a=new Map}registerExtensionPoint(e){if(this.a.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new MV(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);return this.a.set(e.extensionPoint,t),e.activationEventsGenerator&&f_.register(e.extensionPoint,e.activationEventsGenerator),f4.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,d4.registerSchema(K8,f4),t}getExtensionPoints(){return Array.from(this.a.values())}},e7={ExtensionsRegistry:"ExtensionsRegistry"};Qt.add(e7.ExtensionsRegistry,new RV);var t7=Qt.as(e7.ExtensionsRegistry);d4.registerSchema(K8,f4),d4.registerSchema(DV,{properties:{extensionEnabledApiProposals:{description:d(16290,null),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Um),markdownEnumDescriptions:Object.values(Um).map(e=>e.proposal)}}]}}}});var LV={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:d(13251,null)},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:d(13252,null),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:d(13253,null),default:""}}},p4;(function(e){function t(i,s,r){if(!i)return;const n=Oe(i.type)?i.type:void 0;if(!n||n.length===0){r.error(d(13254,null));return}const o=[];if(Array.isArray(i.required))for(const a of i.required)Oe(a)&&o.push(a);return{extensionId:s.value,taskType:n,required:o,properties:i.properties?ct(i.properties):{},when:i.when?Ot.deserialize(i.when):void 0}}e.from=t})(p4||(p4={}));var OV=t7.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:function*(e){for(const t of e)t.type&&(yield`onTaskType:${t.type}`)},jsonSchema:{description:d(13255,null),type:"array",items:LV}}),FV=class{constructor(){this.d=new I,this.onDefinitionsChanged=this.d.event,this.a=Object.create(null),this.b=new Promise((e,t)=>{OV.setHandler((i,s)=>{this.c=void 0;try{for(const r of s.removed){const n=r.value;for(const o of n)this.a&&o.type&&this.a[o.type]&&delete this.a[o.type]}for(const r of s.added){const n=r.value;for(const o of n){const a=p4.from(o,r.description.identifier,r.collector);a&&(this.a[a.taskType]=a)}}(s.removed.length>0||s.added.length>0)&&this.d.fire()}catch{}e(void 0)})})}onReady(){return this.b}get(e){return this.a[e]}all(){return Object.keys(this.a).map(e=>this.a[e])}getJsonSchema(){if(this.c===void 0){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),t.properties!==void 0?i.properties=ct(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this.c={oneOf:e}}return this.c}},jV=new FV,UV={IconContribution:"base.contributions.icons"},i7;(function(e){function t(i,s){let r=i.defaults;for(;Ft.isThemeIcon(r);){const n=Nl.getIcon(r.id);if(!n)return;r=n.defaults}return r}e.getDefinition=t})(i7||(i7={}));var s7;(function(e){function t(s){return{weight:s.weight,style:s.style,src:s.src.map(r=>({format:r.format,location:r.location.toString()}))}}e.toJSONObject=t;function i(s){const r=n=>Oe(n)?n:void 0;if(s&&Array.isArray(s.src)&&s.src.every(n=>Oe(n.format)&&Oe(n.location)))return{weight:r(s.weight),style:r(s.style),src:s.src.map(n=>({format:n.format,location:y.parse(n.location)}))}}e.fromJSONObject=i})(s7||(s7={}));var zV=/^([\w_-]+)$/,HV=d(2636,null),WV=class extends J{constructor(){super(),this.a=this.D(new I),this.onDidChange=this.a.event,this.f={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:d(2637,null),pattern:zV.source,patternErrorMessage:HV},fontCharacter:{type:"string",description:d(2638,null)}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.g={type:"string",pattern:`^${Ft.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.b={},this.h={}}registerIcon(e,t,i,s){const r=this.b[e];if(r){if(i&&!r.description){r.description=i,this.f.properties[e].markdownDescription=`${i} $(${e})`;const a=this.g.enum.indexOf(e);a!==-1&&(this.g.enumDescriptions[a]=i),this.a.fire()}return r}const n={id:e,description:i,defaults:t,deprecationMessage:s};this.b[e]=n;const o={$ref:"#/definitions/icons"};return s&&(o.deprecationMessage=s),i&&(o.markdownDescription=`${i}: $(${e})`),this.f.properties[e]=o,this.g.enum.push(e),this.g.enumDescriptions.push(i||""),this.a.fire(),{id:e}}deregisterIcon(e){delete this.b[e],delete this.f.properties[e];const t=this.g.enum.indexOf(e);t!==-1&&(this.g.enum.splice(t,1),this.g.enumDescriptions.splice(t,1)),this.a.fire()}getIcons(){return Object.keys(this.b).map(e=>this.b[e])}getIcon(e){return this.b[e]}getIconSchema(){return this.f}getIconReferenceSchema(){return this.g}registerIconFont(e,t){const i=this.h[e];return i||(this.h[e]=t,this.a.fire(),t)}deregisterIconFont(e){delete this.h[e]}getIconFont(e){return this.h[e]}toString(){const e=(r,n)=>r.id.localeCompare(n.id),t=r=>{for(;Ft.isThemeIcon(r.defaults);)r=this.b[r.defaults.id];return`codicon codicon-${r?r.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const s=Object.keys(this.b).map(r=>this.b[r]);for(const r of s.filter(n=>!!n.description).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|${Ft.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const r of s.filter(n=>!Ft.isThemeIcon(n.defaults)).sort(e))i.push(`|<i class="${t(r)}"></i>|${r.id}|`);return i.join(`
`)}},Nl=new WV;Qt.add(UV.IconContribution,Nl);function rd(e,t,i,s){return Nl.registerIcon(e,t,i,s)}function _V(){const e=oz();for(const t in e){const i="\\"+e[t].toString(16);Nl.registerIcon(t,{fontCharacter:i})}}_V();var r7="vscode://schemas/icons",n7=Qt.as(gp.JSONContribution);n7.registerSchema(r7,Nl.getIconSchema());var o7=new vr(()=>n7.notifySchemaChanged(r7),200);Nl.onDidChange(()=>{o7.isScheduled()||o7.schedule()});var Jne=rd("widget-close",ce.close,d(2639,null)),Zne=rd("goto-previous-location",ce.arrowUp,d(2640,null)),Yne=rd("goto-next-location",ce.arrowDown,d(2641,null)),Qne=Ft.modify(ce.sync,"spin"),Xne=Ft.modify(ce.loading,"spin"),BV="settings",Kne=new C("taskRunning",!1,d(13256,null)),eoe=new C("taskTerminalActive",!1,d(13257,null)),toe=rf(13260,"Tasks"),zm;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(zm||(zm={})),(function(e){function t(i){if(!i)return e.Strong;switch(i.toLowerCase()){case"escape":return e.Escape;case"strong":return e.Strong;case"weak":return e.Weak;default:return e.Strong}}e.from=t})(zm||(zm={}));var a7;(function(e){e.defaults={cwd:"${workspaceFolder}"}})(a7||(a7={}));var nd;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(nd||(nd={})),(function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"silent":return e.Silent;case"never":return e.Never;default:return e.Always}}e.fromString=t})(nd||(nd={}));var od;(function(e){e[e.Never=1]="Never",e[e.OnProblem=2]="OnProblem",e[e.Always=3]="Always"})(od||(od={})),(function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"never":return e.Never;case"onproblem":return e.OnProblem;default:return e.OnProblem}}e.fromString=t})(od||(od={}));var ad;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(ad||(ad={})),(function(e){function t(i){switch(i.toLowerCase()){case"shared":return e.Shared;case"dedicated":return e.Dedicated;case"new":return e.New;default:return e.Shared}}e.fromString=t})(ad||(ad={}));var c7;(function(e){e.defaults={echo:!0,reveal:nd.Always,revealProblems:od.Never,focus:!1,panel:ad.Shared,showReuseMessage:!0,clear:!1,preserveTerminalName:!1}})(c7||(c7={}));var Hm;(function(e){e[e.Shell=1]="Shell",e[e.Process=2]="Process",e[e.CustomExecution=3]="CustomExecution"})(Hm||(Hm={})),(function(e){function t(s){switch(s.toLowerCase()){case"shell":return e.Shell;case"process":return e.Process;case"customExecution":return e.CustomExecution;default:return e.Process}}e.fromString=t;function i(s){switch(s){case e.Shell:return"shell";case e.Process:return"process";case e.CustomExecution:return"customExecution";default:return"process"}}e.toString=i})(Hm||(Hm={}));var l7;(function(e){function t(i){return Oe(i)?i:i.value}e.value=t})(l7||(l7={}));var u7;(function(e){e.Clean={_id:"clean",isDefault:!1},e.Build={_id:"build",isDefault:!1},e.Rebuild={_id:"rebuild",isDefault:!1},e.Test={_id:"test",isDefault:!1};function t(s){return s===e.Clean._id||s===e.Build._id||s===e.Rebuild._id||s===e.Test._id}e.is=t;function i(s){if(s!==void 0)return Oe(s)?t(s)?{_id:s,isDefault:!1}:void 0:s}e.from=i})(u7||(u7={}));var h7;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.Folder=3]="Folder"})(h7||(h7={}));var d7;(function(e){e.Workspace="workspace",e.Extension="extension",e.InMemory="inMemory",e.WorkspaceFile="workspaceFile",e.User="user";function t(i){switch(i){case e.User:return 2;case e.WorkspaceFile:return 5;default:return 6}}e.toConfigurationTarget=t})(d7||(d7={}));var f7;(function(e){e.parallel="parallel",e.sequence="sequence"})(f7||(f7={}));var g4;(function(e){e[e.default=1]="default",e[e.folderOpen=2]="folderOpen"})(g4||(g4={}));var p7;(function(e){e.terminateNewest="terminateNewest",e.terminateOldest="terminateOldest",e.prompt="prompt",e.warn="warn",e.silent="silent"})(p7||(p7={}));var g7;(function(e){e.defaults={reevaluateOnRerun:!0,runOn:g4.default,instanceLimit:1,instancePolicy:"prompt"}})(g7||(g7={}));var Wm;(function(e){e[e.Process=1]="Process",e[e.Terminal=2]="Terminal"})(Wm||(Wm={})),(function(e){e._default=e.Terminal})(Wm||(Wm={}));var m7;(function(e){e[e.V0_1_0=1]="V0_1_0",e[e.V2_0_0=2]="V2_0_0"})(m7||(m7={}));var v7;(function(e){e.SingleRun="singleRun",e.Background="background"})(v7||(v7={}));var mn;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(mn||(mn={}));var w7;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.FolderOpen=2]="FolderOpen",e[e.ConfigurationChange=3]="ConfigurationChange",e[e.Reconnect=4]="Reconnect",e[e.ChatAgent=5]="ChatAgent"})(w7||(w7={}));var b7;(function(e){function t(u){return{taskId:u._id,taskName:u.configurationProperties.name,runType:u.configurationProperties.isBackground?"background":"singleRun",group:u.configurationProperties.group,__task:u}}function i(u,h,f){return{...t(u),kind:mn.Start,terminalId:h,resolvedVariables:f}}e.start=i;function s(u,h,f){return{...t(u),kind:mn.ProcessStarted,terminalId:h,processId:f}}e.processStarted=s;function r(u,h,f,p){return{...t(u),kind:mn.ProcessEnded,terminalId:h,exitCode:f,durationMs:p}}e.processEnded=r;function n(u,h,f){return{...t(u),kind:mn.Inactive,terminalId:h,durationMs:f}}e.inactive=n;function o(u,h,f){return{...t(u),kind:mn.Terminated,exitReason:f,terminalId:h}}e.terminated=o;function a(u,h,f){return{...t(h),kind:u,terminalId:f}}e.general=a;function c(u,h,f){return{...t(u),kind:mn.ProblemMatcherEnded,hasErrors:h}}e.problemMatcherEnded=c;function l(){return{kind:mn.Changed}}e.changed=l})(b7||(b7={}));var _m;(function(e){function t(s){const r=Object.keys(s).sort();let n="";for(const o of r){let a=s[o];a instanceof Object?a=t(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),n+=o+","+a+","}return n}function i(s){const n={_key:t(s),type:s.taskType};return Object.assign(n,s),n}e.create=i})(_m||(_m={}));var y7;(function(e){e.AutoDetect="task.autoDetect",e.SaveBeforeRun="task.saveBeforeRun",e.ShowDecorations="task.showDecorations",e.ProblemMatchersNeverPrompt="task.problemMatchers.neverPrompt",e.SlowProviderWarning="task.slowProviderWarning",e.QuickOpenHistory="task.quickOpen.history",e.QuickOpenDetail="task.quickOpen.detail",e.QuickOpenSkip="task.quickOpen.skip",e.QuickOpenShowAll="task.quickOpen.showAll",e.AllowAutomaticTasks="task.allowAutomaticTasks",e.Reconnection="task.reconnection",e.VerboseLogging="task.verboseLogging",e.NotifyWindowOnTaskCompletion="task.notifyWindowOnTaskCompletion"})(y7||(y7={}));var A7;(function(e){e.Tasks="tasks",e.SuppressTaskName="tasks.suppressTaskName",e.Windows="tasks.windows",e.Osx="tasks.osx",e.Linux="tasks.linux",e.ShowOutput="tasks.showOutput",e.IsShellCommand="tasks.isShellCommand",e.ServiceTestSetting="tasks.service.testSetting"})(A7||(A7={}));var S7;(function(e){function t(i,s){const r=jV.get(i.type);if(r===void 0){const c=ct(i);return delete c._key,_m.create(c)}const n=Object.create(null);n.type=r.taskType;const o=new Set;r.required.forEach(c=>o.add(c));const a=r.properties;for(const c of Object.keys(a)){const l=i[c];if(l!=null)n[c]=l;else if(o.has(c)){const u=a[c];if(u.default!==void 0)n[c]=ct(u.default);else switch(u.type){case"boolean":n[c]=!1;break;case"number":case"integer":n[c]=0;break;case"string":n[c]="";break;default:s.error(d(13258,null,JSON.stringify(i,void 0,0),c));return}}}return _m.create(n)}e.createTaskIdentifier=t})(S7||(S7={}));var ioe=rd("rerun-task",ce.refresh,d(13259,null)),Bm;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(Bm||(Bm={}));var qm;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(qm||(qm={}));var m4;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(m4||(m4={}));var cd;(function(e){function t(r){if(r){const n=r;return n&&!!n.process}else return!1}e.is=t;function i(r){if(r==null)return;const n={process:r.process,args:r.args};return r.options&&(n.options=m4.from(r.options)),n}e.from=i;function s(r){if(r!=null)return new Zc(r.process,r.args,r.options)}e.to=s})(cd||(cd={}));var v4;(function(e){function t(s){if(s!=null)return s}e.from=t;function i(s){if(s!=null)return s}e.to=i})(v4||(v4={}));var ld;(function(e){function t(r){if(r){const n=r;return n&&(!!n.commandLine||!!n.command)}else return!1}e.is=t;function i(r){if(r==null)return;const n={};return r.commandLine!==void 0?n.commandLine=r.commandLine:(n.command=r.command,n.args=r.args),r.options&&(n.options=v4.from(r.options)),n}e.from=i;function s(r){if(!(r==null||r.command===void 0&&r.commandLine===void 0))return r.commandLine?new ya(r.commandLine,r.options):new ya(r.command,r.args?r.args:[],r.options)}e.to=s})(ld||(ld={}));var or;(function(e){function t(r){if(r){const n=r;return n&&n.customExecution==="customExecution"}else return!1}e.is=t;function i(r){return{customExecution:"customExecution"}}e.from=i;function s(r,n){return n.get(r)}e.to=s})(or||(or={}));var w4;(function(e){function t(i,s){let r;return i.scope!==void 0&&typeof i.scope!="number"?r=i.scope.uri:i.scope!==void 0&&typeof i.scope=="number"&&(i.scope===ho.Workspace&&s&&s.workspaceFile?r=s.workspaceFile:r=BV),{id:i._id,workspaceFolder:r}}e.from=t})(w4||(w4={}));var b4;(function(e){function t(i){if(i!=null)return{_id:i.id,isDefault:i.isDefault}}e.from=t})(b4||(b4={}));var Fr;(function(e){function t(r,n){if(r==null)return[];const o=[];for(const a of r){const c=i(a,n);c&&o.push(c)}return o}e.fromMany=t;function i(r,n){if(r==null)return;let o;r.execution instanceof Zc?o=cd.from(r.execution):r.execution instanceof ya?o=ld.from(r.execution):r.execution&&r.execution instanceof fb&&(o=or.from(r.execution));const a=Bm.from(r.definition);let c;return r.scope?typeof r.scope=="number"?c=r.scope:c=r.scope.uri:c=ho.Workspace,!a||!c?void 0:{_id:r._id,definition:a,name:r.name,source:{extensionId:n.identifier.value,label:r.source,scope:c},execution:o,isBackground:r.isBackground,group:b4.from(r.group),presentationOptions:qm.from(r.presentationOptions),problemMatchers:Es(r.problemMatchers),hasDefinedMatchers:r.hasDefinedMatchers,runOptions:r.runOptions?r.runOptions:{reevaluateOnRerun:!0},detail:r.detail}}e.from=i;async function s(r,n,o){if(r==null)return;let a;cd.is(r.execution)?a=cd.to(r.execution):ld.is(r.execution)?a=ld.to(r.execution):or.is(r.execution)&&(a=or.to(r._id,o));const c=Bm.to(r.definition);let l;if(r.source&&(r.source.scope!==void 0?typeof r.source.scope=="number"?l=r.source.scope:l=await n.resolveWorkspaceFolder(y.revive(r.source.scope)):l=ho.Workspace),!c||!l)return;const u=new qp(c,l,r.name,r.source.label,a,r.problemMatchers);return r.isBackground!==void 0&&(u.isBackground=r.isBackground),r.group!==void 0&&(u.group=uh.from(r.group._id),u.group&&r.group.isDefault&&(u.group=new uh(u.group.id,u.group.label),r.group.isDefault===!0&&(u.group.isDefault=r.group.isDefault))),r.presentationOptions&&(u.presentationOptions=qm.to(r.presentationOptions)),r._id&&(u._id=r._id),r.detail&&(u.detail=r.detail),u}e.to=s})(Fr||(Fr={}));var y4;(function(e){function t(s){return s}e.from=t;function i(s){if(s)return Object.assign(Object.create(null),s)}e.to=i})(y4||(y4={}));var A4=class{#e;constructor(e,t,i){this._id=t,this.b=i,this.#e=e}get task(){return this.b}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}get terminal(){return this.a}set terminal(e){this.a=e}},Vm=class{constructor(t,i,s,r,n,o,a,c){this.q=new I,this.r=new I,this.s=new I,this.u=new I,this.v=new I,this.w=new I,this.a=t.getProxy(Q.MainThreadTask),this.b=s,this.c=r,this.d=n,this.e=o,this.h=0,this.j=new Map,this.k=new Map,this.l=new Map,this.m=new Map,this.n=new Set,this.o=new Map,this.f=a,this.g=c,this.a.$registerSupportedExecutions(!0)}registerTaskProvider(t,i,s){if(!s)return new Pe(()=>{});const r=this.z();return this.j.set(r,{type:i,provider:s,extension:t}),this.a.$registerTaskProvider(r,i),new Pe(()=>{this.j.delete(r),this.a.$unregisterTaskProvider(r)})}registerTaskSystem(t,i){this.a.$registerTaskSystem(t,i)}fetchTasks(t){return this.a.$fetchTasks(y4.from(t)).then(async i=>{const s=[];for(const r of i){const n=await Fr.to(r,this.b,this.m);n&&s.push(n)}return s})}get taskExecutions(){const t=[];return this.k.forEach(i=>t.push(i)),t}terminateTask(t){if(!(t instanceof A4))throw new Error("No valid task execution provided");return this.a.$terminateTask(t._id)}get onDidStartTask(){return this.q.event}async $onDidStartTask(t,i,s){const r=this.m.get(t.id);r&&(this.o.set(t.id,r),this.e.attachPtyToTerminal(i,await r.callback(s))),this.p=t.id;const n=await this.B(t),o=this.e.getTerminalById(i)?.value;n&&(n.terminal=o),this.q.fire({execution:n})}get onDidEndTask(){return this.r.event}async $OnDidEndTask(t){if(!this.l.has(t.id))return;const i=await this.B(t);this.l.delete(t.id),this.k.delete(t.id),this.D(t),this.r.fire({execution:i})}get onDidStartTaskProcess(){return this.s.event}async $onDidStartTaskProcess(t){const i=await this.B(t.id);this.s.fire({execution:i,processId:t.processId})}get onDidEndTaskProcess(){return this.u.event}async $onDidEndTaskProcess(t){const i=await this.B(t.id);this.u.fire({execution:i,exitCode:t.exitCode})}get onDidStartTaskProblemMatchers(){return this.v.event}async $onDidStartTaskProblemMatchers(t){let i;try{i=await this.B(t.execution.id)}catch{return}this.v.fire({execution:i})}get onDidEndTaskProblemMatchers(){return this.w.event}async $onDidEndTaskProblemMatchers(t){let i;try{i=await this.B(t.execution.id)}catch{return}this.w.fire({execution:i,hasErrors:t.hasErrors})}$provideTasks(t,i){const s=this.j.get(t);if(!s)return Promise.reject(new Error("no handler found"));const r=[],n=wi(()=>s.provider.provideTasks(De.None)).then(o=>this.x(i,r,s,o));return new Promise(o=>{n.then(a=>{Promise.all(r).then(()=>{o(a)})})})}async $resolveTask(t,i){const s=this.j.get(t);if(!s)return Promise.reject(new Error("no handler found"));if(i.definition.type!==s.type)throw new Error(`Unexpected: Task of type [${i.definition.type}] cannot be resolved by provider of type [${s.type}].`);const r=await Fr.to(i,this.b,this.m);if(!r)throw new Error("Unexpected: Task cannot be resolved.");const n=await s.provider.resolveTask(r,De.None);if(!n)return;this.C(n,s);const o=Fr.from(n,s.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(n.definition!==r.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return or.is(o.execution)&&await this.A(o,n,!0),await this.y(o)}z(){return this.h++}async A(t,i,s){const r=await this.a.$createTaskId(t);!s&&!this.m.has(r)&&(this.n.add(r),this.o.set(r,i.execution)),this.m.set(r,i.execution)}async B(t,i){if(typeof t=="string"){const n=this.l.get(t);if(!n)throw new zs("Unexpected: The specified task is missing an execution");return n}const s=this.l.get(t.id);if(s)return s;let r;return i?r=Promise.resolve(new A4(this,t.id,i)):r=Fr.to(t.task,this.b,this.m).then(n=>{if(!n)throw new zs("Unexpected: Task does not exist.");return new A4(this,t.id,n)}),this.l.set(t.id,r),r.then(n=>(this.k.set(t.id,n),n))}C(t,i){t._deprecated&&this.g.report("Task.constructor",i.extension,"Use the Task constructor that takes a `scope` instead.")}D(t){this.o.get(t.id)&&this.o.delete(t.id),this.n.has(t.id)&&this.p!==t.id&&(this.m.delete(t.id),this.n.delete(t.id));const s=this.n.values();let r=s.next();for(;!r.done;)!this.o.has(r.value)&&this.p!==r.value&&(this.m.delete(r.value),this.n.delete(r.value)),r=s.next()}};Vm=__decorate([__param(0,Te),__param(1,Wt),__param(2,Ts),__param(3,za),__param(4,bs),__param(5,pn),__param(6,xe),__param(7,Ml)],Vm);var S4=class extends Vm{constructor(t,i,s,r,n,o,a,c){super(t,i,s,r,n,o,a,c),this.registerTaskSystem(V.vscodeRemote,{scheme:V.vscodeRemote,authority:"",platform:d2(0)})}async executeTask(t,i){if(!i.execution)throw new Error("Tasks to execute must include an execution");const s=Fr.from(i,t);if(s===void 0)throw new Error("Task is not valid");if(or.is(s.execution))await this.A(s,i,!1);else throw new I1;const r=await this.B(await this.a.$getTaskExecution(s),i);return this.a.$executeTask(s).catch(n=>{throw new Error(n)}),r}x(t,i,s,r){const n=[];if(r)for(const o of r){if(this.C(o,s),!o.definition||!t[o.definition.type]){const c=o.source?o.source:"No task source";this.f.warn(`The task [${c}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Fr.from(o,s.extension);a&&or.is(a.execution)?(n.push(a),i.push(this.A(a,o,!0))):this.f.warn("Only custom execution tasks supported.")}return{tasks:n,extension:s.extension}}async y(t){if(or.is(t.execution))return t;this.f.warn("Only custom execution tasks supported.")}async $resolveVariables(t,i){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(t,i,s){}};S4=__decorate([__param(0,Te),__param(1,Wt),__param(2,Ts),__param(3,za),__param(4,bs),__param(5,pn),__param(6,xe),__param(7,Ml)],S4);var E4=W("IExtHostTask"),E7=class{constructor(){this.f=new Map,this.m=[],this.n=new I,this.o=new I,this.d=1}get onError(){return this.n.event}get onExit(){return this.o.event}onMessage(e){this.k&&this.n.fire(new Error("attempt to set more than one 'Message' callback")),this.k=e}onEvent(e){this.j&&this.n.fire(new Error("attempt to set more than one 'Event' callback")),this.j=e}onRequest(e){this.g&&this.n.fire(new Error("attempt to set more than one 'Request' callback")),this.g=e}sendResponse(e){e.seq>0?this.n.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.u("response",e)}sendRequest(e,t,i,s){const r={command:e};if(t&&Object.keys(t).length>0&&(r.arguments=t),this.u("request",r),typeof s=="number"){const n=setTimeout(()=>{clearTimeout(n);const o=this.f.get(r.seq);if(o){this.f.delete(r.seq);const a={type:"response",seq:0,request_seq:r.seq,success:!1,command:e,message:d(8326,null,s,e)};o(a)}},s)}return i&&this.f.set(r.seq,i),r.seq}acceptMessage(e){this.k?this.k(e):(this.m.push(e),this.m.length===1&&this.s())}q(e,t){return e.type!=="event"||t.type!=="event"}async s(){let e;for(;this.m.length;){if((!e||this.q(this.m[0],e))&&await Kt(0),e=this.m.shift(),!e)return;switch(e.type){case"event":this.j?.(e);break;case"request":this.g?.(e);break;case"response":{const t=e,i=this.f.get(t.request_seq);i&&(this.f.delete(t.request_seq),i(t));break}}}}u(e,t){t.type=e,t.seq=this.d++,this.sendMessage(t)}async w(){if(this.f.size===0)return Promise.resolve();const e=new Map;this.f.forEach((t,i)=>e.set(i,t)),await Kt(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.f.delete(i)})}getPendingRequestIds(){return Array.from(this.f.keys())}dispose(){this.m=[]}};function qV(e){return e.type&&(e.label||e.program||e.runtime)}var VV=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function GV(e){return!!(e&&e.match(VV))}function x7(e){if(typeof e.path=="string"&&!(typeof e.sourceReference=="number"&&e.sourceReference>0)){if(GV(e.path))return y.parse(e.path);if(Cs(e.path))return y.file(e.path)}return e.path}function C7(e){if(typeof e.path=="object"){const t=y.revive(e.path);if(t)return t.scheme===V.file?t.fsPath:t.toString()}return e.path}function JV(e,t){const i=t?x7:C7,s=ct(e);return k7(s,(r,n)=>{r&&n&&(n.path=i(n))}),s}function ZV(e,t){const i=t?x7:C7,s=ct(e);return k7(s,(r,n)=>{!r&&n&&(n.path=i(n))}),s}function k7(e,t){switch(e.type){case"event":{const i=e;switch(i.event){case"output":t(!1,i.body.source);break;case"loadedSource":t(!1,i.body.source);break;case"breakpoint":t(!1,i.body.breakpoint.source);break;default:break}break}case"request":{const i=e;switch(i.command){case"setBreakpoints":t(!0,i.arguments.source);break;case"breakpointLocations":t(!0,i.arguments.source);break;case"source":t(!0,i.arguments.source);break;case"gotoTargets":t(!0,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(s=>t(!1,s));break;default:break}break}case"response":{const i=e;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(s=>t(!1,s.source));break;case"loadedSources":i.body.sources.forEach(s=>t(!1,s));break;case"scopes":i.body.scopes.forEach(s=>t(!1,s.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(s=>t(!1,s.source));break;case"setBreakpoints":i.body.breakpoints.forEach(s=>t(!1,s.source));break;case"disassemble":i.body?.instructions.forEach(r=>t(!1,r.location));break;case"locations":t(!1,i.body?.source);break;default:break}break}}}var Rl=W("IExtHostEditorTabs"),$7=class{constructor(e,t,i){this.e=i,this.d=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this.a){const e=this,t={get isActive(){return e.b.id===e.e()},get label(){return e.b.label},get input(){return e.c},get isDirty(){return e.b.isDirty},get isPinned(){return e.b.isPinned},get isPreview(){return e.b.isPreview},get group(){return e.d.apiObject}};this.a=Object.freeze(t)}return this.a}get tabId(){return this.b.id}acceptDtoUpdate(e){this.b=e,this.c=this.f()}f(){switch(this.b.input.kind){case 1:return new Nb(y.revive(this.b.input.uri));case 2:return new dg(y.revive(this.b.input.original),y.revive(this.b.input.modified));case 3:return new JD(y.revive(this.b.input.base),y.revive(this.b.input.input1),y.revive(this.b.input.input2),y.revive(this.b.input.result));case 6:return new Rb(y.revive(this.b.input.uri),this.b.input.viewType);case 7:return new ZD(this.b.input.viewType);case 4:return new Lb(y.revive(this.b.input.uri),this.b.input.notebookType);case 5:return new Ob(y.revive(this.b.input.original),y.revive(this.b.input.modified),this.b.input.notebookType);case 8:return new YD;case 9:return new QD(y.revive(this.b.input.uri),y.revive(this.b.input.inputBoxUri));case 10:return new XD;case 11:return new KD(this.b.input.diffEditors.map(e=>new dg(y.revive(e.original),y.revive(e.modified))));default:return}}},YV=class{constructor(e,t){this.c=[],this.d="",this.b=e,this.e=t;for(const i of e.tabs)i.isActive&&(this.d=i.id),this.c.push(new $7(i,this,()=>this.activeTabId()))}get apiObject(){if(!this.a){const e=this,t={get isActive(){return e.b.groupId===e.e()},get viewColumn(){return si.to(e.b.viewColumn)},get activeTab(){return e.c.find(i=>i.tabId===e.d)?.apiObject},get tabs(){return Object.freeze(e.c.map(i=>i.apiObject))}};this.a=Object.freeze(t)}return this.a}get groupId(){return this.b.groupId}get tabs(){return this.c}acceptGroupDtoUpdate(e){this.b=e}acceptTabOperation(e){if(e.kind===0){const i=new $7(e.tabDto,this,()=>this.activeTabId());return this.c.splice(e.index,0,i),e.tabDto.isActive&&(this.d=i.tabId),i}else if(e.kind===1){const i=this.c.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this.d&&(this.d=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this.c.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this.c.splice(e.index,0,i),i}const t=this.c.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this.d=e.tabDto.id:this.d===e.tabDto.id&&!e.tabDto.isActive&&(this.d=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this.d}},x4=class{constructor(t){this.b=new I,this.c=new I,this.e=[],this.a=t.getProxy(Q.MainThreadEditorTabs)}get tabGroups(){if(!this.f){const t=this,i={onDidChangeTabGroups:t.c.event,onDidChangeTabs:t.b.event,get all(){return Object.freeze(t.e.map(s=>s.apiObject))},get activeTabGroup(){const s=t.d;return sc(t.e.find(n=>n.groupId===s)?.apiObject)},close:async(s,r)=>{const n=Array.isArray(s)?s:[s];return n.length?QV(n[0])?this.j(n,r):this.i(n,r):!0}};this.f=Object.freeze(i)}return this.f}$acceptEditorTabModel(t){const i=new Set(this.e.map(l=>l.groupId)),s=new Set(t.map(l=>l.groupId)),r=pL(i,s),n=this.e.filter(l=>r.removed.includes(l.groupId)).map(l=>l.apiObject),o=[],a=[];this.e=t.map(l=>{const u=new YV(l,()=>this.d);return r.added.includes(u.groupId)?o.push(u.apiObject):a.push(u.apiObject),u});const c=sc(t.find(l=>l.isActive===!0)?.groupId);c!==void 0&&this.d!==c&&(this.d=c),this.c.fire(Object.freeze({opened:o,closed:n,changed:a}))}$acceptTabGroupUpdate(t){const i=this.e.find(s=>s.groupId===t.groupId);if(!i)throw new Error("Update Group IPC call received before group creation.");i.acceptGroupDtoUpdate(t),t.isActive&&(this.d=t.groupId),this.c.fire(Object.freeze({changed:[i.apiObject],opened:[],closed:[]}))}$acceptTabOperation(t){const i=this.e.find(r=>r.groupId===t.groupId);if(!i)throw new Error("Update Tabs IPC call received before group creation.");const s=i.acceptTabOperation(t);switch(t.kind){case 0:this.b.fire(Object.freeze({opened:[s.apiObject],closed:[],changed:[]}));return;case 1:this.b.fire(Object.freeze({opened:[],closed:[s.apiObject],changed:[]}));return;case 3:case 2:this.b.fire(Object.freeze({opened:[],closed:[],changed:[s.apiObject]}));return}}g(t){for(const i of this.e)for(const s of i.tabs)if(s.apiObject===t)return s}h(t){return this.e.find(i=>i.apiObject===t)}async i(t,i){const s=[];for(const r of t){const n=this.g(r);if(!n)throw new Error("Tab close: Invalid tab not found!");s.push(n.tabId)}return this.a.$closeTab(s,i)}async j(t,i){const s=[];for(const r of t){const n=this.h(r);if(!n)throw new Error("Group close: Invalid group not found!");s.push(n.groupId)}return this.a.$closeGroup(s,i)}};x4=__decorate([__param(0,Te)],x4);function QV(e){return e.tabs!==void 0}var XV=0,I7=new WeakMap,ud=W("IExtHostTesting"),C4=class extends J{constructor(t,i,s,r){super(),this.z=i,this.C=s,this.F=r,this.f=this.D(new I),this.g=new Map,this.q=this.D(new I),this.w=new Set,this.y=new Map,this.onResultsChanged=this.f.event,this.results=[],this.h=t.getProxy(Q.MainThreadTesting),this.m=new rG(this.h),this.j=new tG(this.h,i),s.registerArgumentProcessor({processArgument:n=>{switch(n?.$mid){case 16:{const o=n,a=o.tests[o.tests.length-1].item.extId;return this.g.get(Je.root(a))?.collection.tree.get(a)?.actual??G9(n)}case 18:{const{test:o,message:a}=n,c=o.item.extId;return{test:this.g.get(Je.root(c))?.collection.tree.get(c)?.actual??G9({$mid:16,tests:[o]}),message:wl.to(a)}}default:return n}}}),s.registerCommand(!1,"testing.getExplorerSelection",async()=>{const n=await s.executeCommand("_testing.getExplorerSelection"),o=a=>{const c=this.g.get(Je.root(a));if(c)return Je.isRoot(a)?c.controller:c.collection.tree.get(a)?.actual};return{include:n?.include.map(o).filter(ps)||[],exclude:n?.exclude.map(o).filter(ps)||[]}})}createTestController(t,i,s,r){if(this.g.has(i))throw new Error(`Attempt to insert a duplicate controller with ID "${i}"`);const n=new X,o=n.add(new aq(i,s,this.F));o.root.label=s;const a=new Map,c=new Set,l=this.h,u=()=>{let p=0;r&&(p|=2);const g=f.relatedCodeProvider;return g&&(g?.provideRelatedTests&&(p|=8),g?.provideRelatedCode&&(p|=4)),p},h={items:o.root.children,get label(){return s},set label(p){s=p,o.root.label=p,l.$updateController(i,{label:s})},get refreshHandler(){return r},set refreshHandler(p){r=p,l.$updateController(i,{capabilities:u()})},get id(){return i},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){T(t,"testRelatedCode"),f.relatedCodeProvider=p,l.$updateController(i,{capabilities:u()})},createRunProfile:(p,g,v,b,S,E)=>{let k=Ar(p);for(;a.has(k);)k++;return new M7(this.h,a,c,this.q.event,i,k,p,g,v,b,S,E)},createTestItem(p,g,v){return new Xh(i,p,g,v)},createTestRun:(p,g,v=!0)=>this.j.createTestRun(t,i,o,p,g,v),invalidateTestResults:p=>{if(p===void 0)this.h.$markTestRetired(void 0);else{const g=p instanceof Array?p:[p];this.h.$markTestRetired(g.map(v=>Je.fromExtHostTestItem(v,i).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{n.dispose()}},f={controller:h,collection:o,profiles:a,extension:t,activeProfiles:c};return l.$registerTestController(i,s,u()),n.add(se(()=>l.$unregisterTestController(i))),this.g.set(i,f),n.add(se(()=>this.g.delete(i))),n.add(o.onDidGenerateDiff(p=>l.$publishDiff(i,p.map(fp.serialize)))),h}createTestObserver(){return this.m.checkout()}async runTests(t,i=De.None){const s=P7(t);if(!s)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const r=this.g.get(s.controllerId);if(!r)throw new Error("Controller not found");await this.h.$runTests({preserveFocus:t.preserveFocus??!0,group:bl.from(s.kind),targets:[{testIds:t.include?.map(n=>Je.fromExtHostTestItem(n,r.collection.root.id).toString())??[r.collection.root.id],profileId:s.profileId,controllerId:s.controllerId}],exclude:t.exclude?.map(n=>n.id)},i)}registerTestFollowupProvider(t){return this.w.add(t),{dispose:()=>{this.w.delete(t)}}}async $getTestsRelatedToCode(t,i,s){const r=this.F.getDocument(y.revive(t));if(!r)return[];const n=et.to(i),o=[];return await Promise.all([...this.g.values()].map(async a=>{let c;try{c=await a.relatedCodeProvider?.provideRelatedTests?.(r.document,n,s)}catch(l){s.isCancellationRequested||this.z.warn(`Error thrown while providing related tests for ${a.controller.label}`,l)}if(c){for(const l of c)o.push(Je.fromExtHostTestItem(l,a.controller.id).toString());a.collection.flushDiff()}})),o}async $getCodeRelatedToTest(t,i){const s=this.g.get(Je.root(t));if(!s)return[];const r=s.collection.tree.get(t);return r?(await s.relatedCodeProvider?.provideRelatedCode?.(r.actual,i))?.map(Bi.from)??[]:[]}$syncTests(){for(const{collection:t}of this.g.values())t.flushDiff();return Promise.resolve()}async $getCoverageDetails(t,i,s){return(await this.j.getCoverageDetails(t,i,s))?.map(Oh.fromDetails)}async $disposeRun(t){this.j.disposeTestRun(t)}$configureRunProfile(t,i){this.g.get(t)?.profiles.get(i)?.configureHandler?.()}$setDefaultRunProfiles(t){const i=new Map;for(const[s,r]of Object.entries(t)){const n=this.g.get(s);if(!n)continue;const o=new Map,a=r.filter(l=>!n.activeProfiles.has(l)),c=[...n.activeProfiles].filter(l=>!r.includes(l));for(const l of a)o.set(l,!0),n.activeProfiles.add(l);for(const l of c)o.set(l,!1),n.activeProfiles.delete(l);o.size&&i.set(s,o)}this.q.fire(i)}async $refreshTests(t,i){await this.g.get(t)?.controller.refreshHandler?.(i)}$publishTestResults(t){this.results=Object.freeze(t.map(i=>{const s=Iy.to(i),r=i.tasks.findIndex(n=>n.hasCoverage);return r!==-1&&(s.getDetailedCoverage=(n,o=De.None)=>this.h.$getCoverageDetails(i.id,r,n,o).then(a=>a.map(Oh.to))),I7.set(s,i.id),s}).concat(this.results).sort((i,s)=>s.completedAt-i.completedAt).slice(0,32)),this.f.fire()}async $expandTest(t,i){const s=this.g.get(Je.fromString(t).controllerId)?.collection;s&&(await s.expand(t,i<0?1/0:i),s.flushDiff())}$acceptDiff(t){this.m.applyDiff(t.map(i=>fp.deserialize({asCanonicalUri:s=>s},i)))}async $runControllerTests(t,i){return Promise.all(t.map(s=>this.G(s,!1,i)))}async $startContinuousRun(t,i){const s=new Ke(i),r=await Promise.all(t.map(n=>this.G(n,!0,s.token)));return!i.isCancellationRequested&&!r.some(n=>n.error)&&await new Promise(n=>i.onCancellationRequested(n)),s.dispose(!0),r}async $provideTestFollowups(t,i){const s=this.results.find(o=>I7.get(o)===t.resultId),r=s&&nG(Je.fromString(t.extId),s?.results);if(!r)return[];let n=[];return await Promise.all([...this.w].map(async o=>{try{const a=await o.provideFollowup(s,r,t.taskIndex,t.messageIndex,i);a&&(n=n.concat(a))}catch(a){this.z.error("Error thrown while providing followup for test message",a)}})),i.isCancellationRequested?[]:n.map(o=>{const a=XV++;return this.y.set(a,o),{title:o.title,id:a}})}$disposeTestFollowups(t){for(const i of t)this.y.delete(i)}$executeTestFollowup(t){const i=this.y.get(t);return i?this.C.executeCommand(i.command,...i.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(t,i){t===void 0?this.j.cancelAllRuns():this.j.cancelRunById(t,i)}getMetadataForRun(t){for(const i of this.j.trackers){const s=i.getTaskIdForRun(t);if(s)return{taskId:s,runId:i.id}}}async G(t,i,s){const r=this.g.get(t.controllerId);if(!r)return{};const{collection:n,profiles:o,extension:a}=r,c=o.get(t.profileId);if(!c)return{};const l=t.testIds.map(p=>n.tree.get(p)).filter(ps),u=t.excludeExtIds.map(p=>r.collection.tree.get(p)).filter(ps).filter(p=>l.some(g=>g.fullId.compare(p.fullId)===2));if(!l.length)return{};const h=new ag(l.some(p=>p.actual instanceof EA)?void 0:l.map(p=>p.actual),u.map(p=>p.actual),c,i),f=_W(t)&&this.j.prepareForMainThreadTestRun(a,h,T7.fromInternal(t,r.collection),c,s);try{return await c.runHandler(h,s),{}}catch(p){return{error:String(p)}}finally{f&&f.hasRunningTasks&&!s.isCancellationRequested&&await Ie.toPromise(f.onEnd)}}};C4=__decorate([__param(0,Te),__param(1,xe),__param(2,Ns),__param(3,za)],C4);var KV=1e4,D7;(function(e){e[e.Running=0]="Running",e[e.Cancelling=1]="Cancelling",e[e.Ended=2]="Ended"})(D7||(D7={}));var eG=class extends J{get hasRunningTasks(){return this.g>0}get id(){return this.z.id}constructor(e,t,i,s,r,n){super(),this.z=e,this.C=t,this.F=i,this.G=s,this.H=r,this.f=0,this.g=0,this.h=new Map,this.j=new Set,this.q=this.D(new I),this.y=new Map,this.onEnd=this.q.event,this.m=this.D(new Ke(n));const o=this.D(new vr(()=>this.I(),KV));this.D(this.m.token.onCancellationRequested(()=>o.schedule()));const a=new I;this.w=a.event,this.D(se(()=>{a.fire(),a.dispose()}))}getTaskIdForRun(e){for(const[t,{run:i}]of this.h)if(i===e)return t}cancel(e){e?this.h.get(e)?.cts.cancel():this.f===0?(this.m.cancel(),this.f=1):this.f===1&&this.I()}async getCoverageDetails(e,t,i){const[,s]=Je.fromString(e).path,r=this.y.get(e);if(!r)return[];const{report:n,extIds:o}=r,a=this.h.get(s);if(!a)throw new Error("unreachable: run task was not found");let c;if(t&&n instanceof hg){const u=o.indexOf(t);if(u===-1)return[];c=n.includesTests[u]}return await(c?this.G?.loadDetailedCoverageForTest?.(a.run,n,c,i):this.G?.loadDetailedCoverage?.(a.run,n,i))??[]}createRun(e){const t=this.z.id,i=this.z.controllerId,s=At(),r=l=>(u,...h)=>{if(o){this.F.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.L(u),l(u,...h)},n=(l,u)=>{const h=u instanceof Array?u.map(wl.from):[wl.from(u)];if(l.uri&&l.range){const f={range:U.from(l.range),uri:l.uri};for(const p of h)p.location=p.location||f}this.C.$appendTestMessagesInRun(t,s,Je.fromExtHostTestItem(l,i).toString(),h)};let o=!1;const a=this.D(new Ke(this.m.token)),c={isPersisted:this.z.isPersisted,token:a.token,name:e,onDidDispose:this.w,addCoverage:l=>{if(o)return;const u=l instanceof hg?l.includesTests:[];if(u.length)for(const p of u)this.L(p);const h=l.uri.toString(),f=new Je([t,s,h]).toString();this.y.set(f,{report:l,extIds:u.map(p=>Je.fromExtHostTestItem(p,i).toString())}),this.C.$appendCoverage(t,s,Oh.fromFile(i,f,l))},enqueued:r(l=>{this.C.$updateTestStateInRun(t,s,Je.fromExtHostTestItem(l,i).toString(),1)}),skipped:r(l=>{this.C.$updateTestStateInRun(t,s,Je.fromExtHostTestItem(l,i).toString(),5)}),started:r(l=>{this.C.$updateTestStateInRun(t,s,Je.fromExtHostTestItem(l,i).toString(),2)}),errored:r((l,u,h)=>{n(l,u),this.C.$updateTestStateInRun(t,s,Je.fromExtHostTestItem(l,i).toString(),6,h)}),failed:r((l,u,h)=>{n(l,u),this.C.$updateTestStateInRun(t,s,Je.fromExtHostTestItem(l,i).toString(),4,h)}),passed:r((l,u)=>{this.C.$updateTestStateInRun(t,s,Je.fromExtHostTestItem(l,this.z.controllerId).toString(),3,u)}),appendOutput:(l,u,h)=>{o||(h&&this.L(h),this.C.$appendOutputToRun(t,s,_.fromString(l),u&&Bi.from(u),h&&Je.fromExtHostTestItem(h,i).toString()))},end:()=>{o||(o=!0,this.C.$finishedTestRunTask(t,s),--this.g||this.J())}};return this.g++,this.h.set(s,{run:c,cts:a}),this.C.$startedTestRunTask(t,{id:s,ctrlId:this.z.controllerId,name:e||this.H.displayName||this.H.identifier.value,running:!0}),c}I(){for(const{run:e}of this.h.values())e.end()}J(){this.f!==2&&(this.f=2,this.q.fire())}L(e){if(!(e instanceof Xh))throw new Cp(e.id);if(this.j.has(Je.fromExtHostTestItem(e,this.z.controllerId).toString()))return;const t=[],i=this.z.colllection.root;for(;;){const s=yo.from(e);if(t.unshift(s),this.j.has(s.extId)||(this.j.add(s.extId),e===i))break;e=e.parent||i}this.C.$addTestsToRun(this.z.controllerId,this.z.id,t)}dispose(){this.J(),super.dispose()}},tG=class{get trackers(){return this.f.values()}constructor(e,t){this.h=e,this.j=t,this.f=new Map,this.g=new Map}getCoverageDetails(e,t,i){const s=Je.root(e);return this.g.get(s)?.getCoverageDetails(e,t,i)||[]}disposeTestRun(e){this.g.get(e)?.dispose(),this.g.delete(e);for(const[t,{id:i}]of this.f)i===e&&this.f.delete(t)}prepareForMainThreadTestRun(e,t,i,s,r){return this.k(t,i,s,e,r)}cancelRunById(e,t){this.g.get(e)?.cancel(t)}cancelAllRuns(){for(const e of this.f.values())e.cancel()}createTestRun(e,t,i,s,r,n){const o=this.f.get(s);if(o)return o.createRun(r);const a=T7.fromPublic(t,i,s,n),c=P7(s);this.h.$startedExtensionTestRun({controllerId:t,continuous:!!s.continuous,profile:c&&{group:bl.from(c.kind),id:c.profileId},exclude:s.exclude?.map(u=>Je.fromExtHostTestItem(u,i.root.id).toString())??[],id:a.id,include:s.include?.map(u=>Je.fromExtHostTestItem(u,i.root.id).toString())??[i.root.id],preserveFocus:s.preserveFocus??!0,persist:n});const l=this.k(s,a,s.profile,e);return Ie.once(l.onEnd)(()=>{this.h.$finishedExtensionTestRun(a.id)}),l.createRun(r)}k(e,t,i,s,r){const n=new eG(t,this.h,this.j,i,s,r);return this.f.set(e,n),this.g.set(n.id,n),n}},P7=e=>{if(e.profile){if(!(e.profile instanceof M7))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return e.profile}},T7=class KE{static fromPublic(t,i,s,r){return new KE(t,At(),r,i)}static fromInternal(t,i){return new KE(t.controllerId,t.runId,!0,i)}constructor(t,i,s,r){this.controllerId=t,this.id=i,this.isPersisted=s,this.colllection=r}},iG=class{get isEmpty(){return this.f.size===0&&this.h.size===0&&this.g.size===0}constructor(e){this.k=e,this.f=new Set,this.g=new Set,this.h=new Set,this.j=new Set}add(e){this.f.add(e)}update(e){Object.assign(e.revived,yo.toPlain(e.item)),this.f.has(e)||this.g.add(e)}remove(e){if(this.f.delete(e))return;this.g.delete(e);const t=Je.parentId(e.item.extId);if(t&&this.j.has(t.toString())){this.j.add(e.item.extId);return}this.h.add(e)}getChangeEvent(){const{f:e,g:t,h:i}=this;return{get added(){return[...e].map(s=>s.revived)},get updated(){return[...t].map(s=>s.revived)},get removed(){return[...i].map(s=>s.revived)}}}complete(){this.isEmpty||this.k.fire(this.getChangeEvent())}},sG=class extends BW{constructor(){super(...arguments),this.z=new I,this.onDidChangeTests=this.z.event}get rootTests(){return this.h}getMirroredTestDataById(e){return this.g.get(e)}getMirroredTestDataByReference(e){return this.g.get(e.id)}y(e,t){return{...e,revived:yo.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}x(){return new iG(this.z)}},rG=class{constructor(e){this.g=e}checkout(){this.f||(this.f=this.h());const e=this.f;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:D1(()=>{--e.observers===0&&(this.g.$unsubscribeFromDiffs(),this.f=void 0)})}}getMirroredTestDataByReference(e){return this.f?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.f?.tests.apply(e)}h(){const e=new sG({asCanonicalUri:t=>t});return this.g.$subscribeToDiffs(),{observers:0,tests:e}}},hd=(e,t,i,s)=>{i?Object.assign(i,s):t.$updateTestRunConfig(e.controllerId,e.profileId,s)},M7=class extends BD{#e;#t;#i;#s;#o;get label(){return this.g}set label(e){e!==this.g&&(this.g=e,hd(this,this.#e,this.#s,{label:e}))}get supportsContinuousRun(){return this.j}set supportsContinuousRun(e){e!==this.j&&(this.j=e,hd(this,this.#e,this.#s,{supportsContinuousRun:e}))}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#t.add(this.profileId):this.#t.delete(this.profileId),hd(this,this.#e,this.#s,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,hd(this,this.#e,this.#s,{tag:e?nr.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this.f}set configureHandler(e){e!==this.f&&(this.f=e,hd(this,this.#e,this.#s,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return Ie.chain(this.#i,e=>e.map(t=>t.get(this.controllerId)?.get(this.profileId)).filter(ps))}constructor(e,t,i,s,r,n,o,a,c,l=!1,u=void 0,h=!1){super(r,n,a),this.g=o,this.runHandler=c,this._tag=u,this.j=h,this.#e=e,this.#o=t,this.#t=i,this.#i=s,t.set(n,this);const f=bl.from(a);l&&i.add(n),this.#s={profileId:n,controllerId:r,tag:u?nr.namespace(this.controllerId,u.id):null,label:o,group:f,isDefault:l,hasConfigurationHandler:!1,supportsContinuousRun:h},queueMicrotask(()=>{this.#s&&(this.#e.$publishTestRunProfile(this.#s),this.#s=void 0)})}dispose(){this.#o?.delete(this.profileId)&&(this.#o=void 0,this.#e.$removeTestProfile(this.controllerId,this.profileId)),this.#s=void 0}};function nG(e,t){for(let i=0;i<e.path.length;i++){const s=t.find(r=>r.id===e.path[i]);if(!s)return;if(i===e.path.length-1)return s;t=s.children}}var aoe=W("configurationResolverService"),mt;(function(e){e.Unknown="unknown",e.Env="env",e.Config="config",e.Command="command",e.Input="input",e.ExtensionInstallFolder="extensionInstallFolder",e.WorkspaceFolder="workspaceFolder",e.Cwd="cwd",e.WorkspaceFolderBasename="workspaceFolderBasename",e.UserHome="userHome",e.LineNumber="lineNumber",e.ColumnNumber="columnNumber",e.SelectedText="selectedText",e.File="file",e.FileWorkspaceFolder="fileWorkspaceFolder",e.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",e.RelativeFile="relativeFile",e.RelativeFileDirname="relativeFileDirname",e.FileDirname="fileDirname",e.FileExtname="fileExtname",e.FileBasename="fileBasename",e.FileBasenameNoExtension="fileBasenameNoExtension",e.FileDirnameBasename="fileDirnameBasename",e.ExecPath="execPath",e.ExecInstallFolder="execInstallFolder",e.PathSeparator="pathSeparator",e.PathSeparatorAlias="/"})(mt||(mt={}));var oG=Object.values(mt).filter(e=>typeof e=="string"),Vi=class extends zs{constructor(e,t){super(t),this.variable=e}},N7=class ex{static{this.VARIABLE_LHS="${"}constructor(t){this.a=new Map,this.d=new Set,typeof t=="string"?(this.c=!0,this.b={value:t}):(this.c=!1,this.b=structuredClone(t))}static parse(t){if(t instanceof ex)return t;const i=new ex(t);return i.e(),i.g(i.b),i}e(){const t=this.b,i=ze?"windows":Nt?"osx":Mt?"linux":void 0;i&&t&&typeof t=="object"&&t.hasOwnProperty(i)&&Object.keys(t[i]).forEach(s=>t[s]=t[i][s]),delete t.windows,delete t.osx,delete t.linux}f(t,i){if(t[i]!=="$"||t[i+1]!=="{")return;let s=i+2,r=1;for(;s<t.length;){if(t[s]==="{")r++;else if(t[s]==="}"&&(r--,r===0))break;s++}if(r!==0)return;const n=t.slice(i,s+1),o=t.substring(i+2,s),a=o.indexOf(":");return a===-1?{replacement:{id:n,name:o,inner:o},end:s}:{replacement:{id:n,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:s}}g(t){if(!(typeof t!="object"||t===null)){if(Array.isArray(t)){for(let i=0;i<t.length;i++){const s=t[i];typeof s=="string"?this.h(t,i,s):this.g(s)}return}for(const[i,s]of Object.entries(t))this.h(t,i,i,!0),typeof s=="string"?this.h(t,i,s):this.g(s)}}h(t,i,s,r,n){let o=0;for(;o<s.length;){const a=s.indexOf("${",o);if(a===-1)break;const c=this.f(s,a);if(c){if(o=c.end+1,n?.includes(c.replacement.id))continue;const l=this.a.get(c.replacement.id)||{locations:[],replacement:c.replacement},u={object:t,propertyName:i,replaceKeyName:r};l.locations.push(u),this.a.set(c.replacement.id,l),l.resolved?this.j(c.replacement,u,l.resolved,n):this.d.forEach(h=>h(c.replacement))}else o=a+2}}*unresolved(){const t=new Map,i=s=>{t.set(s.id,s)};for(const s of this.a.values())s.resolved===void 0&&t.set(s.replacement.id,s.replacement);for(this.d.add(i);;){const s=ai.first(t);if(!s)break;const[r,n]=s;yield n,t.delete(r)}this.d.delete(i)}resolved(){return ai.map(ai.filter(this.a.values(),t=>!!t.resolved),t=>[t.replacement,t.resolved])}resolve(t,i){typeof i!="object"&&(i={value:String(i)});const s=this.a.get(t.id);if(s&&(s.resolved=i,i.value!==void 0))for(const r of s.locations||ai.empty())this.j(t,r,i)}j(t,{replaceKeyName:i,propertyName:s,object:r},n,o=[]){if(n.value!==void 0){if(o.push(t.id),i&&typeof s=="string"){const a=r[s],c=s.replaceAll(t.id,n.value);delete r[s],r[c]=a,this.m(r,s,c),this.h(r,c,n.value,!0,o)}else r[s]=r[s].replaceAll(t.id,n.value),this.h(r,s,n.value,!1,o);o.pop()}}m(t,i,s){for(const r of this.a.values())for(const n of r.locations)n.object===t&&n.propertyName===i&&(n.propertyName=s)}toObject(){return this.c?this.b.value:this.b}},aG=class{constructor(e,t,i,s){this.h=new Map,this.resolvableVariables=new Set(oG),this.a=e,this.b=t,this.g=i,s&&(this.c=s.then(r=>this.i(r)))}i(e){if(ze){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}async resolveWithEnvironment(e,t,i){const s=N7.parse(i);for(const r of s.unresolved()){const n=await this.l(r,t?.uri,e);n!==void 0&&s.resolve(r,String(n))}return s.toObject()}async resolveAsync(e,t){const i=N7.parse(t);for(const s of i.unresolved()){const r=await this.l(s,e?.uri);r!==void 0&&i.resolve(s,String(r))}return i.toObject()}resolveWithInteractionReplace(e,t){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this.h.has(e))throw new Error("Variable "+e+" is contributed twice.");this.resolvableVariables.add(e),this.h.set(e,t)}j(e){return this.b?this.b.getUriLabel(e,{noPrefix:!0}):e.fsPath}async l(e,t,i,s){const r={env:i!==void 0?this.i(i):await this.c,userHome:i!==void 0?void 0:await this.g},{name:n,arg:o}=e,a=u=>{const h=this.a.getFilePath();if(h)return ju(h);throw new Vi(u,d(15998,null,e.id))},c=u=>{const h=a(u);if(this.a.getWorkspaceFolderPathForFile){const f=this.a.getWorkspaceFolderPathForFile();if(f)return ju(f)}throw new Vi(u,d(15999,null,e.id,$t(h)))},l=u=>{if(o){const h=this.a.getFolderUri(o);if(h)return h;throw new Vi(u,d(16e3,null,u,o))}if(t)return t;throw this.a.getWorkspaceFolderCount()>1?new Vi(u,d(16001,null,u)):new Vi(u,d(16002,null,u))};switch(n){case"env":if(o){if(r.env){const u=r.env[ze?o.toLowerCase():o];if(Oe(u))return u}return""}throw new Vi(mt.Env,d(16003,null,e.id));case"config":if(o){const u=this.a.getConfigurationValue(t,o);if(qt(u))throw new Vi(mt.Config,d(16004,null,e.id,o));if(kt(u))throw new Vi(mt.Config,d(16005,null,e.id,o));return u}throw new Vi(mt.Config,d(16006,null,e.id));case"command":return this.m(mt.Command,e.id,o,s,"command");case"input":return this.m(mt.Input,e.id,o,s,"input");case"extensionInstallFolder":if(o){const u=await this.a.getExtension(o);if(!u)throw new Vi(mt.ExtensionInstallFolder,d(16007,null,e.id,o));return this.j(u.extensionLocation)}throw new Vi(mt.ExtensionInstallFolder,d(16008,null,e.id));default:switch(n){case"workspaceRoot":case"workspaceFolder":{const u=l(mt.WorkspaceFolder);return u?ju(this.j(u)):void 0}case"cwd":{if(!t&&!o)return Ho();const u=l(mt.Cwd);return u?ju(this.j(u)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const u=l(mt.WorkspaceFolderBasename);return u?ju($t(this.j(u))):void 0}case"userHome":if(r.userHome)return r.userHome;throw new Vi(mt.UserHome,d(16009,null,e.id));case"lineNumber":{const u=this.a.getLineNumber();if(u)return u;throw new Vi(mt.LineNumber,d(16010,null,e.id))}case"columnNumber":{const u=this.a.getColumnNumber();if(u)return u;throw new Error(d(16011,null,e.id))}case"selectedText":{const u=this.a.getSelectedText();if(u)return u;throw new Vi(mt.SelectedText,d(16012,null,e.id))}case"file":return a(mt.File);case"fileWorkspaceFolder":return c(mt.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return $t(c(mt.FileWorkspaceFolderBasename));case"relativeFile":return t||o?oc(this.j(l(mt.RelativeFile)),a(mt.RelativeFile)):a(mt.RelativeFile);case"relativeFileDirname":{const u=Fi(a(mt.RelativeFileDirname));if(t||o){const h=oc(this.j(l(mt.RelativeFileDirname)),u);return h.length===0?".":h}return u}case"fileDirname":return Fi(a(mt.FileDirname));case"fileExtname":return lf(a(mt.FileExtname));case"fileBasename":return $t(a(mt.FileBasename));case"fileBasenameNoExtension":{const u=$t(a(mt.FileBasenameNoExtension));return u.slice(0,u.length-lf(u).length)}case"fileDirnameBasename":return $t(Fi(a(mt.FileDirnameBasename)));case"execPath":{const u=this.a.getExecPath();return u||e.id}case"execInstallFolder":{const u=this.a.getAppRoot();return u||e.id}case"pathSeparator":case"/":return It;default:try{return this.m(mt.Unknown,e.id,o,s,void 0)}catch{return e.id}}}}m(e,t,i,s,r){if(i&&s){const n=r===void 0?s[i]:s[r+":"+i];if(typeof n=="string")return n;throw new Vi(e,d(16013,null,t))}return t}},Ha=W("IExtHostVariableResolverProvider"),cG=class extends aG{constructor(e,t,i,s,r,n,o){function a(){if(i){const c=i.activeEditor();if(c)return c.document.uri;const l=s.tabGroups.all.find(u=>u.isActive)?.activeTab;if(l!==void 0){if(l.input instanceof dg||l.input instanceof Ob)return l.input.modified;if(l.input instanceof Nb||l.input instanceof Lb||l.input instanceof Rb)return l.input.uri}}}super({getFolderUri:c=>{const l=n.folders.filter(u=>u.name===c);if(l&&l.length>0)return l[0].uri},getWorkspaceFolderCount:()=>n.folders.length,getConfigurationValue:(c,l)=>r.getConfiguration(void 0,c).get(l),getAppRoot:()=>Ho(),getExecPath:()=>Rn.VSCODE_EXEC_PATH,getFilePath:()=>{const c=a();if(c)return Yr(c.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const c=a();if(c){const l=t.getWorkspaceFolder(c);if(l)return Yr(l.uri.fsPath)}}},getSelectedText:()=>{if(i){const c=i.activeEditor();if(c&&!c.selection.isEmpty)return c.document.getText(c.selection)}},getLineNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.line+1)}},getColumnNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.character+1)}},getExtension:c=>e.getExtension(c)},void 0,o?Promise.resolve(o):void 0,Promise.resolve(Rn))}},Gm=class extends J{constructor(t,i,s,r,n){super(),this.b=t,this.c=i,this.g=s,this.h=r,this.j=n,this.a=new Rt(async()=>{const o=await this.h.getConfigProvider(),c={folders:await this.c.getWorkspaceFolders2()||[]};return this.D(this.c.onDidChangeWorkspace(async l=>{c.folders=await this.c.getWorkspaceFolders2()||[]})),new cG(this.b,this.c,this.g,this.j,o,c,this.m())})}getResolver(){return this.a.value}m(){}};Gm=__decorate([__param(0,gn),__param(1,Ts),__param(2,za),__param(3,bs),__param(4,Rl)],Gm);var k4=W("IExtHostDebugService"),Jm=class extends J{get onDidStartDebugSession(){return this.w.event}get onDidTerminateDebugSession(){return this.y.event}get onDidChangeActiveDebugSession(){return this.z.event}get activeDebugSession(){return this.C?.api}get onDidReceiveDebugSessionCustomEvent(){return this.F.event}get activeDebugConsole(){return this.G.value}constructor(t,i,s,r,n,o,a,c){super(),this.Z=i,this.$=s,this.ab=r,this.bb=n,this.cb=o,this.db=a,this.eb=c,this.u=new Map,this.O=0,this.P=new Map,this.Q=new Map,this.R=new WeakMap,this.S=new Map,this.W=new Map,this.X=0,this.f=0,this.g=[],this.h=0,this.j=[],this.m=0,this.n=[],this.M=new Map,this.N=new Map,this.w=this.D(new I),this.y=this.D(new I),this.z=this.D(new I),this.F=this.D(new I),this.q=t.getProxy(Q.MainThreadDebugService),this.I=this.D(new I),this.L=this.D(new I),this.G=new uG(this.q),this.H=new Map,this.$.getExtensionRegistry().then(l=>{this.D(l.onDidChange(u=>{this.gb(l)})),this.gb(l)}),this.Y=t.getProxy(Q.MainThreadTelemetry)}async $getVisualizerTreeItem(t,i){const s=this.hb(i);if(!s)return;const r=await this.Q.get(t)?.getTreeItem?.(s);return r?this.fb(t,r):void 0}registerDebugVisualizationTree(t,i,s){const r=it.toKey(t.identifier),n=this.zb(r,i);if(this.P.has(n))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this.Q.set(n,s),this.q.$registerDebugVisualizerTree(n,!!s.editItem),se(()=>{this.q.$unregisterDebugVisualizerTree(n),this.Q.delete(i)})}async $getVisualizerTreeItemChildren(t,i){const s=this.S.get(i)?.item;return s?(await this.Q.get(t)?.getChildren?.(s))?.map(n=>this.fb(t,n))||[]:[]}async $editVisualizerTreeItem(t,i){const s=this.S.get(t);if(!s)return;const r=await this.Q.get(s.provider)?.editItem?.(s.item,i);return this.fb(s.provider,r||s.item)}$disposeVisualizedTree(t){const i=this.S.get(t);if(!i)return;const s=[i.children];for(const r of s)if(r)for(const n of r)s.push(this.S.get(n)?.children),this.S.delete(n)}fb(t,i){let s=this.R.get(i);return s||(s=this.O++,this.R.set(i,s),this.S.set(s,{provider:t,item:i})),qy.from(i,s)}asDebugSourceUri(t,i){const s=t;if(typeof s.sourceReference=="number"&&s.sourceReference>0){let r=`debug:${encodeURIComponent(s.path||"")}`,n="?";return i&&(r+=`${n}session=${encodeURIComponent(i.id)}`,n="&"),r+=`${n}ref=${s.sourceReference}`,y.parse(r)}else{if(s.path)return y.file(s.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}gb(t){const i=[];for(const s of t.getAllExtensionDescriptions())if(s.contributes){const r=s.contributes.debuggers;if(r&&r.length>0)for(const n of r)qV(n)&&i.push(n.type)}this.q.$registerDebugTypes(i)}get activeStackItem(){return this.J}get onDidChangeActiveStackItem(){return this.L.event}get onDidChangeBreakpoints(){return this.I.event}get breakpoints(){const t=[];return this.H.forEach(i=>t.push(i)),t}async $resolveDebugVisualizer(t,i){const s=this.W.get(t);if(!s)throw new Error(`No debug visualizer found with id '${t}'`);let{v:r,provider:n,extensionId:o}=s;if(r.visualization||(r=await n.resolveDebugVisualization?.(r,i)||r,s.v=r),!r.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${n}'`);return this.Ab(o,r.visualization)}async $executeDebugVisualizerCommand(t){const i=this.W.get(t);if(!i)throw new Error(`No debug visualizer found with id '${t}'`);const s=i.v.visualization;s&&"command"in s&&this.db.executeCommand(s.command,...s.arguments||[])}hb(t){const i=this.u.get(t.sessionId);return i&&{session:i.api,variable:t.variable,containerId:t.containerId,frameId:t.frameId,threadId:t.threadId}}async $provideDebugVisualizers(t,i,s,r){const n=this.hb(s),o=this.zb(t,i),a=this.P.get(o);if(!n||!a)return[];const c=await a.provideDebugVisualization(n,r);return c?c.map(l=>{const u=++this.X;this.W.set(u,{v:l,provider:a,extensionId:t});const h=l.iconPath?this.Bb(l.iconPath):void 0;return{id:u,name:l.name,iconClass:h?.iconClass,iconPath:h?.iconPath,visualization:this.Ab(t,l.visualization)}}):[]}$disposeDebugVisualizers(t){for(const i of t)this.W.delete(i)}registerDebugVisualizationProvider(t,i,s){if(!t.contributes?.debugVisualizers?.some(o=>o.id===i))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${i})`);const r=it.toKey(t.identifier),n=this.zb(r,i);if(this.P.has(n))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this.P.set(n,s),this.q.$registerDebugVisualizer(r,i),se(()=>{this.q.$unregisterDebugVisualizer(r,i),this.P.delete(i)})}addBreakpoints(t){const i=t.filter(n=>{const o=n.id;return this.H.has(o)?!1:(this.H.set(o,n),!0)});this.wb(i,[],[]);const s=[],r=new Map;for(const n of i)if(n instanceof Sa){let o=r.get(n.location.uri.toString());o||(o={type:"sourceMulti",uri:n.location.uri,lines:[]},r.set(n.location.uri.toString(),o),s.push(o)),o.lines.push({id:n.id,enabled:n.enabled,condition:n.condition,hitCondition:n.hitCondition,logMessage:n.logMessage,line:n.location.range.start.line,character:n.location.range.start.character,mode:n.mode})}else n instanceof Ea&&s.push({type:"function",id:n.id,enabled:n.enabled,hitCondition:n.hitCondition,logMessage:n.logMessage,condition:n.condition,functionName:n.functionName,mode:n.mode});return this.q.$registerBreakpoints(s)}removeBreakpoints(t){const i=t.filter(o=>this.H.delete(o.id));this.wb([],i,[]);const s=i.filter(o=>o instanceof Sa).map(o=>o.id),r=i.filter(o=>o instanceof Ea).map(o=>o.id),n=i.filter(o=>o instanceof Zp).map(o=>o.id);return this.q.$unregisterBreakpoints(s,r,n)}startDebugging(t,i,s){const r=s.testRun&&this.eb.getMetadataForRun(s.testRun);return this.q.$startDebugging(t?t.uri:void 0,i,{parentSessionID:s.parentSession?s.parentSession.id:void 0,lifecycleManagedByParent:s.lifecycleManagedByParent,repl:s.consoleMode===tg.MergeWithParent?"mergeWithParent":"separate",noDebug:s.noDebug,compact:s.compact,suppressSaveBeforeStart:s.suppressSaveBeforeStart,testRun:r&&{runId:r.runId,taskId:r.taskId},suppressDebugStatusbar:s.suppressDebugStatusbar??s.debugUI?.simple,suppressDebugToolbar:s.suppressDebugToolbar??s.debugUI?.simple,suppressDebugView:s.suppressDebugView??s.debugUI?.simple})}stopDebugging(t){return this.q.$stopDebugging(t?t.id:void 0)}registerDebugConfigurationProvider(t,i,s){if(!i)return new Pe(()=>{});const r=this.f++;return this.g.push({type:t,handle:r,provider:i}),this.q.$registerDebugConfigurationProvider(t,s,!!i.provideDebugConfigurations,!!i.resolveDebugConfiguration,!!i.resolveDebugConfigurationWithSubstitutedVariables,r),new Pe(()=>{this.g=this.g.filter(n=>n.provider!==i),this.q.$unregisterDebugConfigurationProvider(r)})}registerDebugAdapterDescriptorFactory(t,i,s){if(!s)return new Pe(()=>{});if(!this.sb(t,i))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${i}' debugger.`);if(this.pb(i))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const r=this.h++;return this.j.push({type:i,handle:r,factory:s}),this.q.$registerDebugAdapterDescriptorFactory(i,r),new Pe(()=>{this.j=this.j.filter(n=>n.factory!==s),this.q.$unregisterDebugAdapterDescriptorFactory(r)})}registerDebugAdapterTrackerFactory(t,i){if(!i)return new Pe(()=>{});const s=this.m++;return this.n.push({type:t,handle:s,factory:i}),new Pe(()=>{this.n=this.n.filter(r=>r.factory!==i)})}async $runInTerminal(t,i){return Promise.resolve(void 0)}async $substituteVariables(t,i){let s;const r=await this.yb(t);return r&&(s={uri:r.uri,name:r.name,index:r.index}),(await this.cb.getResolver()).resolveAsync(s,i)}ib(t,i){if(t instanceof fh)return new dG(t.implementation)}jb(){}async $startDASession(t,i){const s=this,r=await this.xb(i);return this.ub(this.pb(r.type),r).then(n=>{if(!n)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}' (extension might have failed to activate)`);const o=this.ib(n,r);if(!o)throw new Error(`Couldn't create a debug adapter for type '${r.type}'.`);const a=o;return this.M.set(t,a),this.tb(r).then(c=>(c&&this.N.set(t,c),a.onMessage(async l=>{if(l.type==="request"&&l.command==="handshake"){const u=l,h={type:"response",seq:0,command:u.command,request_seq:u.seq,success:!0};this.U||(this.U=this.jb());try{if(this.U){const f=await this.U.sign(u.arguments.value);h.body={signature:f},a.sendResponse(h)}else throw new Error("no signer")}catch(f){h.success=!1,h.message=f.message,a.sendResponse(h)}}else{c&&c.onDidSendMessage&&c.onDidSendMessage(l);try{l=ZV(l,!0)}catch(u){const h=l.type+"_"+(l.command??l.event??"");throw this.Y.$publicLog2("debugProtocolMessageError",{type:h,from:r.type}),u}s.q.$acceptDAMessage(t,l)}}),a.onError(l=>{c&&c.onError&&c.onError(l),this.q.$acceptDAError(t,l.name,l.message,l.stack)}),a.onExit(l=>{c&&c.onExit&&c.onExit(l??void 0,void 0),this.q.$acceptDAExit(t,l??void 0,void 0)}),c&&c.onWillStartSession&&c.onWillStartSession(),a.startSession()))})}$sendDAMessage(t,i){i=JV(i,!1);const s=this.N.get(t);s&&s.onWillReceiveMessage&&s.onWillReceiveMessage(i),this.M.get(t)?.sendMessage(i)}$stopDASession(t){const i=this.N.get(t);this.N.delete(t),i&&i.onWillStopSession&&i.onWillStopSession();const s=this.M.get(t);return this.M.delete(t),s?s.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(t){const i=[],s=[],r=[];if(t.added)for(const n of t.added){const o=n.id;if(o&&!this.H.has(o)){let a;if(n.type==="function")a=new Ea(n.functionName,n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode);else if(n.type==="data")a=new Zp(n.label,n.dataId,n.canPersist,n.enabled,n.hitCondition,n.condition,n.logMessage,n.mode);else{const c=y.revive(n.uri);a=new Sa(new ns(c,new Re(n.line,n.character)),n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode)}F_(a,o),this.H.set(o,a),i.push(a)}}if(t.removed)for(const n of t.removed){const o=this.H.get(n);o&&(this.H.delete(n),s.push(o))}if(t.changed){for(const n of t.changed)if(n.id){const o=this.H.get(n.id);if(o){if(o instanceof Ea&&n.type==="function"){const a=o;a.enabled=n.enabled,a.condition=n.condition,a.hitCondition=n.hitCondition,a.logMessage=n.logMessage,a.functionName=n.functionName}else if(o instanceof Sa&&n.type==="source"){const a=o;a.enabled=n.enabled,a.condition=n.condition,a.hitCondition=n.hitCondition,a.logMessage=n.logMessage,a.location=new ns(y.revive(n.uri),new Re(n.line,n.character))}r.push(o)}}}this.wb(i,s,r)}async $acceptStackFrameFocus(t){let i;if(t){const s=await this.xb(t.sessionId);t.kind==="thread"?i=new HD(s.api,t.threadId):i=new zD(s.api,t.threadId,t.frameId)}this.J=i,this.L.fire(this.J)}$provideDebugConfigurations(t,i,s){return wi(async()=>{const r=this.rb(t);if(!r)throw new Error("no DebugConfigurationProvider found");if(!r.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const n=await this.yb(i);return r.provideDebugConfigurations(n,s)}).then(r=>{if(!r)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return r})}$resolveDebugConfiguration(t,i,s,r){return wi(async()=>{const n=this.rb(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.yb(i);return n.resolveDebugConfiguration(o,s,r)})}$resolveDebugConfigurationWithSubstitutedVariables(t,i,s,r){return wi(async()=>{const n=this.rb(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.yb(i);return n.resolveDebugConfigurationWithSubstitutedVariables(o,s,r)})}async $provideDebugAdapter(t,i){const s=this.qb(t);if(!s)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const r=await this.xb(i);return this.ub(s,r).then(n=>{if(!n)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${r.type}'`);return this.kb(n)})}async $acceptDebugSessionStarted(t){const i=await this.xb(t);this.w.fire(i.api)}async $acceptDebugSessionTerminated(t){const i=await this.xb(t);i&&(this.y.fire(i.api),this.u.delete(i.id))}async $acceptDebugSessionActiveChanged(t){this.C=t?await this.xb(t):void 0,this.z.fire(this.C?.api)}async $acceptDebugSessionNameChanged(t,i){(await this.xb(t))?._acceptNameChanged(i)}async $acceptDebugSessionCustomEvent(t,i){const r={session:(await this.xb(t)).api,event:i.event,body:i.body};this.F.fire(r)}kb(t){if(t instanceof el)return this.lb(t);if(t instanceof tl)return this.mb(t);if(t instanceof dh)return this.nb(t);if(t instanceof fh)return this.ob(t);throw new Error("convertToDto unexpected type")}lb(t){return{type:"executable",command:t.command,args:t.args,options:t.options}}mb(t){return{type:"server",port:t.port,host:t.host}}nb(t){return{type:"pipeServer",path:t.path}}ob(t){return{type:"implementation"}}pb(t){const i=this.j.filter(s=>s.type===t);if(i.length>0)return i[0].factory}qb(t){const i=this.j.filter(s=>s.handle===t);if(i.length>0)return i[0].factory}rb(t){const i=this.g.filter(s=>s.handle===t);if(i.length>0)return i[0].provider}sb(t,i){if(t.contributes){const s=t.contributes.debuggers;if(s&&s.length>0){for(const r of s)if(r.label&&r.type&&r.type===i)return!0}}return!1}tb(t){const s=t.configuration.type,r=this.n.filter(n=>n.type===s||n.type==="*").map(n=>wi(()=>n.factory.createDebugAdapterTracker(t.api)).then(o=>o,o=>null));return Promise.race([Promise.all(r).then(n=>{const o=yt(n);if(o.length>0)return new hG(o)}),new Promise(n=>setTimeout(()=>n(void 0),1e3))]).catch(n=>{})}async ub(t,i){const s=i.configuration.debugServer;if(typeof s=="number")return Promise.resolve(new tl(s));if(t){const n=await this.$.getExtensionRegistry();return wi(()=>t.createDebugAdapterDescriptor(i.api,this.vb(i,n))).then(o=>{if(o)return o})}const r=await this.$.getExtensionRegistry();return Promise.resolve(this.vb(i,r))}vb(t,i){}wb(t,i,s){(t.length>0||i.length>0||s.length>0)&&this.I.fire(Object.freeze({added:t,removed:i,changed:s}))}async xb(t){if(t)if(typeof t=="string"){const i=this.u.get(t);if(i)return i}else{let i=this.u.get(t.id);if(!i){const s=await this.yb(t.folderUri),r=t.parent?this.u.get(t.parent):void 0;i=new lG(this.q,t.id,t.type,t.name,s,t.configuration,r?.api),this.u.set(i.id,i),this.q.$sessionCached(i.id)}return i}throw new Error("cannot find session")}yb(t){if(t){const i=y.revive(t);return this.Z.resolveWorkspaceFolder(i)}return Promise.resolve(void 0)}zb(t,i){return`${t}\0${i}`}Ab(t,i){if(i){if("title"in i&&"command"in i)return{type:0};if("treeId"in i)return{type:1,id:`${t}\0${i.treeId}`};throw new Error("Unsupported debug visualization type")}}Bb(t){const i=this.Cb(t);let s,r;return"id"in i?r=Ft.asClassName(i):s=i,{iconPath:s,iconClass:r}}Cb(t){if(t instanceof Ri)return{id:t.id};const i=typeof t=="object"&&"dark"in t?t.dark:t,s=typeof t=="object"&&"light"in t?t.light:t;return{dark:typeof i=="string"?y.file(i):i,light:typeof s=="string"?y.file(s):s}}};Jm=__decorate([__param(0,Te),__param(1,Ts),__param(2,gn),__param(3,bs),__param(4,Rl),__param(5,Ha),__param(6,Ns),__param(7,ud)],Jm);var lG=class{constructor(e,t,i,s,r,n,o){this.f=e,this.g=t,this.h=i,this.j=s,this.k=r,this.l=n,this.m=o}get api(){const e=this;return this.d??=Object.freeze({id:e.g,type:e.h,get name(){return e.j},set name(t){e.j=t,e.f.$setDebugSessionName(e.g,t)},parentSession:e.m,workspaceFolder:e.k,configuration:e.l,customRequest(t,i){return e.f.$customDebugAdapterRequest(e.g,t,i)},getDebugProtocolBreakpoint(t){return e.f.$getDebugProtocolBreakpoint(e.g,t.id)}})}get id(){return this.g}get type(){return this.h}_acceptNameChanged(e){this.j=e}get configuration(){return this.l}},uG=class{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}},hG=class{constructor(e){this.d=e}onWillStartSession(){this.d.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.d.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.d.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.d.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.d.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.d.forEach(i=>i.onExit?i.onExit(e,t):void 0)}},dG=class extends E7{constructor(e){super(),this.h=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.h.handleMessage(e)}stopSession(){return this.h.dispose(),Promise.resolve(void 0)}},$4=class extends Jm{constructor(t,i,s,r,n,o,a,c){super(t,i,s,r,n,o,a,c)}};$4=__decorate([__param(0,Te),__param(1,Ts),__param(2,gn),__param(3,bs),__param(4,Rl),__param(5,Ha),__param(6,Ns),__param(7,ud)],$4);function fG(e){return"uri"in e&&"ranges"in e&&"preview"in e}function pG(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,session:e.session}))}var R7=class{constructor(e){this.a=e}provideFileSearchResults(e,t,i){return(async()=>{const r=pG(t);return Promise.all(r.map(n=>this.a.provideFileSearchResults({pattern:e},n,i)))})().then(r=>yt(r).flat())}};function gG(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,previewOptions:L7(e.previewOptions),maxFileSize:e.maxFileSize,encoding:t.encoding,afterContext:e.surroundingContext,beforeContext:e.surroundingContext}))}function L7(e){return{matchLines:e?.matchLines??iA.matchLines,charsPerLine:e?.charsPerLine??iA.charsPerLine}}function mG(e){if(fG(e)){const t=Es(e.ranges).map((i,s)=>{const n=Es(e.preview.matches)[s];return{sourceRange:i,previewRange:n}});return new hn(e.uri,t,e.preview.text)}else return new hm(e.uri,e.text,e.lineNumber)}var vG=class{constructor(e){this.a=e}provideTextSearchResults(e,t,i,s){const r=a=>{wG(a)&&i.report(mG(a))};return(async()=>yt(await Promise.all(gG(t).map(a=>this.a.provideTextSearchResults(e,a,{report:c=>r(c)},s)))).reduce((a,c)=>({limitHit:a.limitHit||c.limitHit}),{limitHit:!1}))().then(a=>({limitHit:a.limitHit,message:yt(Es(a.message))}))}};function wG(e){if(bG(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}function bG(e){return!!e.preview}var O7=class extends Yn{constructor(e,t,i=()=>!1){const s=new z5(i,()=>!1);super(s);const r=new Ct;e.forEach((n,o)=>{const a=n.folder.with({query:"",fragment:""});r.has(a)?r.get(a).push({fq:n,i:o}):r.set(a,[{fq:n,i:o}])}),r.forEach((n,o)=>{const a=new Map;for(const c of n){const l=t(c.fq,c.i);a.set(this.m(c.fq.folder),l)}super.set(o,a)})}findQueryFragmentAwareSubstr(e){const t=super.findSubstr(e.with({query:"",fragment:""}));if(!t)return;const i=this.m(e);return t.get(i)}forEachFolderQueryInfo(e){return this.forEach(t=>t.forEach(i=>e(i)))}m(e){let t="";return e.query&&(t+=e.query),e.fragment&&(t+="#"+e.fragment),t}},yG=class{constructor(e,t,i){this.l=e,this.o=t,this.p=i,this.f=!1,this.g=0,this.h=!1,this.a=e.filePattern;const s=e.ignoreGlobCase?{ignoreCase:!0}:void 0;this.b=e.includePattern&&Xs(e.includePattern,s),this.c=e.maxResults||void 0,this.d=e.exists,this.j=new Set,this.k=e.excludePattern&&Xs(e.excludePattern,s)}cancel(){this.h=!0,this.j.forEach(e=>e.cancel()),this.j=new Set}search(e){const t=this.l.folderQueries||[];return new Promise((i,s)=>{const r=n=>{this.g++,e(n)};if(this.h)return i({limitHit:this.f});this.l.extraFileResources&&this.l.extraFileResources.forEach(n=>{const o=n.toString(),a=$t(o);this.k&&this.k(o,a)||this.w(r,{base:n,basename:a})}),this.q(t,r).then(n=>{i({limitHit:this.f,stats:n||void 0})},n=>{s(new Error(yr(n)))})})}async q(e,t){const i=new Ke,s=e.map(l=>this.r(l)),r=this.o instanceof R7?this.p?.tokenSource.token:this.p?.obj,n={folderOptions:s,maxResults:this.l.maxResults??fm,session:r},o=l=>{const u=new C9(this.l,l),h=!u.hasSiblingExcludeClauses();return{queryTester:u,noSiblingsClauses:h,folder:l.folder,tree:this.s()}},a=new O7(e,o);let c;try{this.j.add(i),c=Qi.create();const l=await this.o.provideFileSearchResults(this.l.filePattern||"",n,i.token),u=c.elapsed(),h=Qi.create();return this.h&&!this.f||(l&&l.forEach(f=>{const p=a.findQueryFragmentAwareSubstr(f),g=_e.relative(p.folder.path,f.path);if(p.noSiblingsClauses){const v=$t(f.path);this.w(t,{base:p.folder,relativePath:g,basename:v});return}this.u(p.tree,p.folder,g,t)}),this.h&&!this.f)?null:(a.forEachFolderQueryInfo(f=>{this.v(f.tree,f.queryTester,t)}),{providerTime:u,postProcessTime:h.elapsed()})}finally{i.dispose(),this.j.delete(i)}}r(e){const t=Cl(this.l.includePattern,e.includePattern);let i=e.excludePattern?.map(r=>({folder:r.folder,patterns:Cl(this.l.excludePattern,r.pattern)}));i?.length||(i=[{folder:void 0,patterns:Cl(this.l.excludePattern,void 0)}]);const s=$9(i);return{folder:e.folder,excludes:s,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}s(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}u({pathToEntries:e},t,i,s){if(this.a&&jn(i,this.a,this.l.ignoreGlobCase)){const n=$t(this.a);this.w(s,{base:t,relativePath:this.a,basename:n})}function r(n){const o=$t(n),a=Fi(n);let c=e[a];c||(c=e[a]=[],r(a)),c.push({base:t,relativePath:n,basename:o})}r(i)}v({rootEntries:e,pathToEntries:t},i,s){const r=this,n=this.a,o=this.l.ignoreGlobCase;function a(c){const l=tA(()=>c.map(u=>u.basename));for(let u=0,h=c.length;u<h;u++){const f=c[u],{relativePath:p,basename:g}=f;if(i.matchesExcludesSync(p,g,jn(n,g,o)?void 0:l))continue;const v=t[p];if(v)a(v);else{if(jn(p,n,o))continue;r.w(s,f)}if(r.f)break}}a(e)}w(e,t){(!this.b||t.relativePath&&this.b(t.relativePath,t.basename))&&((this.d||this.c&&this.g>=this.c)&&(this.f=!0,this.cancel()),this.f||e(t))}},AG=class{constructor(){this.a=new Object,this.tokenSource=new Ke}get obj(){if(this.a)return this.a;throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel(),this.a=void 0}},SG=class uR{constructor(){this.b=new Map}static{this.a=512}fileSearch(t,i,s,r){const n=this.c(t.cacheKey),o=new yG(t,i,n);let a=0;const c=l=>{a+=l.length,s(l.map(u=>this.d(u)))};return this.f(o,uR.a,c,r).then(l=>({limitHit:l.limitHit,stats:l.stats?{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}:void 0,messages:[]}))}clearCache(t){this.b.get(t)?.cancel(),this.b.delete(t)}c(t){if(t)return this.b.has(t)||this.b.set(t,new AG),this.b.get(t)}d(t){return t.relativePath?{resource:Lt(t.base,t.relativePath)}:{resource:t.base}}f(t,i,s,r){const n=r.onCancellationRequested(()=>{t.cancel()}),o=c=>{c&&(a.push(c),i>0&&a.length>=i&&(s(a),a=[]))};let a=[];return t.search(o).then(c=>(a.length&&s(a),n.dispose(),c),c=>(a.length&&s(a),n.dispose(),Promise.reject(c)))}},I4=class{constructor(e,t,i){this.f=e,this.g=t,this.h=i,this.b=null,this.c=!1,this.d=0}get j(){return this.f.query}search(e,t,i){const s=this.j.folderQueries||[],r=new Ke(t);return new Promise((n,o)=>{this.b=new xG(e);let a=!1;const c=(l,u)=>{if(!(l instanceof Qy)&&!a&&!this.c){const h=this.l(l);l instanceof hn&&typeof this.j.maxResults=="number"&&this.d+h>this.j.maxResults&&(this.c=!0,a=!0,r.cancel(),l=this.m(l,this.j.maxResults-this.d));const f=this.l(l);this.d+=f;const p=l instanceof hn;(f>0||!p)&&this.b.add(l,u)}};this.n(s,c,r.token,i).then(l=>{r.dispose(),this.b.flush(),n({limitHit:this.c||l?.limitHit,messages:this.k(l),stats:{type:this.h}})},l=>{r.dispose();const u=yr(l);o(new Error(u))})})}k(e){return e?.message?Array.isArray(e.message)?e.message:[e.message]:[]}l(e){return e instanceof hn?Array.isArray(e.ranges)?e.ranges.length:1:0}m(e,t){return new hn(e.uri,e.ranges.slice(0,t),e.previewText)}async n(e,t,i,s){const r=new O7(e,(u,h)=>({queryTester:new C9(this.j,u),folder:u.folder,folderIdx:h}),()=>!0),n=[],o={report:u=>{if(u instanceof Qy)s?.(u);else{if(u.uri===void 0)throw Error("Text search result URI is undefined. Please check provider implementation.");const h=r.findQueryFragmentAwareSubstr(u.uri),f=h.folder.scheme===V.file?lB(()=>this.g.readdir(dc(u.uri))):void 0,p=kC(h.folder,u.uri);if(p){const g=h.queryTester.includedInQuery(p,$t(p),f);zn(g)?n.push(g.then(v=>{v&&t(u,h.folderIdx)})):g&&t(u,h.folderIdx)}}}},c={folderOptions:e.map(u=>this.o(u)),maxFileSize:this.j.maxFileSize,maxResults:this.j.maxResults??fm,previewOptions:this.j.previewOptions??iA,surroundingContext:this.j.surroundingContext??0};"usePCRE2"in this.j&&(c.usePCRE2=this.j.usePCRE2);let l;return this.f.query.type===3?l=await this.f.provider.provideAITextSearchResults(this.f.query.contentPattern,c,o,i):l=await this.f.provider.provideTextSearchResults(EG(this.f.query.contentPattern),c,o,i),n.length&&await Promise.all(n),l}o(e){const t=Cl(this.j.includePattern,e.includePattern);let i=e.excludePattern?.map(n=>({folder:n.folder,patterns:Cl(this.j.excludePattern,n.pattern)}));(!i||i.length===0)&&(i=[{folder:void 0,patterns:Cl(this.j.excludePattern,void 0)}]);const s=$9(i);return{folder:y.from(e.folder),excludes:s,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.g.toCanonicalName(e.fileEncoding))??"",ignoreGlobCase:this.j.ignoreGlobCase||e.ignoreGlobCase}}};function EG(e){return{isCaseSensitive:e.isCaseSensitive||!1,isRegExp:e.isRegExp||!1,isWordMatch:e.isWordMatch||!1,isMultiline:e.isMultiline||!1,pattern:e.pattern}}var xG=class{constructor(e){this.g=e,this.c=-1,this.f=null,this.b=new kG(512,t=>this.j(t))}add(e,t){this.f&&(this.c!==t||!hc(this.d,e.uri))&&(this.h(),this.f=null),this.f||(this.c=t,this.d=e.uri,this.f={resource:e.uri,results:[]}),this.f.results.push(CG(e))}h(){const e=this.f&&this.f.results?this.f.results.length:0;this.b.addItem(this.f,e)}flush(){this.h(),this.b.flush()}j(e){this.g(e)}};function CG(e){return e instanceof hn?{previewText:e.previewText,rangeLocations:e.ranges.map(t=>({preview:{startLineNumber:t.previewRange.start.line,startColumn:t.previewRange.start.character,endLineNumber:t.previewRange.end.line,endColumn:t.previewRange.end.character},source:{startLineNumber:t.sourceRange.start.line,startColumn:t.sourceRange.start.character,endLineNumber:t.sourceRange.end.line,endColumn:t.sourceRange.end.character}}))}:{text:e.text,lineNumber:e.lineNumber}}var kG=class tx{static{this.b=4e3}static{this.c=50}constructor(t,i){this.j=t,this.k=i,this.d=0,this.f=[],this.g=0}addItem(t,i){t&&this.l(t,i)}addItems(t,i){t&&this.m(t,i)}l(t,i){this.f.push(t),this.g+=i,this.n()}m(t,i){this.f=this.f.concat(t),this.g+=i,this.n()}n(){this.d<tx.c?this.flush():this.g>=this.j?this.flush():this.h||(this.h=setTimeout(()=>{this.flush()},tx.b))}flush(){this.g&&(this.d+=this.g,this.k(this.f),this.f=[],this.g=0,this.h&&(clearTimeout(this.h),this.h=void 0))}},D4=W("IExtHostSearch"),Zm=class{constructor(t,i,s){this.o=t,this.q=i,this.s=s,this.c=this.o.getProxy(Q.MainThreadSearch),this.e=0,this.g=new Map,this.h=new Set,this.i=new Map,this.j=new Set,this.k=new Map,this.l=new Set,this.n=new SG}t(t){return this.q.transformOutgoingScheme(t)}registerTextSearchProviderOld(t,i){if(this.h.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this.h.add(t);const s=this.e++;return this.g.set(s,new vG(i)),this.c.$registerTextSearchProvider(s,this.t(t)),se(()=>{this.h.delete(t),this.g.delete(s),this.c.$unregisterProvider(s)})}registerTextSearchProvider(t,i){if(this.h.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this.h.add(t);const s=this.e++;return this.g.set(s,i),this.c.$registerTextSearchProvider(s,this.t(t)),se(()=>{this.h.delete(t),this.g.delete(s),this.c.$unregisterProvider(s)})}registerAITextSearchProvider(t,i){if(this.j.has(t))throw new Error(`an AI text search provider for the scheme '${t}'is already registered`);this.j.add(t);const s=this.e++;return this.i.set(s,i),this.c.$registerAITextSearchProvider(s,this.t(t)),se(()=>{this.j.delete(t),this.i.delete(s),this.c.$unregisterProvider(s)})}registerFileSearchProviderOld(t,i){if(this.l.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this.l.add(t);const s=this.e++;return this.k.set(s,new R7(i)),this.c.$registerFileSearchProvider(s,this.t(t)),se(()=>{this.l.delete(t),this.k.delete(s),this.c.$unregisterProvider(s)})}registerFileSearchProvider(t,i){if(this.l.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this.l.add(t);const s=this.e++;return this.k.set(s,i),this.c.$registerFileSearchProvider(s,this.t(t)),se(()=>{this.l.delete(t),this.k.delete(s),this.c.$unregisterProvider(s)})}$provideFileSearchResults(t,i,s,r){const n=Ym(s),o=this.k.get(t);if(o)return this.n.fileSearch(n,o,a=>{this.c.$handleFileMatch(t,i,a.map(c=>c.resource))},r);throw new Error("unknown provider: "+t)}async doInternalFileSearchWithCustomCallback(t,i,s){return{messages:[]}}$clearCache(t){return this.n.clearCache(t),Promise.resolve(void 0)}$provideTextSearchResults(t,i,s,r){const n=this.g.get(t);if(!n||!n.provideTextSearchResults)throw new Error(`Unknown Text Search Provider ${t}`);const o=Ym(s);return this.v(o,n).search(c=>this.c.$handleTextMatch(t,i,c),r)}$provideAITextSearchResults(t,i,s,r){const n=this.i.get(t);if(!n||!n.provideAITextSearchResults)throw new Error(`Unknown AI Text Search Provider ${t}`);const o=Ym(s);return this.w(o,n).search(c=>this.c.$handleTextMatch(t,i,c),r,c=>this.c.$handleKeywordResult(t,i,c))}$enableExtensionHostSearch(){}async $getAIName(t){const i=this.i.get(t);if(!(!i||!i.provideAITextSearchResults))return i.name??"AI"}v(t,i){return new I4({query:t,provider:i},{readdir:s=>Promise.resolve([]),toCanonicalName:s=>s},"textSearchProvider")}w(t,i){return new I4({query:t,provider:i},{readdir:s=>Promise.resolve([]),toCanonicalName:s=>s},"aiTextSearchProvider")}};Zm=__decorate([__param(0,Te),__param(1,ku),__param(2,xe)],Zm);function Ym(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map($G),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function $G(e){return ei(e)}var Qm=class extends MU{constructor(t,i){super(i.logLevel,i.logsLocation,i.loggers.map(s=>ei(s))),this.c=t.getProxy(Q.MainThreadLogger)}$setLogLevel(t,i){i?this.setLogLevel(y.revive(i),t):this.setLogLevel(t)}setVisibility(t,i){super.setVisibility(t,i),this.c.$setVisibility(t,i)}s(t,i,s){return new IG(this.c,t,i,s)}};Qm=__decorate([__param(0,Te),__param(1,Wt)],Qm);var IG=class extends z0{constructor(e,t,i,s){super(s?.logLevel==="always"),this.r=e,this.s=t,this.n=!1,this.q=[],this.setLevel(i),this.r.$createLogger(t,s).then(()=>{this.u(this.q),this.n=!0})}m(e,t){const i=[[e,t]];this.n?this.u(i):this.q.push(...i)}u(e){this.r.$log(this.s,e)}flush(){this.r.$flush(this.s)}},P4=W("IExtHostTerminalShellIntegration"),T4=class extends J{constructor(t,i){super(),this.h=i,this.b=new Map,this.c=new I,this.onDidChangeTerminalShellIntegration=this.c.event,this.f=new I,this.onDidStartTerminalShellExecution=this.f.event,this.g=new I,this.onDidEndTerminalShellExecution=this.g.event,this.a=t.getProxy(Q.MainThreadTerminalShellIntegration),this.D(se(()=>{for(const[s,r]of this.b)r.dispose();this.b.clear()}))}$shellIntegrationChange(t,i){const s=this.h.getTerminalById(t);if(!s)return;const r=s.value;let n=this.b.get(t);n||(n=new DG(s.value,i,this.f),this.b.set(t,n),n.store.add(s.onWillDispose(()=>this.b.get(t)?.dispose())),n.store.add(n.onDidRequestShellExecution(o=>this.a.$executeCommand(t,o))),n.store.add(n.onDidRequestEndExecution(o=>this.g.fire(o))),n.store.add(n.onDidRequestChangeShellIntegration(o=>this.c.fire(o))),s.shellIntegration=n.value),this.c.fire({terminal:r,shellIntegration:n.value})}$shellExecutionStart(t,i,s,r,n,o){this.b.has(t)||this.$shellIntegrationChange(t,i);const a={value:s,confidence:r,isTrusted:n};this.b.get(t)?.startShellExecution(a,this.j(o))}$shellExecutionEnd(t,i,s,r,n){const o={value:i,confidence:s,isTrusted:r};this.b.get(t)?.endShellExecution(o,n)}$shellExecutionData(t,i){this.b.get(t)?.emitData(i)}$shellEnvChange(t,i,s,r){this.b.get(t)?.setEnv(i,s,r)}$cwdChange(t,i){this.b.get(t)?.setCwd(this.j(i))}$closeTerminal(t){this.b.get(t)?.dispose(),this.b.delete(t)}j(t){return t?y.file(t):void 0}};T4=__decorate([__param(0,Te),__param(1,pn)],T4);var DG=class extends J{get currentExecution(){return this.f}constructor(e,t,i){super(),this.r=e,this.s=i,this.a=[],this.store=this.D(new X),this.j=this.D(new I),this.onDidRequestChangeShellIntegration=this.j.event,this.m=this.D(new I),this.onDidRequestShellExecution=this.m.event,this.n=this.D(new I),this.onDidRequestEndExecution=this.n.event,this.q=this.D(new I),this.onDidRequestNewExecution=this.q.event;const s=this;this.value={get cwd(){return s.h},get env(){if(s.g)return Object.freeze({isTrusted:s.g.isTrusted,value:Object.freeze({...s.g.value})})},executeCommand(r,n){if(!t)throw new Error("This terminal does not support the executeCommand API.");let o=r;if(n)for(const l of n)!l.match(/["'`]/)&&l.match(/\s/)?o+=` "${l}"`:o+=` ${l}`;s.m.fire(o);const a={value:o,confidence:lh.High,isTrusted:!0};return s.requestNewShellExecution(a,s.h).value}}}requestNewShellExecution(e,t){const i=new F7(e,t??this.h);return Xm(e.value).length>1&&(this.c={isMultiLine:!0,unresolvedCommandLines:Xm(e.value)}),this.a.push(i),this.q.fire(e.value),i}startShellExecution(e,t){if(this.b&&(this.n.fire({terminal:this.r,shellIntegration:this.value,execution:this.b.value,exitCode:void 0}),this.b=void 0),this.f){if(this.c?.isMultiLine&&this.c.unresolvedCommandLines){const s=j7(this.c.unresolvedCommandLines,e);if(s){this.c.unresolvedCommandLines=s.unresolvedCommandLines;return}}this.f.endExecution(void 0),this.f.flush(),this.n.fire({terminal:this.r,shellIntegration:this.value,execution:this.f.value,exitCode:void 0})}let i;if(e.confidence===lh.High)for(const[s,r]of this.a.entries())if(r.value.commandLine.value===e.value){i=r,this.c={isMultiLine:!1,unresolvedCommandLines:void 0},i=r,this.a.splice(s,1);break}else{const n=j7(Xm(r.value.commandLine.value),e);if(n){this.c={isMultiLine:!0,unresolvedCommandLines:n.unresolvedCommandLines},i=r,this.a.splice(s,1);break}}else i=this.a.shift();i||(i=new F7(e,t??this.h)),this.f=i,this.s.fire({terminal:this.r,shellIntegration:this.value,execution:this.f.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,t){if(!(this.c?.isMultiLine&&this.c.unresolvedCommandLines&&this.c.unresolvedCommandLines.length>0)&&this.f){const i=this.c?.isMultiLine?this.f.value.commandLine:e;this.f.endExecution(i);const s=this.f;this.b=s,this.f=void 0,s.flush().then(()=>{this.b===s&&(this.n.fire({terminal:this.r,shellIntegration:this.value,execution:s.value,exitCode:t}),this.b=void 0)})}}setEnv(e,t,i){const s={};for(let r=0;r<e.length;r++)s[e[r]]=t[r];this.g={value:s,isTrusted:i},this.t()}setCwd(e){let t=!1;y.isUri(this.h)?t=!y.isUri(e)||this.h.toString()!==e.toString():this.h!==e&&(t=!0),t&&(this.h=e,this.t())}t(){this.j.fire({terminal:this.r,shellIntegration:this.value})}},F7=class{constructor(e,t){this.c=e,this.cwd=t,this.b=!1;const i=this;this.value={get commandLine(){return i.c},get cwd(){return i.cwd},read(){return i.d()}}}d(){if(!this.a){if(this.b)return r0.EMPTY;this.a=new PG}return this.a.createIterable()}emitData(e){this.b||this.a?.emitData(e)}endExecution(e){e&&(this.c=e),this.a?.endExecution(),this.b=!0}async flush(){this.a&&(await this.a.flush(),this.a.dispose(),this.a=void 0)}},PG=class extends J{constructor(){super(...arguments),this.b=[],this.c=[]}createIterable(){this.a||(this.a=new ms);const e=this.a,t=new r0(async i=>{this.c.push(i),await e.wait()});return this.b.push(t),t}emitData(e){for(const t of this.c)t.emitOne(e)}endExecution(){this.a?.open()}async flush(){await Promise.all(this.b.map(e=>e.toPromise()))}};function Xm(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0)}function j7(e,t){if(e.length===0)return!1;const i=[...e],s=Xm(t.value);if(i&&i.length>0){for(;i.length>0&&i[0]===s[0];)i.shift(),s.shift();if(s.length===0)return{unresolvedCommandLines:i}}return!1}var U7;(function(e){e[e.CR=13]="CR",e[e.LF=10]="LF",e[e.COLON=58]="COLON",e[e.SPACE=32]="SPACE"})(U7||(U7={}));var M4=class{constructor(e){this.a="",this.b="",this.f=[],this.g=!1,this.h=e,this.i=new TextDecoder("utf-8")}getLastEventId(){return this.d}getReconnectionTime(){return this.e}feed(e){if(e.length===0)return;let t=0;for(this.g&&e[0]===10&&t++,this.g=!1;t<e.length;){const i=e.indexOf(13,t),s=e.indexOf(10,t),r=i===-1?s:s===-1?i:Math.min(i,s);if(r===-1)break;let n="";for(const o of this.f)n+=this.i.decode(o,{stream:!0});n+=this.i.decode(e.subarray(t,r)),this.j(n),this.f.length=0,t=r+(e[r]===13&&e[r+1]===10?2:1)}t<e.length?this.f.push(e.subarray(t)):this.g=e[e.length-1]===13}j(e){if(!e.length){this.l();return}if(e.startsWith(":"))return;let t,i;const s=e.indexOf(":");s===-1?(t=e,i=""):(t=e.substring(0,s),i=e.substring(s+1),i.startsWith(" ")&&(i=i.substring(1))),this.k(t,i)}k(e,t){switch(e){case"event":this.b=t;break;case"data":this.a+=t,this.a+=`
`;break;case"id":t.includes("\0")?this.c=void 0:this.c=this.d=t;break;case"retry":/^\d+$/.test(t)&&(this.e=parseInt(t,10));break}}l(){if(this.a===""){this.a="",this.b="";return}this.a.endsWith(`
`)&&(this.a=this.a.substring(0,this.a.length-1));const e={type:this.b||"message",data:this.a};this.c!==void 0&&(e.id=this.c),this.e!==void 0&&(e.retry=this.e),this.h(e),this.reset()}reset(){this.a="",this.b="",this.c=void 0}},N4=class{validateOrThrow(e){const t=this.validate(e);if(t.error)throw new Error(t.error.message);return t.content}},Km=class extends N4{constructor(e){super(),this.a=e}validate(e){return typeof e!==this.a?{content:void 0,error:{message:`Expected ${this.a}, but got ${typeof e}`}}:{content:e,error:void 0}}getJSONSchema(){return{type:this.a}}},TG=new Km("string");function ev(){return TG}var MG=new Km("number");function NG(){return MG}var poe=new Km("boolean"),RG=new Km("object");function R4(){return RG}var L4=class{constructor(e){this.validator=e}};function Ll(e){return new L4(e)}var LG=class extends N4{constructor(e){super(),this.a=e}validate(e){if(typeof e!="object"||e===null)return{content:void 0,error:{message:"Expected object"}};const t={};for(const i in this.a){const s=this.a[i],r=e[i],n=s instanceof L4,o=n?s.validator:s;if(n&&r===void 0)continue;const{content:a,error:c}=o.validate(r);if(c)return{content:void 0,error:{message:`Error in property '${i}': ${c.message}`}};t[i]=a}return{content:t,error:void 0}}getJSONSchema(){const e=[],t={};for(const[s,r]of Object.entries(this.a)){const n=r instanceof L4,o=n?r.validator:r;t[s]=o.getJSONSchema(),n||e.push(s)}return{type:"object",properties:t,...e.length>0?{required:e}:{}}}};function tv(e){return new LG(e)}var OG=class extends N4{constructor(e){super(),this.a=e}validate(e){if(!Array.isArray(e))return{content:void 0,error:{message:"Expected array"}};const t=[];for(let i=0;i<e.length;i++){const{content:s,error:r}=this.a.validate(e[i]);if(r)return{content:void 0,error:{message:`Error in element ${i}: ${r.message}`}};t.push(s)}return{content:t,error:void 0}}getJSONSchema(){return{type:"array",items:this.a.getJSONSchema()}}};function z7(e){return new OG(e)}var iv=W("IExtHostMpcService"),FG=tv({label:ev(),version:Ll(ev()),metadata:Ll(tv({capabilities:Ll(R4()),serverInfo:Ll(R4()),tools:Ll(z7(tv({availability:NG(),definition:R4()})))})),authentication:Ll(tv({providerId:ev(),scopes:z7(ev())}))}),sv=class extends J{constructor(t,i,s,r,n){super(),this.n=i,this.q=s,this.r=r,this.u=n,this.c=new Set,this.f=this.D(new Fo),this.g=new Map,this.h=this.D(new I),this.onDidChangeMcpServerDefinitions=this.h.event,this.j=[],this.b=t.getProxy(Q.MainThreadMcp)}get mcpServerDefinitions(){return this.j}$onDidChangeMcpServerDefinitions(t){this.j=t.map(i=>xl.to(i)),this.h.fire()}$startMcp(t,i){this.w(t,Tc.fromSerialized(i.launch),i.defaultCwd&&y.revive(i.defaultCwd),i.errorOnUserInteraction)}w(t,i,s,r){if(i.type===2){this.f.set(t,new W7(t,i,this.b,this.n,r));return}throw new Error("not implemented")}async $substituteVariables(t,i){const s=y.revive(t),r=s&&await this.r.resolveWorkspaceFolder(s);return(await this.u.getResolver()).resolveAsync(r&&{uri:r.uri,name:r.name,index:r.index},i)}$stopMcp(t){this.f.get(t)?.close().then(()=>this.y(t))}y(t){this.f.deleteAndDispose(t)}$sendMessage(t,i){this.f.get(t)?.send(i)}async $waitForInitialCollectionProviders(){await Promise.all(this.c)}async $resolveMcpLaunch(t,i){const s=this.g.get(t);if(!s)return;const r=s.servers.find(o=>o.label===i);if(!r)return;if(!s.provider.resolveMcpServerDefinition)return xl.from(r);const n=await s.provider.resolveMcpServerDefinition(r,De.None);return n?xl.from(n):void 0}registerMcpConfigurationProvider(t,i,s){const r=new X,n=t.contributes?.mcpServerDefinitionProviders?.find(l=>l.id===i);if(!n)throw new Error(`MCP configuration providers must be registered in the contributes.mcpServerDefinitionProviders array within your package.json, but "${i}" was not`);const o={id:dW(t.identifier,i),isTrustedByDefault:!0,label:n?.label??t.displayName??t.name,scope:1,canResolveLaunch:typeof s.resolveMcpServerDefinition=="function",extensionId:t.identifier.value,configTarget:this.q.remote.isRemote?4:2},a=async()=>{const l=await s.provideMcpServerDefinitions(De.None);this.g.set(o.id,{servers:l??[],provider:s});const u=[];for(const h of l??[]){let f=it.toKey(t.identifier)+"/"+h.label;if(u.some(v=>v.id===f)){let v=2;for(;u.some(b=>b.id===f+v);)v++;f=f+v}FG.validateOrThrow(h),h.authentication&&T(t,"mcpToolDefinitions");let p;const g=h;qe(t,"mcpToolDefinitions")&&g.metadata&&(p={capabilities:g.metadata.capabilities,instructions:g.metadata.instructions,serverInfo:g.metadata.serverInfo,tools:g.metadata.tools?.map(v=>({availability:v.availability===$g.Dynamic?1:0,definition:v.definition}))}),u.push({id:f,label:h.label,cacheNonce:h.version||"$$NONE",staticMetadata:p,launch:xl.from(h)})}this.b.$upsertMcpCollection(o,u)};r.add(se(()=>{this.g.delete(o.id),this.b.$deleteMcpCollection(o.id)})),s.onDidChangeMcpServerDefinitions&&r.add(s.onDidChangeMcpServerDefinitions(a)),s.onDidChangeServerDefinitions&&r.add(s.onDidChangeServerDefinitions(a)),s.onDidChange&&r.add(s.onDidChange(a));const c=new Promise(l=>{setTimeout(()=>a().finally(()=>{this.c.delete(c),l()}),0)});return this.c.add(c),r}};sv=__decorate([__param(0,Te),__param(1,xe),__param(2,Wt),__param(3,Ts),__param(4,Ha)],sv);var H7;(function(e){e[e.Unknown=0]="Unknown",e[e.Http=1]="Http",e[e.SSE=2]="SSE"})(H7||(H7={}));var jG=5,UG=[301,302,303,307,308],W7=class extends J{constructor(e,t,i,s,r){super(),this.q=e,this.r=t,this.u=i,this.w=s,this.y=r,this.b=new TO,this.c=new Di,this.f={value:0},this.g=new Ke,this.h=new AbortController,this.n=!1,this.D(se(()=>{this.h.abort(),this.g.dispose(!0)})),this.u.$onDidChangeState(this.q,{state:2})}async send(e){try{this.f.value===0?await this.b.queue(()=>this.C(e)):await this.C(e)}catch(t){const i=`Error sending message to ${this.r.uri}: ${String(t)}`;this.u.$onDidChangeState(this.q,{state:3,message:i})}}async close(){if(this.f.value===1&&this.f.sessionId&&!this.n){this.n=!0;try{await this.z(this.f.sessionId)}catch{}}this.u.$onDidChangeState(this.q,{state:0})}async z(e){const t={...Object.fromEntries(this.r.headers),"Mcp-Session-Id":e};try{await this.N(t,{errorOnUserInteraction:!0})}catch{this.O(K.Debug,"Skipping session close: authentication no longer available");return}await this.R(this.r.uri.toString(!0),{method:"DELETE",headers:t})}C(e){return this.f.value===2?this.L(this.f.endpoint,e):this.F(e,this.f.value===1?this.f.sessionId:void 0)}async F(e,t){const i=new TextEncoder().encode(e),s={...Object.fromEntries(this.r.headers),"Content-Type":"application/json","Content-Length":String(i.length),Accept:"text/event-stream, application/json"};t&&(s["Mcp-Session-Id"]=t),await this.N(s);const r=await this.Q(this.r.uri.toString(!0),{method:"POST",headers:s,body:i},s),n=this.f.value===0,o=r.headers.get("Mcp-Session-Id");if(o&&(this.f={value:1,sessionId:o}),this.f.value===0&&r.status>=400&&r.status<500&&!O4(r.status)){this.O(K.Info,`${r.status} status sending message to ${this.r.uri}, will attempt to fall back to legacy SSE`),this.G(e);return}if(r.status>=300){const a=this.f.value===1&&!!this.f.sessionId&&(r.status===400||r.status===404);this.u.$onDidChangeState(this.q,{state:3,message:`${r.status} status sending message to ${this.r.uri}: ${await this.P(r)}`+(a?"; will retry with new session ID":""),shouldRetry:a});return}this.f.value===0&&(this.f={value:1,sessionId:void 0}),n&&this.I(),await this.H(r,e)}async G(e){const t=await this.J();t&&(this.f={value:2,endpoint:t},await this.L(t,e))}async H(e,t){if(e.status===202)return;const i=e.headers.get("Content-Type")?.toLowerCase()||"";if(i.startsWith("text/event-stream")){const s=new M4(r=>{if(r.type==="message")this.u.$onDidReceiveMessage(this.q,r.data);else if(r.type==="endpoint")throw this.O(K.Warning,`Received SSE endpoint from a POST to ${this.r.uri}, will fall back to legacy SSE`),this.G(t),new dt});try{await this.M(s,e)}catch(r){this.O(K.Warning,`Error reading SSE stream: ${String(r)}`)}}else if(i.startsWith("application/json"))this.u.$onDidReceiveMessage(this.q,await e.text());else{const s=await e.text();zG(s)?this.u.$onDidReceiveMessage(this.q,s):this.O(K.Warning,`Unexpected ${e.status} response for request: ${s}`)}}async I(){let e,t;for(let i=0;!this.B.isDisposed;i++){t!==void 0?(await Kt(Math.max(0,t-Date.now()),this.g.token),t=void 0):await Kt(Math.min(i*1e3,3e4),this.g.token);let s;try{const n={...Object.fromEntries(this.r.headers),Accept:"text/event-stream"};await this.N(n),this.f.value===1&&this.f.sessionId!==void 0&&(n["Mcp-Session-Id"]=this.f.sessionId),e&&(n["Last-Event-ID"]=e),s=await this.Q(this.r.uri.toString(!0),{method:"GET",headers:n},n)}catch{this.O(K.Info,`Error connecting to ${this.r.uri} for async notifications, will retry`);continue}if(s.status>=400){this.O(K.Debug,`${s.status} status connecting to ${this.r.uri} for async notifications; they will be disabled: ${await this.P(s)}`);return}s.headers.get("content-type")?.toLowerCase().includes("text/event-stream")&&(i=0);const r=new M4(n=>{n.retry&&(t=Date.now()+n.retry),n.type==="message"&&n.data&&this.u.$onDidReceiveMessage(this.q,n.data),n.id&&(e=n.id)});try{await this.M(r,s)}catch(n){this.O(K.Info,`Error reading from async stream, we will reconnect: ${n}`)}}}async J(){const e=new Di,t={...Object.fromEntries(this.r.headers),Accept:"text/event-stream"};await this.N(t);let i;try{if(i=await this.Q(this.r.uri.toString(!0),{method:"GET",headers:t},t),i.status>=300){this.u.$onDidChangeState(this.q,{state:3,message:`${i.status} status connecting to ${this.r.uri} as SSE: ${await this.P(i)}`});return}}catch(r){this.u.$onDidChangeState(this.q,{state:3,message:`Error connecting to ${this.r.uri} as SSE: ${r}`});return}const s=new M4(r=>{r.type==="message"?this.u.$onDidReceiveMessage(this.q,r.data):r.type==="endpoint"&&e.complete(new URL(r.data,this.r.uri.toString(!0)).toString())});return this.D(se(()=>e.cancel())),this.M(s,i).catch(r=>{this.u.$onDidChangeState(this.q,{state:3,message:`Error reading SSE stream: ${String(r)}`})}),e.p}async L(e,t){const i=new TextEncoder().encode(t),s={...Object.fromEntries(this.r.headers),"Content-Type":"application/json","Content-Length":String(i.length)};await this.N(s);const r=await this.R(e,{method:"POST",headers:s,body:i});r.status>=300&&this.O(K.Warning,`${r.status} status sending message to ${this.c}: ${await this.P(r)}`)}async M(e,t){if(!t.body)return;const i=t.body.getReader();let s;do{try{s=await wf(i.read(),this.g.token)}catch(r){if(i.cancel(),this.B.isDisposed)return;throw r}s.value&&e.feed(s.value)}while(!s.done)}async N(e,t){const i=t?.errorOnUserInteraction??this.y;if(this.j)try{const s={authorizationServer:this.j.authorizationServer.toJSON(),authorizationServerMetadata:this.j.serverMetadata,resourceMetadata:this.j.resourceMetadata,scopes:this.j.scopes},r=await this.u.$getTokenFromServerMetadata(this.q,s,{errorOnUserInteraction:i,forceNewRegistration:t?.forceNewRegistration});r&&(e.Authorization=`Bearer ${r}`)}catch(s){if(XI.is(s))throw this.u.$onDidChangeState(this.q,{state:0,reason:"needs-user-interaction"}),new dt;this.O(K.Warning,`Error getting token from server metadata: ${String(s)}`)}if(this.r.authentication)try{this.O(K.Debug,`Using provided authentication config: providerId=${this.r.authentication.providerId}, scopes=${this.r.authentication.scopes.join(", ")}`);const s=await this.u.$getTokenForProviderId(this.q,this.r.authentication.providerId,this.r.authentication.scopes,{errorOnUserInteraction:i,forceNewRegistration:t?.forceNewRegistration});s&&(e.Authorization=`Bearer ${s}`,this.O(K.Info,"Successfully obtained token from provided authentication config"))}catch(s){if(XI.is(s))throw this.u.$onDidChangeState(this.q,{state:0,reason:"needs-user-interaction"}),new dt;this.O(K.Warning,`Error getting token from provided authentication config: ${String(s)}`)}return e}O(e,t){this.B.isDisposed||this.u.$onDidPublishLog(this.q,e,t)}async P(e){try{return await e.text()}catch{return e.statusText}}async Q(e,t,i){const s=()=>this.R(e,t);let r=await s();if(O4(r.status)&&(this.j?this.j.update(r.headers)&&(await this.N(i),i.Authorization&&(t.headers=i,r=await s())):(this.j=await HG(e,r.headers,{sameOriginHeaders:{...Object.fromEntries(this.r.headers),"MCP-Protocol-Version":Cw.LATEST_PROTOCOL_VERSION},fetch:(n,o)=>this.R(n,o),log:(n,o)=>this.O(n,o)}),this.u.$logMcpAuthSetup(this.j.telemetry),await this.N(i),i.Authorization&&(t.headers=i,r=await s()))),i.Authorization&&O4(r.status)){const n=await this.P(r);this.O(K.Info,`Received ${r.status} status with Authorization header, retrying with new auth registration. Error details: ${n||"no additional details"}`),await this.N(i,{forceNewRegistration:!0}),r=await s()}return r}async R(e,t){if(t.headers["user-agent"]=`${qs.nameLong}/${qs.version}`,U0(this.w.getLevel(),K.Trace)){const r={...t,headers:{...t.headers}};r.body&&(r.body=new TextDecoder().decode(r.body)),r.headers?.Authorization&&(r.headers.Authorization="***"),this.O(K.Trace,`Fetching ${e} with options: ${JSON.stringify(r)}`)}let i=e,s;for(let r=0;r<jG&&(s=await this.S(i,{...t,signal:this.h.signal,redirect:"manual"}),!!UG.includes(s.status));r++){const n=s.headers.get("location");if(!n)break;const o=new URL(n,i).toString();this.O(K.Trace,`Redirect (${s.status}) from ${i} to ${o}`),i=o,(s.status===303||(s.status===301||s.status===302)&&t.method==="POST")&&(t.method="GET",delete t.body)}if(U0(this.w.getLevel(),K.Trace)){const r={};s.headers.forEach((n,o)=>{r[o]=n}),this.O(K.Trace,`Fetched ${i}: ${JSON.stringify({status:s.status,headers:r})}`)}return s}S(e,t){return fetch(e,t)}};function zG(e){try{return JSON.parse(e),!0}catch{return!1}}function O4(e){return e===401||e===403}var _7=class{constructor(e,t,i,s,r,n){this.authorizationServer=e,this.serverMetadata=t,this.resourceMetadata=i,this.telemetry=r,this.b=n,this.a=s}get scopes(){return this.a}update(e){const t=this.c(e);return kq(t,this.a)?!1:(this.b(K.Info,`Scopes changed from ${JSON.stringify(this.a)} to ${JSON.stringify(t)}, updating`),this.a=t,!0)}c(e){const t=e.get("WWW-Authenticate");if(!t)return;const i=f8(t);for(const s of i)if(s.scheme==="Bearer"&&s.params.scope){const r=s.params.scope.split(TA).filter(n=>n.trim().length);if(r.length)return this.b(K.Info,`Found scope challenge in WWW-Authenticate header: ${s.params.scope}`),r}}};async function HG(e,t,i){const{sameOriginHeaders:s,fetch:r,log:n}=i;let o="none",a;const{resourceMetadataChallenge:c,scopesChallenge:l}=WG(t.get("WWW-Authenticate")??void 0,n);let u,h,f=l;try{const{metadata:b,discoveryUrl:S,errors:E}=await $q(e,c,{sameOriginHeaders:s,fetch:(k,O)=>r(k,O)});for(const k of E)n(K.Warning,`Error fetching resource metadata: ${k}`);n(K.Info,`Discovered resource metadata at ${S}`),o=c?"header":"wellKnown",u=b.authorization_servers?.[0],u?(n(K.Info,`Using auth server metadata url: ${u}`),a="resourceMetadata"):n(K.Warning,`No authorization_servers found in resource metadata ${S} - Is this resource metadata configured correctly?`),f??=b.scopes_supported,h=b}catch(b){n(K.Warning,`Could not fetch resource metadata: ${String(b)}`)}const p=new URL(e).origin;let g={};u||(u=p,s&&(g=s));try{n(K.Debug,`Fetching auth server metadata for: ${u} ...`);const{metadata:b,discoveryUrl:S,errors:E}=await Pq(u,{additionalHeaders:g,fetch:(k,O)=>r(k,O)});for(const k of E)n(K.Warning,`Error fetching authorization server metadata: ${k}`);return n(K.Info,`Discovered authorization server metadata at ${S}`),a??="wellKnown",new _7(y.parse(u),b,h,f,{resourceMetadataSource:o,serverMetadataSource:a},n)}catch(b){n(K.Warning,`Error populating auth server metadata for ${u}: ${String(b)}`)}const v=Cq(new URL(p));return n(K.Info,"Using default auth metadata"),new _7(y.parse(p),v,h,f,{resourceMetadataSource:o,serverMetadataSource:"default"},n)}function WG(e,t){if(!e)return{};let i,s;const r=f8(e);for(const n of r)if(n.scheme==="Bearer"){if(!i&&n.params.resource_metadata&&(i=n.params.resource_metadata,t(K.Debug,`Found resource_metadata challenge in WWW-Authenticate header: ${i}`)),!s&&n.params.scope){const o=n.params.scope.split(TA).filter(a=>a.trim().length);o.length&&(t(K.Debug,`Found scope challenge in WWW-Authenticate header: ${n.params.scope}`),s=o)}if(i&&s)break}return{resourceMetadataChallenge:i,scopesChallenge:s}}var B7=W("IExtHostDataChannels"),_G=class{constructor(){this.a=new Map}createDataChannel(e,t){T(e,"dataChannels");let i=this.a.get(t);return i||(i=new BG(t),this.a.set(t,i)),i}$onDidReceiveData(e,t){const i=this.a.get(e);i&&i._fireDidReceiveData(t)}},BG=class extends J{constructor(e){super(),this.b=e,this.a=new I,this.onDidReceiveData=this.a.event,this.D(this.a)}_fireDidReceiveData(e){this.a.fire({data:e})}toString(){return`DataChannel(${this.b})`}};Ne(KA,XA,1),Ne(Zn,Qm,1),Ne(Ml,r4,1),Ne(Ns,CA,0),Ne(Nm,FA,0),Ne(HA,WA,0),Ne(bs,fA,0),Ne(Yh,wA,0),Ne(ud,C4,0),Ne(k4,$4,0),Ne(X8,l4,0),Ne(za,h4,0),Ne(e4,t4,0),Ne(bc,QU,0),Ne(Q8,c4,1),Ne(D4,Zm,0),Ne(vA,q9,0),Ne(E4,S4,0),Ne(pn,IA,0),Ne(P4,T4,0),Ne(km,$m,0),Ne(Tm,RA,0),Ne(Mm,OA,0),Ne(Ts,lA,0),Ne(QA,_8,0),Ne(Rl,x4,0),Ne(Ha,Gm,0),Ne(iv,sv,0),Ne(B7,_G,0);var F4=class extends Dm{constructor(t,i){super(!0,t,i)}createTerminal(t,i,s){return this.createTerminalFromOptions({name:t,shellPath:i,shellArgs:s})}createTerminalFromOptions(t,i){const s=new kA(this.a,At(),t,t.name);return this.f.push(s),s.create(t,this.S(t,i)),s.value}};F4=__decorate([__param(0,Ns),__param(1,Te)],F4);import*as q7 from"child_process";import{promises as V7}from"fs";var G7;(function(e){e[e.stdout=0]="stdout",e[e.stderr=1]="stderr"})(G7||(G7={}));var J7;(function(e){e[e.Success=0]="Success",e[e.Unknown=1]="Unknown",e[e.AccessDenied=2]="AccessDenied",e[e.ProcessNotFound=3]="ProcessNotFound"})(J7||(J7={}));function qG(e,...t){const i=t.reduce((n,o)=>(n[o]=!0,n),{}),s=[/^ELECTRON_.+$/,/^VSCODE_(?!(PORTABLE|SHELL_LOGIN|ENV_REPLACE|ENV_APPEND|ENV_PREPEND)).+$/,/^SNAP(|_.*)$/,/^GDK_PIXBUF_.+$/];Object.keys(e).filter(n=>!i[n]).forEach(n=>{for(let o=0;o<s.length;o++)if(n.search(s[o])!==-1){delete e[n];break}})}function VG(e){e&&(delete e.DEBUG,Mt&&delete e.LD_PRELOAD)}function Z7(e=Rn){return e.comspec||"cmd.exe"}function GG(e){let t=[],i=!1;const s=function(r){if(i){t.push(r);return}(!e.send(r,o=>{if(o&&console.error(o),i=!1,t.length>0){const a=t.slice(0);t=[],a.forEach(c=>s(c))}})||ze)&&(i=!0)};return{send:s}}async function JG(e){if(await at.exists(e)){let t;try{t=await V7.stat(e)}catch(i){i.message.startsWith("EACCES")&&(t=await V7.lstat(e))}return t?!t.isDirectory():!1}return!1}async function rv(e,t,i,s=Rn,r=JG){if(Cs(e))return await r(e)?e:void 0;if(t===void 0&&(t=Ho()),Fi(e)!=="."){const c=Ge(t,e);return await r(c)?c:void 0}const o=Ck(s,"PATH");if(i===void 0&&Oe(o)&&(i=o.split(Yx)),i===void 0||i.length===0){const c=Ge(t,e);return await r(c)?c:void 0}for(const c of i){let l;if(Cs(c)?l=Ge(c,e):l=Ge(t,c,e),ze){const h=(Ck(s,"PATHEXT")||".COM;.EXE;.BAT;.CMD").split(";").map(async f=>{const p=l+f;return await r(p)?p:void 0});for(const f of h){const p=await f;if(p)return p}}if(await r(l))return l}const a=Ge(t,e);return await r(a)?a:void 0}async function j4(e,t=!1){let i;if(ze){const s=process.env.WINDIR||"C:\\Windows",r=Ge(s,"System32","taskkill.exe"),n=["/T"];t&&n.push("/F"),n.push("/PID",String(e)),i=q7.spawn(r,n,{stdio:["ignore","pipe","pipe"]})}else{const s=vf.asFileUri("vs/base/node/terminateProcess.sh").fsPath;i=q7.spawn("/bin/sh",[s,String(e),t?"9":"15"],{stdio:["ignore","pipe","pipe"]})}return new Promise((s,r)=>{const n=[];i.stdout.on("data",o=>n.push(o)),i.stderr.on("data",o=>n.push(o)),i.on("error",r),i.on("exit",o=>{o===0?s():r(new Error(`taskkill exited with code ${o}: ${Buffer.concat(n).toString()}`))})})}import{homedir as ZG}from"os";var U4=class extends Vm{constructor(t,i,s,r,n,o,a,c,l){super(t,i,s,r,n,o,a,c),this.E=s,this.F=l,i.remote.isRemote&&i.remote.authority?this.registerTaskSystem(V.vscodeRemote,{scheme:V.vscodeRemote,authority:i.remote.authority,platform:process.platform}):this.registerTaskSystem(V.file,{scheme:V.file,authority:"",platform:process.platform}),this.a.$registerSupportedExecutions(!0,!0,!0)}async executeTask(t,i){const s=i;if(!i.execution&&s._id===void 0)throw new Error("Tasks to execute must include an execution");if(s._id!==void 0){const r=w4.from(s,this.E),n=await this.a.$getTaskExecution(r);if(n.task===void 0)throw new Error("Task from execution DTO is undefined");const o=await this.B(n,i);return this.a.$executeTask(r).catch(()=>{}),o}else{const r=Fr.from(i,t);if(r===void 0)return Promise.reject(new Error("Task is not valid"));or.is(r.execution)&&await this.A(r,i,!1);const n=await this.B(await this.a.$getTaskExecution(r),i);return this.a.$executeTask(r).catch(()=>{}),n}}x(t,i,s,r){const n=[];if(r)for(const o of r){this.C(o,s),(!o.definition||!t[o.definition.type])&&this.f.warn(`The task [${o.source}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`);const a=Fr.from(o,s.extension);a&&(n.push(a),or.is(a.execution)&&i.push(this.A(a,o,!0)))}return{tasks:n,extension:s.extension}}async y(t){return t}async I(t){let i=t&&t.length>0?t[0]:void 0;if(!i){const s=y.file(ZG());i=new _0({uri:s,name:ji(s),index:0})}return{uri:i.uri,name:i.name,index:i.index,toResource:()=>{throw new Error("Not implemented")}}}async $resolveVariables(t,i){const s=y.revive(t),r={process:void 0,variables:Object.create(null)},n=await this.b.resolveWorkspaceFolder(s),o=await this.b.getWorkspaceFolders2()??[],a=await this.F.getResolver(),c=n?{uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}:await this.I(o);for(const l of i.variables)r.variables[l]=await a.resolveAsync(c,l);if(i.process!==void 0){let l;if(i.process.path!==void 0){l=i.process.path.split(Yx);for(let p=0;p<l.length;p++)l[p]=await a.resolveAsync(c,l[p])}const u=await a.resolveAsync(c,i.process.name),h=i.process.cwd!==void 0?await a.resolveAsync(c,i.process.cwd):void 0,f=await rv(u,h,l);f?r.process=f:Cs(u)?r.process=u:r.process=Ge(h??"",u)}return r}async $jsonTasksSupported(){return!0}async $findExecutable(t,i,s){return rv(t,i,s)}};U4=__decorate([__param(0,Te),__param(1,Wt),__param(2,Ts),__param(3,za),__param(4,bs),__param(5,pn),__param(6,xe),__param(7,Ml),__param(8,Ha)],U4);import*as Ol from"child_process";var yoe=W("externalTerminal"),nv="Terminal.app",Y7=d(2074,null),z4=class{async getDefaultTerminalForPlatforms(){return{windows:H4.getDefaultTerminalWindows(),linux:await Q7.getDefaultTerminalLinuxReady(),osx:"xterm"}}},H4=class Cn extends z4{static{this.b="cmd.exe"}openTerminal(t,i){return this.spawnTerminal(Ol,t,Z7(),i)}spawnTerminal(t,i,s,r){const n=i.windowsExec||Cn.getDefaultTerminalWindows();r&&r[1]===":"&&(r=r[0].toUpperCase()+r.substr(1));const o=$t(n,".exe").toLowerCase();if(o==="cmder")return t.spawn(n,r?[r]:void 0),Promise.resolve(void 0);const a=["/c","start","/wait"];return n.indexOf(" ")>=0&&a.push(n),a.push(n),o==="wt"&&a.push("-d ."),new Promise((c,l)=>{const u=Fl(process),h=t.spawn(s,a,{cwd:r,env:u,detached:!0});h.on("error",l),h.on("exit",()=>c())})}async runInTerminal(t,i,s,r,n){const o=n.windowsExec||Cn.getDefaultTerminalWindows(),a=await Cn.f();return new Promise((c,l)=>{const u=`"${i} - ${Y7}"`,h=`"${s.join('" "')}" & pause`,f=Object.assign({},Fl(process),r);Object.keys(f).filter(S=>f[S]===null).forEach(S=>delete f[S]);const p={cwd:i,env:f,windowsVerbatimArguments:!0};let g,v;$t(o,".exe")==="wt"?(g=o,v=["-d",".",Cn.b,"/c",h]):a?(g=a,v=["-d",".",o,"/c",h]):(g=Cn.b,v=["/c","start",u,"/wait",o,"/c",`"${h}"`]),Ol.spawn(g,v,p).on("error",S=>{l(W4(S))}),c(void 0)})}static getDefaultTerminalWindows(){if(!Cn.d){const t=!!process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432");Cn.d=`${process.env.windir?process.env.windir:"C:\\Windows"}\\${t?"Sysnative":"System32"}\\cmd.exe`}return Cn.d}static async f(){try{return await rv("wt")}catch{return}}};__decorate([nk],H4,"f",null);var YG=class hR extends z4{static{this.b="/usr/bin/osascript"}openTerminal(t,i){return this.spawnTerminal(Ol,t,i)}runInTerminal(t,i,s,r,n){const o=n.osxExec||nv;return new Promise((a,c)=>{if(o===nv||o==="iTerm.app"){const l=o===nv?"TerminalHelper":"iTermHelper",h=[vf.asFileUri(`vs/workbench/contrib/externalTerminal/node/${l}.scpt`).fsPath,"-t",t||Y7,"-w",i];for(const g of s)h.push("-a"),h.push(g);if(r){const g=Object.assign({},Fl(process),r);for(const v in g){const b=g[v];b===null?(h.push("-u"),h.push(v)):(h.push("-e"),h.push(`${v}=${b}`))}}let f="";const p=Ol.spawn(hR.b,h);p.on("error",g=>{c(W4(g))}),p.stderr.on("data",g=>{f+=g.toString()}),p.on("exit",g=>{if(g===0)a(void 0);else if(f){const v=f.split(`
`,1);c(new Error(v[0]))}else c(new Error(d(2075,null,l,g)))})}else c(new Error(d(2076,null,o)))})}spawnTerminal(t,i,s){const r=i.osxExec||nv;return new Promise((n,o)=>{const a=["-a",r];s&&a.push(s);const c=Fl(process),l=t.spawn("/usr/bin/open",a,{cwd:s,env:c});l.on("error",o),l.on("exit",()=>n())})}},Q7=class To extends z4{static{this.b=d(2077,null)}openTerminal(t,i){return this.spawnTerminal(Ol,t,i)}runInTerminal(t,i,s,r,n){const o=n.linuxExec?Promise.resolve(n.linuxExec):To.getDefaultTerminalLinuxReady();return new Promise((a,c)=>{const l=[];o.then(u=>{u.indexOf("gnome-terminal")>=0?l.push("-x"):l.push("-e"),l.push("bash"),l.push("-c");const h=`${QG(s)}; echo; read -p "${To.b}" -n1;`;l.push(`''${h}''`);const f=Object.assign({},Fl(process),r);Object.keys(f).filter(b=>f[b]===null).forEach(b=>delete f[b]);const p={cwd:i,env:f};let g="";const v=Ol.spawn(u,l,p);v.on("error",b=>{c(W4(b))}),v.stderr.on("data",b=>{g+=b.toString()}),v.on("exit",b=>{if(b===0)a(void 0);else if(g){const S=g.split(`
`,1);c(new Error(S[0]))}else c(new Error(d(2078,null,u,b)))})})})}static async getDefaultTerminalLinuxReady(){if(!To.d)if(!Mt)To.d=Promise.resolve("xterm");else{const t=await at.exists("/etc/debian_version");To.d=new Promise(i=>{t?i("x-terminal-emulator"):process.env.DESKTOP_SESSION==="gnome"||process.env.DESKTOP_SESSION==="gnome-classic"?i("gnome-terminal"):process.env.DESKTOP_SESSION==="kde-plasma"?i("konsole"):process.env.COLORTERM?i(process.env.COLORTERM):process.env.TERM?i(process.env.TERM):i("xterm")})}return To.d}spawnTerminal(t,i,s){const r=i.linuxExec?Promise.resolve(i.linuxExec):To.getDefaultTerminalLinuxReady();return new Promise((n,o)=>{r.then(a=>{const c=Fl(process),l=t.spawn(a,[],{cwd:s,env:c});l.on("error",o),l.on("exit",()=>n())})})}};function Fl(e){const t={...e.env};return qG(t),t}function W4(e){return e.errno==="ENOENT"&&e.path?new Error(d(2079,null,e.path)):e}function QG(e){let t="";for(const i of e)i.indexOf(" ")>=0?t+='"'+i+'"':t+=i,t+=" ";return t}var XG=class dR{constructor(){this.b=new Map}static{this.a=1}async createNewMessage(t){try{const i=await this.c();if(i){const s=String(dR.a++);return this.b.set(s,i),{id:s,data:i.createNewMessage(t)}}}catch{}return{id:"",data:t}}async validate(t,i){if(!t.id)return!0;const s=this.b.get(t.id);if(!s)return!1;this.b.delete(t.id);try{return s.validate(i)==="ok"}catch{return!1}finally{s.dispose?.()}}async sign(t){try{return await this.d(t)}catch{}return t}},X7=class extends XG{c(){return this.h().then(e=>new e.validator)}d(e){return this.h().then(t=>new t.signer().sign(e))}async h(){const e="vsda",{default:t}=await import(e);return t}};import*as K7 from"child_process";import*as eP from"net";var tP=class Xl extends E7{static{this.b=`\r
\r
`}static{this.c=/\r?\n/}static{this.i=/: */}constructor(){super(),this.p=Buffer.allocUnsafe(0),this.r=-1}t(t,i){this.l=i,this.p=Buffer.allocUnsafe(0),this.r=-1,t.on("data",s=>this.v(s))}sendMessage(t){if(this.l){const i=JSON.stringify(t);this.l.write(`Content-Length: ${Buffer.byteLength(i,"utf8")}${Xl.b}${i}`,"utf8")}}v(t){for(this.p=Buffer.concat([this.p,t]);;){if(this.r>=0){if(this.p.length>=this.r){const i=this.p.toString("utf8",0,this.r);if(this.p=this.p.slice(this.r),this.r=-1,i.length>0)try{this.acceptMessage(JSON.parse(i))}catch(s){this.n.fire(new Error((s.message||s)+`
`+i))}continue}}else{const i=this.p.indexOf(Xl.b);if(i!==-1){const r=this.p.toString("utf8",0,i).split(Xl.c);for(const n of r){const o=n.split(Xl.i);o[0]==="Content-Length"&&(this.r=Number(o[1]))}this.p=this.p.slice(i+Xl.b.length);continue}}break}}},iP=class extends tP{startSession(){return new Promise((e,t)=>{let i=!1;this.x=this.y(()=>{this.t(this.x,this.x),e(),i=!0}),this.x.on("close",()=>{i?this.n.fire(new Error("connection closed")):t(new Error("connection closed"))}),this.x.on("error",s=>{s instanceof AggregateError&&(s=s.errors[0]),i?this.n.fire(s):t(s)})})}async stopSession(){await this.w(),this.x&&(this.x.end(),this.x=void 0)}},KG=class extends iP{constructor(e){super(),this.z=e}y(e){return eP.createConnection(this.z.port,this.z.host||"127.0.0.1",e)}},eJ=class extends iP{constructor(e){super(),this.z=e}y(e){return eP.createConnection(this.z.path,e)}},sP=class Qa extends tP{constructor(t,i){super(),this.y=t,this.z=i}async startSession(){const t=this.y.command,i=this.y.args,s=this.y.options||{};try{if(t)if(Cs(t)){if(!await at.exists(t))throw new Error(d(8465,null,t))}else t.indexOf("/")<0&&t.indexOf("\\")<0;else throw new Error(d(8466,null,this.z));let r=process.env;if(s.env&&Object.keys(s.env).length>0&&(r=Xr(ct(process.env),s.env)),t==="node")if(Array.isArray(i)&&i.length>0){const n=!!process.env.ELECTRON_RUN_AS_NODE||!!process.versions.electron,o={env:r,execArgv:n?["-e","delete process.env.ELECTRON_RUN_AS_NODE;require(process.argv[1])"]:[],silent:!0};s.cwd&&(o.cwd=s.cwd);const a=K7.fork(i[0],i.slice(1),o);if(!a.pid)throw new Error(d(8467,null,i[0]));this.x=a}else throw new Error(d(8468,null));else{let n=t,o=i;const a={env:r};s.cwd&&(a.cwd=s.cwd),ze&&(t.endsWith(".bat")||t.endsWith(".cmd"))&&(a.shell=!0,n=`"${t}"`,o=i.map(c=>(c=c.replace(/"/g,'\\"'),`"${c}"`))),this.x=K7.spawn(n,o,a)}this.x.on("error",n=>{this.n.fire(n)}),this.x.on("exit",(n,o)=>{this.o.fire(n)}),this.x.stdout.on("close",()=>{this.n.fire(new Error("read error"))}),this.x.stdout.on("error",n=>{this.n.fire(n)}),this.x.stdin.on("error",n=>{this.n.fire(n)}),this.x.stderr.resume(),this.t(this.x.stdout,this.x.stdin)}catch(r){this.n.fire(r)}}async stopSession(){return this.x?(await this.w(),ze?j4(this.x.pid,!0).catch(()=>{this.x?.kill()}):(this.x.kill("SIGTERM"),Promise.resolve(void 0))):Promise.resolve(void 0)}static A(t,i){if(!t)return;const s=Object.create(null);t.runtime&&(t.runtime.indexOf("./")===0?s.runtime=Ge(i,t.runtime):s.runtime=t.runtime),t.runtimeArgs&&(s.runtimeArgs=t.runtimeArgs),t.program&&(Cs(t.program)?s.program=t.program:s.program=Ge(i,t.program)),t.args&&(s.args=t.args);const r=t;return r.win&&(s.win=Qa.A(r.win,i)),r.winx86&&(s.winx86=Qa.A(r.winx86,i)),r.windows&&(s.windows=Qa.A(r.windows,i)),r.osx&&(s.osx=Qa.A(r.osx,i)),r.linux&&(s.linux=Qa.A(r.linux,i)),s}static platformAdapterExecutable(t,i){let s=Object.create(null);i=i.toLowerCase();for(const l of t)if(l.contributes){const u=l.contributes.debuggers;u&&u.length>0&&u.filter(h=>typeof h.type=="string"&&gs(h.type,i)).forEach(h=>{const f=Qa.A(h,l.extensionLocation.fsPath);s=Xr(s,f,l.isBuiltin)})}let r;ze&&!process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?r=s.winx86||s.win||s.windows:ze?r=s.win||s.windows:Nt?r=s.osx:Mt&&(r=s.linux),r=r||s;const n=r.program||s.program,o=r.args||s.args,a=r.runtime||s.runtime,c=r.runtimeArgs||s.runtimeArgs;if(a)return{type:"executable",command:a,args:(c||[]).concat(typeof n=="string"?[n]:[]).concat(o||[])};if(n)return{type:"executable",command:n,args:o||[]}}};import*as tJ from"child_process";function iJ(e,t){return new Promise((i,s)=>{let r="";const n=tJ.spawn(e,t);n.pid&&n.stdout.on("data",o=>{r+=o.toString()}),n.on("error",o=>{s(o)}),n.on("close",o=>{i(r)})})}async function sJ(e){if(e)if(ze){const t=await import("@vscode/windows-process-tree");return new Promise(i=>{t.getProcessTree(e,s=>{i(!!s&&s.children.length>0)})})}else return iJ("/usr/bin/pgrep",["-lP",String(e)]).then(t=>{const i=t.trim();return!(i.length===0||i.indexOf(" tmux")>=0)},t=>!0);return Promise.resolve(!0)}var rP;(function(e){e[e.cmd=0]="cmd",e[e.powershell=1]="powershell",e[e.bash=2]="bash"})(rP||(rP={}));function rJ(e,t,i,s,r){e=e.trim().toLowerCase();let n;e.indexOf("powershell")>=0||e.indexOf("pwsh")>=0?n=1:e.indexOf("cmd.exe")>=0?n=0:e.indexOf("bash")>=0?n=2:ze?n=0:n=2;let o,a=" ";switch(n){case 1:if(o=c=>(c=c.replace(/\'/g,"''"),c.length>0&&c.charAt(c.length-1)==="\\"?`'${c}\\'`:`'${c}'`),s){const c=mC(s);c&&(a+=`${c}:; `),a+=`cd ${o(s)}; `}if(r)for(const c in r){const l=r[c];l===null?a+=`Remove-Item env:${c}; `:a+=`\${env:${c}}='${l}'; `}if(t.length>0){const c=t.shift(),l=i?c:o(c);a+=l[0]==="'"?`& ${l} `:`${l} `;for(const u of t)a+=u==="<"||u===">"||i?u:o(u),a+=" "}break;case 0:if(o=c=>(c=c.replace(/\"/g,'""'),c=c.replace(/([><!^&|])/g,"^$1"),' "'.split("").some(l=>c.includes(l))||c.length===0?`"${c}"`:c),s){const c=mC(s);c&&(a+=`${c}: && `),a+=`cd ${o(s)} && `}if(r){a+='cmd /C "';for(const c in r){let l=r[c];l===null?a+=`set "${c}=" && `:(l=l.replace(/[&^|<>]/g,u=>`^${u}`),a+=`set "${c}=${l}" && `)}}for(const c of t)a+=c==="<"||c===">"||i?c:o(c),a+=" ";r&&(a+='"');break;case 2:{o=l=>(l=l.replace(/(["'\\\$!><#()\[\]*&^| ;{}?`])/g,"\\$1"),l.length===0?'""':l);const c=l=>/[^\w@%\/+=,.:^-]/.test(l)?`'${l.replace(/'/g,"'\\''")}'`:l;if(s&&(a+=`cd ${o(s)} ; `),r){a+="/usr/bin/env";for(const l in r){const u=r[l];u===null?a+=` -u ${c(l)}`:a+=` ${c(`${l}=${u}`)}`}a+=" "}for(const l of t)a+=l==="<"||l===">"||i?l:o(l),a+=" ";break}}return a}var _4=class extends Jm{constructor(t,i,s,r,n,o,a,c,l,u){super(t,i,s,r,a,c,l,u),this.Fb=n,this.Gb=o,this.Db=new oJ}ib(t,i){return t instanceof el?new sP(this.lb(t),i.type):t instanceof tl?new KG(this.mb(t)):t instanceof dh?new eJ(this.nb(t)):super.ib(t,i)}vb(t,i){const s=sP.platformAdapterExecutable(i.getAllExtensionDescriptions(),t.type);if(s)return new el(s.command,s.args,s.options)}jb(){return new X7}async $runInTerminal(t,i){if(t.kind==="integrated"){this.Eb||(this.Eb=this.D(this.Fb.onDidCloseTerminal(g=>{this.Db.onTerminalClosed(g)})));const s=await this.ab.getConfigProvider(),r=this.Fb.getDefaultShell(!0),n=this.Fb.getDefaultShellArgs(!0),o=t.title||d(3073,null),a=JSON.stringify({shell:r,shellArgs:n});let c=await this.Db.checkout(a,o),l,u=!1;if(c)l=t.cwd;else{const g={shellPath:r,shellArgs:n,cwd:t.cwd,name:o,iconPath:new Ri("debug")};u=!0,c=this.Fb.createTerminalFromOptions(g,{isFeatureTerminal:!0,forceShellIntegration:!0,useShellEnvironment:!0}),this.Db.insert(c,a)}c.show(!0);const h=await c.processId;if(u){let g;(function(b){b[b.DataDebounce=500]="DataDebounce",b[b.MaxDelay=5e3]="MaxDelay"})(g||(g={}));const v=new X;await new Promise(b=>{const S=v.add(new vr(b,500));v.add(this.Fb.onDidWriteTerminalData(E=>{E.terminal===c&&S.schedule()})),v.add(this.Gb.onDidChangeTerminalShellIntegration(E=>{E.terminal===c&&b()})),v.add(s0(b,5e3))}),v.dispose()}else if(c.state.isInteractedWith&&!c.shellIntegration&&(c.sendText(""),await Kt(200)),s.getConfiguration("debug.terminal").get("clearBeforeReusing")){let g;if(r.indexOf("powershell")>=0||r.indexOf("pwsh")>=0||r.indexOf("cmd.exe")>=0?g="cls":r.indexOf("bash")>=0?g="clear":ze?g="cls":g="clear",c.shellIntegration){const v=new X,b=c.shellIntegration.executeCommand(g);await new Promise(S=>{v.add(this.Gb.onDidEndTerminalShellExecution(E=>{E.execution===b&&S()})),v.add(s0(S,500))}),v.dispose()}else c.sendText(g),await Kt(200)}const f=rJ(r,t.args,!!t.argsCanBeInterpretedByShell,l,t.env);c.shellIntegration?c.shellIntegration.executeCommand(f):c.sendText(f);const p=this.onDidTerminateDebugSession(g=>{g.id===i&&(this.Db.free(c),p.dispose())});return h}else if(t.kind==="external")return nJ(t,await this.ab.getConfigProvider());return super.$runInTerminal(t,i)}};_4=__decorate([__param(0,Te),__param(1,Ts),__param(2,gn),__param(3,bs),__param(4,pn),__param(5,P4),__param(6,Rl),__param(7,Ha),__param(8,Ns),__param(9,ud)],_4);var dd=void 0;function nJ(e,t){if(!dd)if(ze)dd=new H4;else if(Nt)dd=new YG;else if(Mt)dd=new Q7;else throw new Error("external terminals not supported on this platform");const i=t.getConfiguration("terminal");return dd.runInTerminal(e.title,e.cwd,e.args,e.env||{},i.external||{})}var oJ=class fR{constructor(){this.b=new Map}static{this.a=1e3}async checkout(t,i,s=!1){const n=[...this.b.entries()].map(([o,a])=>Qr(async c=>{if(o.name!==i||a.lastUsedAt!==-1&&await sJ(await o.processId))return null;const l=Date.now();return a.lastUsedAt+fR.a>l||c.isCancellationRequested?null:a.config!==t?(s&&o.dispose(),null):(a.lastUsedAt=l,o)}));return await RO(n,o=>!!o)}insert(t,i){this.b.set(t,{lastUsedAt:Date.now(),config:i})}free(t){const i=this.b.get(t);i&&(i.lastUsedAt=-1)}onTerminalClosed(t){this.b.delete(t)}},nP=new Rt(()=>{const e=Lm.Collator(void 0,{numeric:!0,sensitivity:"base"}).value;return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}}),Soe=new Rt(()=>({collator:Lm.Collator(void 0,{numeric:!0}).value})),Eoe=new Rt(()=>({collator:Lm.Collator(void 0,{numeric:!0,sensitivity:"accent"}).value}));function oP(e,t,i=!1){const s=e||"",r=t||"",n=nP.value.collator.compare(s,r);return nP.value.collatorIsNumeric&&n===0&&s!==r?s<r?-1:1:n}function aJ(e,t,i=!1){return i||(e=e&&e.toLowerCase(),t=t&&t.toLowerCase()),e===t?0:e<t?-1:1}function ov(e,t,i=!1){const s=e.split(It),r=t.split(It),n=s.length-1,o=r.length-1;let a,c;for(let l=0;;l++){if(a=n===l,c=o===l,a&&c)return oP(s[l],r[l],i);if(a)return-1;if(c)return 1;const u=aJ(s[l],r[l],i);if(u!==0)return u}}function B4(e,t,i){const s=e.toLowerCase(),r=t.toLowerCase(),n=cJ(e,t,i);if(n)return n;const o=s.endsWith(i),a=r.endsWith(i);if(o!==a)return o?-1:1;const c=oP(s,r);return c!==0?c:s.localeCompare(r)}function cJ(e,t,i){const s=e.toLowerCase(),r=t.toLowerCase(),n=s.startsWith(i),o=r.startsWith(i);if(n!==o)return n?-1:1;if(n&&o){if(s.length<r.length)return-1;if(s.length>r.length)return 1}return 0}var av=0,aP=[av,[]];function cP(e,t,i,s){if(!e||!t)return aP;const r=e.length,n=t.length;if(r<n)return aP;const o=e.toLowerCase();return lJ(t,i,n,e,o,r,s)}function lJ(e,t,i,s,r,n,o){const a=[],c=[];for(let f=0;f<i;f++){const p=f*n,g=p-n,v=f>0,b=e[f],S=t[f];for(let E=0;E<n;E++){const k=E>0,O=p+E,F=O-1,G=g+E-1,j=k?a[F]:0,B=v&&k?a[G]:0,H=v&&k?c[G]:0;let ie;!B&&v?ie=0:ie=uJ(b,S,s,r,E,H),ie&&B+ie>=j&&(o||v||r.startsWith(t,E))?(c[O]=H+1,a[O]=B+ie):(c[O]=av,a[O]=j)}}const l=[];let u=i-1,h=n-1;for(;u>=0&&h>=0;){const f=u*n+h;c[f]===av||(l.push(h),u--),h--}return[a[i*n-1],l.reverse()]}function uJ(e,t,i,s,r,n){let o=0;if(!hJ(t,s[r]))return o;if(o+=1,n>0&&(o+=Math.min(n,3)*6+Math.max(0,n-3)*3),e===i[r]&&(o+=1),r===0)o+=8;else{const a=dJ(i.charCodeAt(r-1));a?o+=a:Du(i.charCodeAt(r))&&n===0&&(o+=2)}return o}function hJ(e,t){return e===t?!0:e==="/"||e==="\\"?t==="/"||t==="\\":!1}function dJ(e){switch(e){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var cv=Object.freeze({score:0}),lv=1<<18,q4=1<<17,V4=65536;function fJ(e,t,i,s){const r=s.values?s.values:[s];return Ar({[s.normalized]:{values:r.map(o=>({value:o.normalized,expectContiguousMatch:o.expectContiguousMatch})),label:e,description:t,allowNonContiguousMatches:i}})}function lP(e,t,i,s,r){if(!e||!t.normalized)return cv;const n=s.getItemLabel(e);if(!n)return cv;const o=s.getItemDescription(e),a=fJ(n,o,i,t),c=r[a];if(c)return c;const l=pJ(n,o,s.getItemPath(e),t,i);return r[a]=l,l}function pJ(e,t,i,s,r){const n=!i||!s.containsPathSeparator;return i&&(Mt?s.pathNormalized===i:gs(s.pathNormalized,i))?{score:lv,labelMatch:[{start:0,end:e.length}],descriptionMatch:t?[{start:0,end:t.length}]:void 0}:s.values&&s.values.length>1?gJ(e,t,i,s.values,n,r):uP(e,t,i,s,n,r)}function gJ(e,t,i,s,r,n){let o=0;const a=[],c=[];for(const l of s){const{score:u,labelMatch:h,descriptionMatch:f}=uP(e,t,i,l,r,n);if(u===av)return cv;o+=u,h&&a.push(...h),f&&c.push(...f)}return{score:o,labelMatch:dP(a),descriptionMatch:dP(c)}}function uP(e,t,i,s,r,n){if(r||!t){const[o,a]=cP(e,s.normalized,s.normalizedLowercase,n&&!s.expectContiguousMatch);if(o){const c=V0(s.normalized,e);let l;if(c){l=q4;const u=Math.round(s.normalized.length/e.length*100);l+=u}else l=V4;return{score:l+o,labelMatch:c||hP(a)}}}if(t){let o=t;i&&(o=`${t}${It}`);const a=o.length,c=`${o}${e}`,[l,u]=cP(c,s.normalized,s.normalizedLowercase,n&&!s.expectContiguousMatch);if(l){const h=hP(u),f=[],p=[];return h.forEach(g=>{g.start<a&&g.end>a?(f.push({start:0,end:g.end-a}),p.push({start:g.start,end:a})):g.start>=a?f.push({start:g.start-a,end:g.end-a}):p.push(g)}),{score:l,labelMatch:f,descriptionMatch:p}}}return cv}function hP(e){const t=[];if(!e)return t;let i;for(const s of e)i&&i.end===s?i.end+=1:(i={start:s,end:s+1},t.push(i));return t}function dP(e){const t=e.sort((r,n)=>r.start-n.start),i=[];let s;for(const r of t)!s||!mJ(s,r)?(s=r,i.push(r)):(s.start=Math.min(s.start,r.start),s.end=Math.max(s.end,r.end));return i}function mJ(e,t){return!(e.end<t.start||t.end<e.start)}function vJ(e,t,i,s,r,n){const o=lP(e,i,s,r,n),a=lP(t,i,s,r,n),c=o.score,l=a.score;if((c===lv||l===lv)&&c!==l)return c===lv?-1:1;if(c>V4||l>V4){if(c!==l)return c>l?-1:1;if(c<q4&&l<q4){const b=wJ(o.labelMatch,a.labelMatch);if(b!==0)return b}const g=r.getItemLabel(e)||"",v=r.getItemLabel(t)||"";if(g.length!==v.length)return g.length-v.length}if(c!==l)return c>l?-1:1;const u=Array.isArray(o.labelMatch)&&o.labelMatch.length>0,h=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(u&&!h)return-1;if(h&&!u)return 1;const f=fP(e,o,r),p=fP(t,a,r);return f&&p&&f!==p?p>f?-1:1:bJ(e,t,i,r)}function fP(e,t,i){let s=-1,r=-1;if(t.descriptionMatch?.length?s=t.descriptionMatch[0].start:t.labelMatch?.length&&(s=t.labelMatch[0].start),t.labelMatch?.length){if(r=t.labelMatch[t.labelMatch.length-1].end,t.descriptionMatch?.length){const n=i.getItemDescription(e);n&&(r+=n.length)}}else t.descriptionMatch?.length&&(r=t.descriptionMatch[t.descriptionMatch.length-1].end);return r-s}function wJ(e,t){if(!e&&!t||!e?.length&&!t?.length)return 0;if(!t?.length)return-1;if(!e?.length)return 1;const i=e[0].start,r=e[e.length-1].end-i,n=t[0].start,a=t[t.length-1].end-n;return r===a?0:a<r?1:-1}function bJ(e,t,i,s){const r=s.getItemLabel(e)||"",n=s.getItemLabel(t)||"",o=s.getItemDescription(e),a=s.getItemDescription(t),c=r.length+(o?o.length:0),l=n.length+(a?a.length:0);if(c!==l)return c-l;const u=s.getItemPath(e),h=s.getItemPath(t);return u&&h&&u.length!==h.length?u.length-h.length:r!==n?B4(r,n,i.normalized):o&&a&&o!==a?B4(o,a,i.normalized):u&&h&&u!==h?B4(u,h,i.normalized):0}function pP(e){return e.startsWith('"')&&e.endsWith('"')}var yJ=" ";function G4(e){typeof e!="string"&&(e="");const t=e.toLowerCase(),{pathNormalized:i,normalized:s,normalizedLowercase:r}=gP(e),n=i.indexOf(It)>=0,o=pP(e);let a;const c=e.split(yJ);if(c.length>1)for(const l of c){const u=pP(l),{pathNormalized:h,normalized:f,normalizedLowercase:p}=gP(l);f&&(a||(a=[]),a.push({original:l,originalLowercase:l.toLowerCase(),pathNormalized:h,normalized:f,normalizedLowercase:p,expectContiguousMatch:u}))}return{original:e,originalLowercase:t,pathNormalized:i,normalized:s,normalizedLowercase:r,values:a,containsPathSeparator:n,expectContiguousMatch:o}}function gP(e){let t;ze?t=e.replace(/\//g,It):t=e.replace(/\\/g,It);const i=t.replace(/[\*\u2026\s"]/g,"").replace(/(?<=.)#$/,"");return{pathNormalized:t,normalized:i,normalizedLowercase:i.toLowerCase()}}import*as AJ from"child_process";import*as J4 from"fs";import{StringDecoder as mP}from"string_decoder";import*as SJ from"child_process";function uv(e){return e.startsWith("**")||e.startsWith("/")?e:`/${e}`}function EJ(e){return new Ky(e.start.line,e.start.character,e.end.line,e.end.character)}function vP(e){return new f9(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}var hv=class{constructor(t,i){this.a=t,this.b=i}appendLine(t){this.b.debug(`${this.a}#search`,t)}};hv=__decorate([__param(1,xe)],hv);import{rgPath as xJ}from"@vscode/ripgrep";var wP=xJ.replace(/\bnode_modules\.asar\b/,"node_modules.asar.unpacked");function CJ(e,t,i,s,r){const n=kJ(e,t,i,s,r),o=t.folder.fsPath;return{cmd:SJ.spawn(wP,n.args,{cwd:o}),rgDiskPath:wP,siblingClauses:n.siblingClauses,rgArgs:n,cwd:o}}function kJ(e,t,i,s,r){const n=["--files","--hidden","--case-sensitive","--no-require-git"];(e.ignoreGlobCase||t.ignoreGlobCase)&&(n.push("--glob-case-insensitive"),n.push("--ignore-file-case-insensitive")),IJ([t],i,!1).forEach(a=>{const c=uv(a);if(n.push("-g",c),Nt){const l=u0(c);l!==c&&n.push("-g",l)}});const o=$J([t],s,void 0,!1);return o.globArgs.forEach(a=>{const c=`!${uv(a)}`;if(n.push("-g",c),Nt){const l=u0(c);l!==c&&n.push("-g",l)}}),t.disregardIgnoreFiles!==!1?n.push("--no-ignore"):t.disregardParentIgnoreFiles!==!1&&n.push("--no-ignore-parent"),t.ignoreSymlinks||n.push("--follow"),e.exists&&n.push("--quiet"),r&&n.push("--threads",`${r}`),n.push("--no-config"),t.disregardGlobalIgnoreFiles&&n.push("--no-ignore-global"),{args:n,siblingClauses:o.siblingClauses}}function $J(e,t,i,s=!0){const r=[];let n={};return e.forEach(o=>{const a=Object.assign({},o.excludePattern||{},t||{}),c=bP(a,s?o.folder.fsPath:void 0,i);r.push(...c.globArgs),c.siblingClauses&&(n=Object.assign(n,c.siblingClauses))}),{globArgs:r,siblingClauses:n}}function IJ(e,t,i=!0){const s=[];return e.forEach(r=>{const n=Object.assign({},t||{},r.includePattern||{}),o=bP(n,i?r.folder.fsPath:void 0);s.push(...o.globArgs)}),s}function bP(e,t,i){const s=[],r={};return Object.keys(e).forEach(n=>{if(i&&i.has(n)||!n)return;const o=e[n];n=PJ(t?DJ(t,n):n),n.startsWith("\\\\")?n="\\\\"+n.substr(2).replace(/\\/g,"/"):n=n.replace(/\\/g,"/"),typeof o=="boolean"&&o?(n.startsWith("\\\\")&&(n+="**"),s.push(TJ(n))):o&&o.when&&(r[n]=o)}),{globArgs:s,siblingClauses:r}}function DJ(e,t){return Cs(t)?t:Ge(e,t)}function PJ(e){return e=Fn(e,"\\"),Fn(e,"/")}function TJ(e){return Y1(e).toLowerCase()==="c:/"?e.replace(/^c:[/\\]/i,"/"):e}var dv=new Set;process.on("exit",()=>{dv.forEach(e=>e())});var MJ=class{constructor(e){this.c=null,this.j=null,this.m=!1,this.o=null,this.s=null,this.t=0,this.a=e,this.b=e.filePattern||"";const t=e.ignoreGlobCase?{ignoreCase:!0}:void 0;this.d=e.includePattern&&Xs(e.includePattern,t),this.g=e.maxResults||null,this.h=!!e.exists,this.w=Object.create(null),this.l=0,this.k=!1,this.p=0,this.q=0,this.r=[],this.b&&(this.c=e.shouldGlobMatchFilePattern?null:G4(this.b).normalizedLowercase),this.v=e.excludePattern&&Xs(e.excludePattern,t),this.u=new Map,e.folderQueries.forEach(i=>{const s={};i.excludePattern?.forEach(n=>{Object.assign(s,n.pattern||{},this.a.excludePattern||{})}),i.excludePattern?.length||Object.assign(s,this.a.excludePattern||{});const r=i.folder.fsPath;e.folderQueries.map(n=>n.folder.fsPath).filter(n=>n!==r).forEach(n=>{Bo(n,r,e.ignoreGlobCase)&&(s[oc(r,n)]=!0)}),this.u.set(r,new NJ(s,r,e.ignoreGlobCase))})}cancel(){this.m=!0,dv.forEach(e=>e())}walk(e,t,i,s,r,n){if(this.o=Qi.create(!1),this.m)return n(null,this.k);t.forEach(o=>{const a=$t(o.fsPath);this.v&&this.v(o.fsPath,a)||this.K(s,{relativePath:o.fsPath,searchPath:void 0})}),this.s=Qi.create(!1),this.x(e,(o,a)=>{this.y(this.z,this,o,i,s,r,c=>{if(c){const l=yr(c);console.error(l),this.r.push(l),a(c,void 0)}else a(null,void 0)})},(o,a)=>{this.o.stop();const c=o?yt(o)[0]:null;n(c,this.k)})}x(e,t,i){const s=new Array(e.length),r=new Array(e.length);let n=!1,o=0;if(e.length===0)return i(null,[]);e.forEach((a,c)=>{t(a,(l,u)=>{if(l?(n=!0,s[c]=null,r[c]=l):(s[c]=u,r[c]=null),++o===e.length)return i(n?r:null,s)})})}y(e,t,...i){try{e.apply(t,i)}catch(s){i[i.length-1](s)}}z(e,t,i,s,r){const n=e.folder.fsPath,o=Nt,a=()=>f&&f.kill();dv.add(a);let c=b=>{dv.delete(a),c=()=>{},r(b)},l="";const u=this.G(),h=CJ(this.a,e,this.a.includePattern,this.u.get(e.folder.fsPath).expression,t),f=h.cmd,p=!Object.keys(h.siblingClauses).length,g=h.rgArgs.args.map(b=>b.match(/^-/)?b:`'${b}'`).join(" ");let v=`${h.rgDiskPath} ${g}
 - cwd: ${h.cwd}`;h.rgArgs.siblingClauses&&(v+=`
 - Sibling clauses: ${JSON.stringify(h.rgArgs.siblingClauses)}`),s({message:v}),this.t=0,this.A(f,"utf8",s,(b,S,E)=>{if(b){c(b);return}if(this.k){c();return}const O=(l+(o?xf(S||""):S)).split(`
`);if(E){const F=O.length;O[F-1]=O[F-1].trim(),O[F-1]||O.pop()}else l=O.pop()||"";if(O.length&&O[0].indexOf(`
`)!==-1){c(new Error("Splitting up files failed"));return}if(this.t+=O.length,p){for(const F of O)if(this.K(i,{base:n,relativePath:F,searchPath:this.O(e,F)}),this.k){a();break}(E||this.k)&&c();return}this.H(e,u,n,O,i),E&&(this.I(u,n,i),c())})}spawnFindCmd(e){const t=this.u.get(e.folder.fsPath),i=t.getBasenameTerms(),s=t.getPathTerms(),r=["-L","."];if(i.length||s.length){r.push("-not","(","(");for(const n of i)r.push("-name",n),r.push("-o");for(const n of s)r.push("-path",n),r.push("-o");r.pop(),r.push(")","-prune",")")}return r.push("-type","f"),AJ.spawn("find",r,{cwd:e.folder.fsPath})}readStdout(e,t,i){let s="";this.A(e,t,()=>{},(r,n,o)=>{if(r){i(r);return}s+=n,o&&i(null,s)})}A(e,t,i,s){let r=(a,c,l)=>{(a||l)&&(r=()=>{},this.s?.stop()),s(a,c,l)},n=!1;e.stdout?(this.B(e.stdout,t,r),e.stdout.once("data",()=>n=!0)):i({message:"stdout is null"});let o;e.stderr?o=this.C(e.stderr):i({message:"stderr is null"}),e.on("error",a=>{r(a)}),e.on("close",a=>{let c;!n&&(c=this.D(o,t))&&RJ(c)?r(new Error(`command failed with error code ${a}: ${this.D(o,t)}`)):(this.h&&a===0&&(this.k=!0),r(null,"",!0))})}B(e,t,i){const s=new mP(t);return e.on("data",r=>{i(null,s.write(r))}),s}C(e){const t=[];return e.on("data",i=>{t.push(i)}),t}D(e,t){const i=new mP(t);return e.map(s=>i.write(s)).join("")}G(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}H(e,{pathToEntries:t},i,s,r){const n=this.b&&s.find(a=>jn(a,this.b,this.a.ignoreGlobCase));n&&this.K(r,{base:i,relativePath:n,searchPath:this.O(e,n)});const o=a=>{const c=$t(a),l=Fi(a);let u=t[l];u||(u=t[l]=[],o(l)),u.push({base:i,relativePath:a,basename:c,searchPath:this.O(e,a)})};s.forEach(o)}I({rootEntries:e,pathToEntries:t},i,s){const r=this,n=this.u.get(i),o=this.b,a=this.a.ignoreGlobCase;function c(l){r.p++;const u=tA(()=>l.map(h=>h.basename));for(let h=0,f=l.length;h<f;h++){const p=l[h],{relativePath:g,basename:v}=p;if(n.test(g,v,jn(o,v,a)?void 0:u))continue;const b=t[g];if(b)c(b);else{if(r.q++,jn(g,o,a))continue;r.K(s,p)}if(r.k)break}}c(e)}getStats(){return{cmdTime:this.s.elapsed(),fileWalkTime:this.o.elapsed(),directoriesWalked:this.p,filesWalked:this.q,cmdResultCount:this.t}}J(e,t,i,s,r){const n=e.folder,o=tA(()=>i);this.x(i,(a,c)=>{if(this.m||this.k)return c(null);const l=t?[t,a].join(It):a;if(this.u.get(e.folder.fsPath).test(l,a,jn(this.a.filePattern,a,this.a.ignoreGlobCase)?void 0:o))return c(null);const u=[n.fsPath,l].join(It);J4.lstat(u,(h,f)=>{if(h||this.m||this.k)return c(null);this.M(u,f,(p,g)=>p||this.m||this.k?c(null):g.isDirectory()?(this.p++,this.N(u,f,(v,b)=>v||this.m||this.k||(b=b||"",this.w[b])?c(null):(this.w[b]=!0,at.readdir(u).then(S=>{if(this.m||this.k)return c(null);this.J(e,l,S,s,E=>c(E||null))},S=>{c(null)})))):(this.q++,jn(l,this.b,this.a.ignoreGlobCase)||this.j&&xs(g.size)&&g.size>this.j||this.K(s,{base:n.fsPath,relativePath:l,searchPath:this.O(e,l)}),c(null,void 0)))})},a=>{const c=a&&yt(a);return r(c&&c.length>0?c[0]:void 0)})}K(e,t){this.L(t)&&(!this.d||this.d(t.relativePath,$t(t.relativePath)))&&(this.l++,(this.h||this.g&&this.l>this.g)&&(this.k=!0),this.k||e(t))}L(e){if(this.b){if(this.b==="*")return!0;if(this.c)return eA(e,this.c);if(this.b)return eA(e,this.b,!1)}return!0}M(e,t,i){return t.isSymbolicLink()?J4.stat(e,i):i(null,t)}N(e,t,i){return t.isSymbolicLink()?J4.realpath(e,(s,r)=>s?i(s):i(null,r)):i(null,e)}O(e,t){return e.folderName?Ge(e.folderName,t):t}},yP=class{constructor(e,t){this.a=e.folderQueries,this.b=e.extraFileResources||[],this.d=t,this.c=new MJ(e)}search(e,t,i){this.c.walk(this.a,this.b,this.d,e,t,(s,r)=>{i(s,{limitHit:r,stats:this.c.getStats(),messages:[]})})}cancel(){this.c.cancel()}},NJ=class{constructor(e,t,i){this.expression=e,this.c=t,this.d=i,this.g(e)}g(e){let t,i;Object.keys(e).filter(r=>e[r]).forEach(r=>{Cs(r)?(t=t||a6(),t[r]=e[r]):(i=i||a6(),i[r]=e[r])});const s={trimForExclusions:!0,ignoreCase:this.d};this.a=t&&Xs(t,s),this.b=i&&Xs(i,s)}test(e,t,i){return this.b&&this.b(e,t,i)||this.a&&this.a(Ge(this.c,e),t,i)}getBasenameTerms(){const e=[];return this.a&&e.push(...p6(this.a)),this.b&&e.push(...p6(this.b)),e}getPathTerms(){const e=[];return this.a&&e.push(...g6(this.a)),this.b&&e.push(...g6(this.b)),e}};function RJ(e){const t=e.trim().split(`
`),i=t[0].trim();if(i.startsWith("Error parsing regex"))return i;if(i.startsWith("regex parse error"))return eO(t[t.length-1].trim());if(i.startsWith("error parsing glob")||i.startsWith("unsupported encoding"))return i.charAt(0).toUpperCase()+i.substr(1);if(i==="Literal '\\n' not allowed.")return"Literal '\\n' currently not supported";if(i.startsWith("Literal "))return i}import*as LJ from"child_process";import{EventEmitter as OJ}from"events";import{StringDecoder as FJ}from"string_decoder";import{RegExpParser as jJ,RegExpVisitor as UJ}from"vscode-regexpp";import{rgPath as zJ}from"@vscode/ripgrep";var AP=zJ.replace(/\bnode_modules\.asar\b/,"node_modules.asar.unpacked"),SP=class{constructor(e,t){this.a=e,this.b=t}provideTextSearchResults(e,t,i,s){return Promise.all(t.folderOptions.map(r=>{const n={folderOptions:r,numThreads:this.b,maxResults:t.maxResults,previewOptions:t.previewOptions,maxFileSize:t.maxFileSize,surroundingContext:t.surroundingContext};return this.provideTextSearchResultsWithRgOptions(e,n,i,s)})).then((r=>({limitHit:r.some(o=>!!o&&o.limitHit)})))}provideTextSearchResultsWithRgOptions(e,t,i,s){return this.a.appendLine(`provideTextSearchResults ${e.pattern}, ${JSON.stringify({...t,folder:t.folderOptions.folder.toString()})}`),e.pattern?new Promise((r,n)=>{s.onCancellationRequested(()=>g());const o={...t,numThreads:this.b},a=BJ(e,o),c=t.folderOptions.folder.fsPath,l=a.map(k=>k.match(/^-/)?k:`'${k}'`).join(" ");this.a.appendLine(`${AP} ${l}
 - cwd: ${c}`);let u=LJ.spawn(AP,a,{cwd:c});u.on("error",k=>{console.error(k),this.a.appendLine("Error: "+(k&&k.message)),n(x9(new Oa(k&&k.message,Ao.rgProcessError)))});let h=!1;const f=new _J(t.maxResults??fm,t.folderOptions.folder,L7(t.previewOptions));f.on("result",k=>{h=!0,b="",i.report(k)});let p=!1;const g=()=>{p=!0,u?.kill(),f?.cancel()};let v=!1;f.on("hitLimit",()=>{v=!0,g()});let b="";u.stdout.on("data",k=>{f.handleData(k),h||(b+=k)});let S=!1;u.stdout.once("data",()=>S=!0);let E="";u.stderr.on("data",k=>{const O=k.toString();this.a.appendLine(O),E.length+O.length<1e6&&(E+=O)}),u.on("close",()=>{if(this.a.appendLine(S?"Got data from stdout":"No data from stdout"),this.a.appendLine(h?"Got result from parser":"No result from parser"),b&&this.a.appendLine(`Got data without result: ${b}`),this.a.appendLine(""),p)r({limitHit:v});else{f.flush(),u=null;let k;E&&!S&&(k=HJ(E))?n(x9(new Oa(k.message,k.code))):r({limitHit:v})}})}):Promise.resolve({limitHit:!1})}};function HJ(e){const t=e.split(`
`),i=t[0].trim();if(t.some(r=>r.startsWith("regex parse error")))return new Oa(WJ(t),Ao.regexParseError);const s=i.match(/grep config error: unknown encoding: (.*)/);if(s)return new Oa(`Unknown encoding: ${s[1]}`,Ao.unknownEncoding);if(i.startsWith("error parsing glob"))return new Oa(i.charAt(0).toUpperCase()+i.substr(1),Ao.globParseError);if(i.startsWith("the literal"))return new Oa(i.charAt(0).toUpperCase()+i.substr(1),Ao.invalidLiteral);if(i.startsWith("PCRE2: error compiling pattern"))return new Oa(i,Ao.regexParseError)}function WJ(e){const t=["Regex parse error"],i=e.filter(s=>s.startsWith("PCRE2:"));if(i.length>=1){const s=i[0].replace("PCRE2:","");if(s.indexOf(":")!==-1&&s.split(":").length>=2){const r=s.split(":")[1];t.push(":"+r)}}return t.join("")}var _J=class extends OJ{constructor(e,t,i){super(),this.g=e,this.h=t,this.j=i,this.a="",this.b=!1,this.c=!1,this.f=0,this.d=new FJ}cancel(){this.b=!0}flush(){this.k(this.d.end())}on(e,t){return super.on(e,t),this}handleData(e){if(this.b)return;const t=typeof e=="string"?e:this.d.write(e);this.k(t)}k(e){let t=e.indexOf(`
`);const i=this.a+e;if(t>=0)t+=this.a.length;else{this.a=i;return}let s=0;for(;t>=0;)this.m(i.substring(s,t).trim()),s=t+1,t=i.indexOf(`
`,s);this.a=i.substring(s)}m(e){if(this.b||!e)return;let t;try{t=JSON.parse(e)}catch{throw new Error(`malformed line from rg: ${e}`)}if(t.type==="match"){const i=fd(t.data.path),s=y.joinPath(this.h,i),r=this.n(t.data,s);this.p(r),this.c&&(this.cancel(),this.emit("hitLimit"))}else if(t.type==="context"){const i=fd(t.data.path),s=y.joinPath(this.h,i);this.o(t.data,s).forEach(n=>this.p(n))}}n(e,t){const i=e.line_number-1,s=fd(e.lines),r=Buffer.from(s);let n=0,o=0,a=i;e.submatches.length===0&&e.submatches.push(s.length?{start:0,end:1,match:{text:s[0]}}:{start:0,end:0,match:{text:""}});const c=yt(e.submatches.map((h,f)=>{if(this.c)return null;this.f++,this.f>=this.g&&(this.c=!0);const p=fd(h.match),g=r.slice(n,h.start).toString(),v=EP(g),b=v.numLines>0?v.lastLineLength:v.lastLineLength+o,S=EP(p),E=v.numLines+a,k=S.numLines+E,O=S.numLines>0?S.lastLineLength:S.lastLineLength+b;return n=h.end,o=O,a=k,new f9(E,b,k,O)})),l=Kd(c,EJ),u=new b9(s,l,this.j);return new hn(t,u.rangeLocations.map(h=>({sourceRange:vP(h.source),previewRange:vP(h.preview)})),u.previewText)}o(e,t){const i=fd(e.lines),s=e.line_number;return i.replace(/\r?\n$/,"").split(`
`).map((r,n)=>new hm(t,r,s+n))}p(e){this.emit("result",e)}};function fd(e){return e.bytes?Buffer.from(e.bytes,"base64").toString():e.text}function EP(e){const t=/\n/g;let i=0,s=-1,r;for(;r=t.exec(e);)i++,s=r.index;const n=s>=0?e.length-s-1:e.length;return{numLines:i,lastLineLength:n}}function BJ(e,t){const i=["--hidden","--no-require-git"];i.push(e.isCaseSensitive?"--case-sensitive":"--ignore-case"),t.folderOptions.ignoreGlobCase&&(i.push("--glob-case-insensitive"),i.push("--ignore-file-case-insensitive"));const{doubleStarIncludes:s,otherIncludes:r}=x1(t.folderOptions.includes,o=>o.startsWith("**")?"doubleStarIncludes":"otherIncludes");if(r&&r.length){const o=new Set;r.forEach(a=>{o.add(a)}),i.push("-g","!*"),o.forEach(a=>{qJ(a).map(uv).forEach(c=>{i.push("-g",c)})})}s&&s.length&&s.forEach(o=>{i.push("-g",o)}),t.folderOptions.excludes.map(o=>typeof o=="string"?o:o.pattern).map(uv).forEach(o=>i.push("-g",`!${o}`)),t.maxFileSize&&i.push("--max-filesize",t.maxFileSize+""),t.folderOptions.useIgnoreFiles.local?t.folderOptions.useIgnoreFiles.parent||i.push("--no-ignore-parent"):i.push("--no-ignore"),t.folderOptions.followSymlinks&&i.push("--follow"),t.folderOptions.encoding&&t.folderOptions.encoding!=="utf8"&&i.push("--encoding",t.folderOptions.encoding),t.numThreads&&i.push("--threads",`${t.numThreads}`),e.pattern==="--"&&(e.isRegExp=!0,e.pattern="\\-\\-"),e.isMultiline&&!e.isRegExp&&(e.pattern=On(e.pattern),e.isRegExp=!0),t.usePCRE2&&i.push("--pcre2"),i.push("--crlf"),e.isRegExp&&(e.pattern=VJ(e.pattern),i.push("--engine","auto"));let n;if(e.isWordMatch){const a=Xx(e.pattern,!!e.isRegExp,{wholeWord:e.isWordMatch}).source.replace(/\\\//g,"/");i.push("--regexp",a)}else if(e.isRegExp){let o=GJ(e.pattern);o=JJ(o),i.push("--regexp",o)}else n=e.pattern,i.push("--fixed-strings");return i.push("--no-config"),t.folderOptions.useIgnoreFiles.global||i.push("--no-ignore-global"),i.push("--json"),e.isMultiline&&i.push("--multiline"),t.surroundingContext&&(i.push("--before-context",t.surroundingContext+""),i.push("--after-context",t.surroundingContext+"")),i.push("--"),n&&i.push(n),i.push("."),i}function qJ(e){return CP(e).flatMap(i=>{const s=Mc(i,"/");return s.map((r,n)=>s.slice(0,n+1).join("/"))})}function VJ(e){const t=/((?:[^\\]|^)(?:\\\\)*)\\u([a-z0-9]{4})/gi;for(;e.match(t);)e=e.replace(t,"$1\\x{$2}");const i=/((?:[^\\]|^)(?:\\\\)*)\\u\{([a-z0-9]{4})\}/gi;for(;e.match(i);)e=e.replace(i,"$1\\x{$2}");return e}var xP=e=>e.type==="Assertion"&&e.kind==="lookbehind";function GJ(e){let t;try{t=new jJ().parsePattern(e)}catch{return e}let i="",s=0;const r=(a,c,l)=>{i+=e.slice(s,a)+l,s=c},n=[];return new UJ({onCharacterEnter(a){if(a.raw!=="\\n")return;const c=n[0];if(!c)r(a.start,a.end,"\\r?\\n");else if(!n.some(xP))if(c.type==="CharacterClass")if(c.negate){const l=e.slice(c.start+2,a.start)+e.slice(a.end,c.end-1);c.parent?.type==="Quantifier"?r(c.start,c.end,l?`[^${l}]`:"."):r(c.start,c.end,"(?!\\r?\\n"+(l?`|[${l}]`:"")+")")}else{const l=e.slice(c.start+1,a.start)+e.slice(a.end,c.end-1);r(c.start,c.end,l===""?"\\r?\\n":`(?:[${l}]|\\r?\\n)`)}else c.type==="Quantifier"&&r(a.start,a.end,"(?:\\r?\\n)")},onQuantifierEnter(a){n.unshift(a)},onQuantifierLeave(){n.shift()},onCharacterClassRangeEnter(a){n.unshift(a)},onCharacterClassRangeLeave(){n.shift()},onCharacterClassEnter(a){n.unshift(a)},onCharacterClassLeave(){n.shift()},onAssertionEnter(a){xP(a)&&n.push(a)},onAssertionLeave(a){n[0]===a&&n.shift()}}).visit(t),i+=e.slice(s),i}function JJ(e){return e.replace(/\n/g,"\\r?\\n")}function ZJ(e){let t=!1,i=!1,s="",r="";for(let n=0;n<e.length;n++){const o=e[n];switch(o){case"\\":i?(t?r+="\\"+o:s+="\\"+o,i=!1):i=!0;break;case"{":if(i)t?r+=o:s+=o,i=!1;else{if(t)return{strInBraces:s+"{"+r+"{"+e.substring(n+1)};t=!0}break;case"}":if(i)t?r+=o:s+=o,i=!1;else{if(t)return{fixedStart:s,strInBraces:r,fixedEnd:e.substring(n+1)};s+=o}break;default:t?r+=(i?"\\":"")+o:s+=(i?"\\":"")+o,i=!1;break}}return{strInBraces:s+(t?"{"+r:"")}}function CP(e){const{fixedStart:t,strInBraces:i,fixedEnd:s}=ZJ(e);if(t===void 0||s===void 0)return[i];let r=Mc(i,",");r.length||(r=[""]);const n=CP(s);return r.flatMap(o=>{const a=t+o;return n.map(c=>a+c)})}var kP=class extends I4{constructor(e,t,i=Ef,s="searchProcess"){super({query:e,provider:t},{readdir:r=>i.Promises.readdir(r.fsPath),toCanonicalName:r=>IB(r)},s)}},YJ=class{constructor(e,t){this.a=e,this.b=t}search(e,t,i){if((!this.a.folderQueries||!this.a.folderQueries.length)&&(!this.a.extraFileResources||!this.a.extraFileResources.length))return Promise.resolve({type:"success",limitHit:!1,stats:{type:"searchProcess"},messages:[]});const s={appendLine(n){i({message:n})}},r=new kP(this.a,new SP(s,this.b),Ef);return new Promise((n,o)=>r.search(a=>{t(a.map(QJ))},e).then(a=>n({limitHit:a.limitHit??!1,type:"success",stats:a.stats,messages:[]}),o))}};function QJ(e){return{path:e.resource&&e.resource.fsPath,results:e.results,numMatches:(e.results||[]).reduce((t,i)=>Xy(i)?t+i.rangeLocations.length:t+1,0)}}var XJ=class g1{static{this.a=512}constructor(t="searchProcess",i){this.d=t,this.f=i,this.b=Object.create(null)}fileSearch(t){let i;const s=$P(t),r=new I({onDidAddFirstListener:()=>{i=Qr(async n=>{const o=await this.f?.();return this.doFileSearchWithEngine(yP,s,a=>r.fire(a),n,g1.a,o)}),i.then(n=>r.fire(n),n=>r.fire({type:"error",error:{message:n.message,stack:n.stack}}))},onDidRemoveLastListener:()=>{i.cancel()}});return r.event}textSearch(t){let i;const s=$P(t),r=new I({onDidAddFirstListener:()=>{i=Qr(n=>this.g(s,o=>r.fire(o),n)),i.then(n=>r.fire(n),n=>r.fire({type:"error",error:{message:n.message,stack:n.stack}}))},onDidRemoveLastListener:()=>{i.cancel()}});return r.event}async g(t,i,s){t.maxFileSize=this.h().maxFileSize;const r=await this.f?.();return new YJ(t,r).search(s,i,i)}h(){return{maxFileSize:16*X$.GB}}doFileSearch(t,i,s,r){return this.doFileSearchWithEngine(yP,t,s,r,g1.a,i)}doFileSearchWithEngine(t,i,s,r,n=g1.a,o){let a=0;const c=u=>{Array.isArray(u)?(a+=u.length,s(u.map(h=>this.j(h)))):u.relativePath?(a++,s(this.j(u))):s(u)};if(i.sortByScore){let u=this.n(i,c,r);if(!u){const h=i.maxResults?Object.assign({},i,{maxResults:null}):i,f=new t(h,o);u=this.k(f,i,s,c,r)}return new Promise((h,f)=>{u.then(([p,g])=>{const v=g.map(b=>this.j(b));this.q(v,s,n),h(p)},f)})}const l=new t(i,o);return this.s(l,c,n,r).then(u=>({limitHit:u.limitHit,type:"success",stats:{detailStats:u.stats,type:this.d,fromCache:!1,resultCount:a,sortingTime:void 0},messages:[]}))}j(t){return{path:t.base?Ge(t.base,t.relativePath):t.relativePath}}k(t,i,s,r,n){const o=new I;let a=Qr(l=>{let u=[];const h=f=>{Array.isArray(f)?u=f:(r(f),o.fire(f))};return this.s(t,h,-1,l).then(f=>[f,u])}),c;if(i.cacheKey){c=this.l(i.cacheKey);const l={promise:a,event:o.event,resolved:!1};c.resultsToSearchCache[i.filePattern||""]=l,a.then(()=>{l.resolved=!0},u=>{delete c.resultsToSearchCache[i.filePattern||""]}),a=this.t(a)}return a.then(([l,u])=>{const h=c?c.scorerCache:Object.create(null),f=(typeof i.maxResults!="number"||i.maxResults>0)&&Qi.create(!1);return this.o(i,u,h,n).then(p=>{const g=f?f.elapsed():-1;return[{type:"success",stats:{detailStats:l.stats,sortingTime:g,fromCache:!1,type:this.d,resultCount:p.length},messages:l.messages,limitHit:l.limitHit||typeof i.maxResults=="number"&&u.length>i.maxResults},p]})})}l(t){const i=this.b[t];return i||(this.b[t]=new KJ)}n(t,i,s){const r=t.cacheKey&&this.b[t.cacheKey];if(!r)return;const n=this.r(r,t.filePattern||"",i,s);if(n)return n.then(([o,a,c])=>{const l=Qi.create(!1);return this.o(t,a,r.scorerCache,s).then(u=>{const h=l.elapsed(),f={fromCache:!0,detailStats:c,type:this.d,resultCount:a.length,sortingTime:h};return[{type:"success",limitHit:o.limitHit||typeof t.maxResults=="number"&&a.length>t.maxResults,stats:f,messages:[]},u]})})}o(t,i,s,r){const n=G4(t.filePattern||""),o=(c,l)=>vJ(c,l,n,!0,eZ,s),a=typeof t.maxResults=="number"?t.maxResults:fm;return xL(i,o,a,1e4,r)}q(t,i,s){if(s&&s>0)for(let r=0;r<t.length;r+=s)i(t.slice(r,r+s));else i(t)}r(t,i,s,r){const n=Qi.create(!1),o=i.indexOf(It)>=0;let a;for(const h in t.resultsToSearchCache)if(i.startsWith(h)){if(o&&h.indexOf(It)<0&&h!=="")continue;const f=t.resultsToSearchCache[h];a={promise:this.t(f.promise),event:f.event,resolved:f.resolved};break}if(!a)return null;const c=n.elapsed(),l=Qi.create(!1),u=a.event(s);return r&&r.onCancellationRequested(()=>{u.dispose()}),a.promise.then(([h,f])=>{if(r&&r.isCancellationRequested)throw ou();const p=[],g=G4(i).normalizedLowercase;for(const v of f)eA(v,g)&&p.push(v);return[h,p,{cacheWasResolved:a.resolved,cacheLookupTime:c,cacheFilterTime:l.elapsed(),cacheEntryCount:f.length}]})}s(t,i,s,r){return new Promise((n,o)=>{let a=[];r?.onCancellationRequested(()=>t.cancel()),t.search(c=>{c&&(s?(a.push(c),s>0&&a.length>=s&&(i(a),a=[])):i(c))},c=>{i(c)},(c,l)=>{a.length&&i(a),c?(i({message:"Search finished. Error: "+c.message}),o(c)):(i({message:"Search finished. Stats: "+JSON.stringify(l.stats)}),n(l))})})}clearCache(t){return delete this.b[t],Promise.resolve(void 0)}t(t){return new class{get[Symbol.toStringTag](){return this.toString()}cancel(){}then(i,s){return t.then(i,s)}catch(i){return this.then(void 0,i)}finally(i){return t.finally(i)}}}},KJ=class{constructor(){this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null)}},eZ=new class{getItemLabel(e){return $t(e.relativePath)}getItemDescription(e){return Fi(e.relativePath)}getItemPath(e){return e.relativePath}};function $P(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(tZ),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function tZ(e){return ei(e)}var IP=class{constructor(e,t){this.b=e,this.c=t,this.a=new Set,process.once("exit",()=>this.f())}async provideTextSearchResults(e,t,i,s){const r=await this.c(),n=new SP(this.b,r);return Promise.all(t.folderOptions.map(o=>{const a={folderOptions:o,numThreads:r,maxResults:t.maxResults,previewOptions:t.previewOptions,maxFileSize:t.maxFileSize,surroundingContext:t.surroundingContext};if(o.folder.scheme===V.vscodeUserData){const c={...a,folder:o.folder.with({scheme:V.file})},l=new Pm(u=>i.report({...u,uri:u.uri.with({scheme:o.folder.scheme})}));return this.d(s,u=>n.provideTextSearchResultsWithRgOptions(e,c,l,u))}else return this.d(s,c=>n.provideTextSearchResultsWithRgOptions(e,a,i,c))})).then((o=>({limitHit:o.some(c=>!!c&&c.limitHit)})))}async d(e,t){const i=iZ(e);this.a.add(i);const s=await t(i.token);return this.a.delete(i),s}f(){this.a.forEach(e=>e.cancel())}};function iZ(e){const t=new Ke;return e.onCancellationRequested(()=>t.cancel()),t}var Z4=class extends Zm{constructor(t,i,s,r,n){super(t,s,n),this.E=r,this.x=Ef,this.y=-1,this.z=null,this.A=!1,this.C=new X,this.D=!1,this.getNumThreads=this.getNumThreads.bind(this),this.getNumThreadsCached=this.getNumThreadsCached.bind(this),this.F=this.F.bind(this);const o=new hv("RipgrepSearchUD",this.s);this.C.add(this.registerTextSearchProvider(V.vscodeUserData,new IP(o,this.getNumThreadsCached))),i.remote.isRemote&&i.remote.authority&&this.G(),r.getConfigProvider().then(a=>{this.D||this.C.add(a.onDidChangeConfiguration(this.F))})}F(t){t.affectsConfiguration("search")&&(this.B=void 0)}async getNumThreads(){return(await this.E.getConfigProvider()).getConfiguration("search").get("ripgrep.maxThreads")}async getNumThreadsCached(){return this.B||(this.B=this.getNumThreads()),this.B}dispose(){this.D=!0,this.C.dispose()}$enableExtensionHostSearch(){this.G()}G(){if(this.A)return;this.A=!0;const t=new hv("RipgrepSearchEH",this.s);this.C.add(this.registerTextSearchProvider(V.file,new IP(t,this.getNumThreadsCached))),this.C.add(this.H(V.file,new XJ("fileSearchProvider",this.getNumThreadsCached)))}H(t,i){const s=this.e++;return this.z=i,this.y=s,this.c.$registerFileSearchProvider(s,this.t(t)),se(()=>{this.z=null,this.c.$unregisterProvider(s)})}$provideFileSearchResults(t,i,s,r){const n=Ym(s);if(t===this.y){const o=Date.now();return this.I(t,i,n,r).then(a=>{const c=Date.now()-o;return this.s.debug(`Ext host file search time: ${c}ms`),a})}return super.$provideFileSearchResults(t,i,s,r)}async doInternalFileSearchWithCustomCallback(t,i,s){const r=o=>{if(aB(o)&&(o=[o]),Array.isArray(o)){s(o.map(a=>y.file(a.path)));return}o.message&&this.s.debug("ExtHostSearch",o.message)};if(!this.z)throw new Error("No internal file search handler");const n=await this.getNumThreadsCached();return this.z.doFileSearch(t,n,r,i)}async I(t,i,s,r){return this.doInternalFileSearchWithCustomCallback(s,r,n=>{this.c.$handleFileMatch(t,i,n)})}$clearCache(t){return this.z?.clearCache(t),super.$clearCache(t)}v(t,i){return new kP(t,i,void 0,"textSearchProvider")}};Z4=__decorate([__param(0,Te),__param(1,Wt),__param(2,ku),__param(3,bs),__param(4,xe)],Z4);function DP(e,t,i,s,r,n){if(Array.isArray(e)){let o=0;for(const a of e){const c=DP(a,t,i,s,r,n);if(c===10)return c;c>o&&(o=c)}return o}else{if(typeof e=="string")return s?e==="*"?5:e===i?10:0:0;if(e){const{language:o,pattern:a,scheme:c,hasAccessToAllModels:l,notebookType:u}=e;if(!s&&!l)return 0;u&&r&&(t=r);let h=0;if(c)if(c===t.scheme)h=10;else if(c==="*")h=5;else return 0;if(o)if(o===i)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(u)if(u===n)h=10;else if(u==="*"&&n!==void 0)h=Math.max(h,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:Yr(a.base)},f===t.fsPath||la(f,t.fsPath))h=10;else return 0}return h}else return 0}}function PP(e){return typeof e=="string"?!1:Array.isArray(e)?e.some(PP):!!e.notebookType}var Y4;(function(e){e[e.None=0]="None",e[e.Indent=1]="Indent",e[e.IndentOutdent=2]="IndentOutdent",e[e.Outdent=3]="Outdent"})(Y4||(Y4={}));var Moe=W("editSessionIdentityService"),Q4;(function(e){e[e.Complete=100]="Complete",e[e.Partial=50]="Partial",e[e.None=0]="None"})(Q4||(Q4={}));var Noe=new C("debugType",void 0,{type:"string",description:d(8327,null)}),Roe=new C("debugConfigurationType",void 0,{type:"string",description:d(8328,null)}),Loe=new C("debugState","inactive",{type:"string",description:d(8329,null)}),sZ="debugUx",Ooe=new C(sZ,"default",{type:"string",description:d(8330,null)}),Foe=new C("hasDebugged",!1,{type:"boolean",description:d(8331,null)}),joe=new C("inDebugMode",!1,{type:"boolean",description:d(8332,null)}),Uoe=new C("inDebugRepl",!1,{type:"boolean",description:d(8333,null)}),zoe=new C("breakpointWidgetVisible",!1,{type:"boolean",description:d(8334,null)}),Hoe=new C("inBreakpointWidget",!1,{type:"boolean",description:d(8335,null)}),Woe=new C("breakpointsFocused",!0,{type:"boolean",description:d(8336,null)}),_oe=new C("watchExpressionsFocused",!0,{type:"boolean",description:d(8337,null)}),Boe=new C("watchExpressionsExist",!1,{type:"boolean",description:d(8338,null)}),qoe=new C("variablesFocused",!0,{type:"boolean",description:d(8339,null)}),Voe=new C("expressionSelected",!1,{type:"boolean",description:d(8340,null)}),Goe=new C("breakpointInputFocused",!1,{type:"boolean",description:d(8341,null)}),Joe=new C("callStackItemType",void 0,{type:"string",description:d(8342,null)}),Zoe=new C("callStackSessionIsAttach",!1,{type:"boolean",description:d(8343,null)}),Yoe=new C("callStackItemStopped",!1,{type:"boolean",description:d(8344,null)}),Qoe=new C("callStackSessionHasOneThread",!1,{type:"boolean",description:d(8345,null)}),Xoe=new C("callStackFocused",!0,{type:"boolean",description:d(8346,null)}),Koe=new C("watchItemType",void 0,{type:"string",description:d(8347,null)}),eae=new C("canViewMemory",void 0,{type:"boolean",description:d(8348,null)}),tae=new C("breakpointItemType",void 0,{type:"string",description:d(8349,null)}),iae=new C("breakpointItemBytes",void 0,{type:"boolean",description:d(8350,null)}),sae=new C("breakpointHasModes",!1,{type:"boolean",description:d(8351,null)}),rae=new C("breakpointSupportsCondition",!1,{type:"boolean",description:d(8352,null)}),nae=new C("loadedScriptsSupported",!1,{type:"boolean",description:d(8353,null)}),oae=new C("loadedScriptsItemType",void 0,{type:"string",description:d(8354,null)}),aae=new C("focusedSessionIsAttach",!1,{type:"boolean",description:d(8355,null)}),cae=new C("focusedSessionIsNoDebug",!1,{type:"boolean",description:d(8356,null)}),lae=new C("stepBackSupported",!1,{type:"boolean",description:d(8357,null)}),uae=new C("restartFrameSupported",!1,{type:"boolean",description:d(8358,null)}),hae=new C("stackFrameSupportsRestart",!1,{type:"boolean",description:d(8359,null)}),dae=new C("jumpToCursorSupported",!1,{type:"boolean",description:d(8360,null)}),fae=new C("stepIntoTargetsSupported",!1,{type:"boolean",description:d(8361,null)}),pae=new C("breakpointsExist",!1,{type:"boolean",description:d(8362,null)}),gae=new C("debuggersAvailable",!1,{type:"boolean",description:d(8363,null)}),mae=new C("debugExtensionAvailable",!0,{type:"boolean",description:d(8364,null)}),vae=new C("debugProtocolVariableMenuContext",void 0,{type:"string",description:d(8365,null)}),wae=new C("debugSetVariableSupported",!1,{type:"boolean",description:d(8366,null)}),bae=new C("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:d(8367,null)}),yae=new C("debugSetExpressionSupported",!1,{type:"boolean",description:d(8368,null)}),Aae=new C("breakWhenValueChangesSupported",!1,{type:"boolean",description:d(8369,null)}),Sae=new C("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:d(8370,null)}),Eae=new C("breakWhenValueIsReadSupported",!1,{type:"boolean",description:d(8371,null)}),xae=new C("terminateDebuggeeSupported",!1,{type:"boolean",description:d(8372,null)}),Cae=new C("suspendDebuggeeSupported",!1,{type:"boolean",description:d(8373,null)}),kae=new C("terminateThreadsSupported",!1,{type:"boolean",description:d(8374,null)}),$ae=new C("variableEvaluateNamePresent",!1,{type:"boolean",description:d(8375,null)}),Iae=new C("variableIsReadonly",!1,{type:"boolean",description:d(8376,null)}),Dae=new C("variableValue",!1,{type:"string",description:d(8377,null)}),Pae=new C("variableType",!1,{type:"string",description:d(8378,null)}),Tae=new C("variableInterfaces",!1,{type:"array",description:d(8379,null)}),Mae=new C("variableName",!1,{type:"string",description:d(8380,null)}),Nae=new C("variableLanguage",!1,{type:"string",description:d(8381,null)}),Rae=new C("variableExtensionId",!1,{type:"string",description:d(8382,null)}),Lae=new C("exceptionWidgetVisible",!1,{type:"boolean",description:d(8383,null)}),Oae=new C("multiSessionRepl",!1,{type:"boolean",description:d(8384,null)}),Fae=new C("multiSessionDebug",!1,{type:"boolean",description:d(8385,null)}),jae=new C("disassembleRequestSupported",!1,{type:"boolean",description:d(8386,null)}),Uae=new C("disassemblyViewFocus",!1,{type:"boolean",description:d(8387,null)}),zae=new C("languageSupportsDisassembleRequest",!1,{type:"boolean",description:d(8388,null)}),Hae=new C("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:d(8389,null)}),Wae={enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart"],default:"openOnFirstSessionStart",description:d(8391,null)},TP;(function(e){e[e.Inactive=0]="Inactive",e[e.Initializing=1]="Initializing",e[e.Stopped=2]="Stopped",e[e.Running=3]="Running"})(TP||(TP={}));var MP;(function(e){e[e.Valid=0]="Valid",e[e.Unreadable=1]="Unreadable",e[e.Error=2]="Error"})(MP||(MP={}));var NP;(function(e){e[e.Variable=0]="Variable",e[e.Address=1]="Address"})(NP||(NP={}));var fv;(function(e){e[e.Initial=1]="Initial",e[e.Dynamic=2]="Dynamic"})(fv||(fv={}));var RP;(function(e){e.UnverifiedBreakpoints="unverifiedBreakpoints"})(RP||(RP={}));var _ae=W("debugService"),LP;(function(e){e[e.CONDITION=0]="CONDITION",e[e.HIT_COUNT=1]="HIT_COUNT",e[e.LOG_MESSAGE=2]="LOG_MESSAGE",e[e.TRIGGER_POINT=3]="TRIGGER_POINT"})(LP||(LP={}));var OP;(function(e){e[e.Command=0]="Command",e[e.Tree=1]="Tree"})(OP||(OP={}));var FP;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(FP||(FP={}));var jP;(function(e){e.deserialize=t=>t,e.serialize=t=>t})(jP||(jP={}));var UP;(function(e){e.deserialize=t=>({id:t.id,name:t.name,iconPath:t.iconPath&&{light:y.revive(t.iconPath.light),dark:y.revive(t.iconPath.dark)},iconClass:t.iconClass,visualization:t.visualization}),e.serialize=t=>t})(UP||(UP={}));var ft;(function(e){e.instructions="instructions",e.prompt="prompt",e.agent="agent",e.skill="skill",e.hook="hook"})(ft||(ft={}));var rZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(Q.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this.a.size===0)throw new Error("No related information providers registered");const s=this.a.get(e);if(!s)throw new Error("related information provider not found");return await s.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this.c.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const s=this.b;return this.b++,this.a.set(s,i),this.c.$registerAiRelatedInformationProvider(s,t),new Pe(()=>{this.c.$unregisterAiRelatedInformationProvider(s),this.a.delete(s)})}},nZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(Q.MainThreadAiSettingsSearch)}async $startSearch(e,t,i,s){if(this.a.size===0)throw new Error("No related information providers registered");const r=this.a.get(e);if(!r)throw new Error("Settings search provider not found");const n=new Pm(o=>{this.c.$handleSearchResult(e,Gy.fromSettingsSearchResult(o))});return r.provideSettingsSearchResults(t,i,n,s)}registerSettingsSearchProvider(e,t){const i=this.b;return this.b++,this.a.set(i,t),this.c.$registerAiSettingsSearchProvider(i),new Pe(()=>{this.c.$unregisterAiSettingsSearchProvider(i),this.a.delete(i)})}},zP;(function(e){e[e.Full=1]="Full",e[e.Delta=2]="Delta"})(zP||(zP={}));function HP(e){for(let t=0,i=e.length;t<i;t+=4){const s=e[t+0],r=e[t+1],n=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=n,e[t+2]=r,e[t+3]=s}}function oZ(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.length*4);return Vx()||HP(t),_.wrap(t)}function aZ(e){const t=e.buffer;if(Vx()||HP(t),t.byteOffset%4===0)return new Uint32Array(t.buffer,t.byteOffset,t.length/4);{const i=new Uint8Array(t.byteLength);return i.set(t),new Uint32Array(i.buffer,i.byteOffset,i.length/4)}}function X4(e){const t=new Uint32Array(cZ(e));let i=0;if(t[i++]=e.id,e.type==="full")t[i++]=1,t[i++]=e.data.length,t.set(e.data,i),i+=e.data.length;else{t[i++]=2,t[i++]=e.deltas.length;for(const s of e.deltas)t[i++]=s.start,t[i++]=s.deleteCount,s.data?(t[i++]=s.data.length,t.set(s.data,i),i+=s.data.length):t[i++]=0}return oZ(t)}function cZ(e){let t=0;if(t+=2,e.type==="full")t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const i of e.deltas)i.data&&(t+=i.data.length)}return t}function WP(e){const t=aZ(e);let i=0;const s=t[i++];if(t[i++]===1){const a=t[i++],c=t.subarray(i,i+a);return i+=a,{id:s,type:"full",data:c}}const n=t[i++],o=[];for(let a=0;a<n;a++){const c=t[i++],l=t[i++],u=t[i++];let h;u>0&&(h=t.subarray(i,i+u),i+=u),o[a]={start:c,deleteCount:l,data:h}}return{id:s,type:"delta",deltas:o}}var lZ=[new Se("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[q.Uri,q.Position],new ye("A promise that resolves to an array of DocumentHighlight-instances.",ar(hl.to))),new Se("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[q.Uri],new ye("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(e,t)=>{if(P1(e))return;class i extends eh{constructor(){super(...arguments),this.containerName=""}static to(r){const n=new i(r.name,Ps.to(r.kind),r.containerName||"",new ns(t[0],U.to(r.range)));return n.detail=r.detail,n.range=n.location.range,n.selectionRange=U.to(r.selectionRange),n.children=r.children?r.children.map(i.to):[],n}}return e.map(i.to)})),new Se("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[q.Uri,new q("options","Formatting options",e=>!0,e=>e)],new ye("A promise that resolves to an array of TextEdits.",ar(ri.to))),new Se("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[q.Uri,q.Range,new q("options","Formatting options",e=>!0,e=>e)],new ye("A promise that resolves to an array of TextEdits.",ar(ri.to))),new Se("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[q.Uri,q.Position,new q("ch","Trigger character",e=>typeof e=="string",e=>e),new q("options","Formatting options",e=>!0,e=>e)],new ye("A promise that resolves to an array of TextEdits.",ar(ri.to))),new Se("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location or LocationLink instances.",Co)),new Se("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location-instances.",ar(Bi.to))),new Se("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Location-instances.",ar(Bi.to))),new Se("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Hover-instances.",ar(Mh.to))),new Se("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[q.Uri,q.Position],new ye("A promise that resolves to an array of Hover-instances.",ar(Mh.to))),new Se("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[q.Uri,new q("position","A position in a text document",e=>Array.isArray(e)&&e.every(t=>Re.isPosition(t)),e=>e.map(et.from))],new ye("A promise that resolves to an array of ranges.",e=>e.map(t=>{let i;for(const s of t.reverse())i=new nh(U.to(s),i);return i}))),new Se("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[q.String.with("query","Search string")],new ye("A promise that resolves to an array of SymbolInformation-instances.",e=>e.map(Da.to))),new Se("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[q.Uri,q.Position],new ye("A promise that resolves to an array of CallHierarchyItem-instances",e=>e.map(Pa.to))),new Se("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[q.CallHierarchyItem],new ye("A promise that resolves to an array of CallHierarchyIncomingCall-instances",e=>e.map(dy.to))),new Se("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[q.CallHierarchyItem],new ye("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",e=>e.map(fy.to))),new Se("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[q.Uri,q.Position],new ye("A promise that resolves to a range and placeholder text.",e=>{if(e)return{range:U.to(e.range),placeholder:e.text}})),new Se("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[q.Uri,q.Position,q.String.with("newName","The new symbol name")],new ye("A promise that resolves to a WorkspaceEdit.",e=>{if(e){if(e.rejectReason)throw new Error(e.rejectReason);return as.to(e)}})),new Se("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[q.Uri,q.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new ye("A promise that resolves to an array of DocumentLink-instances.",e=>e.map(Ta.to))),new Se("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[q.Uri],new ye("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new Sb(e.tokenTypes,e.tokenModifiers)})),new Se("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[q.Uri],new ye("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=WP(e);if(t.type==="full")return new sl(t.data,void 0)})),new Se("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[q.Uri,q.Range.optional()],new ye("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new Sb(e.tokenTypes,e.tokenModifiers)})),new Se("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[q.Uri,q.Range],new ye("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=WP(e);if(t.type==="full")return new sl(t.data,void 0)})),new Se("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[q.Uri,q.Position,q.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),q.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new ye("A promise that resolves to a CompletionList-instance.",(e,t,i)=>{if(!e)return new zc([]);const s=e.suggestions.map(r=>by.to(r,i));return new zc(s,e.incomplete)})),new Se("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[q.Uri,q.Position,q.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new ye("A promise that resolves to SignatureHelp.",e=>{if(e)return Nh.to(e)})),new Se("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[q.Uri,q.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new ye("A promise that resolves to an array of CodeLens-instances.",(e,t,i)=>ar(s=>new Fp(U.to(s.range),s.command&&i.fromInternal(s.command)))(e))),new Se("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[q.Uri,new q("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",e=>ke.isRange(e),e=>Ir.isSelection(e)?sr.from(e):U.from(e)),q.String.with("kind","Code action kind to return code actions for").optional(),q.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new ye("A promise that resolves to an array of Command-instances.",(e,t,i)=>ar(s=>{if(s._isSynthetic){if(!s.command)throw new Error("Synthetic code actions must have a command");return i.fromInternal(s.command)}else{const r=new rh(s.title,s.kind?new Pt(s.kind):void 0);return s.edit&&(r.edit=as.to(s.edit)),s.command&&(r.command=i.fromInternal(s.command)),r.isPreferred=s.isPreferred,r}})(e))),new Se("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[q.Uri],new ye("A promise that resolves to an array of ColorInformation objects.",e=>e?e.map(t=>new _p(U.to(t.range),dl.to(t.color))):[])),new Se("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new q("color","The color to show and insert",e=>e instanceof Gc,dl.from),new q("context","Context object with uri and range",e=>!0,e=>({uri:e.uri,range:U.from(e.range)}))],new ye("A promise that resolves to an array of ColorPresentation objects.",e=>e?e.map(Ug.to):[])),new Se("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[q.Uri,q.Range],new ye("A promise that resolves to an array of Inlay objects",(e,t,i)=>e.map(yy.to.bind(void 0,i)))),new Se("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[q.Uri],new ye("A promise that resolves to an array of FoldingRange objects",(e,t)=>{if(e)return e.map(Wg.to)})),new Se("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new ye("A promise that resolves to an array of NotebookContentProvider static info objects.",ar(e=>({viewType:e.viewType,displayName:e.displayName,options:{transientOutputs:e.options.transientOutputs,transientCellMetadata:e.options.transientCellMetadata,transientDocumentMetadata:e.options.transientDocumentMetadata},filenamePattern:e.filenamePattern.map(t=>Bg.to(t))})))),new Se("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[q.Uri,q.Range,new q("context","An InlineValueContext",e=>e&&typeof e.frameId=="number"&&e.stoppedLocation instanceof ke,e=>Ng.from(e))],new ye("A promise that resolves to an array of InlineValue objects",e=>e.map(Mg.to))),new Se("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new q("uriOrString","Uri-instance or string (only http/https)",e=>y.isUri(e)||typeof e=="string"&&yO(e,V.http,V.https),e=>e),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[si.from(e),void 0]:[si.from(e.viewColumn),Rh.from(e)])).optional(),q.String.with("label","").optional()],ye.Void),new Se("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[q.Uri.with("resource","Resource to open"),q.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[si.from(e),void 0]:[si.from(e.viewColumn),Rh.from(e)])).optional()],ye.Void),new Se("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[q.Uri.with("left","Left-hand side resource of the diff editor"),q.Uri.with("right","Right-hand side resource of the diff editor"),q.String.with("title","Human readable title for the diff editor").optional(),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="object",e=>e&&[si.from(e.viewColumn),Rh.from(e)]).optional()],ye.Void),new Se("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[q.String.with("title","Human readable title for the changes editor"),new q("resourceList","List of resources to compare",e=>{for(const t of e){if(t.length!==3)return!1;const[i,s,r]=t;if(!y.isUri(i)||!y.isUri(s)&&s!==void 0&&s!==null||!y.isUri(r)&&r!==void 0&&r!==null)return!1}return!0},e=>e)],ye.Void),new Se("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[q.Uri,q.Position],new ye("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ma.to))),new Se("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[q.TypeHierarchyItem],new ye("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ma.to))),new Se("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[q.TypeHierarchyItem],new ye("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map(Ma.to))),new Se("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[q.TestItem],ye.Void),new Se("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[q.TestProfile,q.Arr(q.TestItem)],ye.Void),new Se("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[q.Arr(q.TestItem)],ye.Void),new Se("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[q.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],ye.Void),new Se("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[q.String.with("name","The context key name"),new q("value","The context key value",()=>!0,e=>e)],ye.Void),new Se("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new q("Run arguments","",e=>!0,e=>{if(e)return{initialRange:e.initialRange?U.from(e.initialRange):void 0,initialSelection:Ir.isSelection(e.initialSelection)?sr.from(e.initialSelection):void 0,message:e.message,attachments:e.attachments,autoSend:e.autoSend,position:e.position?et.from(e.position):void 0,resolveOnResponse:e.resolveOnResponse}})],ye.Void),new Se("vscode.extensionPromptFileProvider","_listExtensionPromptFiles","Get all extension-contributed prompt files (custom agents, instructions, and prompt files).",[],new ye("A promise that resolves to an array of objects containing uri and type.",e=>e?e.map(t=>({uri:y.revive(t.uri),type:t.type})):[]))],uZ=class{static register(e){lZ.forEach(e.registerApiCommand,e),this.a(e)}static a(e){e.registerCommand(!1,"_validateWhenClauses",$U)}};function ar(e){return t=>{if(Array.isArray(t))return t.map(e)}}function Co(e){if(!Array.isArray(e))return;const t=[];for(const i of e)Qz(i)?t.push(Th.to(i)):t.push(Bi.to(i));return t}var K4=class{constructor(t,i){this.a=t.getProxy(Q.MainThreadBulkEdits),this.b={getTextDocumentVersion:s=>i.getDocument(s)?.version,getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(t,i,s){const r=new Si(as.from(t,this.b));return this.a.$tryApplyWorkspaceEdit(r,void 0,s?.isRefactoring??!1)}};K4=__decorate([__param(0,Te)],K4);function hZ(e){return!!e&&y.isUri(e.sessionResource)&&e.$mid===19}var _P;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(_P||(_P={}));var BP;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(BP||(BP={}));var qP;(function(e){e[e.NoReason=0]="NoReason",e[e.FilteredContentRetry=1]="FilteredContentRetry",e[e.CopyrightContentRetry=2]="CopyrightContentRetry"})(qP||(qP={}));var VP;(function(e){e.Pending="pending",e.Accepted="accepted",e.Rejected="rejected"})(VP||(VP={}));var GP;(function(e){e[e.Denied=0]="Denied",e[e.ConfirmationNotNeeded=1]="ConfirmationNotNeeded",e[e.Setting=2]="Setting",e[e.LmServicePerTool=3]="LmServicePerTool",e[e.UserAction=4]="UserAction",e[e.Skipped=5]="Skipped"})(GP||(GP={}));var JP;(function(e){let t;(function(f){f[f.Streaming=0]="Streaming",f[f.WaitingForConfirmation=1]="WaitingForConfirmation",f[f.Executing=2]="Executing",f[f.WaitingForPostApproval=3]="WaitingForPostApproval",f[f.Completed=4]="Completed",f[f.Cancelled=5]="Cancelled"})(t=e.StateKind||(e.StateKind={}));function i(f,p){if(f.kind==="toolInvocationSerialized")return f.isConfirmed===void 0||typeof f.isConfirmed=="boolean"?{type:f.isConfirmed?4:0}:f.isConfirmed;const g=f.state.read(p);if(!(g.type===0||g.type===1))return g.type===5?{type:g.reason}:g.confirmed}e.executionConfirmedOrDenied=i;function s(f,p){const g=i(f);if(g)return Promise.resolve(g);const v=new X;return new Promise(b=>{p&&v.add(p.onCancellationRequested(()=>{b({type:0})})),v.add(Qf(S=>{const E=i(f,S);E&&(v.dispose(),b(E))}))}).finally(()=>{v.dispose()})}e.awaitConfirmation=s;function r(f,p){const g=f.state.read(p);if(g.type===4)return g.postConfirmed||{type:1};if(g.type===5)return{type:g.reason}}function n(f,p){const g=f?.state.get();return g?.type===1||g?.type===3?(g.confirm(p),!0):!1}e.confirmWith=n;function o(f,p){const g=r(f);if(g)return Promise.resolve(g);const v=new X;return new Promise(b=>{p&&v.add(p.onCancellationRequested(()=>{b({type:0})})),v.add(Qf(S=>{const E=r(f,S);E&&(v.dispose(),b(E))}))}).finally(()=>{v.dispose()})}e.awaitPostConfirmation=o;function a(f,p){if(f.kind==="toolInvocationSerialized")return f.resultDetails;const g=f.state.read(p);if(g.type===4||g.type===3)return g.resultDetails}e.resultDetails=a;function c(f,p){if(f.kind==="toolInvocationSerialized")return!0;const g=f.state.read(p);return g.type===4||g.type===5}e.isComplete=c;function l(f,p){return f.kind==="toolInvocationSerialized"?!1:f.state.read(p).type===0}e.isStreaming=l;function u(f,p){if(f.kind==="toolInvocationSerialized")return;const g=f.state.read(p);if(g.type!==0)return g.parameters}e.getParameters=u;function h(f,p){if(f.kind==="toolInvocationSerialized")return;const g=f.state.read(p);if(g.type!==0)return g.confirmationMessages}e.getConfirmationMessages=h})(JP||(JP={}));var pv;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(pv||(pv={}));var ZP;(function(e){e.IncorrectCode="incorrectCode",e.DidNotFollowInstructions="didNotFollowInstructions",e.IncompleteCode="incompleteCode",e.MissingContext="missingContext",e.PoorlyWrittenOrFormatted="poorlyWrittenOrFormatted",e.RefusedAValidRequest="refusedAValidRequest",e.OffensiveOrUnsafe="offensiveOrUnsafe",e.Other="other",e.WillReportIssue="willReportIssue"})(ZP||(ZP={}));var YP;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(YP||(YP={}));var QP;(function(e){e[e.Pending=0]="Pending",e[e.Complete=1]="Complete",e[e.Cancelled=2]="Cancelled",e[e.Failed=3]="Failed",e[e.NeedsInput=4]="NeedsInput"})(QP||(QP={}));var XP;(function(e){function t(n){return n.kind==="sent"}e.isSent=t;function i(n){return n.kind==="rejected"}e.isRejected=i;function s(n){return n.kind==="queued"}e.isQueued=s;function r(n){if(n.kind!=="sent")throw new Error(`Expected ChatSendResult to be 'sent', but was '${n.kind}'`)}e.assertSent=r})(XP||(XP={}));var KP;(function(e){e.Queued="queued",e.Steering="steering"})(KP||(KP={}));var e3=W("IChatService"),eS=class{constructor(e,t,i,s,r,n,o){this.j=e,this.l=t,this.m=i,this.n=s,this.o=r,this.q=n,this.s=o,this.b=Qi.create(!1),this.c=!1}close(){this.c=!0}get timings(){return{firstProgress:this.d,totalElapsed:this.b.elapsed()}}get apiObject(){if(!this.g){let i=function(l){if(r.c){const u=new Error("Response stream has been closed");throw Error.captureStackTrace(u,l),u}},s=function(l,u){if(o.push(u!==void 0?[l,u]:l)===1&&queueMicrotask(()=>{const f=a;a=[],r.m.$handleProgressChunk(r.l.requestId,o).finally(()=>{f.forEach(p=>p())}),o.length=0}),u!==void 0)return new Promise(f=>{a.push(f)})};var e=i,t=s;const r=this;this.b.reset();let n=0;const o=[];let a=[];const c=(l,u)=>{if(typeof this.d>"u"&&(l.kind==="markdownContent"||l.kind==="markdownVuln"||l.kind==="beginToolInvocation")&&(this.d=this.b.elapsed()),u){const h=n++,f=s(l,h),p={report:g=>{f.then(()=>{Ni.isMarkdownString(g.value)?s(Hh.from(g),h):s(Ra.from(g),h)})}};Promise.all([f,u(p)]).then(([g,v])=>{s(Ly.from(v),h)})}else s(l)};this.g=Object.freeze({clearToPreviousToolInvocation(l){return i(this.markdown),s({kind:"clearToPreviousToolInvocation",reason:l}),this},markdown(l){i(this.markdown);const u=new fg(l),h=Fh.from(u);return c(h),this},markdownWithVulnerabilities(l,u){i(this.markdown),u&&T(r.j,"chatParticipantAdditions");const h=new Ch(l,u),f=Yg.from(h);return c(f),this},codeblockUri(l,u){i(this.codeblockUri),T(r.j,"chatParticipantAdditions");const h=new bg(l,u),f=Zg.from(h);return c(f),this},filetree(l,u){i(this.filetree);const h=new gg(l,u),f=jh.from(h);return c(f),this},anchor(l,u){const h=new kh(l,u);return this.push(h)},button(l){i(this.anchor);const u=new wg(l),h=Wh.from(u,r.n,r.o);return c(h),this},progress(l,u){i(this.progress);const h=new mg(l,u),f=u?em.from(h):Uh.from(h);return c(f,u),this},thinkingProgress(l){i(this.thinkingProgress),T(r.j,"chatParticipantAdditions");const u=new al(l.text??"",l.id,l.metadata),h=zh.from(u);return c(h),this},hookProgress(l,u,h){i(this.hookProgress),T(r.j,"chatParticipantAdditions");const f=new vg(l,u,h),p=Kg.from(f);return c(p),this},warning(l){i(this.progress),T(r.j,"chatParticipantAdditions");const u=new $h(l),h=Hh.from(u);return c(h),this},reference(l,u){return this.reference2(l,u)},reference2(l,u,h){if(i(this.reference),typeof l=="object"&&"variableName"in l&&T(r.j,"chatParticipantAdditions"),typeof l=="object"&&"variableName"in l&&!l.value){const f=r.l.variables.variables.find(p=>p.name===l.variableName);if(f){let p;if(f.references?.length)p=f.references.map(g=>({kind:"reference",reference:{variableName:l.variableName,value:g.reference}}));else{const g=new Ca(l,u,h);p=[Ra.from(g)]}return p.forEach(g=>c(g)),this}}else{const f=new Ca(l,u,h),p=Ra.from(f);c(p)}return this},codeCitation(l,u,h){i(this.codeCitation),T(r.j,"chatParticipantAdditions");const f=new yg(l,u,h),p=nm.from(f);c(p)},textEdit(l,u){i(this.textEdit),T(r.j,"chatParticipantAdditions");const h=new Dh(l,u);h.isDone=u===!0?!0:void 0;const f=tm.from(h);return c(f),this},notebookEdit(l,u){i(this.notebookEdit),T(r.j,"chatParticipantAdditions");const h=new Sg(l,u),f=sm.from(h);return c(f),this},workspaceEdit(l){i(this.workspaceEdit),T(r.j,"chatParticipantAdditions");const u=new Gb(l),h=rm.from(u);return c(h),this},async externalEdit(l,u){i(this.externalEdit);const h=Array.isArray(l)?l:[l],f=n++,p=At();await s({kind:"externalEdits",start:!0,resources:h,undoStopId:p},f);try{return await u(),p}finally{await s({kind:"externalEdits",start:!1,resources:h,undoStopId:p},f)}},confirmation(l,u,h,f){i(this.confirmation),T(r.j,"chatParticipantAdditions");const p=new pg(l,u,h,f),g=Qg.from(p);return c(g),this},async questionCarousel(l,u=!0){i(this.questionCarousel),T(r.j,"chatParticipantAdditions");const h=At(),f=new Ih(l,u),p=Xg.from(f);p.resolveId=h;const g=new Di;return r.q.has(r.l.requestId)||r.q.set(r.l.requestId,new Map),r.q.get(r.l.requestId).set(h,g),c(p),PC(g.p,r.s)},beginToolInvocation(l,u,h){i(this.beginToolInvocation),T(r.j,"chatParticipantAdditions");const f={kind:"beginToolInvocation",toolCallId:l,toolName:u,streamData:h?{partialInput:h.partialInput}:void 0,subagentInvocationId:h?.subagentInvocationId};return c(f),this},updateToolInvocation(l,u){i(this.updateToolInvocation),T(r.j,"chatParticipantAdditions");const h={kind:"updateToolInvocation",toolCallId:l,streamData:{partialInput:u.partialInput}};return c(h),this},push(l){if(i(this.push),(l instanceof Dh||l instanceof Sg||l instanceof Ch||l instanceof $h||l instanceof pg||l instanceof Ih||l instanceof yg||l instanceof Ag||l instanceof qb||l instanceof _b||l instanceof al||l instanceof Vb||l instanceof mg)&&T(r.j,"chatParticipantAdditions"),l instanceof Ca)this.reference2(l.value,l.iconPath,l.options);else if(l instanceof mg){const u=l.task?em.from(l):Uh.from(l);c(u,l.task)}else if(l instanceof al){const u=zh.from(l);c(u)}else if(l instanceof kh){const u=Sl.from(l);if(l.resolve){T(r.j,"chatParticipantAdditions"),u.resolveId=At();const h=new Ke;l.resolve(h.token).then(()=>{const f=Sl.from(l);r.m.$handleAnchorResolve(r.l.requestId,u.resolveId,f)}).then(()=>h.dispose(),()=>h.dispose()),r.o.add(se(()=>h.dispose(!0)))}c(u)}else{if(l instanceof _b)return this.externalEdit(l.uris,l.callback).then(h=>l.didGetApplied(h)),this;{const u=_h.from(l,r.n,r.o);c(u)}}return this}})}return this.g}},dZ=class _d extends J{static{this.b=0}static{this.j=0}static{this.n=0}constructor(t,i,s,r,n,o,a,c){super(),this.C=i,this.F=s,this.G=r,this.H=n,this.I=o,this.J=a,this.L=c,this.c=new Map,this.m=new Map,this.q=new Map,this.s=this.D(new GL),this.t=this.D(new Fo),this.u=new Set,this.w=new Map,this.y=this.D(new I),this.onDidChangeChatRequestTools=this.y.event,this.z=this.D(new I),this.onDidDisposeChatSession=this.z.event,this.g=t.getProxy(Q.MainThreadChatAgents2),s.registerArgumentProcessor({processArgument:l=>hZ(l)?null:l})}async transferActiveChat(t){await this.g.$transferActiveChatSession(t)}createChatAgent(t,i,s){const r=_d.b++,n=new t3(t,i,this.g,r,s);return this.c.set(r,n),this.g.$registerAgent(r,t.identifier,i,{},void 0),n.apiAgent}createDynamicChatAgent(t,i,s,r){const n=_d.b++,o=new t3(t,i,this.g,n,r);return this.c.set(n,o),this.g.$registerAgent(n,t.identifier,i,{isSticky:!0},s),o.apiAgent}registerChatParticipantDetectionProvider(t,i){const s=_d.j++;return this.m.set(s,new fZ(t,i)),this.g.$registerChatParticipantDetectionProvider(s),se(()=>{this.m.delete(s),this.g.$unregisterChatParticipantDetectionProvider(s)})}registerPromptFileProvider(t,i,s){const r=_d.n++;this.q.set(r,{extension:t,provider:s}),this.g.$registerPromptFileProvider(r,i,t.identifier);const n=new X;let o;switch(i){case ft.agent:o=s.onDidChangeCustomAgents;break;case ft.instructions:o=s.onDidChangeInstructions;break;case ft.prompt:o=s.onDidChangePromptFiles;break;case ft.skill:o=s.onDidChangeSkills;break}return o&&n.add(o(()=>{this.g.$onDidChangePromptFiles(r)})),n.add(se(()=>{this.q.delete(r),this.g.$unregisterPromptFileProvider(r)})),n}async $providePromptFiles(t,i,s,r){const n=this.q.get(t);if(!n)return;const o=n.provider;let a;switch(i){case ft.agent:a=await o.provideCustomAgents(s,r)??void 0;break;case ft.instructions:a=await o.provideInstructions(s,r)??void 0;break;case ft.prompt:a=await o.providePromptFiles(s,r)??void 0;break;case ft.skill:a=await o.provideSkills(s,r)??void 0;break}return a}async $detectChatParticipant(t,i,s,r,n){const o=this.m.get(t);if(!o)return;const{request:a,location:c,history:l}=await this.M(i,s,o.extension),u=await this.N(a,o.extension),h=await this.P(o.extension,a.userSelectedTools,u.id,n),f=Bh.to(a,c,u,this.O(o.extension),h,o.extension,this.C);return o.provider.provideParticipantDetection(f,{history:l,yieldRequested:!1},{participants:r.participants,location:qh.to(r.location)},n)}async M(t,i,s){const r=ei(t),n=await this.Q(s,r.agentId,i);let o;if(r.locationData?.type===ti.EditorInline){const a=this.G.getDocument(r.locationData.document),c=this.H.getEditor(r.locationData.id);o=new i9(c.value,a,sr.to(r.locationData.selection),U.to(r.locationData.wholeRange))}else if(r.locationData?.type===ti.Notebook){const a=this.G.getDocument(r.locationData.sessionInputUri);o=new s9(a)}else r.locationData?.type,ti.Terminal;return{request:r,location:o,history:n}}async N(t,i){let s;if(t.userSelectedModelId&&(s=await this.I.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!s&&(s=await this.I.getDefaultLanguageModel(i),!s))throw new Error("Language model unavailable");return s}async $setRequestTools(t,i){const s=[...this.u].find(n=>n.requestId===t);if(!s)return;s.extRequest.tools.clear();const r=await this.P(s.extension,i,s.extRequest.model.id,De.None);for(const[n,o]of r)s.extRequest.tools.set(n,o);this.y.fire(s.extRequest)}$setYieldRequested(t){const i=[...this.u].find(s=>s.requestId===t);i&&(i.yieldRequested=!0)}async $invokeAgent(t,i,s,r){const n=this.c.get(t);if(!n)throw new Error(`[CHAT](${t}) CANNOT invoke agent because the agent is not registered`);let o,a;try{const{request:c,location:l,history:u}=await this.M(i,s,n.extension);let h=this.s.get(c.sessionResource);h||(h=new X,this.s.set(c.sessionResource,h)),o=new eS(n.extension,c,this.g,this.F.converter,h,this.w,r);const f=await this.N(c,n.extension),p=await this.P(n.extension,c.userSelectedTools,f.id,r),g=Bh.to(c,l,f,this.O(n.extension),p,n.extension,this.C);a={requestId:i.requestId,extRequest:g,extension:n.extension,hooks:c.hooks,yieldRequested:!1},this.u.add(a);let v;s.chatSessionContext&&(v={chatSessionItem:{resource:y.revive(s.chatSessionContext.chatSessionResource),label:s.chatSessionContext.isUntitled?"Untitled Session":"Session"},isUntitled:s.chatSessionContext.isUntitled});const b={history:u,chatSessionContext:v,get yieldRequested(){return a?.yieldRequested??!1}},S=n.invoke(g,b,o.apiObject,r);return await pZ(1e3,Promise.resolve(S).then(E=>{if(E?.metadata)try{JSON.stringify(E.metadata)}catch(O){const F=`result.metadata MUST be JSON.stringify-able. Got error: ${O.message}`;return this.C.error(`[${n.extension.identifier.value}] [@${n.id}] ${F}`,n.extension),{errorDetails:{message:F},timings:o?.timings,nextQuestion:E.nextQuestion}}let k;return E?.errorDetails&&(k={...E.errorDetails,responseIsIncomplete:!0}),(k?.responseIsRedacted||k?.isQuotaExceeded||k?.isRateLimited||k?.confirmationButtons||k?.code)&&T(n.extension,"chatParticipantPrivate"),{errorDetails:k,timings:o?.timings,metadata:E?.metadata,nextQuestion:E?.nextQuestion,details:E?.details,usage:E?.usage}}),r)}catch(c){this.C.error(c,n.extension),c instanceof cn&&c.cause&&(c=c.cause);const l=c instanceof Error&&c.name==="ChatQuotaExceeded",u=c instanceof Error&&c.name==="ChatRateLimited";return{errorDetails:{message:yr(c),responseIsIncomplete:!0,isQuotaExceeded:l,isRateLimited:u}}}finally{a&&this.u.delete(a);const c=this.w.get(i.requestId);if(c){for(const l of c.values())l.complete(void 0);this.w.delete(i.requestId)}o?.close()}}O(t){return qe(t,"chatReferenceDiagnostic")?this.J.getDiagnostics():[]}async P(t,i,s,r){if(!i)return new Map;const n=new Map;for(const o of this.L.getTools(t))typeof i[o.name]=="boolean"&&n.set(o,i[o.name]);return n}async Q(t,i,s){const r=[];for(const n of s.history){const o=El.to(n.result),a=i===n.request.agentId||i3(n.request.agentId)&&i3(i)?o:{...o,metadata:void 0},c=[],l=[];for(const p of n.request.variables.variables)if(p.kind==="tool")l.push(La.to(p));else if(p.kind==="toolset")l.push(...p.value.map(La.to));else{const g=om.to(p,this.O(t),this.C);g&&c.push(g)}const u=qe(t,"chatParticipantPrivate")?n.request.editedFileEvents:void 0,h=new Eg(n.request.message,n.request.command,c,n.request.agentId,l,u,n.request.requestId);r.push(h);const f=yt(n.response.map(p=>_h.toContent(p,this.F.converter)));r.push(new t9(f,a,n.request.agentId,n.request.command))}return r}$releaseSession(t){const i=y.revive(t);this.s.deleteAndDispose(i);const s=Cc.parseLocalSessionId(i);s&&this.z.fire(s)}async $provideFollowups(t,i,s,r,n){const o=this.c.get(i);if(!o)return Promise.resolve([]);const a=ei(t),c=await this.Q(o.extension,o.id,r),l=El.to(s);return(await o.provideFollowups(l,{history:c,yieldRequested:!1},n)).filter(u=>{const h=!u.participant||ai.some(this.c.values(),f=>f.id===u.participant&&it.equals(f.extension.identifier,o.extension.identifier));return h||this.C.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`),h}).map(u=>Gg.from(u,a))}$acceptFeedback(t,i,s){const r=this.c.get(t);if(!r)return;const n=El.to(i);let o;switch(s.direction){case pv.Down:o=xh.Unhelpful;break;case pv.Up:o=xh.Helpful;break}const a={result:n,kind:o,unhelpfulReason:qe(r.extension,"chatParticipantAdditions")?s.reason:void 0};r.acceptFeedback(Object.freeze(a))}$handleQuestionCarouselAnswer(t,i,s){const r=this.w.get(t);if(!r)return;const n=r.get(i);n&&(n.complete(s),r.delete(i)),r.size===0&&this.w.delete(t)}$acceptAction(t,i,s){const r=this.c.get(t);if(!r||s.action.kind==="vote")return;const n=jy.to(i,s,this.F.converter);n&&r.acceptAction(Object.freeze(n))}async $invokeCompletionProvider(t,i,s){const r=this.c.get(t);if(!r)return[];let n=this.t.get(t);return n?n.clear():(n=new X,this.t.set(t,n)),(await r.invokeCompletionProvider(i,s)).map(a=>Fy.from(a,this.F.converter,n))}async $provideChatTitle(t,i,s){const r=this.c.get(t);if(!r)return;const n=await this.Q(r.extension,r.id,{history:i});return await r.provideTitle({history:n,yieldRequested:!1},s)}async $provideChatSummary(t,i,s){const r=this.c.get(t);if(!r)return;const n=await this.Q(r.extension,r.id,{history:i});return await r.provideSummary({history:n,yieldRequested:!1},s)}},fZ=class{constructor(e,t){this.extension=e,this.provider=t}},t3=class{constructor(e,t,i,s,r){this.extension=e,this.id=t,this.u=i,this.w=s,this.x=r,this.j=new I,this.l=new I,this.t=new I}acceptFeedback(e){this.j.fire(e)}acceptAction(e){this.l.fire(e)}setChatRequestPauseState(e){this.t.fire(e)}async invokeCompletionProvider(e,t){return this.n?await this.n.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this.b)return[];const s=await this.b.provideFollowups(e,t,i);return s?s.filter(r=>!(r&&"commandId"in r)).filter(r=>!(r&&"message"in r)):[]}async provideTitle(e,t){if(this.q)return await this.q.provideChatTitle(e,t)??void 0}async provideSummary(e,t){if(this.s)return await this.s.provideChatSummary(e,t)??void 0}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this.u.$updateAgent(this.w,{icon:this.c?this.c instanceof y?this.c:"light"in this.c?this.c.light:void 0:void 0,iconDark:this.c&&"dark"in this.c?this.c.dark:void 0,themeIcon:this.c instanceof Ri?this.c:void 0,hasFollowups:this.b!==void 0,helpTextPrefix:!this.d||typeof this.d=="string"?this.d:le.from(this.d),helpTextPostfix:!this.g||typeof this.g=="string"?this.g:le.from(this.g),supportIssueReporting:this.m,additionalWelcomeMessage:!this.o||typeof this.o=="string"?this.o:le.from(this.o)}),t=!1}))},s=this;return{get id(){return s.id},get iconPath(){return s.c},set iconPath(r){s.c=r,i()},get requestHandler(){return s.x},set requestHandler(r){R1(typeof r=="function","Invalid request handler"),s.x=r},get followupProvider(){return s.b},set followupProvider(r){s.b=r,i()},get helpTextPrefix(){return T(s.extension,"defaultChatParticipant"),s.d},set helpTextPrefix(r){T(s.extension,"defaultChatParticipant"),s.d=r,i()},get helpTextPostfix(){return T(s.extension,"defaultChatParticipant"),s.g},set helpTextPostfix(r){T(s.extension,"defaultChatParticipant"),s.g=r,i()},get supportIssueReporting(){return T(s.extension,"chatParticipantPrivate"),s.m},set supportIssueReporting(r){T(s.extension,"chatParticipantPrivate"),s.m=r,i()},get onDidReceiveFeedback(){return s.j.event},set participantVariableProvider(r){if(T(s.extension,"chatParticipantAdditions"),s.n=r,r){if(!r.triggerCharacters.length)throw new Error("triggerCharacters are required");s.u.$registerAgentCompletionsProvider(s.w,s.id,r.triggerCharacters)}else s.u.$unregisterAgentCompletionsProvider(s.w,s.id)},get participantVariableProvider(){return T(s.extension,"chatParticipantAdditions"),s.n},set additionalWelcomeMessage(r){T(s.extension,"defaultChatParticipant"),s.o=r,i()},get additionalWelcomeMessage(){return T(s.extension,"defaultChatParticipant"),s.o},set titleProvider(r){T(s.extension,"defaultChatParticipant"),s.q=r,i()},get titleProvider(){return T(s.extension,"defaultChatParticipant"),s.q},set summarizer(r){T(s.extension,"defaultChatParticipant"),s.s=r},get summarizer(){return T(s.extension,"defaultChatParticipant"),s.s},get onDidChangePauseState(){return T(s.extension,"chatParticipantAdditions"),s.t.event},onDidPerformAction:qe(this.extension,"chatParticipantAdditions")?this.l.event:void 0,dispose(){e=!0,s.b=void 0,s.j.dispose(),s.u.$unregisterAgent(s.w)}}}invoke(e,t,i,s){return this.x(e,t,i,s)}};function pZ(e,t,i){return new Promise((s,r)=>{const n=i.onCancellationRequested(async()=>{n.dispose(),await Kt(e),s(void 0)});t.then(s,r).finally(()=>n.dispose())})}function i3(e){return e.startsWith("github.copilot")}var gZ=class{constructor(e,t){this.c=t,this.b=new Map,this.a=e.getProxy(Q.MainThreadChatOutputRenderer)}registerChatOutputRenderer(e,t,i){if(this.b.has(t))throw new Error(`Chat output renderer already registered for: ${t}`);return this.b.set(t,{extension:e,renderer:i}),this.a.$registerChatOutputRenderer(t,e.identifier,e.extensionLocation),new Pe(()=>{this.b.delete(t),this.a.$unregisterChatOutputRenderer(t)})}async $renderChatOutput(e,t,i,s,r){const n=this.b.get(e);if(!n)throw new Error(`No chat output renderer registered for: ${e}`);const o=this.c.createNewWebview(s,{},n.extension),a=Object.freeze({webview:o,onDidDispose:o._onDidDispose});return n.renderer.renderChatOutput(Object.freeze({mime:t,value:i.buffer}),a,{},r)}},tS,mZ=class{#e;#t;#i;#s;#o;#n;#c;#a;#l;#u;#r;constructor(e,t,i){this.resource=e,this.#e=t,this.#r=i}get label(){return this.#e}set label(e){this.#e!==e&&(this.#e=e,this.#r())}get iconPath(){return this.#t}set iconPath(e){this.#t!==e&&(this.#t=e,this.#r())}get description(){return this.#i}set description(e){this.#i!==e&&(this.#i=e,this.#r())}get badge(){return this.#s}set badge(e){this.#s!==e&&(this.#s=e,this.#r())}get status(){return this.#o}set status(e){this.#o!==e&&(this.#o=e,this.#r())}get archived(){return this.#n}set archived(e){this.#n!==e&&(this.#n=e,this.#r())}get tooltip(){return this.#c}set tooltip(e){this.#c!==e&&(this.#c=e,this.#r())}get timing(){return this.#a}set timing(e){this.#a!==e&&(this.#a=e,this.#r())}get changes(){return this.#l}set changes(e){this.#l!==e&&(this.#l=e,this.#r())}get metadata(){return this.#u}set metadata(e){Ai(this.#u,e)||(this.#u=e,this.#r())}},vZ=class{#e=new Ct;#t;constructor(e){this.#t=e}get size(){return this.#e.size}replace(e){if(!(e.length===0&&this.#e.size===0)){this.#e.clear();for(const t of e)this.#e.set(t.resource,t);this.#t()}}forEach(e,t){for(const[i,s]of this.#e)e.call(t,s,this)}add(e){this.#e.set(e.resource,e),this.#t()}delete(e){this.#e.delete(e),this.#t()}get(e){return this.#e.get(e)}[Symbol.iterator](){return this.#e.entries()}},wZ=class{constructor(e,t,i,s,r,n){this.session=e,this.extension=t,this.proxy=s,this.commandsConverter=r,this.sessionDisposables=n,this.b=new Map,this.a=new eS(t,i,s,r,n,this.b,De.None)}get activeResponseStream(){return this.a}getActiveRequestStream(e){return new eS(this.extension,e,this.proxy,this.commandsConverter,this.sessionDisposables,this.b,De.None)}},iS=class extends J{static{tS=this}static{this.a=0}constructor(t,i,s,r){super(),this.u=t,this.w=i,this.y=s,this.z=r,this.c=0,this.f=new Map,this.h=0,this.j=new Map,this.m=0,this.n=new Map,this.q=new Ct,this.s=new Ct,this.t=new Map,this.b=this.y.getProxy(Q.MainThreadChatSessions),t.registerArgumentProcessor({processArgument:n=>{if(n&&n.$mid===25){const o=n.session.resource||n.sessionId,a=this.q.get(o);return a||(this.z.warn(`No chat session found for ID: ${o}`),n)}return n}})}registerChatSessionItemProvider(t,i,s){const r=this.c++,n=new X;return this.f.set(r,{provider:s,extension:t,disposable:n,sessionType:i}),this.b.$registerChatSessionItemProvider(r,i),s.onDidChangeChatSessionItems&&n.add(s.onDidChangeChatSessionItems(()=>{this.z.trace(`ExtHostChatSessions. Firing $onDidChangeChatSessionItems for ${i}`),this.b.$onDidChangeChatSessionItems(r)})),s.onDidCommitChatSessionItem&&n.add(s.onDidCommitChatSessionItem(o=>{const{original:a,modified:c}=o;this.b.$onDidCommitChatSessionItem(r,a.resource,c.resource)})),{dispose:()=>{this.f.delete(r),n.dispose(),this.b.$unregisterChatSessionItemProvider(r)}}}createChatSessionItemController(t,i,s){const r=this.h++,n=new X;let o=!1,a=0,c;const l=n.add(new I),u=n.add(new I),h=()=>{typeof c>"u"&&l.fire()},f=new vZ(()=>{h()}),p=Object.freeze({id:i,refreshHandler:async g=>{if(o)throw new Error("ChatSessionItemController has been disposed");const v=++a;c=v;try{this.z.trace(`ExtHostChatSessions. Controller(${i}).refresh()`),await s(g)}finally{c===v&&(c=void 0)}},items:f,onDidChangeChatSessionItemState:u.event,createChatSessionItem:(g,v)=>{if(o)throw new Error("ChatSessionItemController has been disposed");return new mZ(g,v,()=>{h()})},dispose:()=>{o=!0,n.dispose()}});return this.j.set(r,{controller:p,extension:t,disposable:n,sessionType:i,onDidChangeChatSessionItemStateEmitter:u}),n.add(this.registerChatSessionItemProvider(t,i,{onDidChangeChatSessionItems:l.event,onDidCommitChatSessionItem:Ie.None,provideChatSessionItems:async g=>(await p.refreshHandler(g),Array.from(p.items,v=>v[1]))})),n.add(se(()=>{this.j.delete(r),this.b.$unregisterChatSessionItemProvider(r)})),p}registerChatSessionContentProvider(t,i,s,r,n){const o=this.m++,a=new X;return this.n.set(o,{provider:r,extension:t,capabilities:n,disposable:a}),this.b.$registerChatSessionContentProvider(o,i),r.onDidChangeChatSessionOptions&&a.add(r.onDidChangeChatSessionOptions(c=>{this.b.$onDidChangeChatSessionOptions(o,c.resource,c.updates)})),r.onDidChangeChatSessionProviderOptions&&a.add(r.onDidChangeChatSessionProviderOptions(()=>{this.b.$onDidChangeChatSessionProviderOptions(o)})),new Pe(()=>{this.n.delete(o),a.dispose(),this.b.$unregisterChatSessionContentProvider(o)})}C(t){if(t!==void 0)switch(t){case 0:return 0;case 1:return 1;case 2:return 2;default:return}}F(t){const i=t.timing,s=i?.created??i?.startTime??0,r=i?.lastRequestStarted??i?.startTime,n=i?.lastRequestEnded??i?.endTime;return{resource:t.resource,label:t.label,description:t.description?le.from(t.description):void 0,badge:t.badge?le.from(t.badge):void 0,status:this.C(t.status),archived:t.archived,tooltip:le.fromStrict(t.tooltip),timing:{created:s,lastRequestStarted:r,lastRequestEnded:n},changes:t.changes instanceof Array?t.changes:void 0,metadata:t.metadata}}async $provideChatSessionItems(t,i){const s=this.f.get(t);if(!s)return this.z.error(`No provider registered for handle ${t}`),[];this.z.trace(`ExtHostChatSessions:$provideChatSessionItems(${s.sessionType})`);const r=await s.provider.provideChatSessionItems(i)??[];if(i.isCancellationRequested)return[];const n=[];for(const o of r)this.q.set(o.resource,o),n.push(this.F(o));return n}async $provideChatSessionContent(t,i,s){const r=this.n.get(t);if(!r)throw new Error(`No provider for handle ${t}`);const n=y.revive(i),o=await r.provider.provideChatSessionContent(n,s);if(s.isCancellationRequested)throw new dt;const a=new X,c=tS.a++,l=n.toString(),u=new wZ(o,r.extension,{sessionResource:n,requestId:"ongoing",agentId:l,message:"",variables:{variables:[]},location:ti.Chat},{$handleProgressChunk:(p,g)=>this.b.$handleProgressChunk(t,n,p,g),$handleAnchorResolve:(p,g,v)=>{this.b.$handleAnchorResolve(t,n,p,g,v)}},this.u.converter,a),h=a.add(new Ke);this.s.set(n,{sessionObj:u,disposeCts:h}),o.activeResponseCallback&&Promise.resolve(o.activeResponseCallback(u.activeResponseStream.apiObject,h.token)).finally(()=>{this.b.$handleProgressComplete(t,n,"ongoing")});const{capabilities:f}=r;return{id:c+"",resource:y.revive(n),hasActiveResponseCallback:!!o.activeResponseCallback,hasRequestHandler:!!o.requestHandler,supportsInterruption:!!f?.supportsInterruptions,options:o.options,history:o.history.map(p=>p instanceof Eg?this.H(p):this.J(p,a))}}async $provideHandleOptionsChange(t,i,s,r){const n=y.revive(i),o=this.n.get(t);if(!o){this.z.warn(`No provider for handle ${t}`);return}if(!o.provider.provideHandleOptionsChange){this.z.debug(`Provider for handle ${t} does not implement provideHandleOptionsChange`);return}try{const a=s.map(c=>({optionId:c.optionId,value:c.value===void 0?void 0:typeof c.value=="string"?c.value:c.value.id}));await o.provider.provideHandleOptionsChange(n,a,r)}catch(a){this.z.error(`Error calling provideHandleOptionsChange for handle ${t}, sessionResource ${n}:`,a)}}async $provideChatSessionProviderOptions(t,i){const s=this.n.get(t);if(!s){this.z.warn(`No provider for handle ${t} when requesting chat session options`);return}const r=s.provider;if(r.provideChatSessionProviderOptions)try{const{optionGroups:n}=await r.provideChatSessionProviderOptions(i);return n?(this.t.set(t,n),{optionGroups:n}):void 0}catch(n){this.z.error(`Error calling provideChatSessionProviderOptions for handle ${t}:`,n);return}}async $interruptChatSessionActiveResponse(t,i,s){this.s.get(y.revive(i))?.disposeCts.cancel()}async $disposeChatSessionContent(t,i){const s=this.s.get(y.revive(i));if(!s){this.z.warn(`No chat session found for resource: ${i}`);return}s.disposeCts.cancel(),s.sessionObj.sessionDisposables.dispose(),this.s.delete(y.revive(i))}async $invokeChatSessionRequestHandler(t,i,s,r,n){const o=this.s.get(y.revive(i));if(!o||!o.sessionObj.session.requestHandler)return{};const a=Bh.to(s,void 0,await this.G(s,o.sessionObj.extension),[],new Map,o.sessionObj.extension,this.z),c=o.sessionObj.getActiveRequestStream(s);return await o.sessionObj.session.requestHandler(a,{history:r,yieldRequested:!1},c.apiObject,n),{}}async G(t,i){let s;if(t.userSelectedModelId&&(s=await this.w.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!s&&(s=await this.w.getDefaultLanguageModel(i),!s))throw new Error("Language model unavailable");return s}H(t){const i=t.references.map(s=>this.I(s));return{type:"request",id:t.id,prompt:t.prompt,participant:t.participant,command:t.command,variableData:i.length>0?{variables:i}:void 0}}I(t){const i=t.value&&typeof t.value=="object"&&"uri"in t.value&&"range"in t.value?rr.from(t.value):t.value,s=t.range?{start:t.range[0],endExclusive:t.range[1]}:void 0;if(i&&i instanceof Xb&&Array.isArray(i.diagnostics)&&i.diagnostics.length&&i.diagnostics[0][1].length){const o=Ia.from(i.diagnostics[0][1][0]),a={filterRange:{startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.endLineNumber,endColumn:o.endColumn},filterSeverity:o.severity,filterUri:i.diagnostics[0][0],problemMessage:i.diagnostics[0][1][0].message};return fw.toEntry(a)}if(ns.isLocation(t.value)&&t.name.startsWith("sym:")){const o=rr.from(t.value);return{id:t.id,name:t.name,fullName:t.name.substring(4),value:{uri:t.value.uri,range:o.range},symbolKind:6,icon:lw.toIcon(6),kind:"symbol",range:s}}if(y.isUri(i)&&t.name.startsWith("prompt:")&&t.id.startsWith(oa.PromptFile)&&t.id.endsWith(i.toString()))return{id:t.id,name:`prompt:${ji(i)}`,value:i,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:!0,automaticallyAdded:!1,range:s};const r=y.isUri(i)||i&&typeof i=="object"&&"uri"in i,n=r&&y.isUri(i)&&i.path.endsWith("/");return{id:t.id,name:t.name,value:i,modelDescription:t.modelDescription,range:s,kind:n?"directory":r?"file":"generic"}}J(t,i){return{type:"response",parts:yt(t.response.map(r=>_h.from(r,this.u.converter,i))),participant:t.participant}}async $invokeOptionGroupSearch(t,i,s,r){const n=this.t.get(t);if(!n)return this.z.warn(`No option groups found for provider handle ${t}`),[];const o=n.find(a=>a.id===i);if(!o||!o.onSearch)return this.z.warn(`No onSearch callback found for option group ${i}`),[];try{return await o.onSearch(s,r)??[]}catch(a){return this.z.error(`Error calling onSearch for option group ${i}:`,a),[]}}$onDidChangeChatSessionItemState(t,i,s){const r=this.j.get(t);if(!r){this.z.warn(`No controller found for handle ${t}`);return}const n=y.revive(i),o=r.controller.items.get(n);if(!o){this.z.warn(`No item found for session resource ${n.toString()}`);return}o.archived=s,r.onDidChangeChatSessionItemStateEmitter.fire(o)}};iS=tS=__decorate([__param(2,Te),__param(3,xe)],iS);var bZ=class{constructor(e){this.b=new Map,this.a=e.getProxy(Q.MainThreadChatStatus)}createChatStatusItem(e,t){const i=yZ(e.identifier,t);if(this.b.has(i))throw new Error(`Chat status item '${t}' already exists`);const s={id:i,title:"",description:"",detail:""};let r=!1,n=!1;const o=()=>{if(r)throw new Error("Chat status item is disposed");n&&this.a.$setEntry(t,s)},a=Object.freeze({id:t,get title(){return s.title},set title(c){s.title=c,o()},get description(){return s.description},set description(c){s.description=c,o()},get detail(){return s.detail},set detail(c){s.detail=c,o()},show:()=>{n=!0,o()},hide:()=>{n=!1,this.a.$disposeEntry(t)},dispose:()=>{r=!0,this.a.$disposeEntry(t),this.b.delete(i)}});return this.b.set(i,a),a}};function yZ(e,t){return`${it.toKey(e)}.${t}`}var AZ=class{constructor(e){const t=e.getProxy(Q.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}},s3="vscode-cdn.net",SZ=`vscode-resource.${s3}`,sS=`'self' https://*.${s3}`;function pd(e,t){return e.scheme===V.http||e.scheme===V.https?e:(t&&t.authority&&t.isRemote&&e.scheme===V.file&&(e=y.from({scheme:V.vscodeRemote,authority:t.authority,path:e.path})),y.from({scheme:V.https,authority:`${e.scheme}+${EZ(e.authority)}.${SZ}`,path:e.path,fragment:e.fragment,query:e.query}))}function EZ(e){return e.replace(/./g,t=>{const i=t.charCodeAt(0);return i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57?t:"-"+i.toString(16).padStart(4,"0")})}var xZ=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i,this.a=0,this.b=new X,this.c=new Map,this.b.add(t.onDidChangeVisibleTextEditors(()=>{const s=t.getVisibleTextEditors();for(const r of this.c.values())s.indexOf(r.editor)<0&&r.inset.dispose()}))}dispose(){this.c.forEach(e=>e.inset.dispose()),this.b.dispose()}createWebviewEditorInset(e,t,i,s,r){let n;for(const f of this.e.getVisibleTextEditors(!0))if(f.value===e){n=f;break}if(!n)throw new Error("not a visible editor");const o=this,a=this.a++,c=new I,l=new I,u=new class{constructor(){this.a="",this.b=Object.create(null)}asWebviewUri(f){return pd(f,o.f)}get cspSource(){return sS}set options(f){this.b=f,o.d.$setOptions(a,f)}get options(){return this.b}set html(f){this.a=f,o.d.$setHtml(a,f)}get html(){return this.a}get onDidReceiveMessage(){return c.event}postMessage(f){return o.d.$postMessage(a,f)}},h=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=u,this.onDidDispose=l.event}dispose(){o.c.delete(a)&&(o.d.$disposeEditorInset(a),l.fire(),l.dispose(),c.dispose())}};return this.d.$createEditorInset(a,n.id,n.value.document.uri,t+1,i,s||{},r.identifier,r.extensionLocation),this.c.set(a,{editor:e,inset:h,onDidReceiveMessage:c}),h}$onDidDispose(e){const t=this.c.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){this.c.get(e)?.onDidReceiveMessage.fire(t)}},CZ=class pR{static{this.a=0}constructor(t){this.c=new Map,this.b=t.getProxy(Q.MainThreadCodeMapper)}async $mapCode(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Received request to map code for unknown provider handle ${t}`);const n={textEdit:(c,l)=>{l=Es(l),this.b.$handleProgress(i.requestId,{uri:c,edits:l.map(ri.from)})},notebookEdit:(c,l)=>{l=Es(l),this.b.$handleProgress(i.requestId,{uri:c,edits:l.map(im.from)})}},o={location:i.location,chatRequestId:i.chatRequestId,chatRequestModel:i.chatRequestModel,chatSessionId:i.chatSessionResource?Cc.parseLocalSessionId(y.revive(i.chatSessionResource)):void 0,codeBlocks:i.codeBlocks.map(c=>({code:c.code,resource:y.revive(c.resource),markdownBeforeBlock:c.markdownBeforeBlock}))};return await r.provideMappedEdits(o,n,s)??null}registerMappedEditsProvider(t,i){const s=pR.a++;return this.b.$registerCodeMapperProvider(s,t.displayName??t.name),this.c.set(s,i),{dispose:()=>this.b.$unregisterCodeMapperProvider(s)}}};function kZ(e,t,i){const s=e.getProxy(Q.MainThreadComments);class r{static{this.a=0}constructor(){this.b=new Map,this.c=new Gn,t.registerArgumentProcessor({processArgument:g=>{if(g&&g.$mid===6){const v=this.b.get(g.handle);return v?v.value:g}else if(g&&g.$mid===7){const v=g,b=this.b.get(v.commentControlHandle);if(!b)return v;const S=b.getCommentThread(v.commentThreadHandle);return S?S.value:v}else if(g&&(g.$mid===9||g.$mid===8)){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);return b?g.$mid===8?b.value:{thread:b.value,text:g.text}:g}else if(g&&g.$mid===10){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);if(!b)return g;const S=g.commentUniqueId,E=b.getCommentByUniqueId(S);return E||g}else if(g&&g.$mid===11){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);if(!b)return g;const S=g.text,E=g.commentUniqueId,k=b.getCommentByUniqueId(E);return k?(typeof k.body=="string"?k.body=S:k.body=new Ni(S),k):g}return g}})}createCommentController(g,v,b){const S=r.a++,E=new o(g,S,v,b);this.b.set(E.handle,E);const k=this.c.get(g.identifier)||[];return k.push(E),this.c.set(g.identifier,k),E.value}async $createCommentThreadTemplate(g,v,b,S){const E=this.b.get(g);E&&E.$createCommentThreadTemplate(v,b,S)}async $setActiveComment(g,v){const b=this.b.get(g);b&&b.$setActiveComment(v??void 0)}async $updateCommentThreadTemplate(g,v,b){const S=this.b.get(g);S&&S.$updateCommentThreadTemplate(v,b)}$deleteCommentThread(g,v){this.b.get(g)?.$deleteCommentThread(v)}async $updateCommentThread(g,v,b){this.b.get(g)?.$updateCommentThread(v,b)}async $provideCommentingRanges(g,v,b){const S=this.b.get(g);if(!S||!S.commentingRangeProvider)return Promise.resolve(void 0);const E=await i.ensureDocumentData(y.revive(v));return wi(async()=>{const k=await S.commentingRangeProvider?.provideCommentingRanges(E.document,b);let O;return Array.isArray(k)?O={ranges:k,fileComments:!1}:k?O={ranges:k.ranges||[],fileComments:k.enableFileComments||!1}:O=k??void 0,O}).then(k=>{let O;return k&&(O={ranges:k.ranges.map(F=>U.from(F)),fileComments:k.fileComments}),O})}$toggleReaction(g,v,b,S,E){const k=this.b.get(g);return!k||!k.reactionHandler?Promise.resolve(void 0):wi(()=>{const O=k.getCommentThread(v);if(O){const F=O.getCommentByUniqueId(S.uniqueIdInThread);if(k!==void 0&&F&&k.reactionHandler)return k.reactionHandler(F,l(E))}return Promise.resolve(void 0)})}}class n{static{this.a=0}set threadId(g){this.n=g}get threadId(){return this.n}get id(){return this.n}get resource(){return this.o}get uri(){return this.o}set range(g){(g===void 0!=(this.p===void 0)||!g||!this.p||!g.isEqual(this.p))&&(this.p=g,this.b.range=g,this.c.fire())}get range(){return this.p}set canReply(g){this.d!==g&&(this.d=g,this.b.canReply=g,this.c.fire())}get canReply(){return this.d}get label(){return this.e}set label(g){this.e=g,this.b.label=g,this.c.fire()}get contextValue(){return this.f}set contextValue(g){this.f=g,this.b.contextValue=g,this.c.fire()}get comments(){return this.q}set comments(g){this.q=g,this.b.comments=g,this.c.fire()}get collapsibleState(){return this.g}set collapsibleState(g){this.g!==g&&(this.g=g,this.b.collapsibleState=g,this.c.fire())}get state(){return this.h}set state(g){this.h=g,typeof g=="object"?(T(this.extensionDescription,"commentThreadApplicability"),this.b.state=g.resolved,this.b.applicability=g.applicability):this.b.state=g,this.c.fire()}get isDisposed(){return this.j}constructor(g,v,b,S,E,k,O,F,G){this.m=v,this.n=b,this.o=S,this.p=E,this.q=k,this.extensionDescription=O,this.r=F,this.handle=n.a++,this.commentHandle=0,this.b=Object.create(null),this.c=new I,this.onDidUpdateCommentThread=this.c.event,this.d=!0,this.k=new Map,this.l=new Hs,this.l.value=new X,this.n===void 0&&(this.n=`${g}.${this.handle}`),s.$createCommentThread(v,this.handle,this.n,this.o,U.from(this.p),this.q.map(B=>a(this,B,this.k,this.extensionDescription)),O.identifier,this.r,G),this.i=[],this.j=!1,this.i.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.i.push({dispose:()=>{s.$deleteCommentThread(v,this.handle)}});const j=this;this.value={get uri(){return j.uri},get range(){return j.range},set range(B){j.range=B},get comments(){return j.comments},set comments(B){j.comments=B},get collapsibleState(){return j.collapsibleState},set collapsibleState(B){j.collapsibleState=B},get canReply(){return j.canReply},set canReply(B){j.canReply=B},get contextValue(){return j.contextValue},set contextValue(B){j.contextValue=B},get label(){return j.label},set label(B){j.label=B},get state(){return j.state},set state(B){j.state=B},reveal:(B,H)=>j.reveal(B,H),hide:()=>j.hide(),dispose:()=>{j.dispose()}}}s(){this.r&&(this.r=!1,this.b.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this.j)return;this.s(),this.l.value||(this.l.value=new X);const g=b=>Object.prototype.hasOwnProperty.call(this.b,b),v={};g("range")&&(v.range=U.from(this.p)),g("label")&&(v.label=this.label),g("contextValue")&&(v.contextValue=this.contextValue??null),g("comments")&&(v.comments=this.q.map(b=>a(this,b,this.k,this.extensionDescription))),g("collapsibleState")&&(v.collapseState=u(this.g)),g("canReply")&&(v.canReply=this.canReply),g("state")&&(v.state=h(this.h)),g("applicability")&&(v.applicability=f(this.h)),g("isTemplate")&&(v.isTemplate=this.r),this.b={},s.$updateCommentThread(this.m,this.handle,this.n,this.o,v)}getCommentByUniqueId(g){for(const v of this.k){const b=v[0],S=v[1];if(g===S)return b}}async reveal(g,v){T(this.extensionDescription,"commentReveal");let b;g&&g.body!==void 0?b=g:v=v??g;let S=b?this.k.get(b):void 0;S??=this.k.get(this.q[0]);let E=!0,k=!1;return v?.focus===bh.Reply?(k=!0,E=!1):v?.focus===bh.Comment&&(E=!1),s.$revealCommentThread(this.m,this.handle,S,{preserveFocus:E,focusReply:k})}async hide(){return s.$hideCommentThread(this.m,this.handle)}dispose(){this.j=!0,this.l.dispose(),this.i.forEach(g=>g.dispose())}}__decorate([kf(100)],n.prototype,"eventuallyUpdateCommentThread",null);class o{get id(){return this.j}get label(){return this.k}get handle(){return this.i}get commentingRangeProvider(){return this.b}set commentingRangeProvider(g){this.b=g,g?.resourceHints&&T(this.h,"commentingRangeHint"),s.$updateCommentingRanges(this.handle,g?.resourceHints)}get reactionHandler(){return this.c}set reactionHandler(g){this.c=g,s.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!g})}get options(){return this.d}set options(g){this.d=g,s.$updateCommentControllerFeatures(this.handle,{options:this.d})}get activeComment(){return T(this.h,"activeComment"),this.e}get activeCommentThread(){return T(this.h,"activeComment"),this.f?.value}constructor(g,v,b,S){this.h=g,this.i=v,this.j=b,this.k=S,this.a=new Map,s.$registerCommentController(this.handle,b,S,this.h.identifier.value);const E=this;this.value=Object.freeze({id:E.id,label:E.label,get options(){return E.options},set options(k){E.options=k},get commentingRangeProvider(){return E.commentingRangeProvider},set commentingRangeProvider(k){E.commentingRangeProvider=k},get reactionHandler(){return E.reactionHandler},set reactionHandler(k){E.reactionHandler=k},get activeCommentThread(){return E.activeCommentThread},createCommentThread(k,O,F){return E.createCommentThread(k,O,F).value},dispose:()=>{E.dispose()}}),this.g=[],this.g.push({dispose:()=>{s.$unregisterCommentController(this.handle)}})}createCommentThread(g,v,b){const S=new n(this.id,this.handle,void 0,g,v,b,this.h,!1);return this.a.set(S.handle,S),S}$setActiveComment(g){if(!g){this.e=void 0,this.f=void 0;return}const v=this.a.get(g.commentThreadHandle);v&&(this.e=g.uniqueIdInThread?v.getCommentByUniqueId(g.uniqueIdInThread):void 0,this.f=v)}$createCommentThreadTemplate(g,v,b){const S=new n(this.id,this.handle,void 0,y.revive(g),U.to(v),[],this.h,!0,b);return S.collapsibleState=Ec.Expanded,this.a.set(S.handle,S),S}$updateCommentThreadTemplate(g,v){const b=this.a.get(g);b&&(b.range=U.to(v))}$updateCommentThread(g,v){const b=this.a.get(g);if(!b)return;(E=>Object.prototype.hasOwnProperty.call(v,E))("collapseState")&&(b.collapsibleState=u(v.collapseState))}$deleteCommentThread(g){this.a.get(g)?.dispose(),this.a.delete(g)}getCommentThread(g){return this.a.get(g)}dispose(){this.a.forEach(g=>{g.dispose()}),this.g.forEach(g=>g.dispose())}}function a(p,g,v,b){let S=v.get(g);return S||(S=++p.commentHandle,v.set(g,S)),g.state!==void 0&&T(b,"commentsDraftState"),g.reactions?.some(E=>E.reactors!==void 0)&&T(b,"commentReactor"),{mode:g.mode,contextValue:g.contextValue,uniqueIdInThread:S,body:typeof g.body=="string"?g.body:le.from(g.body),userName:g.author.name,userIconPath:g.author.iconPath,label:g.label,commentReactions:g.reactions?g.reactions.map(E=>c(E)):void 0,state:g.state,timestamp:g.timestamp?.toJSON()}}function c(p){return{label:p.label,iconPath:p.iconPath?Pg(p.iconPath):void 0,count:p.count,hasReacted:p.authorHasReacted,reactors:p.reactors&&p.reactors.length>0&&typeof p.reactors[0]!="string"?p.reactors.map(g=>g.name):p.reactors}}function l(p){return{label:p.label||"",count:p.count||0,iconPath:p.iconPath?y.revive(p.iconPath):"",authorHasReacted:p.hasReacted||!1,reactors:p.reactors?.map(g=>({name:g}))}}function u(p){if(p!==void 0)switch(p){case mh.Expanded:return Ec.Expanded;case mh.Collapsed:return Ec.Collapsed}return Ec.Collapsed}function h(p){let g;if(typeof p=="object"?g=p.resolved:g=p,g!==void 0)switch(g){case vh.Unresolved:return Lu.Unresolved;case vh.Resolved:return Lu.Resolved}return Lu.Unresolved}function f(p){let g;if(typeof p=="object"&&(g=p.applicability),g!==void 0)switch(g){case wh.Current:return Ou.Current;case wh.Outdated:return Ou.Outdated}return Ou.Current}return new r}var gv={},Ze={exports:gv};(function(e,t){if(typeof gv=="object"&&typeof Ze=="object")Ze.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var i=t();for(var s in i)(typeof gv=="object"?gv:e)[s]=i[s]}})(typeof self<"u"?self:void 0,(function(){return(function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(s,r,n){i.o(s,r)||Object.defineProperty(s,r,{enumerable:!0,get:n})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,r){if(1&r&&(s=i(s)),8&r||4&r&&typeof s=="object"&&s&&s.__esModule)return s;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:s}),2&r&&typeof s!="string")for(var o in s)i.d(n,o,function(a){return s[a]}.bind(null,o));return n},i.n=function(s){var r=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(r,"a",r),r},i.o=function(s,r){return Object.prototype.hasOwnProperty.call(s,r)},i.p="",i(i.s=0)})([function(e,t,i){(function(s){var r;t=e.exports=Xe,r=typeof s=="object"&&s.env&&s.env.NODE_DEBUG&&/\bsemver\b/i.test(s.env.NODE_DEBUG)?function(){var P=Array.prototype.slice.call(arguments,0);P.unshift("SEMVER"),console.log.apply(console,P)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,a=t.re=[],c=t.src=[],l=0,u=l++;c[u]="0|[1-9]\\d*";var h=l++;c[h]="[0-9]+";var f=l++;c[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var p=l++;c[p]="("+c[u]+")\\.("+c[u]+")\\.("+c[u]+")";var g=l++;c[g]="("+c[h]+")\\.("+c[h]+")\\.("+c[h]+")";var v=l++;c[v]="(?:"+c[u]+"|"+c[f]+")";var b=l++;c[b]="(?:"+c[h]+"|"+c[f]+")";var S=l++;c[S]="(?:-("+c[v]+"(?:\\."+c[v]+")*))";var E=l++;c[E]="(?:-?("+c[b]+"(?:\\."+c[b]+")*))";var k=l++;c[k]="[0-9A-Za-z-]+";var O=l++;c[O]="(?:\\+("+c[k]+"(?:\\."+c[k]+")*))";var F=l++,G="v?"+c[p]+c[S]+"?"+c[O]+"?";c[F]="^"+G+"$";var j="[v=\\s]*"+c[g]+c[E]+"?"+c[O]+"?",B=l++;c[B]="^"+j+"$";var H=l++;c[H]="((?:<|>)?=?)";var ie=l++;c[ie]=c[h]+"|x|X|\\*";var Ae=l++;c[Ae]=c[u]+"|x|X|\\*";var re=l++;c[re]="[v=\\s]*("+c[Ae]+")(?:\\.("+c[Ae]+")(?:\\.("+c[Ae]+")(?:"+c[S]+")?"+c[O]+"?)?)?";var $e=l++;c[$e]="[v=\\s]*("+c[ie]+")(?:\\.("+c[ie]+")(?:\\.("+c[ie]+")(?:"+c[E]+")?"+c[O]+"?)?)?";var Z=l++;c[Z]="^"+c[H]+"\\s*"+c[re]+"$";var z=l++;c[z]="^"+c[H]+"\\s*"+c[$e]+"$";var ee=l++;c[ee]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var Y=l++;c[Y]="(?:~>?)";var ae=l++;c[ae]="(\\s*)"+c[Y]+"\\s+",a[ae]=new RegExp(c[ae],"g");var ge=l++;c[ge]="^"+c[Y]+c[re]+"$";var we=l++;c[we]="^"+c[Y]+c[$e]+"$";var ht=l++;c[ht]="(?:\\^)";var We=l++;c[We]="(\\s*)"+c[ht]+"\\s+",a[We]=new RegExp(c[We],"g");var Le=l++;c[Le]="^"+c[ht]+c[re]+"$";var vt=l++;c[vt]="^"+c[ht]+c[$e]+"$";var Gt=l++;c[Gt]="^"+c[H]+"\\s*("+j+")$|^$";var jt=l++;c[jt]="^"+c[H]+"\\s*("+G+")$|^$";var yi=l++;c[yi]="(\\s*)"+c[H]+"\\s*("+j+"|"+c[re]+")",a[yi]=new RegExp(c[yi],"g");var $n=l++;c[$n]="^\\s*("+c[re]+")\\s+-\\s+("+c[re]+")\\s*$";var ui=l++;c[ui]="^\\s*("+c[$e]+")\\s+-\\s+("+c[$e]+")\\s*$";var eu=l++;c[eu]="(<|>)?=?\\s*\\*";for(var qr=0;qr<35;qr++)r(qr,c[qr]),a[qr]||(a[qr]=new RegExp(c[qr]));function ds(P,R){if(P instanceof Xe)return P;if(typeof P!="string"||P.length>n||!(R?a[B]:a[F]).test(P))return null;try{return new Xe(P,R)}catch{return null}}function Xe(P,R){if(P instanceof Xe){if(P.loose===R)return P;P=P.version}else if(typeof P!="string")throw new TypeError("Invalid Version: "+P);if(P.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof Xe))return new Xe(P,R);r("SemVer",P,R),this.loose=R;var L=P.trim().match(R?a[B]:a[F]);if(!L)throw new TypeError("Invalid Version: "+P);if(this.raw=P,this.major=+L[1],this.minor=+L[2],this.patch=+L[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");L[4]?this.prerelease=L[4].split(".").map((function(fe){if(/^[0-9]+$/.test(fe)){var ve=+fe;if(ve>=0&&ve<o)return ve}return fe})):this.prerelease=[],this.build=L[5]?L[5].split("."):[],this.format()}t.parse=ds,t.valid=function(P,R){var L=ds(P,R);return L?L.version:null},t.clean=function(P,R){var L=ds(P.trim().replace(/^[=v]+/,""),R);return L?L.version:null},t.SemVer=Xe,Xe.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Xe.prototype.toString=function(){return this.version},Xe.prototype.compare=function(P){return r("SemVer.compare",this.version,this.loose,P),P instanceof Xe||(P=new Xe(P,this.loose)),this.compareMain(P)||this.comparePre(P)},Xe.prototype.compareMain=function(P){return P instanceof Xe||(P=new Xe(P,this.loose)),In(this.major,P.major)||In(this.minor,P.minor)||In(this.patch,P.patch)},Xe.prototype.comparePre=function(P){if(P instanceof Xe||(P=new Xe(P,this.loose)),this.prerelease.length&&!P.prerelease.length)return-1;if(!this.prerelease.length&&P.prerelease.length)return 1;if(!this.prerelease.length&&!P.prerelease.length)return 0;var R=0;do{var L=this.prerelease[R],fe=P.prerelease[R];if(r("prerelease compare",R,L,fe),L===void 0&&fe===void 0)return 0;if(fe===void 0)return 1;if(L===void 0)return-1;if(L!==fe)return In(L,fe)}while(++R)},Xe.prototype.inc=function(P,R){switch(P){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",R);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",R);break;case"prepatch":this.prerelease.length=0,this.inc("patch",R),this.inc("pre",R);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",R),this.inc("pre",R);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var L=this.prerelease.length;--L>=0;)typeof this.prerelease[L]=="number"&&(this.prerelease[L]++,L=-2);L===-1&&this.prerelease.push(0)}R&&(this.prerelease[0]===R?isNaN(this.prerelease[1])&&(this.prerelease=[R,0]):this.prerelease=[R,0]);break;default:throw new Error("invalid increment argument: "+P)}return this.format(),this.raw=this.version,this},t.inc=function(P,R,L,fe){typeof L=="string"&&(fe=L,L=void 0);try{return new Xe(P,L).inc(R,fe).version}catch{return null}},t.diff=function(P,R){if(Xa(P,R))return null;var L=ds(P),fe=ds(R);if(L.prerelease.length||fe.prerelease.length){for(var ve in L)if((ve==="major"||ve==="minor"||ve==="patch")&&L[ve]!==fe[ve])return"pre"+ve;return"prerelease"}for(var ve in L)if((ve==="major"||ve==="minor"||ve==="patch")&&L[ve]!==fe[ve])return ve},t.compareIdentifiers=In;var Fe=/^[0-9]+$/;function In(P,R){var L=Fe.test(P),fe=Fe.test(R);return L&&fe&&(P=+P,R=+R),L&&!fe?-1:fe&&!L?1:P<R?-1:P>R?1:0}function js(P,R,L){return new Xe(P,L).compare(new Xe(R,L))}function As(P,R,L){return js(P,R,L)>0}function gr(P,R,L){return js(P,R,L)<0}function Xa(P,R,L){return js(P,R,L)===0}function Jd(P,R,L){return js(P,R,L)!==0}function tu(P,R,L){return js(P,R,L)>=0}function iu(P,R,L){return js(P,R,L)<=0}function Ka(P,R,L,fe){var ve;switch(R){case"===":typeof P=="object"&&(P=P.version),typeof L=="object"&&(L=L.version),ve=P===L;break;case"!==":typeof P=="object"&&(P=P.version),typeof L=="object"&&(L=L.version),ve=P!==L;break;case"":case"=":case"==":ve=Xa(P,L,fe);break;case"!=":ve=Jd(P,L,fe);break;case">":ve=As(P,L,fe);break;case">=":ve=tu(P,L,fe);break;case"<":ve=gr(P,L,fe);break;case"<=":ve=iu(P,L,fe);break;default:throw new TypeError("Invalid operator: "+R)}return ve}function Oi(P,R){if(P instanceof Oi){if(P.loose===R)return P;P=P.value}if(!(this instanceof Oi))return new Oi(P,R);r("comparator",P,R),this.loose=R,this.parse(P),this.semver===Mo?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(P,R){return In(R,P)},t.major=function(P,R){return new Xe(P,R).major},t.minor=function(P,R){return new Xe(P,R).minor},t.patch=function(P,R){return new Xe(P,R).patch},t.compare=js,t.compareLoose=function(P,R){return js(P,R,!0)},t.rcompare=function(P,R,L){return js(R,P,L)},t.sort=function(P,R){return P.sort((function(L,fe){return t.compare(L,fe,R)}))},t.rsort=function(P,R){return P.sort((function(L,fe){return t.rcompare(L,fe,R)}))},t.gt=As,t.lt=gr,t.eq=Xa,t.neq=Jd,t.gte=tu,t.lte=iu,t.cmp=Ka,t.Comparator=Oi;var Mo={};function Et(P,R){if(P instanceof Et)return P.loose===R?P:new Et(P.raw,R);if(P instanceof Oi)return new Et(P.value,R);if(!(this instanceof Et))return new Et(P,R);if(this.loose=R,this.raw=P,this.set=P.split(/\s*\|\|\s*/).map((function(L){return this.parseRange(L.trim())}),this).filter((function(L){return L.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+P);this.format()}function hi(P){return!P||P.toLowerCase()==="x"||P==="*"}function y1(P,R,L,fe,ve,_t,st,xi,Bt,di,Ss,xt,fi){return((R=hi(L)?"":hi(fe)?">="+L+".0.0":hi(ve)?">="+L+"."+fe+".0":">="+R)+" "+(xi=hi(Bt)?"":hi(di)?"<"+(+Bt+1)+".0.0":hi(Ss)?"<"+Bt+"."+(+di+1)+".0":xt?"<="+Bt+"."+di+"."+Ss+"-"+xt:"<="+xi)).trim()}function A1(P,R){for(var L=0;L<P.length;L++)if(!P[L].test(R))return!1;if(R.prerelease.length){for(L=0;L<P.length;L++)if(r(P[L].semver),P[L].semver!==Mo&&P[L].semver.prerelease.length>0){var fe=P[L].semver;if(fe.major===R.major&&fe.minor===R.minor&&fe.patch===R.patch)return!0}return!1}return!0}function Us(P,R,L){try{R=new Et(R,L)}catch{return!1}return R.test(P)}function su(P,R,L,fe){var ve,_t,st,xi,Bt;switch(P=new Xe(P,fe),R=new Et(R,fe),L){case">":ve=As,_t=iu,st=gr,xi=">",Bt=">=";break;case"<":ve=gr,_t=tu,st=As,xi="<",Bt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Us(P,R,fe))return!1;for(var di=0;di<R.set.length;++di){var Ss=R.set[di],xt=null,fi=null;if(Ss.forEach((function(Ci){Ci.semver===Mo&&(Ci=new Oi(">=0.0.0")),xt=xt||Ci,fi=fi||Ci,ve(Ci.semver,xt.semver,fe)?xt=Ci:st(Ci.semver,fi.semver,fe)&&(fi=Ci)})),xt.operator===xi||xt.operator===Bt||(!fi.operator||fi.operator===xi)&&_t(P,fi.semver)||fi.operator===Bt&&st(P,fi.semver))return!1}return!0}Oi.prototype.parse=function(P){var R=this.loose?a[Gt]:a[jt],L=P.match(R);if(!L)throw new TypeError("Invalid comparator: "+P);this.operator=L[1],this.operator==="="&&(this.operator=""),L[2]?this.semver=new Xe(L[2],this.loose):this.semver=Mo},Oi.prototype.toString=function(){return this.value},Oi.prototype.test=function(P){return r("Comparator.test",P,this.loose),this.semver===Mo||(typeof P=="string"&&(P=new Xe(P,this.loose)),Ka(P,this.operator,this.semver,this.loose))},Oi.prototype.intersects=function(P,R){if(!(P instanceof Oi))throw new TypeError("a Comparator is required");var L;if(this.operator==="")return L=new Et(P.value,R),Us(this.value,L,R);if(P.operator==="")return L=new Et(this.value,R),Us(P.semver,L,R);var fe=!(this.operator!==">="&&this.operator!==">"||P.operator!==">="&&P.operator!==">"),ve=!(this.operator!=="<="&&this.operator!=="<"||P.operator!=="<="&&P.operator!=="<"),_t=this.semver.version===P.semver.version,st=!(this.operator!==">="&&this.operator!=="<="||P.operator!==">="&&P.operator!=="<="),xi=Ka(this.semver,"<",P.semver,R)&&(this.operator===">="||this.operator===">")&&(P.operator==="<="||P.operator==="<"),Bt=Ka(this.semver,">",P.semver,R)&&(this.operator==="<="||this.operator==="<")&&(P.operator===">="||P.operator===">");return fe||ve||_t&&st||xi||Bt},t.Range=Et,Et.prototype.format=function(){return this.range=this.set.map((function(P){return P.join(" ").trim()})).join("||").trim(),this.range},Et.prototype.toString=function(){return this.range},Et.prototype.parseRange=function(P){var R=this.loose;P=P.trim(),r("range",P,R);var L=R?a[ui]:a[$n];P=P.replace(L,y1),r("hyphen replace",P),P=P.replace(a[yi],"$1$2$3"),r("comparator trim",P,a[yi]),P=(P=(P=P.replace(a[ae],"$1~")).replace(a[We],"$1^")).split(/\s+/).join(" ");var fe=R?a[Gt]:a[jt],ve=P.split(" ").map((function(_t){return(function(st,xi){return r("comp",st),st=(function(Bt,di){return Bt.trim().split(/\s+/).map((function(Ss){return(function(xt,fi){r("caret",xt,fi);var Ci=fi?a[vt]:a[Le];return xt.replace(Ci,(function(fs,Ce,Ue,bt,x){var Tt;return r("caret",xt,fs,Ce,Ue,bt,x),hi(Ce)?Tt="":hi(Ue)?Tt=">="+Ce+".0.0 <"+(+Ce+1)+".0.0":hi(bt)?Tt=Ce==="0"?">="+Ce+"."+Ue+".0 <"+Ce+"."+(+Ue+1)+".0":">="+Ce+"."+Ue+".0 <"+(+Ce+1)+".0.0":x?(r("replaceCaret pr",x),x.charAt(0)!=="-"&&(x="-"+x),Tt=Ce==="0"?Ue==="0"?">="+Ce+"."+Ue+"."+bt+x+" <"+Ce+"."+Ue+"."+(+bt+1):">="+Ce+"."+Ue+"."+bt+x+" <"+Ce+"."+(+Ue+1)+".0":">="+Ce+"."+Ue+"."+bt+x+" <"+(+Ce+1)+".0.0"):(r("no pr"),Tt=Ce==="0"?Ue==="0"?">="+Ce+"."+Ue+"."+bt+" <"+Ce+"."+Ue+"."+(+bt+1):">="+Ce+"."+Ue+"."+bt+" <"+Ce+"."+(+Ue+1)+".0":">="+Ce+"."+Ue+"."+bt+" <"+(+Ce+1)+".0.0"),r("caret return",Tt),Tt}))})(Ss,di)})).join(" ")})(st,xi),r("caret",st),st=(function(Bt,di){return Bt.trim().split(/\s+/).map((function(Ss){return(function(xt,fi){var Ci=fi?a[we]:a[ge];return xt.replace(Ci,(function(fs,Ce,Ue,bt,x){var Tt;return r("tilde",xt,fs,Ce,Ue,bt,x),hi(Ce)?Tt="":hi(Ue)?Tt=">="+Ce+".0.0 <"+(+Ce+1)+".0.0":hi(bt)?Tt=">="+Ce+"."+Ue+".0 <"+Ce+"."+(+Ue+1)+".0":x?(r("replaceTilde pr",x),x.charAt(0)!=="-"&&(x="-"+x),Tt=">="+Ce+"."+Ue+"."+bt+x+" <"+Ce+"."+(+Ue+1)+".0"):Tt=">="+Ce+"."+Ue+"."+bt+" <"+Ce+"."+(+Ue+1)+".0",r("tilde return",Tt),Tt}))})(Ss,di)})).join(" ")})(st,xi),r("tildes",st),st=(function(Bt,di){return r("replaceXRanges",Bt,di),Bt.split(/\s+/).map((function(Ss){return(function(xt,fi){xt=xt.trim();var Ci=fi?a[z]:a[Z];return xt.replace(Ci,(function(fs,Ce,Ue,bt,x,Tt){r("xRange",xt,fs,Ce,Ue,bt,x,Tt);var ec=hi(Ue),ne=ec||hi(bt),Ve=ne||hi(x);return Ce==="="&&Ve&&(Ce=""),ec?fs=Ce===">"||Ce==="<"?"<0.0.0":"*":Ce&&Ve?(ne&&(bt=0),Ve&&(x=0),Ce===">"?(Ce=">=",ne?(Ue=+Ue+1,bt=0,x=0):Ve&&(bt=+bt+1,x=0)):Ce==="<="&&(Ce="<",ne?Ue=+Ue+1:bt=+bt+1),fs=Ce+Ue+"."+bt+"."+x):ne?fs=">="+Ue+".0.0 <"+(+Ue+1)+".0.0":Ve&&(fs=">="+Ue+"."+bt+".0 <"+Ue+"."+(+bt+1)+".0"),r("xRange return",fs),fs}))})(Ss,di)})).join(" ")})(st,xi),r("xrange",st),st=(function(Bt,di){return r("replaceStars",Bt,di),Bt.trim().replace(a[eu],"")})(st,xi),r("stars",st),st})(_t,R)})).join(" ").split(/\s+/);return this.loose&&(ve=ve.filter((function(_t){return!!_t.match(fe)}))),ve=ve.map((function(_t){return new Oi(_t,R)}))},Et.prototype.intersects=function(P,R){if(!(P instanceof Et))throw new TypeError("a Range is required");return this.set.some((function(L){return L.every((function(fe){return P.set.some((function(ve){return ve.every((function(_t){return fe.intersects(_t,R)}))}))}))}))},t.toComparators=function(P,R){return new Et(P,R).set.map((function(L){return L.map((function(fe){return fe.value})).join(" ").trim().split(" ")}))},Et.prototype.test=function(P){if(!P)return!1;typeof P=="string"&&(P=new Xe(P,this.loose));for(var R=0;R<this.set.length;R++)if(A1(this.set[R],P))return!0;return!1},t.satisfies=Us,t.maxSatisfying=function(P,R,L){var fe=null,ve=null;try{var _t=new Et(R,L)}catch{return null}return P.forEach((function(st){_t.test(st)&&(fe&&ve.compare(st)!==-1||(ve=new Xe(fe=st,L)))})),fe},t.minSatisfying=function(P,R,L){var fe=null,ve=null;try{var _t=new Et(R,L)}catch{return null}return P.forEach((function(st){_t.test(st)&&(fe&&ve.compare(st)!==1||(ve=new Xe(fe=st,L)))})),fe},t.validRange=function(P,R){try{return new Et(P,R).range||"*"}catch{return null}},t.ltr=function(P,R,L){return su(P,R,"<",L)},t.gtr=function(P,R,L){return su(P,R,">",L)},t.outside=su,t.prerelease=function(P,R){var L=ds(P,R);return L&&L.prerelease.length?L.prerelease:null},t.intersects=function(P,R,L){return P=new Et(P,L),R=new Et(R,L),P.intersects(R)},t.coerce=function(P){if(P instanceof Xe)return P;if(typeof P!="string")return null;var R=P.match(a[ee]);return R==null?null:ds((R[1]||"0")+"."+(R[2]||"0")+"."+(R[3]||"0"))}}).call(this,i(1))},function(e,t){var i,s,r=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(b){if(i===setTimeout)return setTimeout(b,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(b,0);try{return i(b,0)}catch{try{return i.call(null,b,0)}catch{return i.call(this,b,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:n}catch{i=n}try{s=typeof clearTimeout=="function"?clearTimeout:o}catch{s=o}})();var c,l=[],u=!1,h=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!u){var b=a(f);u=!0;for(var S=l.length;S;){for(c=l,l=[];++h<S;)c&&c[h].run();h=-1,S=l.length}c=null,u=!1,(function(E){if(s===clearTimeout)return clearTimeout(E);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(E);try{s(E)}catch{try{return s.call(null,E)}catch{return s.call(this,E)}}})(b)}}function g(b,S){this.fun=b,this.array=S}function v(){}r.nextTick=function(b){var S=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)S[E-1]=arguments[E];l.push(new g(b,S)),l.length!==1||u||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=v,r.addListener=v,r.once=v,r.off=v,r.removeListener=v,r.removeAllListeners=v,r.emit=v,r.prependListener=v,r.prependOnceListener=v,r.listeners=function(b){return[]},r.binding=function(b){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(b){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}])}));var Vae=Ze.exports.SEMVER_SPEC_VERSION,Gae=Ze.exports.parse,Jae=Ze.exports.valid,Zae=Ze.exports.coerce,Yae=Ze.exports.clean,Qae=Ze.exports.inc,Xae=Ze.exports.major,Kae=Ze.exports.minor,ece=Ze.exports.patch,tce=Ze.exports.prerelease,ice=Ze.exports.gt,sce=Ze.exports.gte,rce=Ze.exports.lt,nce=Ze.exports.lte,oce=Ze.exports.eq,ace=Ze.exports.neq,cce=Ze.exports.cmp,lce=Ze.exports.compare,uce=Ze.exports.rcompare,hce=Ze.exports.compareIdentifiers,dce=Ze.exports.rcompareIdentifiers,fce=Ze.exports.compareBuild,pce=Ze.exports.sort,gce=Ze.exports.rsort,mce=Ze.exports.diff,vce=Ze.exports.validRange,wce=Ze.exports.satisfies,bce=Ze.exports.maxSatisfying,yce=Ze.exports.minSatisfying,Ace=Ze.exports.minVersion,Sce=Ze.exports.gtr,Ece=Ze.exports.ltr,xce=Ze.exports.outside,Cce=Ze.exports.intersects,kce=Ze.exports.SemVer,$ce=Ze.exports.Comparator,Ice=Ze.exports.Range,r3=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,$Z=/^-(\d{4})(\d{2})(\d{2})(\d{2})?(\d{2})?$/;function IZ(e){return e=e.trim(),e==="*"||r3.test(e)}function n3(e){if(!IZ(e))return null;if(e=e.trim(),e==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const t=e.match(r3);return t?{hasCaret:t[1]==="^",hasGreaterEquals:t[1]===">=",majorBase:t[2]==="x"?0:parseInt(t[2],10),majorMustEqual:t[2]!=="x",minorBase:t[4]==="x"?0:parseInt(t[4],10),minorMustEqual:t[4]!=="x",patchBase:t[6]==="x"?0:parseInt(t[6],10),patchMustEqual:t[6]!=="x",preRelease:t[8]||null}:null}function o3(e){if(!e)return null;const t=e.majorBase,i=e.majorMustEqual,s=e.minorBase;let r=e.minorMustEqual;const n=e.patchBase;let o=e.patchMustEqual;e.hasCaret&&(t===0||(r=!1),o=!1);let a=0;if(e.preRelease){const c=$Z.exec(e.preRelease);if(c){const[,l,u,h,f,p]=c;a=Date.UTC(Number(l),Number(u)-1,Number(h),Number(f)||0,Number(p)||0)}}return{majorBase:t,majorMustEqual:i,minorBase:s,minorMustEqual:r,patchBase:n,patchMustEqual:o,isMinimum:e.hasGreaterEquals,notBefore:a}}var DZ=class{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}};function PZ(e,t){if(t.serializeBuffersForPostMessage){const i=new DZ,r=JSON.stringify(e,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a)};if(ArrayBuffer.isView(a)){const c=TZ(a);if(c)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a.buffer),view:{type:c,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),n=i.buffers.map(o=>{const a=new Uint8Array(o);return _.wrap(a)});return{message:r,buffers:n}}else return{message:JSON.stringify(e),buffers:[]}}function TZ(e){switch(e.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function MZ(e,t){const i=t.map(n=>{const o=new ArrayBuffer(n.byteLength);return new Uint8Array(o).set(n.buffer),o}),s=t.length?(n,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:c}=a,l=i[c];if(a.view)switch(a.view.type){case 1:return new Int8Array(l,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(l,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(l,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(l,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(l,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(l,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(l,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(l,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(l,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(l,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(l,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return l}return o}:void 0;return{message:JSON.parse(e,s),arrayBuffers:i}}var NZ=class{#e;#t;#i;#s;#o;#n;#c;#a;#l;#u;#r;#d;constructor(e,t,i,s,r,n,o){this.#c="",this.#l=!1,this.#u=!1,this._onMessageEmitter=new I,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#h=new I,this._onDidDispose=this.#h.event,this.#e=e,this.#t=t,this.#a=i,this.#s=s,this.#o=r,this.#n=n,this.#r=jl(n),this.#d=RZ(n),this.#i=o}#h;dispose(){this.#l=!0,this.#h.fire(),this.#h.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#u=!0,pd(e,this.#s)}get cspSource(){const e=this.#n.extensionLocation;if(e.scheme===V.https||e.scheme===V.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+sS}return sS}get html(){return this.a(),this.#c}set html(e){this.a(),this.#c!==e&&(this.#c=e,this.#d&&!this.#u&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#u=!0,this.#i.report("Webview vscode-resource: uris",this.#n,"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),this.#t.$setHtml(this.#e,this.b(e)))}get options(){return this.a(),this.#a}set options(e){this.a(),Ai(this.#a,e)||this.#t.$setOptions(this.#e,a3(this.#n,this.#o,e)),this.#a=e}async postMessage(e){if(this.#l)return!1;const t=PZ(e,{serializeBuffersForPostMessage:this.#r});return this.#t.$postMessage(this.#e,t.message,...t.buffers)}a(){if(this.#l)throw new Error("Webview is disposed")}b(e){if(!this.#d)return e;const t=this.#n.extensionLocation?.scheme===V.vscodeRemote,i=this.#n.extensionLocation.scheme===V.vscodeRemote?this.#n.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,n,o,a,c)=>{const l=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=pd(l,{isRemote:t,authority:i}).toString();return`${r}${u}${c}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,n,o,a,c)=>{const l=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=pd(l,{isRemote:t,authority:i}).toString();return`${r}${u}${c}`})}};function jl(e){try{const t=o3(n3(e.engines.vscode));return!!t&&t.majorBase>=1&&t.minorBase>=57}catch{return!1}}function RZ(e){try{const t=o3(n3(e.engines.vscode));return t?t.majorBase<1||t.majorBase===1&&t.minorBase<60:!1}catch{return!1}}var LZ=class extends J{constructor(e,t,i,s,r){super(),this.c=t,this.f=i,this.g=s,this.h=r,this.b=new Map,this.a=e.getProxy(Q.MainThreadWebviews)}dispose(){super.dispose();for(const e of this.b.values())e.dispose();this.b.clear()}$onMessage(e,t,i){const s=this.j(e);if(s){const{message:r}=MZ(t,i.value);s._onMessageEmitter.fire(r)}}$onMissingCsp(e,t){this.g.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const s=new NZ(e,this.a,OZ(t),this.c,this.f,i,this.h);this.b.set(e,s);const r=s._onDidDispose(()=>{r.dispose(),this.deleteWebview(e)});return s}deleteWebview(e){this.b.delete(e)}j(e){return this.b.get(e)}};function mv(e){return{id:e.identifier,location:e.extensionLocation}}function a3(e,t,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||FZ(e,t)}}function OZ(e){return{enableCommandUris:e.enableCommandUris,enableScripts:e.enableScripts,enableForms:e.enableForms,portMapping:e.portMapping,localResourceRoots:e.localResourceRoots?.map(t=>y.from(t))}}function FZ(e,t){return[...(t?.getWorkspaceFolders()||[]).map(i=>i.uri),e.extensionLocation]}var cr=class gR{static{this.a=!1}constructor(t){this.d=t,this.b=new Map,this.c=1}add(t){const i=this.c++;return this.b.set(i,t),this.e(),i}get(t,i){return this.b.has(t)?this.b.get(t)[i]:void 0}delete(t){this.b.delete(t),this.e()}e(){gR.a&&console.log(`${this.d} cache size - ${this.b.size}`)}},jZ=class{constructor(e,t){this.document=e,this.b=t,this.a=1,this.c=new cr("custom documents")}addEdit(e){return this.c.add([e])}async undo(e,t){await this.f(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.f(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this.c.delete(t)}getNewBackupUri(){if(!this.b)throw new Error("Backup requires a valid storage path");const e=BZ(this.document.uri)+this.a++;return Lt(this.b,e)}updateBackup(e){this.d?.delete(),this.d=e}disposeBackup(){this.d?.delete(),this.d=void 0}f(e){const t=this.c.get(e,0);if(!t)throw new Error("No edit found");return t}},UZ=class{constructor(){this.a=new Map}get(e,t){return this.a.get(this.b(e,t))}add(e,t,i){const s=this.b(e,t.uri);if(this.a.has(s))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const r=new jZ(t,i);return this.a.set(s,r),r}delete(e,t){const i=this.b(e,t);this.a.delete(i)}b(e,t){return`${e}@@@${t}`}},c3;(function(e){e[e.Text=0]="Text",e[e.Custom=1]="Custom"})(c3||(c3={}));var zZ=class{constructor(){this.a=new Map}addTextProvider(e,t,i){return this.b(e,{type:0,extension:t,provider:i})}addCustomProvider(e,t,i){return this.b(e,{type:1,extension:t,provider:i})}get(e){return this.a.get(e)}b(e,t){if(this.a.has(e))throw new Error(`Provider for viewType:${e} already registered`);return this.a.set(e,t),new Pe(()=>this.a.delete(e))}},HZ=class{constructor(e,t,i,s,r){this.d=t,this.f=i,this.g=s,this.h=r,this.b=new zZ,this.c=new UZ,this.a=e.getProxy(Q.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,s){const r=new X;return WZ(i)?(r.add(this.b.addTextProvider(t,e,i)),this.a.$registerTextEditorProvider(mv(e),t,s.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},jl(e))):(r.add(this.b.addCustomProvider(t,e,i)),vv(i)&&r.add(i.onDidChangeCustomDocument(n=>{const o=this.i(t,n.document.uri);if(_Z(n)){const a=o.addEdit(n);this.a.$onDidEdit(n.document.uri,t,a,n.label)}else this.a.$onContentChange(n.document.uri,t)})),this.a.$registerCustomEditorProvider(mv(e),t,s.webviewOptions||{},!!s.supportsMultipleEditorsPerDocument,jl(e))),Pe.from(r,new Pe(()=>{this.a.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,s,r){const n=this.b.get(t);if(!n)throw new Error(`No provider found for '${t}'`);if(n.type!==1)throw new Error(`Invalid provide type for '${t}'`);const o=y.revive(e),a=await n.provider.openCustomDocument(o,{backupId:i,untitledDocumentData:s?.buffer},r);let c;return vv(n.provider)&&this.f&&(c=this.f.workspaceValue(n.extension)??this.f.globalValue(n.extension)),this.c.add(t,a,c),{editable:vv(n.provider)}}async $disposeCustomDocument(e,t){const i=this.b.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const s=y.revive(e),{document:r}=this.i(t,s);this.c.delete(t,s),r.dispose()}async $resolveCustomEditor(e,t,i,s,r,n){const o=this.b.get(i);if(!o)throw new Error(`No provider found for '${i}'`);const a=si.to(r),c=this.g.createNewWebview(t,s.contentOptions,o.extension),l=this.h.createNewWebviewPanel(t,i,s.title,a,s.options,c,s.active),u=y.revive(e);switch(o.type){case 1:{const{document:h}=this.i(i,u);return o.provider.resolveCustomEditor(h,l,n)}case 0:{const h=this.d.getDocument(u);return o.provider.resolveCustomTextEditor(h,l,n)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.i(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const s=this.b.get(i);if(!s)throw new Error(`No provider found for '${i}'`);if(!s.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const r=this.h.getWebviewPanel(e);if(!r)throw new Error("No webview found");const n=y.revive(t),o=this.d.getDocument(n);await s.provider.moveCustomTextEditor(o,r,De.None)}async $undo(e,t,i,s){return this.i(t,e).undo(i,s)}async $redo(e,t,i,s){return this.i(t,e).redo(i,s)}async $revert(e,t,i){const s=this.i(t,e);await this.j(t).revertCustomDocument(s.document,i),s.disposeBackup()}async $onSave(e,t,i){const s=this.i(t,e);await this.j(t).saveCustomDocument(s.document,i),s.disposeBackup()}async $onSaveAs(e,t,i,s){const r=this.i(t,e);return this.j(t).saveCustomDocumentAs(r.document,y.revive(i),s)}async $backup(e,t,i){const s=this.i(t,e),n=await this.j(t).backupCustomDocument(s.document,{destination:s.getNewBackupUri()},i);return s.updateBackup(n),n.id}i(e,t){const i=this.c.get(e,y.revive(t));if(!i)throw new Error("No custom document found");return i}j(e){const i=this.b.get(e)?.provider;if(!i||!vv(i))throw new Error("Custom document is not editable");return i}};function vv(e){return!!e.onDidChangeCustomDocument}function WZ(e){return typeof e.resolveCustomTextEditor=="function"}function _Z(e){return typeof e.undo=="function"&&typeof e.redo=="function"}function BZ(e){const t=e.scheme===V.file||e.scheme===V.untitled?e.fsPath:e.toString();return Ar(t)+""}var Wa,l3=class mR{#e;#t;#i;constructor(t,i,s,r,n,o,a,c){this.d=t,this.e=i,this.f=s,this.g=r,this.h=n,this.c=!1,this.f=Math.max(r,s),this.#i=new Ct(l=>o.getComparisonKey(l)),this.#e=a,this.#t=c}dispose(){this.c||(this.#t.fire([...this.#i.keys()]),this.#e?.$clear(this.e),this.#i.clear(),this.c=!0)}get name(){return this.j(),this.d}set(t,i){if(!t){this.clear();return}this.j();let s=[];if(y.isUri(t)){if(!i){this.delete(t);return}this.#i.set(t,yt(i)),s=[t]}else if(Array.isArray(t)){s=[];let o;t=[...t].sort(mR.k);for(const a of t){const[c,l]=a;if((!o||c.toString()!==o.toString())&&(o&&this.#i.get(o).length===0&&this.#i.delete(o),o=c,s.push(c),this.#i.set(c,[])),l)this.#i.get(c)?.push(...yt(l));else{const u=this.#i.get(c);u&&(u.length=0)}}}if(this.#t.fire(s),!this.#e)return;const r=[];let n=0;for(const o of s){let a=[];const c=this.#i.get(o);if(c)if(c.length>this.g){a=[];const l=[bi.Error,bi.Warning,bi.Information,bi.Hint];e:for(let u=0;u<4;u++)for(const h of c)if(h.severity===l[u]&&a.push({...Ia.from(h),modelVersionId:this.h(o)})===this.g)break e;a.push({severity:Hi.Info,message:d(3038,null,c.length-this.g),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...Ia.from(l),modelVersionId:this.h(o)}));if(r.push([o,a]),n+=a.length,n>this.f)break}this.#e.$changeMany(this.e,r)}delete(t){this.j(),this.#t.fire([t]),this.#i.delete(t),this.#e?.$changeMany(this.e,[[t,void 0]])}clear(){this.j(),this.#t.fire([...this.#i.keys()]),this.#i.clear(),this.#e?.$clear(this.e)}forEach(t,i){this.j();for(const[s,r]of this)t.call(i,s,r,this)}*[Symbol.iterator](){this.j();for(const t of this.#i.keys())yield[t,this.get(t)]}get(t){this.j();const i=this.#i.get(t);return Array.isArray(i)?Object.freeze(i.slice(0)):[]}has(t){return this.j(),Array.isArray(this.#i.get(t))}j(){if(this.c)throw new Error("illegal state - object is disposed")}static k(t,i){return t[0].toString()<i[0].toString()?-1:t[0].toString()>i[0].toString()?1:0}},rS=class{static{Wa=this}static{this.c=0}static{this.d=1e3}static{this.e=1.1*this.d}static _mapper(t){const i=new Ct;for(const s of t)i.set(s,s);return{uris:Object.freeze(Array.from(i.values()))}}constructor(t,i,s,r){this.j=i,this.k=s,this.l=r,this.g=new Map,this.h=new s2({merge:n=>n.flat(),delay:50}),this.onDidChangeDiagnostics=Ie.map(this.h.event,Wa._mapper),this.f=t.getProxy(Q.MainThreadDiagnostics)}createDiagnosticCollection(t,i){const{g:s,f:r,h:n,j:o,k:a,l:c}=this,l=new class{$changeMany(f,p){r.$changeMany(f,p),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",t.value,f,p.length===0?"CLEARING":p)}$clear(f){r.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",t.value,f)}dispose(){r.dispose()}};let u;if(!i)i="_generated_diagnostic_collection_name_#"+Wa.c++,u=i;else if(!s.has(i))u=i;else{this.j.warn(`DiagnosticCollection with name '${i}' does already exist.`);do u=i+Wa.c++;while(s.has(u))}return new class extends l3{constructor(){super(i,u,Wa.e,Wa.d,f=>c.getDocument(f)?.version,a.extUri,l,n),s.set(u,this)}dispose(){super.dispose(),s.delete(u)}}}getDiagnostics(t){if(t)return this.m(t);{const i=new Map,s=[];for(const r of this.g.values())r.forEach((n,o)=>{let a=i.get(n.toString());typeof a>"u"&&(a=s.length,i.set(n.toString(),a),s.push([n,[]])),s[a][1]=s[a][1].concat(...o)});return s}}m(t){let i=[];for(const s of this.g.values())s.has(t)&&(i=i.concat(s.get(t)));return i}$acceptMarkersChange(t){if(!this.n){const i="_generated_mirror",s=new l3(i,i,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,r=>{},this.k.extUri,void 0,this.h);this.g.set(i,s),this.n=s}for(const[i,s]of t)this.n.set(y.revive(i),s.map(Ia.to))}};rS=Wa=__decorate([__param(1,xe),__param(2,bc)],rS);var qZ=class{constructor(e){this.a=e.getProxy(Q.MainThreadDialogs)}showOpenDialog(e){return this.a.$showOpenDialog(e).then(t=>t?t.map(i=>y.revive(i)):void 0)}showSaveDialog(e){return this.a.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}},VZ=class vR{static{this.a=0}constructor(t,i,s){this.d=i,this.e=s,this.b=new Map,this.c=t.getProxy(Q.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(t,i){if(Object.keys(V).indexOf(t)>=0)throw new Error(`scheme '${t}' already registered`);const s=vR.a++;this.b.set(s,i),this.c.$registerTextContentProvider(s,t);let r;if(typeof i.onDidChange=="function"){let n;r=i.onDidChange(async o=>{if(o.scheme!==t){this.e.warn(`Provider for scheme '${t}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this.d.getDocument(o))return;n&&await n;const a=this.$provideTextDocumentContent(s,o).then(async c=>{if(!c&&typeof c!="string")return;const l=this.d.getDocument(o);if(!l)return;const u=eC(c);if(!l.equalLines(u))return this.c.$onVirtualDocumentChange(o,c)}).catch(pt).finally(()=>{n===a&&(n=void 0)});n=a})}return new Pe(()=>{this.b.delete(s)&&this.c.$unregisterTextContentProvider(s),r&&(r.dispose(),r=void 0)})}$provideTextDocumentContent(t,i){const s=this.b.get(t);return s?Promise.resolve(s.provideTextDocumentContent(y.revive(i),De.None)):Promise.reject(new Error(`unsupported uri-scheme: ${i.scheme}`))}},GZ=class{constructor(e,t,i,s={timeout:1500,errors:3}){this.c=e,this.d=t,this.f=i,this.g=s,this.a=new Pn,this.b=new WeakMap}dispose(){this.a.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,s)=>{const n={dispose:this.a.push([t,i,e])};return Array.isArray(s)&&s.push(n),n}}async $participateInSave(e,t){const i=y.revive(e);let s=!1;const r=setTimeout(()=>s=!0,this.g.timeout),n=[];try{for(const o of[...this.a]){if(s)break;const a=this.d.getDocument(i),c=await this.h(o,{document:a,reason:zg.to(t)});n.push(c)}}finally{clearTimeout(r)}return n}h([e,t,i],s){const r=this.b.get(e);return typeof r=="number"&&r>this.g.errors?Promise.resolve(!1):this.i(i,e,t,s).then(()=>!0,n=>{if(this.c.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this.c.error(n),!(n instanceof Error)||n.message!=="concurrent_edits"){const o=this.b.get(e);this.b.set(e,o?o+1:1),typeof o=="number"&&o>this.g.errors&&this.c.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}i(e,t,i,s){const r=[],n=Date.now(),{document:o,reason:a}=s,{version:c}=o,l=Object.freeze({document:o,reason:a,waitUntil(u){if(Object.isFrozen(r))throw $1("waitUntil can not be called async");r.push(Promise.resolve(u))}});try{t.apply(i,[l])}catch(u){return Promise.reject(u)}return Object.freeze(r),new Promise((u,h)=>{const f=setTimeout(()=>h(new Error("timeout")),this.g.timeout);return Promise.all(r).then(p=>{this.c.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-n}ms`),clearTimeout(f),u(p)}).catch(p=>{clearTimeout(f),h(p)})}).then(u=>{const h={edits:[]};for(const f of u)if(Array.isArray(f)&&f.every(p=>p instanceof lo))for(const{newText:p,newEol:g,range:v}of f)h.edits.push({resource:o.uri,versionId:void 0,textEdit:{range:v&&U.from(v),text:p,eol:g&&pl.from(g)}});if(h.edits.length!==0)return c===o.version?this.f.$tryApplyWorkspaceEdit(new Si(h)):Promise.reject(new Error("concurrent_edits"))})}},JZ=class{constructor(e,t){this.a=new I,this.b=new I,this.c=new I,this.d=new I,this.e=new I,this.onDidAddDocument=this.a.event,this.onDidRemoveDocument=this.b.event,this.onDidChangeDocument=this.c.event,this.onDidChangeDocumentWithReason=this.d.event,this.onDidSaveDocument=this.e.event,this.f=new X,this.i=new Map,this.g=e.getProxy(Q.MainThreadDocuments),this.h=t,this.h.onDidRemoveDocuments(i=>{for(const s of i)this.b.fire(s.document)},void 0,this.f),this.h.onDidAddDocuments(i=>{for(const s of i)this.a.fire(s.document)},void 0,this.f)}dispose(){this.f.dispose()}getAllDocumentData(){return[...this.h.allDocuments()]}getDocumentData(e){if(!e)return;const t=this.h.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!t?.document)throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e,t){const i=this.h.getDocument(e);if(i&&(!t?.encoding||i.document.encoding===t.encoding))return Promise.resolve(i);let s=this.i.get(e.toString());return s?t?.encoding&&(s=s.then(r=>r.document.encoding!==t.encoding?this.ensureDocumentData(e,t):r)):(s=this.g.$tryOpenDocument(e,t).then(r=>{this.i.delete(e.toString());const n=y.revive(r);return sc(this.h.getDocument(n))},r=>(this.i.delete(e.toString()),Promise.reject(r))),this.i.set(e.toString(),s)),s}createDocumentData(e){return this.g.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const i=y.revive(e),s=this.h.getDocument(i);if(!s)throw new Error("unknown document");this.b.fire(s.document),s._acceptLanguageId(t),this.a.fire(s.document)}$acceptModelSaved(e){const t=y.revive(e),i=this.h.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this.e.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=y.revive(e),s=this.h.getDocument(i);if(!s)throw new Error("unknown document");s._acceptIsDirty(t),this.c.fire({document:s.document,contentChanges:[],reason:void 0}),this.d.fire({document:s.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptEncodingChanged(e,t){const i=y.revive(e),s=this.h.getDocument(i);if(!s)throw new Error("unknown document");s._acceptEncoding(t),this.c.fire({document:s.document,contentChanges:[],reason:void 0}),this.d.fire({document:s.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptModelChanged(e,t,i){const s=y.revive(e),r=this.h.getDocument(s);if(!r)throw new Error("unknown document");r._acceptIsDirty(i),r.onEvents(t);let n;t.isUndoing?n=ch.Undo:t.isRedoing&&(n=ch.Redo),this.c.fire(y0({document:r.document,contentChanges:t.changes.map(o=>({range:U.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:n})),this.d.fire(y0({document:r.document,contentChanges:t.changes.map(o=>({range:U.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:n,detailedReason:t.detailedReason?{source:t.detailedReason.source,metadata:t.detailedReason}:void 0}))}setWordDefinitionFor(e,t){yV(e,t)}},ZZ=class{constructor(e){this.b=new Map,this.c=new I,this.onDidChange=this.c.event,this.d=new Set,this.e=0,this.a=e.getProxy(Q.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,i){if(this.d.has(t))throw new Error("An embeddings provider for this model is already registered");const s=this.e++;return this.a.$registerEmbeddingProvider(s,t),this.b.set(s,{id:t,provider:i}),se(()=>{this.d.delete(t),this.a.$unregisterEmbeddingProvider(s),this.b.delete(s)})}async computeEmbeddings(e,t,i){i??=De.None;let s=!1;typeof t=="string"&&(t=[t],s=!0);const r=await this.a.$computeEmbeddings(e,t,i);if(r.length!==t.length)throw new Error;if(s){if(r.length!==1)throw new Error;return r[0]}return r}async $provideEmbeddings(e,t,i){const s=this.b.get(e);if(!s)return[];const r=await s.provider.provideEmbeddings(t,i);return r||[]}get embeddingsModels(){return Array.from(this.d)}$acceptEmbeddingModels(e){this.d=new Set(e),this.c.fire()}},YZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(Q.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this.a.size===0)throw new Error("No embedding vector providers registered");const s=this.a.get(e);if(!s)throw new Error("Embedding vector provider not found");const r=await s.provideEmbeddingVector(t,i);if(!r)throw new Error("Embedding vector provider returned undefined");return r}registerEmbeddingVectorProvider(e,t,i){const s=this.b;return this.b++,this.a.set(s,i),this.c.$registerAiEmbeddingVectorProvider(t,s),new Pe(()=>{this.c.$unregisterAiEmbeddingVectorProvider(s),this.a.delete(s)})}},u3;(function(e){e[e.Invalid=0]="Invalid",e[e.Start=1]="Start",e[e.H=2]="H",e[e.HT=3]="HT",e[e.HTT=4]="HTT",e[e.HTTP=5]="HTTP",e[e.F=6]="F",e[e.FI=7]="FI",e[e.FIL=8]="FIL",e[e.BeforeColon=9]="BeforeColon",e[e.AfterColon=10]="AfterColon",e[e.AlmostThere=11]="AlmostThere",e[e.End=12]="End",e[e.Accept=13]="Accept",e[e.LastKnownState=14]="LastKnownState"})(u3||(u3={}));var QZ=class{constructor(e,t,i){const s=new Uint8Array(e*t);for(let r=0,n=e*t;r<n;r++)s[r]=i;this.a=s,this.rows=e,this.cols=t}get(e,t){return this.a[e*this.cols+t]}set(e,t,i){this.a[e*this.cols+t]=i}},h3=class{constructor(e){let t=0,i=0;for(let r=0,n=e.length;r<n;r++){const[o,a,c]=e[r];a>t&&(t=a),o>i&&(i=o),c>i&&(i=c)}t++,i++;const s=new QZ(i,t,0);for(let r=0,n=e.length;r<n;r++){const[o,a,c]=e[r];s.set(o,a,c)}this.a=s,this.b=t}nextState(e,t){return t<0||t>=this.b?0:this.a.get(e,t)}},nS=null;function XZ(){return nS===null&&(nS=new h3([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),nS}var d3;(function(e){e[e.None=0]="None",e[e.ForceTermination=1]="ForceTermination",e[e.CannotEndIn=2]="CannotEndIn"})(d3||(d3={}));var gd=null;function KZ(){if(gd===null){gd=new w8(0);const e=` 	<>'"\u3001\u3002\uFF61\uFF64\uFF0C\uFF0E\uFF1A\uFF1B\u2018\u3008\u300C\u300E\u3014\uFF08\uFF3B\uFF5B\uFF62\uFF63\uFF5D\uFF3D\uFF09\u3015\u300F\u300D\u3009\u2019\uFF40\uFF5E\u2026|`;for(let i=0;i<e.length;i++)gd.set(e.charCodeAt(i),1);const t=".,;:";for(let i=0;i<t.length;i++)gd.set(t.charCodeAt(i),2)}return gd}var eY=class ix{static a(t,i,s,r,n){let o=n-1;do{const a=i.charCodeAt(o);if(t.get(a)!==2)break;o--}while(o>r);if(r>0){const a=i.charCodeAt(r-1),c=i.charCodeAt(o);(a===40&&c===41||a===91&&c===93||a===123&&c===125)&&o--}return{range:{startLineNumber:s,startColumn:r+1,endLineNumber:s,endColumn:o+2},url:i.substring(r,o+1)}}static computeLinks(t,i=XZ()){const s=KZ(),r=[];for(let n=1,o=t.getLineCount();n<=o;n++){const a=t.getLineContent(n),c=a.length;let l=0,u=0,h=0,f=1,p=!1,g=!1,v=!1,b=!1;for(;l<c;){let S=!1;const E=a.charCodeAt(l);if(f===13){let k;switch(E){case 40:p=!0,k=0;break;case 41:k=p?0:1;break;case 91:v=!0,g=!0,k=0;break;case 93:v=!1,k=g?0:1;break;case 123:b=!0,k=0;break;case 125:k=b?0:1;break;case 39:case 34:case 96:h===E?k=1:h===39||h===34||h===96?k=0:k=1;break;case 42:k=h===42?1:0;break;case 32:k=v?0:1;break;default:k=s.get(E)}k===1&&(r.push(ix.a(s,a,n,u,l)),S=!0)}else if(f===12){let k;E===91?(g=!0,k=0):k=s.get(E),k===1?S=!0:f=13}else f=i.nextState(f,E),f===0&&(S=!0);S&&(f=1,p=!1,g=!1,b=!1,u=l+1,h=E),l++}f===13&&r.push(ix.a(s,a,n,u,c))}return r}},tY=class{constructor(){this.a=[]}add(e){this.b=void 0,this.a.push(e)}delete(e){const t=this.a.indexOf(e);t>=0&&(this.a.splice(t,1),this.b=void 0)}c(){if(!this.b){const e=this.a.sort(),t=[];let i,s,r=14,n=14;for(const o of e){let a=i?z2(i,o):0;for(a===0?s=1:s=n;a<o.length;a++)a+1===o.length?(r=n,n=9):n+=1,t.push([s,o.toUpperCase().charCodeAt(a),n]),t.push([s,o.toLowerCase().charCodeAt(a),n]),s=n;i=o,n=r}t.push([9,58,10]),t.push([10,47,12]),this.b=new h3(t)}}provideDocumentLinks(e){this.c();const t=[],i=eY.computeLinks({getLineContent(s){return e.lineAt(s-1).text},getLineCount(){return e.lineCount}},this.b);for(const s of i){const r=Ta.to(s);r.target&&t.push(r)}return t}},iY=class sx{constructor(t,i){this.i=i,this.b=new tY,this.c=new Map,this.d=new Set,this.f=new Map,this.h=0,this.a=t.getProxy(Q.MainThreadFileSystem)}dispose(){this.g?.dispose()}registerFileSystemProvider(t,i,s,r={}){if(sx.j(s),this.d.has(i))throw new Error(`a provider for the scheme '${i}' is already registered`);this.g||(this.g=this.i.registerDocumentLinkProvider(t,"*",this.b));const n=this.h++;this.b.add(i),this.d.add(i),this.c.set(n,s);let o=2;r.isCaseSensitive&&(o+=1024),r.isReadonly&&(o+=2048),typeof s.copy=="function"&&(o+=8),typeof s.open=="function"&&typeof s.close=="function"&&typeof s.read=="function"&&typeof s.write=="function"&&(T(t,"fsChunks"),o+=4);let a;r.isReadonly&&Xn(r.isReadonly)&&r.isReadonly.value!==""&&(a={value:r.isReadonly.value,isTrusted:r.isReadonly.isTrusted,supportThemeIcons:r.isReadonly.supportThemeIcons,supportHtml:r.isReadonly.supportHtml,baseUri:r.isReadonly.baseUri,uris:r.isReadonly.uris}),this.a.$registerFileSystemProvider(n,i,o,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${t.identifier.value}-extension for the scheme ${i}`),console.error(l)});const c=s.onDidChangeFile(l=>{const u=[];for(const h of l){const{uri:f,type:p}=h;if(f.scheme!==i)continue;let g;switch(p){case il.Changed:g=0;break;case il.Created:g=1;break;case il.Deleted:g=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:g})}this.a.$onFileSystemChange(n,u)});return se(()=>{c.dispose(),this.b.delete(i),this.d.delete(i),this.c.delete(n),this.a.$unregisterProvider(n)})}static j(t){if(!t)throw new Error("MISSING provider");if(typeof t.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof t.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof t.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof t.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof t.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof t.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof t.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof t.rename!="function")throw new Error("Provider does NOT implement rename")}static k(t){const{type:i,ctime:s,mtime:r,size:n,permissions:o}=t;return{type:i,ctime:s,mtime:r,size:n,permissions:o}}$stat(t,i){return Promise.resolve(this.l(t).stat(y.revive(i))).then(s=>sx.k(s))}$readdir(t,i){return Promise.resolve(this.l(t).readDirectory(y.revive(i)))}$readFile(t,i){return Promise.resolve(this.l(t).readFile(y.revive(i))).then(s=>_.wrap(s))}$writeFile(t,i,s,r){return Promise.resolve(this.l(t).writeFile(y.revive(i),s.buffer,r))}$delete(t,i,s){return Promise.resolve(this.l(t).delete(y.revive(i),s))}$rename(t,i,s,r){return Promise.resolve(this.l(t).rename(y.revive(i),y.revive(s),r))}$copy(t,i,s,r){const n=this.l(t);if(!n.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(n.copy(y.revive(i),y.revive(s),r))}$mkdir(t,i){return Promise.resolve(this.l(t).createDirectory(y.revive(i)))}$watch(t,i,s,r){const n=this.l(t).watch(y.revive(s),r);this.f.set(i,n)}$unwatch(t,i){const s=this.f.get(i);s&&(s.dispose(),this.f.delete(i))}$open(t,i,s){const r=this.l(t);if(!r.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(r.open(y.revive(i),s))}$close(t,i){const s=this.l(t);if(!s.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(s.close(i))}$read(t,i,s,r){const n=this.l(t);if(!n.read)throw new Error('FileSystemProvider does not implement "read"');const o=_.alloc(r);return Promise.resolve(n.read(i,s,o.buffer,0,r)).then(a=>o.slice(0,a))}$write(t,i,s,r){const n=this.l(t);if(!n.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(n.write(i,s,r.buffer,0,r.byteLength))}l(t){const i=this.c.get(t);if(!i){const s=new Error;throw s.name="ENOPRO",s.message="no provider",s}return i}};function f3(e){return typeof e.correlationId=="number"}function sY(e){return e.recursive===!0}var p3=class wR extends J{static{this.a=5}constructor(t,i,s,r){super(),this.h=t,this.j=i,this.m=s,this.n=r,this.c=this.D(new Hs),this.f=void 0,this.g=0}r(){const t=new X;this.c.value=t,this.b=this.q(t),this.b.setVerboseLogging(this.m),t.add(this.b.onDidChangeFile(i=>this.h(i))),t.add(this.b.onDidLogMessage(i=>this.j(i))),t.add(this.b.onDidError(i=>this.s(i.error,i.request)))}s(t,i){this.t(t,i)?this.g<wR.a&&this.f?(this.w(`restarting watcher after unexpected error: ${t}`),this.u(this.f)):this.w(`gave up attempting to restart watcher after unexpected error: ${t}`):this.w(t)}t(t,i){return!(!this.n.restartOnError||i||t.indexOf("No space left on device")!==-1||t.indexOf("EMFILE")!==-1)}u(t){this.g++,this.r(),this.watch(t)}async watch(t){this.f=t,await this.b?.watch(t)}async setVerboseLogging(t){this.m=t,await this.b?.setVerboseLogging(t)}w(t){this.j({type:"error",message:`[File Watcher (${this.n.type})] ${t}`})}y(t){this.j({type:"trace",message:`[File Watcher (${this.n.type})] ${t}`})}dispose(){return this.b=void 0,super.dispose()}},rY=class extends p3{constructor(e,t,i){super(e,t,i,{type:"node.js",restartOnError:!1})}},nY=class extends p3{constructor(e,t,i){super(e,t,i,{type:"universal",restartOnError:!0})}};function g3(e){return e.map(t=>({type:t.type,resource:y.revive(t.resource),cId:t.cId}))}function oY(e){const t=new aY;for(const i of e)t.processEvent(i);return t.coalesce()}function m3(e,t){return typeof t=="string"&&!t.startsWith(ca)&&!Cs(t)?{base:e,pattern:t}:t}function v3(e,t,i){const s=[];for(const r of t)s.push(Xs(m3(e,r),{ignoreCase:i}));return s}var aY=class{constructor(){this.a=new Set,this.b=new Map}c(e){return Mt?e.resource.fsPath:e.resource.fsPath.toLowerCase()}processEvent(e){const t=this.b.get(this.c(e));let i=!1;if(t){const s=t.type,r=e.type;t.resource.fsPath!==e.resource.fsPath&&(e.type===2||e.type===1)?i=!0:s===1&&r===2?(this.b.delete(this.c(e)),this.a.delete(t)):s===2&&r===1?t.type=0:s===1&&r===0||(t.type=r)}else i=!0;i&&(this.a.add(e),this.b.set(this.c(e),e))}coalesce(){const e=[],t=[];return Array.from(this.a).filter(i=>i.type!==2?(e.push(i),!1):!0).sort((i,s)=>i.resource.fsPath.length-s.resource.fsPath.length).filter(i=>t.some(s=>iH(i.resource.fsPath,s,!Mt))?!1:(t.push(i.resource.fsPath),!0)).concat(e)}};function cY(e,t){if(typeof t=="number")switch(e.type){case 1:return(t&4)===0;case 2:return(t&8)===0;case 0:return(t&2)===0}return!1}function lY(e){if(typeof e=="number"){const t=[];return e&4&&t.push("Added"),e&8&&t.push("Deleted"),e&2&&t.push("Updated"),t.length===0?"<all>":`[${t.join(", ")}]`}return"<none>"}var uY=class{get ignoreCreateEvents(){return!!(this.h&1)}get ignoreChangeEvents(){return!!(this.h&2)}get ignoreDeleteEvents(){return!!(this.h&4)}constructor(e,t,i,s,r,n,o,a){this.a=Math.random(),this.b=new I,this.c=new I,this.d=new I,this.h=0,a.ignoreCreateEvents&&(this.h+=1),a.ignoreChangeEvents&&(this.h+=2),a.ignoreDeleteEvents&&(this.h+=4);const c=typeof o=="string"?!((i.getCapabilities(V.file)??0)&1024):i.extUri.ignorePathCasing(y.revive(o.baseUri)),l=Xs(o,{ignoreCase:c}),u=typeof o=="string",h=!1,f=n(p=>{if(!(typeof p.session=="number"&&p.session!==this.a)&&!(h&&typeof p.session>"u")){if(!a.ignoreCreateEvents)for(const g of p.created){const v=y.revive(g);l(v.fsPath)&&(!u||s.getWorkspaceFolder(v))&&this.b.fire(v)}if(!a.ignoreChangeEvents)for(const g of p.changed){const v=y.revive(g);l(v.fsPath)&&(!u||s.getWorkspaceFolder(v))&&this.c.fire(v)}if(!a.ignoreDeleteEvents)for(const g of p.deleted){const v=y.revive(g);l(v.fsPath)&&(!u||s.getWorkspaceFolder(v))&&this.d.fire(v)}}});this.g=Pe.from(this.i(e,s,t,r,o,a,!1),this.b,this.c,this.d,f)}i(e,t,i,s,r,n,o){const a=Pe.from();if(typeof r=="string"||n.ignoreChangeEvents&&n.ignoreCreateEvents&&n.ignoreDeleteEvents)return a;const c=e.getProxy(Q.MainThreadFileSystemEventService);let l=!1;(r.pattern.includes(ca)||r.pattern.includes($w))&&(l=!0);const u=[];let h,f;if(o)(n.ignoreChangeEvents||n.ignoreCreateEvents||n.ignoreDeleteEvents)&&(f=14,n.ignoreChangeEvents&&(f&=-3),n.ignoreCreateEvents&&(f&=-5),n.ignoreDeleteEvents&&(f&=-9));else if(l&&u.length===0){const p=t.getWorkspaceFolder(y.revive(r.baseUri)),g=i.getConfiguration("files",p).get("watcherExclude");if(g)for(const v in g)v&&g[v]===!0&&u.push(v)}else if(!l){const p=t.getWorkspaceFolder(y.revive(r.baseUri));if(p){const g=i.getConfiguration("files",p).get("watcherExclude");if(g){for(const v in g)if(v&&g[v]===!0){const b=`${Fn(v,"/")}/${ca}`;h||(h=[]),h.push(m3(p.uri.fsPath,b))}}if(!h||h.length===0)return a}}return c.$watch(s.identifier.value,this.a,r.baseUri,{recursive:l,excludes:u,includes:h,filter:f},!!o),Pe.from({dispose:()=>c.$unwatch(this.a)})}dispose(){this.g.dispose()}get onDidCreate(){return this.b.event}get onDidChange(){return this.c.event}get onDidDelete(){return this.d.event}},hY=class{get created(){return this.a.value}get changed(){return this.b.value}get deleted(){return this.c.value}constructor(e){this.d=e,this.a=new Rt(()=>this.d.created.map(y.revive)),this.b=new Rt(()=>this.d.changed.map(y.revive)),this.c=new Rt(()=>this.d.deleted.map(y.revive)),this.session=this.d.session}},dY=class{constructor(e,t,i){this.j=e,this.k=t,this.l=i,this.a=new I,this.b=new I,this.c=new I,this.d=new I,this.g=new uu,this.h=new uu,this.i=new uu,this.onDidRenameFile=this.b.event,this.onDidCreateFile=this.c.event,this.onDidDeleteFile=this.d.event}createFileSystemWatcher(e,t,i,s,r,n){return new uY(this.j,t,i,e,s,this.a.event,qi.from(r),n)}$onFileEvent(e){this.a.fire(new hY(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this.b.fire(Object.freeze({files:t.map(i=>({oldUri:y.revive(i.source),newUri:y.revive(i.target)}))}));break;case 1:this.d.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;case 0:case 3:this.c.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;default:}}getOnWillRenameFileEvent(e){return this.m(e,this.g)}getOnWillCreateFileEvent(e){return this.m(e,this.h)}getOnWillDeleteFileEvent(e){return this.m(e,this.i)}m(e,t){return(i,s,r)=>{const n=function(a){i.call(s,a)};return n.extension=e,t.event(n,void 0,r)}}async $onWillRunFileOperation(e,t,i,s){switch(e){case 2:return await this.n(this.g,{files:t.map(r=>({oldUri:y.revive(r.source),newUri:y.revive(r.target)}))},i,s);case 1:return await this.n(this.i,{files:t.map(r=>y.revive(r.target))},i,s);case 0:case 3:return await this.n(this.h,{files:t.map(r=>y.revive(r.target))},i,s)}}async n(e,t,i,s){const r=new Set,n=[];if(await e.fireAsync(t,s,async(a,c)=>{const l=Date.now(),u=await Promise.resolve(a);u instanceof va&&(n.push([c.extension,u]),r.add(c.extension.displayName??c.extension.identifier.value)),Date.now()-l>i&&this.k.warn("SLOW file-participant",c.extension.identifier)}),s.isCancellationRequested||n.length===0)return;const o={edits:[]};for(const[,a]of n){const{edits:c}=as.from(a,{getTextDocumentVersion:l=>this.l.getDocument(l)?.version,getNotebookDocumentVersion:()=>{}});o.edits=o.edits.concat(c)}return{edit:o,extensionNames:Array.from(r)}}},fY=class{constructor(e,t,i,s,r){this.a=t,this.b=i,this.c=s;const n=new Se("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new q("showOptions","Show Options",o=>!0,o=>o),new q("resource","Interactive resource Uri",o=>!0,o=>o),new q("controllerId","Notebook controller Id",o=>!0,o=>o),new q("title","Interactive editor title",o=>!0,o=>o)],new ye("Notebook and input URI",o=>{if(r.debug("[ExtHostInteractive] open iw with notebook editor id",o.notebookEditorId),o.notebookEditorId!==void 0){const a=this.a.getEditorById(o.notebookEditorId);return r.debug("[ExtHostInteractive] notebook editor found",a.id),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri),notebookEditor:a.apiEditor}}return r.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",o.notebookUri,o.inputUri),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri)}}));this.c.registerApiCommand(n)}$willAddInteractiveDocument(e,t,i,s){this.b.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,t){this.b.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}},pY=class{constructor(e){this.b=0,this.a=e.getProxy(Q.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this.b++;return this.a.$registerResourceLabelFormatter(t,e),se(()=>{this.a.$unregisterResourceLabelFormatter(t)})}},w3;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(w3||(w3={}));var gY=class Fs extends ot{constructor(t,i,s,r){super(t,i,s,r),this.selectionStartLineNumber=t,this.selectionStartColumn=i,this.positionLineNumber=s,this.positionColumn=r}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(t){return Fs.selectionsEqual(this,t)}static selectionsEqual(t,i){return t.selectionStartLineNumber===i.selectionStartLineNumber&&t.selectionStartColumn===i.selectionStartColumn&&t.positionLineNumber===i.positionLineNumber&&t.positionColumn===i.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(t,i){return this.getDirection()===0?new Fs(this.startLineNumber,this.startColumn,t,i):new Fs(t,i,this.startLineNumber,this.startColumn)}getPosition(){return new ws(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new ws(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,i){return this.getDirection()===0?new Fs(t,i,this.endLineNumber,this.endColumn):new Fs(this.endLineNumber,this.endColumn,t,i)}static fromPositions(t,i=t){return new Fs(t.lineNumber,t.column,i.lineNumber,i.column)}static fromRange(t,i){return i===0?new Fs(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new Fs(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new Fs(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(t,i){if(t&&!i||!t&&i)return!1;if(!t&&!i)return!0;if(t.length!==i.length)return!1;for(let s=0,r=t.length;s<r;s++)if(!this.selectionsEqual(t[s],i[s]))return!1;return!0}static isISelection(t){return!!t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(t,i,s,r,n){return n===0?new Fs(t,i,s,r):new Fs(s,r,t,i)}},b3=class bR{constructor(t,i){this.d=t,this.f=i}async provideDocumentSymbols(t,i){const s=this.d.getDocument(t),r=await this.f.provideDocumentSymbols(s,i);if(!P1(r))return r[0]instanceof ih?r.map(hy.from):bR.g(r)}static g(t){t=t.slice(0).sort((r,n)=>{let o=r.location.range.start.compareTo(n.location.range.start);return o===0&&(o=n.location.range.end.compareTo(r.location.range.end)),o});const i=[],s=[];for(const r of t){const n={name:r.name||"!!MISSING: name!!",kind:Ps.from(r.kind),tags:r.tags?.map(ln.from)||[],detail:"",containerName:r.containerName,range:U.from(r.location.range),selectionRange:U.from(r.location.range),children:[]};for(;;){if(s.length===0){s.push(n),i.push(n);break}const o=s[s.length-1];if(ot.containsRange(o.range,n.range)&&!ot.equalsRange(o.range,n.range)){o.children?.push(n),s.push(n);break}s.pop()}}return i}},wv=class{constructor(e,t,i,s,r,n){this.g=e,this.h=t,this.j=i,this.k=s,this.l=r,this.m=n,this.d=new cr("CodeLens"),this.f=new Map}async provideCodeLenses(e,t){const i=this.g.getDocument(e),s=await this.j.provideCodeLenses(i,t);if(!s||t.isCancellationRequested)return;const r=this.d.add(s),n=new X;this.f.set(r,n);const o={cacheId:r,lenses:[]};for(let a=0;a<s.length;a++){if(!ke.isRange(s[a].range)){console.warn("INVALID code lens, range is not defined",this.k.identifier.value);continue}o.lenses.push({cacheId:[r,a],range:U.from(s[a].range),command:this.h.toInternal(s[a].command,n)})}return o}async resolveCodeLens(e,t){const i=e.cacheId&&this.d.get(...e.cacheId);if(!i)return;let s;if(typeof this.j.resolveCodeLens!="function"||i.isResolved?s=i:s=await this.j.resolveCodeLens(i,t),s||(s=i),t.isCancellationRequested)return;const r=e.cacheId&&this.f.get(e.cacheId[0]);if(r){if(!s.command){const n=new Error("INVALID code lens resolved, lacks command: "+this.k.identifier.value);this.l.onExtensionError(this.k.identifier,n),this.m.error(n);return}return e.command=this.h.toInternal(s.command,r),e}}releaseCodeLenses(e){this.f.get(e)?.dispose(),this.f.delete(e),this.d.delete(e)}};function bv(e){return Array.isArray(e)?e.map(Th.from):e?[Th.from(e)]:[]}var y3=class{constructor(e,t){this.d=e,this.f=t}async provideDefinition(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideDefinition(s,r,i);return bv(n)}},A3=class{constructor(e,t){this.d=e,this.f=t}async provideDeclaration(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideDeclaration(s,r,i);return bv(n)}},S3=class{constructor(e,t){this.d=e,this.f=t}async provideImplementation(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideImplementation(s,r,i);return bv(n)}},E3=class{constructor(e,t){this.d=e,this.f=t}async provideTypeDefinition(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideTypeDefinition(s,r,i);return bv(n)}},oS=class yR{static{this.g=10}constructor(t,i){this.h=t,this.j=i,this.d=0,this.f=new Map}async provideHover(t,i,s,r){const n=this.h.getDocument(t),o=et.to(i);let a;if(s&&s.verbosityRequest){const h=s.verbosityRequest.previousHover.id,f=this.f.get(h);if(!f)throw new Error(`Hover with id ${h} not found`);const p={verbosityDelta:s.verbosityRequest.verbosityDelta,previousHover:f};a=await this.j.provideHover(n,o,r,p)}else a=await this.j.provideHover(n,o,r);if(!a||P1(a.contents))return;a.range||(a.range=n.getWordRangeAtPosition(o)),a.range||(a.range=new ke(o,o));const c=Mh.from(a),l=this.d;if(this.f.size===yR.g){const h=Math.min(...this.f.keys());this.f.delete(h)}return this.f.set(l,a),this.d+=1,{...c,id:l}}releaseHover(t){this.f.delete(t)}},x3=class{constructor(e,t){this.d=e,this.f=t}async provideEvaluatableExpression(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideEvaluatableExpression(s,r,i);if(n)return py.from(n)}},C3=class{constructor(e,t){this.d=e,this.f=t}async provideInlineValues(e,t,i,s){const r=this.d.getDocument(e),n=await this.f.provideInlineValues(r,U.to(t),Ng.to(i),s);if(Array.isArray(n))return n.map(o=>Mg.from(o))}},k3=class{constructor(e,t){this.d=e,this.f=t}async provideDocumentHighlights(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideDocumentHighlights(s,r,i);if(Array.isArray(n))return n.map(hl.from)}},$3=class{constructor(e,t,i){this.d=e,this.f=t,this.g=i}async provideMultiDocumentHighlights(e,t,i,s){const r=this.d.getDocument(e),n=i.map(c=>{try{return this.d.getDocument(c)}catch(l){this.g.error("Error: Unable to retrieve document from URI: "+c+". Error message: "+l);return}}).filter(c=>c!==void 0),o=et.to(t),a=await this.f.provideMultiDocumentHighlights(r,o,n,s);if(Array.isArray(a))return a.map(gy.from)}},I3=class{constructor(e,t){this.d=e,this.f=t}async provideLinkedEditingRanges(e,t,i){const s=this.d.getDocument(e),r=et.to(t),n=await this.f.provideLinkedEditingRanges(s,r,i);if(n&&Array.isArray(n.ranges))return{ranges:yt(n.ranges.map(U.from)),wordPattern:n.wordPattern}}},D3=class{constructor(e,t){this.d=e,this.f=t}async provideReferences(e,t,i,s){const r=this.d.getDocument(e),n=et.to(t),o=await this.f.provideReferences(r,n,i,s);if(Array.isArray(o))return o.map(Bi.from)}},yv=class m1{static{this.d=1e3}constructor(t,i,s,r,n,o,a){this.h=t,this.j=i,this.k=s,this.l=r,this.m=n,this.n=o,this.o=a,this.f=new cr("CodeAction"),this.g=new Map}async provideCodeActions(t,i,s,r){const n=this.h.getDocument(t),o=gY.isISelection(i)?sr.to(i):U.to(i),a=[];for(const p of this.k.getDiagnostics(t))if(o.intersection(p.range)&&a.push(p)>m1.d)break;const c={diagnostics:a,only:s.only?new Pt(s.only):void 0,triggerKind:Dy.to(s.trigger)},l=await this.l.provideCodeActions(n,o,c,r);if(!au(l)||r.isCancellationRequested)return;const u=this.f.add(l),h=new X;this.g.set(u,h);const f=[];for(let p=0;p<l.length;p++){const g=l[p];if(g)if(m1.p(g)&&!(g instanceof rh))this.o.report("CodeActionProvider.provideCodeActions - return commands",this.n,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:g.title,command:this.j.toInternal(g,h)});else{const v=g;c.only&&(v.kind?c.only.contains(v.kind)||this.m.warn(`${this.n.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action is of kind '${v.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this.m.warn(`${this.n.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const b=v.ranges??[];f.push({cacheId:[u,p],title:v.title,command:v.command&&this.j.toInternal(v.command,h),diagnostics:v.diagnostics&&v.diagnostics.map(Ia.from),edit:v.edit&&as.from(v.edit,void 0),kind:v.kind&&v.kind.value,isPreferred:v.isPreferred,isAI:qe(this.n,"codeActionAI")?v.isAI:!1,ranges:qe(this.n,"codeActionRanges")?yt(b.map(U.from)):void 0,disabled:v.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(t,i){const[s,r]=t,n=this.f.get(s,r);if(!n||m1.p(n))return{};if(!this.l.resolveCodeAction)return{};const o=await this.l.resolveCodeAction(n,i)??n;let a;o.edit&&(a=as.from(o.edit,void 0));let c;if(o.command){const l=this.g.get(s);l&&(c=this.j.toInternal(o.command,l))}return{edit:a,command:c}}releaseCodeActions(t){this.g.get(t)?.dispose(),this.g.delete(t),this.f.delete(t)}static p(t){return typeof t.command=="string"&&typeof t.title=="string"}},md=class{constructor(e,t,i,s,r){this.g=e,this.h=t,this.j=i,this.k=s,this.l=r,this.f=new cr("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,t,i,s){if(!this.j.prepareDocumentPaste)return;this.d=void 0;const r=this.h.getDocument(e),n=t.map(u=>U.to(u)),o=yl.toDataTransfer(i,()=>{throw new vL});if(await this.j.prepareDocumentPaste(r,n,o,s),s.isCancellationRequested)return;const a=Array.from(o).filter(([,u])=>!(u instanceof Jp)),c=new Map,l=await Promise.all(Array.from(a,async([u,h])=>{const f=At();return c.set(f,h),[u,await Na.from(u,h,f)]}));return this.d=c,{items:l}}async providePasteEdits(e,t,i,s,r,n){if(!this.j.provideDocumentPasteEdits)return[];const o=this.h.getDocument(t),a=i.map(f=>U.to(f)),c=s.items.map(([f,p])=>{const g=this.d?.get(p.id);return g?[f,g]:[f,Na.to(f,p,async v=>(await this.g.$resolvePasteFileData(this.k,e,v)).buffer)]}),l=new Yc(c),u=await this.j.provideDocumentPasteEdits(o,a,l,{only:r.only?new po(r.only):void 0,triggerKind:r.triggerKind},n);if(!u||n.isCancellationRequested)return[];const h=this.f.add(u);return u.map((f,p)=>({_cacheId:[h,p],title:f.title??d(3041,null,this.l.displayName||this.l.name),kind:f.kind,yieldTo:f.yieldTo?.map(g=>g.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?as.from(f.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,t){const[i,s]=e,r=this.f.get(i,s);if(!r||!this.j.resolveDocumentPasteEdit)return{};const n=await this.j.resolveDocumentPasteEdit(r,t)??r;return{insertText:n.insertText,additionalEdit:n.additionalEdit?as.from(n.additionalEdit,void 0):void 0}}releasePasteEdits(e){this.f.delete(e)}},P3=class{constructor(e,t){this.d=e,this.f=t}async provideDocumentFormattingEdits(e,t,i){const s=this.d.getDocument(e),r=await this.f.provideDocumentFormattingEdits(s,t,i);if(Array.isArray(r))return r.map(ri.from)}},aS=class{constructor(e,t){this.d=e,this.f=t}async provideDocumentRangeFormattingEdits(e,t,i,s){const r=this.d.getDocument(e),n=U.to(t),o=await this.f.provideDocumentRangeFormattingEdits(r,n,i,s);if(Array.isArray(o))return o.map(ri.from)}async provideDocumentRangesFormattingEdits(e,t,i,s){R1(typeof this.f.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const r=this.d.getDocument(e),n=t.map(U.to),o=await this.f.provideDocumentRangesFormattingEdits(r,n,i,s);if(Array.isArray(o))return o.map(ri.from)}},T3=class{constructor(e,t){this.d=e,this.f=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,s,r){const n=this.d.getDocument(e),o=et.to(t),a=await this.f.provideOnTypeFormattingEdits(n,o,i,s,r);if(Array.isArray(a))return a.map(ri.from)}},Av=class{constructor(e,t){this.f=e,this.g=t,this.d=new cr("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this.f.provideWorkspaceSymbols(e,t);if(!au(i))return{symbols:[]};const s=this.d.add(i),r={cacheId:s,symbols:[]};for(let n=0;n<i.length;n++){const o=i[n];if(!o||!o.name){this.g.warn("INVALID SymbolInformation",o);continue}r.symbols.push({...Da.from(o),cacheId:[s,n]})}return r}async resolveWorkspaceSymbol(e,t){if(typeof this.f.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this.d.get(...e.cacheId);if(i){const s=await this.f.resolveWorkspaceSymbol(i,t);return s&&Xr(e,Da.from(s),!0)}}releaseWorkspaceSymbols(e){this.d.delete(e)}},Sv=class rx{static supportsResolving(t){return typeof t.prepareRename=="function"}constructor(t,i,s){this.d=t,this.f=i,this.g=s}async provideRenameEdits(t,i,s,r){const n=this.d.getDocument(t),o=et.to(i);try{const a=await this.f.provideRenameEdits(n,o,s,r);return a?as.from(a):void 0}catch(a){const c=rx.h(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(t,i,s){if(typeof this.f.prepareRename!="function")return Promise.resolve(void 0);const r=this.d.getDocument(t),n=et.to(i);try{const o=await this.f.prepareRename(r,n,s);let a,c;if(ke.isRange(o)?(a=o,c=r.getText(o)):kt(o)&&(a=o.range,c=o.placeholder),!a||!c)return;if(a.start.line>n.line||a.end.line<n.line){this.g.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:U.from(a),text:c}}catch(o){const a=rx.h(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static h(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},cS=class nx{static{this.d={[_f.Invoke]:gh.Invoke,[_f.Automatic]:gh.Automatic}}constructor(t,i,s){this.f=t,this.g=i,this.h=s}async supportsAutomaticNewSymbolNamesTriggerKind(){return this.g.supportsAutomaticTriggerKind}async provideNewSymbolNames(t,i,s,r){const n=this.f.getDocument(t),o=U.to(i);try{const a=nx.d[s],c=await this.g.provideNewSymbolNames(n,o,a,r);return c?c.map(l=>typeof l=="string"?{newSymbolName:l}:{newSymbolName:l.newSymbolName,tags:l.tags}):void 0}catch(a){this.h.error(nx.j(a)??JSON.stringify(a,null,"	"));return}}static j(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},lS=class{constructor(e,t){this.resultId=e,this.tokens=t}},uS=class fr{constructor(t,i){this.g=t,this.h=i,this.f=1,this.d=new Map}async provideDocumentSemanticTokens(t,i,s){const r=this.g.getDocument(t),n=i!==0?this.d.get(i):null;let o=typeof n?.resultId=="string"&&typeof this.h.provideDocumentSemanticTokensEdits=="function"?await this.h.provideDocumentSemanticTokensEdits(r,n.resultId,s):await this.h.provideDocumentSemanticTokens(r,s);return n&&this.d.delete(i),o?(o=fr.j(o),this.p(fr.o(n,o),o)):null}async releaseDocumentSemanticColoring(t){this.d.delete(t)}static j(t){return fr.k(t)?fr.l(t)?t:new sl(new Uint32Array(t.data),t.resultId):fr.m(t)?fr.n(t)?t:new eg(t.edits.map(i=>new WD(i.start,i.deleteCount,i.data?new Uint32Array(i.data):i.data)),t.resultId):t}static k(t){return t&&!!t.data}static l(t){return t.data instanceof Uint32Array}static m(t){return t&&Array.isArray(t.edits)}static n(t){for(const i of t.edits)if(!(i.data instanceof Uint32Array))return!1;return!0}static o(t,i){if(!fr.k(i)||!t||!t.tokens)return i;const s=t.tokens,r=s.length,n=i.data,o=n.length;let a=0;const c=Math.min(r,o);for(;a<c&&s[a]===n[a];)a++;if(a===r&&a===o)return new eg([],i.resultId);let l=0;const u=c-a;for(;l<u&&s[r-l-1]===n[o-l-1];)l++;return new eg([{start:a,deleteCount:r-a-l,data:n.subarray(a,o-l)}],i.resultId)}p(t,i){if(fr.k(t)){const s=this.f++;return this.d.set(s,new lS(t.resultId,t.data)),X4({id:s,type:"full",data:t.data})}if(fr.m(t)){const s=this.f++;return fr.k(i)?this.d.set(s,new lS(i.resultId,i.data)):this.d.set(s,new lS(t.resultId)),X4({id:s,type:"delta",deltas:(t.edits||[]).map(r=>({start:r.start,deleteCount:r.deleteCount,data:r.data}))})}return null}},M3=class{constructor(e,t){this.d=e,this.f=t}async provideDocumentRangeSemanticTokens(e,t,i){const s=this.d.getDocument(e),r=await this.f.provideDocumentRangeSemanticTokens(s,U.to(t),i);return r?this.g(r):null}g(e){return X4({id:0,type:"full",data:e.data})}},vd=class AR{static supportsResolving(t){return typeof t.resolveCompletionItem=="function"}constructor(t,i,s,r,n){this.g=t,this.h=i,this.j=s,this.k=r,this.l=n,this.d=new cr("CompletionItem"),this.f=new Map}async provideCompletionItems(t,i,s,r){const n=this.g.getDocument(t),o=et.to(i),a=n.getWordRangeAtPosition(o)||new ke(o,o),c=a.with({end:o}),l=new Qi,u=await this.j.provideCompletionItems(n,o,r,vy.to(s));if(!u||r.isCancellationRequested)return;const h=Array.isArray(u)?new zc(u):u,f=AR.supportsResolving(this.j)?this.d.add(h.items):this.d.add([]),p=new X;this.f.set(f,p);const g=[],v={x:f,b:g,a:{replace:U.from(a),insert:U.from(c)},c:h.isIncomplete||void 0,d:l.elapsed()};for(let b=0;b<h.items.length;b++){const S=h.items[b],E=this.m(S,[f,b],c,a);g.push(E)}return v}async resolveCompletionItem(t,i){if(typeof this.j.resolveCompletionItem!="function")return;const s=this.d.get(...t);if(!s)return;const r=this.m(s,t),n=await this.j.resolveCompletionItem(s,i);if(!n)return;const o=this.m(n,t);return(r.h!==o.h||r.i!==o.i)&&this.k.report("CompletionItem.insertText",this.l,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(r.n!==o.n||r.o!==o.o||!Ai(r.p,o.p))&&this.k.report("CompletionItem.command",this.l,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...r,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(t){this.f.get(t)?.dispose(),this.f.delete(t),this.d.delete(t)}m(t,i,s,r){const n=this.f.get(i[0]);if(!n)throw Error("DisposableStore is missing...");const o=this.h.toInternal(t.command,n),a={x:i,a:t.label,b:t.kind!==void 0?Lg.from(t.kind):void 0,m:t.tags&&t.tags.map(Rg.from),c:t.detail,d:typeof t.documentation>"u"?void 0:le.fromStrict(t.documentation),e:t.sortText!==t.label?t.sortText:void 0,f:t.filterText!==t.label?t.filterText:void 0,g:t.preselect||void 0,i:t.keepWhitespace?1:0,k:t.commitCharacters?.join(""),l:t.additionalTextEdits&&t.additionalTextEdits.map(ri.from),n:o?.$ident,o:o?.id,p:o?.$ident?void 0:o?.arguments};t.textEdit?(this.k.report("CompletionItem.textEdit",this.l,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=t.textEdit.newText):typeof t.insertText=="string"?a.h=t.insertText:t.insertText instanceof ga&&(a.h=t.insertText.value,a.i|=4);let c;return t.textEdit?c=t.textEdit.range:t.range&&(c=t.range),ke.isRange(c)?a.j=U.from(c):c&&(!s?.isEqual(c.inserting)||!r?.isEqual(c.replacing))&&(a.j={insert:U.from(c.inserting),replace:U.from(c.replacing)}),a}},ko=class{constructor(e,t,i,s){this.g=e,this.h=t,this.j=i,this.k=s,this.d=new mY,this.l={[Hf.Automatic]:ph.Automatic,[Hf.Explicit]:ph.Invoke},this.f=qe(this.g,"inlineCompletionsAdditions")}get supportsHandleEvents(){return qe(this.g,"inlineCompletionsAdditions")&&(typeof this.j.handleDidShowCompletionItem=="function"||typeof this.j.handleDidPartiallyAcceptCompletionItem=="function"||typeof this.j.handleDidRejectCompletionItem=="function"||typeof this.j.handleEndOfLifetime=="function")}get supportsSetModelId(){return qe(this.g,"inlineCompletionsAdditions")&&typeof this.j.setCurrentModelId=="function"}get modelInfo(){if(this.f)return this.j.modelInfo?{models:this.j.modelInfo.models,currentModelId:this.j.modelInfo.currentModelId}:void 0}setCurrentModelId(e){this.f&&this.j.setCurrentModelId?.(e)}async provideInlineCompletions(e,t,i,s){const r=this.h.getDocument(e),n=et.to(t),o=await this.j.provideInlineCompletionItems(r,n,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:U.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.l[i.triggerKind],requestUuid:i.requestUuid,requestIssuedDateTime:i.requestIssuedDateTime,earliestShownDateTime:i.earliestShownDateTime,changeHint:i.changeHint},s);if(!o)return;const{resultItems:a,list:c}=Array.isArray(o)?{resultItems:o,list:void 0}:{resultItems:o.items,list:o},l=this.f?Array.isArray(o)?[]:o.commands||[]:[],u=this.f&&!Array.isArray(o)?o.enableForwardStability:void 0;let h;return{pid:this.d.createReferenceId({dispose(){h?.dispose()},items:a,list:c}),languageId:r.languageId,items:a.map((g,v)=>{let b;g.command&&(h||(h=new X),b=this.k.toInternal(g.command,h));let S;g.action&&(h||(h=new X),S=this.k.toInternal(g.action,h));const E=g.insertText;return{insertText:E===void 0?void 0:typeof E=="string"?E:{snippet:E.value},range:g.range?U.from(g.range):void 0,showRange:this.f&&g.showRange?U.from(g.showRange):void 0,command:b,gutterMenuLinkAction:S,idx:v,completeBracketPairs:this.f?g.completeBracketPairs:!1,isInlineEdit:this.f?g.isInlineEdit:!1,showInlineEditMenu:this.f?g.showInlineEditMenu:!1,hint:g.displayLocation&&this.f?{range:U.from(g.displayLocation.range),content:g.displayLocation.label,style:g.displayLocation.kind?By.from(g.displayLocation.kind):Ac.Code}:void 0,warning:g.warning&&this.f?{message:le.from(g.warning.message),icon:g.warning.icon?un.fromThemeIcon(g.warning.icon):void 0}:void 0,correlationId:this.f?g.correlationId:void 0,suggestionId:void 0,uri:this.f&&g.uri?g.uri:void 0,supportsRename:this.f?g.supportsRename:!1,jumpToPosition:this.f&&g.jumpToPosition?et.from(g.jumpToPosition):void 0}}),commands:l.map(g=>(h||(h=new X),wy.from(g,this.k,h))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e,t){const i=this.d.get(e);if(this.j.handleListEndOfLifetime&&this.f&&i?.list){let n=function(o){switch(o.kind){case"lostRace":return{kind:on.LostRace};case"tokenCancellation":return{kind:on.TokenCancellation};case"other":return{kind:on.Other};case"empty":return{kind:on.Empty};case"notTaken":return{kind:on.NotTaken};default:return{kind:on.Other}}};var s=n;this.j.handleListEndOfLifetime(i.list,n(t))}this.d.disposeReferenceId(e)?.dispose()}handleDidShowCompletionItem(e,t,i){const s=this.d.get(e)?.items[t];s&&this.j.handleDidShowCompletionItem&&this.f&&this.j.handleDidShowCompletionItem(s,i)}handlePartialAccept(e,t,i,s){const r=this.d.get(e)?.items[t];r&&this.j.handleDidPartiallyAcceptCompletionItem&&this.f&&(this.j.handleDidPartiallyAcceptCompletionItem(r,i),this.j.handleDidPartiallyAcceptCompletionItem(r,Hy.to(s)))}handleEndOfLifetime(e,t,i){const s=this.d.get(e)?.items[t];if(s&&this.j.handleEndOfLifetime&&this.f){const r=_y.to(i,n=>this.d.get(n.pid)?.items[n.idx]);this.j.handleEndOfLifetime(s,r)}}handleRejection(e,t){const i=this.d.get(e)?.items[t];i&&this.j.handleDidRejectCompletionItem&&this.f&&this.j.handleDidRejectCompletionItem(i)}},mY=class{constructor(){this.d=new Map,this.f=1}createReferenceId(e){const t=this.f++;return this.d.set(t,e),t}disposeReferenceId(e){const t=this.d.get(e);return this.d.delete(e),t}get(e){return this.d.get(e)}},hS=class{constructor(e,t){this.f=e,this.g=t,this.d=new cr("SignatureHelp")}async provideSignatureHelp(e,t,i,s){const r=this.f.getDocument(e),n=et.to(t),o=this.h(i),a=await this.g.provideSignatureHelp(r,n,s,o);if(a){const c=this.d.add([a]);return{...Nh.from(a),id:c}}}h(e){let t;if(e.activeSignatureHelp){const i=Nh.to(e.activeSignatureHelp),s=this.d.get(e.activeSignatureHelp.id,0);s?(t=s,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this.d.delete(e)}},Ev=class{constructor(e,t,i,s,r){this.g=e,this.h=t,this.j=i,this.k=s,this.l=r,this.d=new cr("InlayHints"),this.f=new Map}async provideInlayHints(e,t,i){const s=this.g.getDocument(e),r=U.to(t),n=await this.j.provideInlayHints(s,r,i);if(!Array.isArray(n)||n.length===0){this.k.trace(`[InlayHints] NO inlay hints from '${this.l.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const o=this.d.add(n);this.f.set(o,new X);const a={hints:[],cacheId:o};for(let c=0;c<n.length;c++)this.m(n[c],r)&&a.hints.push(this.n(n[c],[o,c]));return this.k.trace(`[InlayHints] ${a.hints.length} inlay hints from '${this.l.identifier.value}' for range ${JSON.stringify(t)}`),a}async resolveInlayHint(e,t){if(typeof this.j.resolveInlayHint!="function")return;const i=this.d.get(...e);if(!i)return;const s=await this.j.resolveInlayHint(i,t);if(s&&this.m(s))return this.n(s,e)}releaseHints(e){this.f.get(e)?.dispose(),this.f.delete(e),this.d.delete(e)}m(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}n(e,t){const i=this.f.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const s={label:"",cacheId:t,tooltip:le.fromStrict(e.tooltip),position:et.from(e.position),textEdits:e.textEdits&&e.textEdits.map(ri.from),kind:e.kind&&jg.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")s.label=e.label;else{const r=[];s.label=r;for(const n of e.label){if(!n.value){console.warn("INVALID inlay hint, empty label part",this.l.identifier.value);continue}const o={label:n.value,tooltip:le.fromStrict(n.tooltip)};ns.isLocation(n.location)&&(o.location=Bi.from(n.location)),n.command&&(o.command=this.h.toInternal(n.command,i)),r.push(o)}}return s}},xv=class v1{constructor(t,i){this.f=t,this.g=i,this.d=new cr("DocumentLink")}async provideLinks(t,i){const s=this.f.getDocument(t),r=await this.g.provideDocumentLinks(s,i);if(!(!Array.isArray(r)||r.length===0)&&!i.isCancellationRequested){if(typeof this.g.resolveDocumentLink!="function")return{links:r.filter(v1.h).map(Ta.from)};{const n=this.d.add(r),o={links:[],cacheId:n};for(let a=0;a<r.length;a++){if(!v1.h(r[a]))continue;const c=Ta.from(r[a]);c.cacheId=[n,a],o.links.push(c)}return o}}}static h(t){return t.target&&t.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(t,i){if(typeof this.g.resolveDocumentLink!="function")return;const s=this.d.get(...t);if(!s)return;const r=await this.g.resolveDocumentLink(s,i);if(!(!r||!v1.h(r)))return Ta.from(r)}releaseLinks(t){this.d.delete(t)}},dS=class{constructor(e,t){this.d=e,this.f=t}async provideColors(e,t){const i=this.d.getDocument(e),s=await this.f.provideDocumentColors(i,t);return Array.isArray(s)?s.map(n=>({color:dl.from(n.color),range:U.from(n.range)})):[]}async provideColorPresentations(e,t,i){const s=this.d.getDocument(e),r=U.to(t.range),n=dl.to(t.color),o=await this.f.provideColorPresentations(n,{document:s,range:r},i);if(Array.isArray(o))return o.map(Ug.from)}},N3=class{constructor(e,t){this.d=e,this.f=t}async provideFoldingRanges(e,t,i){const s=this.d.getDocument(e),r=await this.f.provideFoldingRanges(s,t,i);if(Array.isArray(r))return r.map(Wg.from)}},R3=class{constructor(e,t,i){this.d=e,this.f=t,this.g=i}async provideSelectionRanges(e,t,i){const s=this.d.getDocument(e),r=t.map(et.to),n=await this.f.provideSelectionRanges(s,r,i);if(!au(n))return[];if(n.length!==r.length)return this.g.warn("BAD selection ranges, provider must return ranges for each position"),[];const o=[];for(let a=0;a<r.length;a++){const c=[];o.push(c);let l=r[a],u=n[a];for(;;){if(!u.range.contains(l))throw new Error("INVALID selection range, must contain the previous range");if(c.push(Sy.from(u)),!u.parent)break;l=u.range,u=u.parent}}return o}},wd=class{constructor(e,t){this.g=e,this.h=t,this.d=new jm(""),this.f=new Map}async prepareSession(e,t,i){const s=this.g.getDocument(e),r=et.to(t),n=await this.h.prepareCallHierarchy(s,r,i);if(!n)return;const o=this.d.nextId();return this.f.set(o,new Map),Array.isArray(n)?n.map(a=>this.j(o,a)):[this.j(o,n)]}async provideCallsTo(e,t,i){const s=this.k(e,t);if(!s)throw new Error("missing call hierarchy item");const r=await this.h.provideCallHierarchyIncomingCalls(s,i);if(r)return r.map(n=>({from:this.j(e,n.from),fromRanges:n.fromRanges.map(o=>U.from(o))}))}async provideCallsFrom(e,t,i){const s=this.k(e,t);if(!s)throw new Error("missing call hierarchy item");const r=await this.h.provideCallHierarchyOutgoingCalls(s,i);if(r)return r.map(n=>({to:this.j(e,n.to),fromRanges:n.fromRanges.map(o=>U.from(o))}))}releaseSession(e){this.f.delete(e)}j(e,t){const i=this.f.get(e),s=Pa.from(t,e,i.size.toString(36));return i.set(s._itemId,t),s}k(e,t){return this.f.get(e)?.get(t)}},bd=class{constructor(e,t){this.g=e,this.h=t,this.d=new jm(""),this.f=new Map}async prepareSession(e,t,i){const s=this.g.getDocument(e),r=et.to(t),n=await this.h.prepareTypeHierarchy(s,r,i);if(!n)return;const o=this.d.nextId();return this.f.set(o,new Map),Array.isArray(n)?n.map(a=>this.j(o,a)):[this.j(o,n)]}async provideSupertypes(e,t,i){const s=this.k(e,t);if(!s)throw new Error("missing type hierarchy item");const r=await this.h.provideTypeHierarchySupertypes(s,i);if(r)return r.map(n=>this.j(e,n))}async provideSubtypes(e,t,i){const s=this.k(e,t);if(!s)throw new Error("missing type hierarchy item");const r=await this.h.provideTypeHierarchySubtypes(s,i);if(r)return r.map(n=>this.j(e,n))}releaseSession(e){this.f.delete(e)}j(e,t){const i=this.f.get(e),s=Ma.from(t,e,i.size.toString(36));return i.set(s._itemId,t),s}k(e,t){return this.f.get(e)?.get(t)}},Cv=class{constructor(e,t,i,s,r){this.f=e,this.g=t,this.h=i,this.j=s,this.k=r,this.d=new cr("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,s,r){const n=this.g.getDocument(t),o=et.to(i),a=yl.toDataTransfer(s,async h=>(await this.f.$resolveDocumentOnDropFileData(this.j,e,h)).buffer),c=await this.h.provideDocumentDropEdits(n,o,a,r);if(!c)return;const l=Es(c),u=this.d.add(l);return l.map((h,f)=>({_cacheId:[u,f],title:h.title??d(3042,null,this.k.displayName||this.k.name),kind:h.kind?.value,yieldTo:h.yieldTo?.map(p=>p.value),insertText:typeof h.insertText=="string"?h.insertText:{snippet:h.insertText.value},additionalEdit:h.additionalEdit?as.from(h.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,t){const[i,s]=e,r=this.d.get(i,s);if(!r||!this.h.resolveDocumentDropEdit)return{};const n=await this.h.resolveDocumentDropEdit(r,t)??r;return{additionalEdit:n.additionalEdit?as.from(n.additionalEdit,void 0):void 0}}releaseDropEdits(e){this.d.delete(e)}},yd=class{constructor(e,t){this.adapter=e,this.extension=t}},vY=class li extends J{static{this.f=0}get inlineCompletionsUnificationState(){return this.j}constructor(t,i,s,r,n,o,a,c){super(),this.n=i,this.q=s,this.s=r,this.t=n,this.u=o,this.w=a,this.y=c,this.h=new Map,this.m=this.D(new I),this.onDidChangeInlineCompletionsUnificationState=this.m.event,this.g=t.getProxy(Q.MainThreadLanguageFeatures),this.j={codeUnification:!1,modelUnification:!1,extensionUnification:!1,expAssignments:[]}}z(t,i){return $a.from(t,this.n,i)}C(t){return new Pe(()=>{this.h.delete(t),this.g.$unregister(t)})}F(){return li.f++}async G(t,i,s,r,n,o=!1){const a=this.h.get(t);if(!a||!(a.adapter instanceof i))return r;const c=Date.now();o||this.u.trace(`[${a.extension.identifier.value}] INVOKE provider '${s.toString().replace(/[\r\n]/g,"")}'`);const l=s(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{ki(u)||(this.u.error(`[${a.extension.identifier.value}] provider FAILED`),this.u.error(u),this.y.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this.u.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),De.isCancellationToken(n)?wf(l,n):l}H(t,i){const s=this.F();return this.h.set(s,new yd(t,i)),s}static I(t){return t.displayName||t.name}static J(t){return t.identifier.value}registerDocumentSymbolProvider(t,i,s,r){const n=this.H(new b3(this.q,s),t),o=r&&r.label||li.I(t);return this.g.$registerDocumentSymbolProvider(n,this.z(i,t),o),this.C(n)}$provideDocumentSymbols(t,i,s){return this.G(t,b3,r=>r.provideDocumentSymbols(y.revive(i),s),void 0,s)}registerCodeLensProvider(t,i,s){const r=this.F(),n=typeof s.onDidChangeCodeLenses=="function"?this.F():void 0;this.h.set(r,new yd(new wv(this.q,this.s.converter,s,t,this.y,this.u),t)),this.g.$registerCodeLensSupport(r,this.z(i,t),n);let o=this.C(r);if(n!==void 0){const a=s.onDidChangeCodeLenses(c=>this.g.$emitCodeLensEvent(n));o=Pe.from(o,a)}return o}$provideCodeLenses(t,i,s){return this.G(t,wv,r=>r.provideCodeLenses(y.revive(i),s),void 0,s,i.scheme==="output")}$resolveCodeLens(t,i,s){return this.G(t,wv,r=>r.resolveCodeLens(i,s),void 0,void 0,!0)}$releaseCodeLenses(t,i){this.G(t,wv,s=>Promise.resolve(s.releaseCodeLenses(i)),void 0,void 0,!0)}registerDefinitionProvider(t,i,s){const r=this.H(new y3(this.q,s),t);return this.g.$registerDefinitionSupport(r,this.z(i,t)),this.C(r)}$provideDefinition(t,i,s,r){return this.G(t,y3,n=>n.provideDefinition(y.revive(i),s,r),[],r)}registerDeclarationProvider(t,i,s){const r=this.H(new A3(this.q,s),t);return this.g.$registerDeclarationSupport(r,this.z(i,t)),this.C(r)}$provideDeclaration(t,i,s,r){return this.G(t,A3,n=>n.provideDeclaration(y.revive(i),s,r),[],r)}registerImplementationProvider(t,i,s){const r=this.H(new S3(this.q,s),t);return this.g.$registerImplementationSupport(r,this.z(i,t)),this.C(r)}$provideImplementation(t,i,s,r){return this.G(t,S3,n=>n.provideImplementation(y.revive(i),s,r),[],r)}registerTypeDefinitionProvider(t,i,s){const r=this.H(new E3(this.q,s),t);return this.g.$registerTypeDefinitionSupport(r,this.z(i,t)),this.C(r)}$provideTypeDefinition(t,i,s,r){return this.G(t,E3,n=>n.provideTypeDefinition(y.revive(i),s,r),[],r)}registerHoverProvider(t,i,s,r){const n=this.H(new oS(this.q,s),t);return this.g.$registerHoverProvider(n,this.z(i,t)),this.C(n)}$provideHover(t,i,s,r,n){return this.G(t,oS,o=>o.provideHover(y.revive(i),s,r,n),void 0,n)}$releaseHover(t,i){this.G(t,oS,s=>Promise.resolve(s.releaseHover(i)),void 0,void 0)}registerEvaluatableExpressionProvider(t,i,s,r){const n=this.H(new x3(this.q,s),t);return this.g.$registerEvaluatableExpressionProvider(n,this.z(i,t)),this.C(n)}$provideEvaluatableExpression(t,i,s,r){return this.G(t,x3,n=>n.provideEvaluatableExpression(y.revive(i),s,r),void 0,r)}registerInlineValuesProvider(t,i,s,r){const n=typeof s.onDidChangeInlineValues=="function"?this.F():void 0,o=this.H(new C3(this.q,s),t);this.g.$registerInlineValuesProvider(o,this.z(i,t),n);let a=this.C(o);if(n!==void 0){const c=s.onDidChangeInlineValues(l=>this.g.$emitInlineValuesEvent(n));a=Pe.from(a,c)}return a}$provideInlineValues(t,i,s,r,n){return this.G(t,C3,o=>o.provideInlineValues(y.revive(i),s,r,n),void 0,n)}registerDocumentHighlightProvider(t,i,s){const r=this.H(new k3(this.q,s),t);return this.g.$registerDocumentHighlightProvider(r,this.z(i,t)),this.C(r)}registerMultiDocumentHighlightProvider(t,i,s){const r=this.H(new $3(this.q,s,this.u),t);return this.g.$registerMultiDocumentHighlightProvider(r,this.z(i,t)),this.C(r)}$provideDocumentHighlights(t,i,s,r){return this.G(t,k3,n=>n.provideDocumentHighlights(y.revive(i),s,r),void 0,r)}$provideMultiDocumentHighlights(t,i,s,r,n){return this.G(t,$3,o=>o.provideMultiDocumentHighlights(y.revive(i),s,r.map(a=>y.revive(a)),n),void 0,n)}registerLinkedEditingRangeProvider(t,i,s){const r=this.H(new I3(this.q,s),t);return this.g.$registerLinkedEditingRangeProvider(r,this.z(i,t)),this.C(r)}$provideLinkedEditingRanges(t,i,s,r){return this.G(t,I3,async n=>{const o=await n.provideLinkedEditingRanges(y.revive(i),s,r);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?li.L(o.wordPattern):void 0}},void 0,r)}registerReferenceProvider(t,i,s){const r=this.H(new D3(this.q,s),t);return this.g.$registerReferenceSupport(r,this.z(i,t)),this.C(r)}$provideReferences(t,i,s,r,n){return this.G(t,D3,o=>o.provideReferences(y.revive(i),s,r,n),void 0,n)}registerCodeActionProvider(t,i,s,r){const n=new X,o=this.H(new yv(this.q,this.s.converter,this.t,s,this.u,t,this.w),t);return this.g.$registerCodeActionSupport(o,this.z(i,t),{providedKinds:r?.providedCodeActionKinds?.map(a=>a.value),documentation:r?.documentation?.map(a=>({kind:a.kind.value,command:this.s.converter.toInternal(a.command,n)}))},li.I(t),li.J(t),!!s.resolveCodeAction),n.add(this.C(o)),n}$provideCodeActions(t,i,s,r,n){return this.G(t,yv,o=>o.provideCodeActions(y.revive(i),s,r,n),void 0,n)}$resolveCodeAction(t,i,s){return this.G(t,yv,r=>r.resolveCodeAction(i,s),{},void 0)}$releaseCodeActions(t,i){this.G(t,yv,s=>Promise.resolve(s.releaseCodeActions(i)),void 0,void 0)}registerDocumentFormattingEditProvider(t,i,s){const r=this.H(new P3(this.q,s),t);return this.g.$registerDocumentFormattingSupport(r,this.z(i,t),t.identifier,t.displayName||t.name),this.C(r)}$provideDocumentFormattingEdits(t,i,s,r){return this.G(t,P3,n=>n.provideDocumentFormattingEdits(y.revive(i),s,r),void 0,r)}registerDocumentRangeFormattingEditProvider(t,i,s){const r=typeof s.provideDocumentRangesFormattingEdits=="function",n=this.H(new aS(this.q,s),t);return this.g.$registerRangeFormattingSupport(n,this.z(i,t),t.identifier,t.displayName||t.name,r),this.C(n)}$provideDocumentRangeFormattingEdits(t,i,s,r,n){return this.G(t,aS,o=>o.provideDocumentRangeFormattingEdits(y.revive(i),s,r,n),void 0,n)}$provideDocumentRangesFormattingEdits(t,i,s,r,n){return this.G(t,aS,o=>o.provideDocumentRangesFormattingEdits(y.revive(i),s,r,n),void 0,n)}registerOnTypeFormattingEditProvider(t,i,s,r){const n=this.H(new T3(this.q,s),t);return this.g.$registerOnTypeFormattingSupport(n,this.z(i,t),r,t.identifier),this.C(n)}$provideOnTypeFormattingEdits(t,i,s,r,n,o){return this.G(t,T3,a=>a.provideOnTypeFormattingEdits(y.revive(i),s,r,n,o),void 0,o)}registerWorkspaceSymbolProvider(t,i){const s=this.H(new Av(i,this.u),t);return this.g.$registerNavigateTypeSupport(s,typeof i.resolveWorkspaceSymbol=="function"),this.C(s)}$provideWorkspaceSymbols(t,i,s){return this.G(t,Av,r=>r.provideWorkspaceSymbols(i,s),{symbols:[]},s)}$resolveWorkspaceSymbol(t,i,s){return this.G(t,Av,r=>r.resolveWorkspaceSymbol(i,s),void 0,void 0)}$releaseWorkspaceSymbols(t,i){this.G(t,Av,s=>s.releaseWorkspaceSymbols(i),void 0,void 0)}registerRenameProvider(t,i,s){const r=this.H(new Sv(this.q,s,this.u),t);return this.g.$registerRenameSupport(r,this.z(i,t),Sv.supportsResolving(s)),this.C(r)}$provideRenameEdits(t,i,s,r,n){return this.G(t,Sv,o=>o.provideRenameEdits(y.revive(i),s,r,n),void 0,n)}$resolveRenameLocation(t,i,s,r){return this.G(t,Sv,n=>n.resolveRenameLocation(y.revive(i),s,r),void 0,r)}registerNewSymbolNamesProvider(t,i,s){const r=this.H(new cS(this.q,s,this.u),t);return this.g.$registerNewSymbolNamesProvider(r,this.z(i,t)),this.C(r)}$supportsAutomaticNewSymbolNamesTriggerKind(t){return this.G(t,cS,i=>i.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(t,i,s,r,n){return this.G(t,cS,o=>o.provideNewSymbolNames(y.revive(i),s,r,n),void 0,n)}registerDocumentSemanticTokensProvider(t,i,s,r){const n=this.H(new uS(this.q,s),t),o=typeof s.onDidChangeSemanticTokens=="function"?this.F():void 0;this.g.$registerDocumentSemanticTokensProvider(n,this.z(i,t),r,o);let a=this.C(n);if(o){const c=s.onDidChangeSemanticTokens(l=>this.g.$emitDocumentSemanticTokensEvent(o));a=Pe.from(a,c)}return a}$provideDocumentSemanticTokens(t,i,s,r){return this.G(t,uS,n=>n.provideDocumentSemanticTokens(y.revive(i),s,r),null,r)}$releaseDocumentSemanticTokens(t,i){this.G(t,uS,s=>s.releaseDocumentSemanticColoring(i),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(t,i,s,r){const n=this.H(new M3(this.q,s),t),o=typeof s.onDidChangeSemanticTokens=="function"?this.F():void 0;this.g.$registerDocumentRangeSemanticTokensProvider(n,this.z(i,t),r,o);let a=this.C(n);if(o){const c=s.onDidChangeSemanticTokens(l=>this.g.$emitDocumentRangeSemanticTokensEvent(o));a=Pe.from(a,c)}return a}$provideDocumentRangeSemanticTokens(t,i,s,r){return this.G(t,M3,n=>n.provideDocumentRangeSemanticTokens(y.revive(i),s,r),null,r)}registerCompletionItemProvider(t,i,s,r){const n=this.H(new vd(this.q,this.s.converter,s,this.w,t),t);return this.g.$registerCompletionsProvider(n,this.z(i,t),r,vd.supportsResolving(s),t.identifier),this.C(n)}$provideCompletionItems(t,i,s,r,n){return this.G(t,vd,o=>o.provideCompletionItems(y.revive(i),s,r,n),void 0,n)}$resolveCompletionItem(t,i,s){return this.G(t,vd,r=>r.resolveCompletionItem(i,s),void 0,s)}$releaseCompletionItems(t,i){this.G(t,vd,s=>s.releaseCompletionItems(i),void 0,void 0)}registerInlineCompletionsProvider(t,i,s,r){const n=new ko(t,this.q,s,this.s.converter),o=this.H(n,t);let a=this.C(o);const c=qe(t,"inlineCompletionsAdditions")&&typeof s.onDidChange=="function";if(c){const u=s.onDidChange(h=>this.g.$emitInlineCompletionsChange(o,h?{data:h.data}:void 0));a=Pe.from(a,u)}const l=qe(t,"inlineCompletionsAdditions")&&typeof s.onDidChangeModelInfo=="function";if(l){const u=s.onDidChangeModelInfo(h=>this.g.$emitInlineCompletionModelInfoChange(o,n.modelInfo));a=Pe.from(a,u)}return this.g.$registerInlineCompletionsSupport(o,this.z(i,t),n.supportsHandleEvents,it.toKey(t.identifier.value),t.version,r?.groupId?it.toKey(r.groupId):void 0,r?.yieldTo?.map(u=>it.toKey(u))||[],r?.displayName,r?.debounceDelayMs,r?.excludes?.map(u=>it.toKey(u))||[],c,n.supportsSetModelId,n.modelInfo,l),a}$provideInlineCompletions(t,i,s,r,n){return this.G(t,ko,o=>o.provideInlineCompletions(y.revive(i),s,r,n),void 0,void 0)}$handleInlineCompletionDidShow(t,i,s,r){this.G(t,ko,async n=>{n.handleDidShowCompletionItem(i,s,r)},void 0,void 0)}$handleInlineCompletionPartialAccept(t,i,s,r,n){this.G(t,ko,async o=>{o.handlePartialAccept(i,s,r,n)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(t,i,s,r){this.G(t,ko,async n=>{n.handleEndOfLifetime(i,s,r)},void 0,void 0)}$handleInlineCompletionRejection(t,i,s){this.G(t,ko,async r=>{r.handleRejection(i,s)},void 0,void 0)}$freeInlineCompletionsList(t,i,s){this.G(t,ko,async r=>{r.disposeCompletions(i,s)},void 0,void 0)}$acceptInlineCompletionsUnificationState(t){this.j=t,this.m.fire()}$handleInlineCompletionSetCurrentModelId(t,i){this.G(t,ko,async s=>{s.setCurrentModelId(i)},void 0,void 0)}registerSignatureHelpProvider(t,i,s,r){const n=Array.isArray(r)?{triggerCharacters:r,retriggerCharacters:[]}:r,o=this.H(new hS(this.q,s),t);return this.g.$registerSignatureHelpProvider(o,this.z(i,t),n),this.C(o)}$provideSignatureHelp(t,i,s,r,n){return this.G(t,hS,o=>o.provideSignatureHelp(y.revive(i),s,r,n),void 0,n)}$releaseSignatureHelp(t,i){this.G(t,hS,s=>s.releaseSignatureHelp(i),void 0,void 0)}registerInlayHintsProvider(t,i,s){const r=typeof s.onDidChangeInlayHints=="function"?this.F():void 0,n=this.H(new Ev(this.q,this.s.converter,s,this.u,t),t);this.g.$registerInlayHintsProvider(n,this.z(i,t),typeof s.resolveInlayHint=="function",r,li.I(t));let o=this.C(n);if(r!==void 0){const a=s.onDidChangeInlayHints(c=>this.g.$emitInlayHintsEvent(r));o=Pe.from(o,a)}return o}$provideInlayHints(t,i,s,r){return this.G(t,Ev,n=>n.provideInlayHints(y.revive(i),s,r),void 0,r)}$resolveInlayHint(t,i,s){return this.G(t,Ev,r=>r.resolveInlayHint(i,s),void 0,s)}$releaseInlayHints(t,i){this.G(t,Ev,s=>s.releaseHints(i),void 0,void 0)}registerDocumentLinkProvider(t,i,s){const r=this.H(new xv(this.q,s),t);return this.g.$registerDocumentLinkProvider(r,this.z(i,t),typeof s.resolveDocumentLink=="function"),this.C(r)}$provideDocumentLinks(t,i,s){return this.G(t,xv,r=>r.provideLinks(y.revive(i),s),void 0,s,i.scheme==="output")}$resolveDocumentLink(t,i,s){return this.G(t,xv,r=>r.resolveLink(i,s),void 0,void 0,!0)}$releaseDocumentLinks(t,i){this.G(t,xv,s=>s.releaseLinks(i),void 0,void 0,!0)}registerColorProvider(t,i,s){const r=this.H(new dS(this.q,s),t);return this.g.$registerDocumentColorProvider(r,this.z(i,t)),this.C(r)}$provideDocumentColors(t,i,s){return this.G(t,dS,r=>r.provideColors(y.revive(i),s),[],s)}$provideColorPresentations(t,i,s,r){return this.G(t,dS,n=>n.provideColorPresentations(y.revive(i),s,r),void 0,r)}registerFoldingRangeProvider(t,i,s){const r=this.F(),n=typeof s.onDidChangeFoldingRanges=="function"?this.F():void 0;this.h.set(r,new yd(new N3(this.q,s),t)),this.g.$registerFoldingRangeProvider(r,this.z(i,t),t.identifier,n);let o=this.C(r);if(n!==void 0){const a=s.onDidChangeFoldingRanges(()=>this.g.$emitFoldingRangeEvent(n));o=Pe.from(o,a)}return o}$provideFoldingRanges(t,i,s,r){return this.G(t,N3,n=>n.provideFoldingRanges(y.revive(i),s,r),void 0,r)}registerSelectionRangeProvider(t,i,s){const r=this.H(new R3(this.q,s,this.u),t);return this.g.$registerSelectionRangeProvider(r,this.z(i,t)),this.C(r)}$provideSelectionRanges(t,i,s,r){return this.G(t,R3,n=>n.provideSelectionRanges(y.revive(i),s,r),[],r)}registerCallHierarchyProvider(t,i,s){const r=this.H(new wd(this.q,s),t);return this.g.$registerCallHierarchyProvider(r,this.z(i,t)),this.C(r)}$prepareCallHierarchy(t,i,s,r){return this.G(t,wd,n=>Promise.resolve(n.prepareSession(y.revive(i),s,r)),void 0,r)}$provideCallHierarchyIncomingCalls(t,i,s,r){return this.G(t,wd,n=>n.provideCallsTo(i,s,r),void 0,r)}$provideCallHierarchyOutgoingCalls(t,i,s,r){return this.G(t,wd,n=>n.provideCallsFrom(i,s,r),void 0,r)}$releaseCallHierarchy(t,i){this.G(t,wd,s=>Promise.resolve(s.releaseSession(i)),void 0,void 0)}registerTypeHierarchyProvider(t,i,s){const r=this.H(new bd(this.q,s),t);return this.g.$registerTypeHierarchyProvider(r,this.z(i,t)),this.C(r)}$prepareTypeHierarchy(t,i,s,r){return this.G(t,bd,n=>Promise.resolve(n.prepareSession(y.revive(i),s,r)),void 0,r)}$provideTypeHierarchySupertypes(t,i,s,r){return this.G(t,bd,n=>n.provideSupertypes(i,s,r),void 0,r)}$provideTypeHierarchySubtypes(t,i,s,r){return this.G(t,bd,n=>n.provideSubtypes(i,s,r),void 0,r)}$releaseTypeHierarchy(t,i){this.G(t,bd,s=>Promise.resolve(s.releaseSession(i)),void 0,void 0)}registerDocumentOnDropEditProvider(t,i,s,r){const n=this.F();return this.h.set(n,new yd(new Cv(this.g,this.q,s,n,t),t)),this.g.$registerDocumentOnDropEditProvider(n,this.z(i,t),r?{supportsResolve:!!s.resolveDocumentDropEdit,dropMimeTypes:r.dropMimeTypes,providedDropKinds:r.providedDropEditKinds?.map(o=>o.value)}:void 0),this.C(n)}$provideDocumentOnDropEdits(t,i,s,r,n,o){return this.G(t,Cv,a=>Promise.resolve(a.provideDocumentOnDropEdits(i,y.revive(s),r,n,o)),void 0,void 0)}$resolveDropEdit(t,i,s){return this.G(t,Cv,r=>r.resolveDropEdit(i,s),{},void 0)}$releaseDocumentOnDropEdits(t,i){this.G(t,Cv,s=>Promise.resolve(s.releaseDropEdits(i)),void 0,void 0)}registerDocumentPasteEditProvider(t,i,s,r){const n=this.F();return this.h.set(n,new yd(new md(this.g,this.q,s,n,t),t)),this.g.$registerPasteEditProvider(n,this.z(i,t),{supportsCopy:!!s.prepareDocumentPaste,supportsPaste:!!s.provideDocumentPasteEdits,supportsResolve:!!s.resolveDocumentPasteEdit,providedPasteEditKinds:r.providedPasteEditKinds?.map(o=>o.value),copyMimeTypes:r.copyMimeTypes,pasteMimeTypes:r.pasteMimeTypes}),this.C(n)}$prepareDocumentPaste(t,i,s,r,n){return this.G(t,md,o=>o.prepareDocumentPaste(y.revive(i),s,r,n),void 0,n)}$providePasteEdits(t,i,s,r,n,o,a){return this.G(t,md,c=>c.providePasteEdits(i,y.revive(s),r,n,o,a),void 0,a)}$resolvePasteEdit(t,i,s){return this.G(t,md,r=>r.resolvePasteEdit(i,s),{},void 0)}$releasePasteEdits(t,i){this.G(t,md,s=>Promise.resolve(s.releasePasteEdits(i)),void 0,void 0)}static L(t){return{pattern:t.source,flags:t.flags}}static M(t){return{decreaseIndentPattern:li.L(t.decreaseIndentPattern),increaseIndentPattern:li.L(t.increaseIndentPattern),indentNextLinePattern:t.indentNextLinePattern?li.L(t.indentNextLinePattern):void 0,unIndentedLinePattern:t.unIndentedLinePattern?li.L(t.unIndentedLinePattern):void 0}}static N(t){return{beforeText:li.L(t.beforeText),afterText:t.afterText?li.L(t.afterText):void 0,previousLineText:t.previousLineText?li.L(t.previousLineText):void 0,action:t.action}}static O(t){return t.map(li.N)}static P(t){return{open:t.open,close:t.close,notIn:t.notIn?t.notIn.map(i=>Vc.toString(i)):void 0}}static Q(t){return t.map(li.P)}setLanguageConfiguration(t,i,s){const{wordPattern:r}=s;if(r&&Kx(r))throw new Error(`Invalid language configuration: wordPattern '${r}' is not allowed to match the empty string.`);r?this.q.setWordDefinitionFor(i,r):this.q.setWordDefinitionFor(i,void 0),s.__electricCharacterSupport&&this.w.report("LanguageConfiguration.__electricCharacterSupport",t,"Do not use."),s.__characterPairSupport&&this.w.report("LanguageConfiguration.__characterPairSupport",t,"Do not use.");const n=this.F(),o={comments:s.comments,brackets:s.brackets,wordPattern:s.wordPattern?li.L(s.wordPattern):void 0,indentationRules:s.indentationRules?li.M(s.indentationRules):void 0,onEnterRules:s.onEnterRules?li.O(s.onEnterRules):void 0,__electricCharacterSupport:s.__electricCharacterSupport,__characterPairSupport:s.__characterPairSupport,autoClosingPairs:s.autoClosingPairs?li.Q(s.autoClosingPairs):void 0};return this.g.$setLanguageConfiguration(n,i,o),this.C(n)}$setWordDefinitions(t){for(const i of t)this.q.setWordDefinitionFor(i.languageId,new RegExp(i.regexSource,i.regexFlags))}},wY=W("notebookService"),bY=W("codeMapperService"),L3="vscode_editFile",fS="vscode_editFile_internal",yY={id:fS,displayName:"",modelDescription:"",source:io.Internal},pS=class{constructor(t,i,s){this.a=t,this.b=i,this.c=s}async invoke(t,i,s,r){if(!t.context)throw new Error("toolInvocationToken is required for this tool");const n=t.parameters,o=y.revive(n.uri),a=Mw.parse(o)?.notebook||o,c=this.a.getSession(t.context.sessionResource),l=c.getRequests().at(-1);c.acceptResponseProgress(l,{kind:"markdownContent",content:new Qn("\n````\n")}),c.acceptResponseProgress(l,{kind:"codeblockUri",uri:a,isEdit:!0}),c.acceptResponseProgress(l,{kind:"markdownContent",content:new Qn("\n````\n")}),this.c.hasSupportedNotebooks(a)&&this.c.getNotebookTextModel(a)?c.acceptResponseProgress(l,{kind:"notebookEdit",edits:[],uri:a}):c.acceptResponseProgress(l,{kind:"textEdit",edits:[],uri:a});const u=c.editingSession;if(!u)throw new Error("This tool must be called from within an editing session");const h=await this.b.mapCode({codeBlocks:[{code:n.code,resource:a,markdownBeforeBlock:n.explanation}],location:"tool",chatRequestId:t.chatRequestId,chatRequestModel:t.modelId,chatSessionResource:t.context.sessionResource},{textEdit:(p,g)=>{c.acceptResponseProgress(l,{kind:"textEdit",uri:p,edits:g})},notebookEdit(p,g){c.acceptResponseProgress(l,{kind:"notebookEdit",uri:p,edits:g})}},r);if(this.c.hasSupportedNotebooks(a)&&this.c.getNotebookTextModel(a)?c.acceptResponseProgress(l,{kind:"notebookEdit",uri:a,edits:[],done:!0}):c.acceptResponseProgress(l,{kind:"textEdit",uri:a,edits:[],done:!0}),h?.errorMessage)throw new Error(h.errorMessage);let f;return await new Promise(p=>{let g=!1;f=Qf(v=>{const S=u.entries.read(v)?.find(E=>E.modifiedURI.toString()===a.toString());S&&(S.isCurrentlyBeingModifiedBy.read(v)?g=!0:g&&p(!0))})}).finally(()=>{f.dispose()}),{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(t,i){return{presentation:Pc.Hidden}}};pS=__decorate([__param(0,e3),__param(1,bY),__param(2,wY)],pS);var AY="vscode_get_confirmation",SY={id:AY,displayName:"Confirmation Tool",modelDescription:"A tool that demonstrates different types of confirmations. Takes a title, message, and confirmation type (basic or terminal).",source:io.Internal,inputSchema:{type:"object",properties:{title:{type:"string",description:"Title for the confirmation dialog"},message:{type:"string",description:"Message to show in the confirmation dialog"},confirmationType:{type:"string",enum:["basic","terminal"],description:"Type of confirmation to show - basic for simple confirmation, terminal for terminal command confirmation"},terminalCommand:{type:"string",description:'Terminal command to show (only used when confirmationType is "terminal")'}},required:["title","message","confirmationType"],additionalProperties:!1}},EY=class{async prepareToolInvocation(e,t){const i=e.parameters;if(!i.title||!i.message)throw new Error("Missing required parameters for ConfirmationTool");const s=i.confirmationType??"basic";let r;return s==="terminal"?r={kind:"terminal",commandLine:{original:i.terminalCommand??""},language:"bash"}:r=void 0,{confirmationMessages:{title:i.title,message:new Qn(i.message),allowAutoConfirm:!0},toolSpecificData:r,presentation:Pc.HiddenAfterComplete}}async invoke(e,t,i,s){return{content:[{kind:"text",value:"yes"}]}}},$o;(function(e){e[e.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",e[e.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})($o||($o={}));var lr;(function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.Closed=2]="Closed"})(lr||(lr={}));var gS=class SR extends J{static{this.a=100}constructor(t,i=Object.create(null)){super(),this.q=t,this.r=i,this.b=this.D(new hu),this.onDidChangeStorage=this.b.event,this.c=lr.None,this.f=new Map,this.g=this.D(new gu(SR.a)),this.h=new Set,this.j=new Map,this.m=void 0,this.n=[],this.s()}s(){this.D(this.q.onDidChangeItemsExternal(t=>this.t(t)))}t(t){this.b.pause();try{t.changed?.forEach((i,s)=>this.u(s,i)),t.deleted?.forEach(i=>this.u(i,void 0))}finally{this.b.resume()}}u(t,i){if(this.c===lr.Closed)return;let s=!1;qt(i)?s=this.f.delete(t):this.f.get(t)!==i&&(this.f.set(t,i),s=!0),s&&this.b.fire({key:t,external:!0})}get items(){return this.f}get size(){return this.f.size}async init(){this.c===lr.None&&(this.c=lr.Initialized,this.r.hint!==$o.STORAGE_DOES_NOT_EXIST&&(this.f=await this.q.getItems()))}get(t,i){const s=this.f.get(t);return qt(s)?i:s}getBoolean(t,i){const s=this.get(t);return qt(s)?i:s==="true"}getNumber(t,i){const s=this.get(t);return qt(s)?i:parseInt(s,10)}getObject(t,i){const s=this.get(t);return qt(s)?i:ok(s)}async set(t,i,s=!1){if(this.c===lr.Closed)return;if(qt(i))return this.delete(t,s);const r=kt(i)||Array.isArray(i)?IF(i):String(i);if(this.f.get(t)!==r)return this.f.set(t,r),this.j.set(t,r),this.h.delete(t),this.b.fire({key:t,external:s}),this.C()}async delete(t,i=!1){if(!(this.c===lr.Closed||!this.f.delete(t)))return this.h.has(t)||this.h.add(t),this.j.delete(t),this.b.fire({key:t,external:i}),this.C()}async optimize(){if(this.c!==lr.Closed)return await this.flush(0),this.q.optimize()}async close(){return this.m||(this.m=this.w()),this.m}async w(){this.c=lr.Closed;try{await this.C(0)}catch{}await this.q.close(()=>this.f)}get y(){return this.j.size>0||this.h.size>0}async z(){if(!this.y)return;const t={insert:this.j,delete:this.h};return this.h=new Set,this.j=new Map,this.q.updateItems(t).finally(()=>{if(!this.y)for(;this.n.length;)this.n.pop()?.()})}async flush(t){if(!(this.c===lr.Closed||this.m))return this.C(t)}async C(t){return this.r.hint===$o.STORAGE_IN_MEMORY?this.z():this.g.trigger(()=>this.z(),t)}async whenFlushed(){if(this.y)return new Promise(t=>this.n.push(t))}isInMemory(){return this.r.hint===$o.STORAGE_IN_MEMORY}},mS=class{constructor(){this.onDidChangeItemsExternal=Ie.None,this.a=new Map}async getItems(){return this.a}async updateItems(e){e.insert?.forEach((t,i)=>this.a.set(i,t)),e.delete?.forEach(t=>this.a.delete(t))}async optimize(){}async close(){}},O3;(function(e){e.Settings="settings",e.Keybindings="keybindings",e.Snippets="snippets",e.Prompts="prompts",e.Tasks="tasks",e.Extensions="extensions",e.GlobalState="globalState",e.Mcp="mcp"})(O3||(O3={}));function xY(e){const t=e;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&y.isUri(t.location)&&y.isUri(t.globalStorageHome)&&y.isUri(t.settingsResource)&&y.isUri(t.keybindingsResource)&&y.isUri(t.tasksResource)&&y.isUri(t.snippetsHome)&&y.isUri(t.promptsHome)&&y.isUri(t.extensionsResource)&&y.isUri(t.mcpResource))}var CY=W("IUserDataProfilesService");function kv(e,t,i,s,r,n){return{id:e,name:t,location:i,isDefault:!1,icon:r?.icon,globalStorageHome:n&&r?.useDefaultFlags?.globalState?n.globalStorageHome:Lt(i,"globalStorage"),settingsResource:n&&r?.useDefaultFlags?.settings?n.settingsResource:Lt(i,"settings.json"),keybindingsResource:n&&r?.useDefaultFlags?.keybindings?n.keybindingsResource:Lt(i,"keybindings.json"),tasksResource:n&&r?.useDefaultFlags?.tasks?n.tasksResource:Lt(i,"tasks.json"),snippetsHome:n&&r?.useDefaultFlags?.snippets?n.snippetsHome:Lt(i,"snippets"),promptsHome:n&&r?.useDefaultFlags?.prompts?n.promptsHome:Lt(i,"prompts"),extensionsResource:n&&r?.useDefaultFlags?.extensions?n.extensionsResource:Lt(i,"extensions.json"),mcpResource:n&&r?.useDefaultFlags?.mcp?n.mcpResource:Lt(i,"mcp.json"),cacheHome:Lt(s,e),useDefaultFlags:r?.useDefaultFlags,isTransient:r?.transient,workspaces:r?.workspaces}}var F3=class extends J{static{this.b="userDataProfiles"}static{this.c="profileAssociations"}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.z.profiles,...this.q.profiles]}constructor(t,i,s,r){super(),this.r=t,this.s=i,this.t=s,this.u=r,this.g=this.D(new I),this.onDidChangeProfiles=this.g.event,this.h=this.D(new I),this.onWillCreateProfile=this.h.event,this.j=this.D(new I),this.onWillRemoveProfile=this.j.event,this.m=this.D(new I),this.onDidResetWorkspaces=this.m.event,this.n=new Map,this.q={profiles:[],emptyWindows:new Map},this.profilesHome=Lt(this.r.userRoamingDataHome,"profiles"),this.f=Lt(this.r.cacheHome,"CachedProfilesData")}init(){this.y=void 0}get z(){if(!this.y){const t=this.F(),i=[t];try{for(const r of this.O()){if(this.C(r)){this.u.warn("Skipping the invalid stored profile",r.location||r.name);continue}const n=ji(r.location);i.push(kv(n,r.name,r.location,this.f,{icon:r.icon,useDefaultFlags:r.useDefaultFlags},t))}}catch(r){this.u.error(r)}const s=new Map;if(i.length)try{const r=this.Q();if(r.workspaces)for(const[n,o]of Object.entries(r.workspaces)){const a=y.parse(n),c=i.find(l=>l.id===o);if(c){const l=c.workspaces?c.workspaces.slice(0):[];l.push(a),c.workspaces=l}}if(r.emptyWindows)for(const[n,o]of Object.entries(r.emptyWindows)){const a=i.find(c=>c.id===o);a&&s.set(n,a)}}catch(r){this.u.error(r)}this.y={profiles:i,emptyWindows:s}}return this.y}C(t){return!!(!t.name||!Oe(t.name)||!t.location||t.isSystem||this.t.extUri.basename(this.t.extUri.dirname(t.location))==="builtin")}F(){const t=kv("__default__profile__",d(2731,null),this.r.userRoamingDataHome,this.f);return{...t,extensionsResource:this.S()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){const i="Temp",s=new RegExp(`${On(i)}\\s(\\d+)`);let r=0;for(const o of this.profiles){const a=s.exec(o.name),c=a?parseInt(a[1]):0;r=c>r?c:r}const n=`${i} ${r+1}`;return this.createProfile(Ar(At()).toString(16),n,{transient:!0},t)}async createNamedProfile(t,i,s){return this.createProfile(Ar(At()).toString(16),t,i,s)}async createProfile(t,i,s,r){return await this.G(t,i,s,r)}async G(t,i,s,r){if(!Oe(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let n=this.n.get(i);return n||(n=(async()=>{try{if(this.profiles.find(u=>u.id===t||!u.isTransient&&!s?.transient&&u.name===i))throw new Error(`Profile with ${i} name already exists`);const a=r?this.H(r):void 0;y.isUri(a)&&(s={...s,workspaces:[a]});const c=kv(t,i,this.t.extUri.joinPath(this.profilesHome,t),this.f,s,this.defaultProfile);await this.s.createFolder(c.location);const l=[];return this.h.fire({profile:c,join(u){l.push(u)}}),await Hn.settled(l),a&&!y.isUri(a)&&this.M(a,c,!!c.isTransient),this.J([c],[],[]),c}finally{this.n.delete(i)}})(),this.n.set(i,n)),n}async updateProfile(t,i){const s=[];for(const n of this.profiles){let o;if(t.id===n.id)n.isDefault?i.workspaces&&(o=n,o.workspaces=i.workspaces):o=kv(n.id,i.name??n.name,n.location,this.f,{icon:i.icon===null?void 0:i.icon??n.icon,transient:i.transient??n.isTransient,useDefaultFlags:i.useDefaultFlags??n.useDefaultFlags,workspaces:i.workspaces??n.workspaces},this.defaultProfile);else if(i.workspaces){const a=n.workspaces?.filter(c=>!i.workspaces?.some(l=>this.t.extUri.isEqual(c,l)));n.workspaces?.length!==a?.length&&(o=n,o.workspaces=a)}o&&s.push(o)}if(!s.length)throw t.isDefault?new Error("Cannot update default profile"):new Error(`Profile '${t.name}' does not exist`);this.J([],[],s);const r=this.profiles.find(n=>n.id===t.id);if(!r)throw new Error(`Profile '${t.name}' was not updated`);return r}async removeProfile(t){if(t.isDefault)throw new Error("Cannot remove default profile");const i=this.profiles.find(r=>r.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);const s=[];this.j.fire({profile:i,join(r){s.push(r)}});try{await Promise.allSettled(s)}catch(r){this.u.error(r)}this.J([],[i],[]);try{await this.s.del(i.cacheHome,{recursive:!0})}catch(r){tH(r)!==1&&this.u.error(r)}}async setProfileForWorkspace(t,i){const s=this.profiles.find(n=>n.id===i.id);if(!s)throw new Error(`Profile '${i.name}' does not exist`);const r=this.H(t);if(y.isUri(r)){const n=s.workspaces?[...s.workspaces]:[];n.some(o=>this.t.extUri.isEqual(o,r))||(n.push(r),await this.updateProfile(s,{workspaces:n}))}else this.M(r,s,!1),this.N(this.profiles)}unsetWorkspace(t,i=!1){const s=this.H(t);if(y.isUri(s)){const r=this.getProfileForWorkspace(t);r&&this.updateProfile(r,{workspaces:r.workspaces?.filter(n=>!this.t.extUri.isEqual(n,s))})}else this.M(s,void 0,i),this.N(this.profiles)}async resetWorkspaces(){this.q.emptyWindows.clear(),this.z.emptyWindows.clear();for(const t of this.profiles)t.workspaces=void 0;this.J([],[],this.profiles),this.m.fire()}async cleanUp(){try{if(await this.s.exists(this.profilesHome)){const t=this.t.extUri.joinPath(this.profilesHome,"builtin");if(await this.s.exists(t))try{await this.s.del(t,{recursive:!0})}catch(s){this.u.error(s)}const i=await this.s.resolve(this.profilesHome);await Promise.all((i.children||[]).filter(s=>s.isDirectory&&this.profiles.every(r=>!this.t.extUri.isEqual(r.location,s.resource))).map(s=>this.s.del(s.resource,{recursive:!0})))}}catch(t){this.u.error("Error deleting redundant profile folders",t)}try{const t=this.O(),i=[];for(const s of this.O())this.C(s)?this.u.warn(`Invalid user data profile found: ${s.name}`):i.push(s);t.length!==i.length&&this.P(i)}catch(t){this.u.error("Error removing invalid stored profiles",t)}}async cleanUpTransientProfiles(){const t=this.q.profiles.filter(i=>!this.I(i));await Promise.allSettled(t.map(i=>this.removeProfile(i)))}getProfileForWorkspace(t){const i=this.H(t);return y.isUri(i)?this.profiles.find(s=>s.workspaces?.some(r=>this.t.extUri.isEqual(r,i))):this.z.emptyWindows.get(i)??this.q.emptyWindows.get(i)}H(t){return VU(t)?t.uri:GU(t)?t.configPath:t.id}I(t){return!!(t.workspaces?.length||[...this.z.emptyWindows.values()].some(i=>this.t.extUri.isEqual(i.location,t.location))||[...this.q.emptyWindows.values()].some(i=>this.t.extUri.isEqual(i.location,t.location)))}J(t,i,s,r=!1){const n=[...this.profiles,...t],o=this.q.profiles;this.q.profiles=[];const a=[];for(let c of n){if(i.some(l=>c.id===l.id)){for(const l of[...this.z.emptyWindows.keys()])c.id===this.z.emptyWindows.get(l)?.id&&this.z.emptyWindows.delete(l);continue}if(!c.isDefault){c=s.find(u=>c.id===u.id)??c;const l=o.find(u=>c.id===u.id);if(c.isTransient)this.q.profiles.push(c);else if(l){for(const[u,h]of this.q.emptyWindows.entries())if(c.id===h.id){this.q.emptyWindows.delete(u),this.z.emptyWindows.set(u,c);break}}}c.workspaces?.length===0&&(c.workspaces=void 0),a.push(c)}this.N(a),r||this.L(t,i,s)}L(t,i,s){this.g.fire({added:t,removed:i,updated:s,all:this.profiles})}M(t,i,s){s=i?.isTransient?!0:s,s?i?this.q.emptyWindows.set(t,i):this.q.emptyWindows.delete(t):(this.q.emptyWindows.delete(t),i?this.z.emptyWindows.set(t,i):this.z.emptyWindows.delete(t))}N(t){const i=[],s={},r={};for(const n of t)if(!n.isTransient&&(n.isDefault||i.push({location:n.location,name:n.name,icon:n.icon,useDefaultFlags:n.useDefaultFlags}),n.workspaces))for(const o of n.workspaces)s[o.toString()]=n.id;for(const[n,o]of this.z.emptyWindows.entries())r[n.toString()]=o.id;this.R({workspaces:s,emptyWindows:r}),this.P(i),this.y=void 0}O(){return[]}P(t){throw new Error("not implemented")}Q(){return{}}R(t){throw new Error("not implemented")}S(){}};F3=__decorate([__param(0,VA),__param(1,Bf),__param(2,F8),__param(3,xe)],F3);var kY="__$__isNewStorageMarker",$v="__$__targetStorageMarker",_a=W("storageService"),Ul;(function(e){e[e.NONE=0]="NONE",e[e.SHUTDOWN=1]="SHUTDOWN"})(Ul||(Ul={}));var j3;(function(e){e[e.APPLICATION=-1]="APPLICATION",e[e.PROFILE=0]="PROFILE",e[e.WORKSPACE=1]="WORKSPACE"})(j3||(j3={}));var U3;(function(e){e[e.USER=0]="USER",e[e.MACHINE=1]="MACHINE"})(U3||(U3={}));function $Y(e){const t=e.get($v);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var IY=class ER extends J{static{this.a=60*1e3}constructor(t={flushInterval:ER.a}){super(),this.b=this.D(new hu),this.f=this.D(new hu),this.onDidChangeTarget=this.f.event,this.g=this.D(new I),this.onWillSaveState=this.g.event,this.m=this.D(new Hs),this.z=void 0,this.F=void 0,this.H=void 0,this.j=this.D(new vr(()=>this.n(),t.flushInterval))}onDidChangeValue(t,i,s){return Ie.filter(this.b.event,r=>r.scope===t&&(i===void 0||r.key===i),s)}n(){this.m.value=jC(()=>{this.q()&&this.flush(),this.j.schedule()})}q(){return!0}r(){Yi([this.m,this.j])}initialize(){return this.h||(this.h=(async()=>{Ht("code/willInitStorage");try{await this.O()}finally{Ht("code/didInitStorage")}this.j.schedule()})()),this.h}t(t,i){const{key:s,external:r}=i;if(s===$v){switch(t){case-1:this.H=void 0;break;case 0:this.F=void 0;break;case 1:this.z=void 0;break}this.f.fire({scope:t})}else this.b.fire({scope:t,key:s,target:this.J(t)[s],external:r})}u(t){this.g.fire({reason:t})}get(t,i,s){return this.P(i)?.get(t,s)}getBoolean(t,i,s){return this.P(i)?.getBoolean(t,s)}getNumber(t,i,s){return this.P(i)?.getNumber(t,s)}getObject(t,i,s){return this.P(i)?.getObject(t,s)}storeAll(t,i){this.w(()=>{for(const s of t)this.store(s.key,s.value,s.scope,s.target,i)})}store(t,i,s,r,n=!1){if(qt(i)){this.remove(t,s,n);return}this.w(()=>{this.y(t,s,r),this.P(s)?.set(t,i,n)})}remove(t,i,s=!1){this.w(()=>{this.y(t,i,void 0),this.P(i)?.delete(t,s)})}w(t){this.b.pause(),this.f.pause();try{t()}finally{this.b.resume(),this.f.resume()}}keys(t,i){const s=[],r=this.J(t);for(const n of Object.keys(r))r[n]===i&&s.push(n);return s}y(t,i,s,r=!1){const n=this.J(i);typeof s=="number"?n[t]!==s&&(n[t]=s,this.P(i)?.set($v,JSON.stringify(n),r)):typeof n[t]=="number"&&(delete n[t],this.P(i)?.set($v,JSON.stringify(n),r))}get C(){return this.z||(this.z=this.L(1)),this.z}get G(){return this.F||(this.F=this.L(0)),this.F}get I(){return this.H||(this.H=this.L(-1)),this.H}J(t){switch(t){case-1:return this.I;case 0:return this.G;default:return this.C}}L(t){const i=this.P(t);return i?$Y(i):Object.create(null)}isNew(t){return this.getBoolean(kY,t)===!0}async flush(t=Ul.NONE){this.g.fire({reason:t});const i=this.P(-1),s=this.P(0),r=this.P(1);switch(t){case Ul.NONE:await Hn.settled([i?.whenFlushed()??Promise.resolve(),s?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve()]);break;case Ul.SHUTDOWN:await Hn.settled([i?.flush(0)??Promise.resolve(),s?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve()]);break}}async log(){const t=this.P(-1)?.items??new Map,i=this.P(0)?.items??new Map,s=this.P(1)?.items??new Map;return PY(t,i,s,this.Q(-1)??"",this.Q(0)??"",this.Q(1)??"")}async optimize(t){return await this.flush(),this.P(t)?.optimize()}async switch(t,i){return this.u(Ul.NONE),xY(t)?this.R(t,i):this.S(t,i)}M(t,i){return!(t.id===i.id||z3(i)&&z3(t))}N(t,i,s){this.w(()=>{const r=new Set;for(const[n,o]of t)r.add(n),i.get(n)!==o&&this.t(s,{key:n,external:!0});for(const[n]of i.items)r.has(n)||this.t(s,{key:n,external:!0})})}};function z3(e){return e.isDefault||!!e.useDefaultFlags?.globalState}var DY=class extends IY{constructor(){super(),this.U=this.D(new gS(new mS,{hint:$o.STORAGE_IN_MEMORY})),this.W=this.D(new gS(new mS,{hint:$o.STORAGE_IN_MEMORY})),this.X=this.D(new gS(new mS,{hint:$o.STORAGE_IN_MEMORY})),this.D(this.X.onDidChangeStorage(e=>this.t(1,e))),this.D(this.W.onDidChangeStorage(e=>this.t(0,e))),this.D(this.U.onDidChangeStorage(e=>this.t(-1,e)))}P(e){switch(e){case-1:return this.U;case 0:return this.W;default:return this.X}}Q(e){switch(e){case-1:return"inMemory (application)";case 0:return"inMemory (profile)";default:return"inMemory (workspace)"}}async O(){}async R(){}async S(){}q(){return!1}hasScope(e){return!1}};async function PY(e,t,i,s,r,n){const o=v=>{try{return JSON.parse(v)}catch{return v}},a=new Map,c=new Map;e.forEach((v,b)=>{a.set(b,v),c.set(b,o(v))});const l=new Map,u=new Map;t.forEach((v,b)=>{l.set(b,v),u.set(b,o(v))});const h=new Map,f=new Map;i.forEach((v,b)=>{h.set(b,v),f.set(b,o(v))}),console.group(s!==r?`Storage: Application (path: ${s})`:`Storage: Application & Profile (path: ${s}, default profile)`);const p=[];if(a.forEach((v,b)=>{p.push({key:b,value:v})}),console.table(p),console.groupEnd(),console.log(c),s!==r){console.group(`Storage: Profile (path: ${r}, profile specific)`);const v=[];l.forEach((b,S)=>{v.push({key:S,value:b})}),console.table(v),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${n})`);const g=[];h.forEach((v,b)=>{g.push({key:b,value:v})}),console.table(g),console.groupEnd(),console.log(f)}var TY=class Ei{static{this.a=new Map}static{this.b=new Map}static{this.c=new Map}static{this.d="memento/"}constructor(t,i){this.f=i,this.e=Ei.d+t}getMemento(t,i){switch(t){case 1:{let s=Ei.c.get(this.e);return s||(s=new vS(this.e,t,i,this.f),Ei.c.set(this.e,s)),s.getMemento()}case 0:{let s=Ei.b.get(this.e);return s||(s=new vS(this.e,t,i,this.f),Ei.b.set(this.e,s)),s.getMemento()}case-1:{let s=Ei.a.get(this.e);return s||(s=new vS(this.e,t,i,this.f),Ei.a.set(this.e,s)),s.getMemento()}}}onDidChangeValue(t,i){return this.f.onDidChangeValue(t,this.e,i)}saveMemento(){Ei.c.get(this.e)?.save(),Ei.b.get(this.e)?.save(),Ei.a.get(this.e)?.save()}reloadMemento(t){let i;switch(t){case-1:i=Ei.a.get(this.e);break;case 0:i=Ei.b.get(this.e);break;case 1:i=Ei.c.get(this.e);break}i?.reload()}static clear(t){switch(t){case 1:Ei.c.clear();break;case 0:Ei.b.clear();break;case-1:Ei.a.clear();break}}},vS=class{constructor(e,t,i,s){this.b=e,this.c=t,this.d=i,this.e=s,this.a=this.f()}f(){try{return this.e.getObject(this.b,this.c,{})}catch(e){pt(`[memento]: failed to parse contents: ${e} (id: ${this.b}, scope: ${this.c}, contents: ${this.e.get(this.b,this.c)})`)}return{}}getMemento(){return this.a}reload(){for(const e of Object.getOwnPropertyNames(this.a))delete this.a[e];Object.assign(this.a,this.f())}save(){L1(this.a)?this.e.remove(this.b,this.c):this.e.store(this.b,this.a,this.c,this.d)}},MY=W("chatTodoListService"),wS=class{constructor(t){this.a=new TY("chat-todo-list",t)}b(t){return this.a.getMemento(1,1)[this.d(t)]||[]}c(t,i){const s=this.a.getMemento(1,1);s[this.d(t)]=i,this.a.saveMemento()}getTodoList(t){return this.b(t)}setTodoList(t,i){this.c(t,i)}d(t){return gH(t)}};wS=__decorate([__param(0,_a)],wS);var H3=class extends J{constructor(t){super(),this.a=this.D(new I),this.onDidUpdateTodos=this.a.event,this.b=new wS(t)}getTodos(t){return this.b.getTodoList(t)}setTodos(t,i){this.b.setTodoList(t,i),this.a.fire(t)}};H3=__decorate([__param(0,_a)],H3);var W3="manage_todo_list";function _3(){const e={type:"object",properties:{todoList:{type:"array",description:"Complete array of all todo items. Must include ALL items - both existing and new.",items:{type:"object",properties:{id:{type:"number",description:"Unique identifier for the todo. Use sequential numbers starting from 1."},title:{type:"string",description:"Concise action-oriented todo label (3-7 words). Displayed in UI."},status:{type:"string",enum:["not-started","in-progress","completed"],description:"not-started: Not begun | in-progress: Currently working (max 1) | completed: Fully finished with no blockers"}},required:["id","title","status"]}}},required:["todoList"]};return{id:W3,toolReferenceName:"todo",legacyToolReferenceFullNames:["todos"],canBeReferencedInPrompt:!0,icon:Ft.fromId(ce.checklist.id),displayName:d(7202,null),userDescription:d(7203,null),modelDescription:`Manage a structured todo list to track progress and plan tasks throughout your coding session. Use this tool VERY frequently to ensure task visibility and proper planning.

When to use this tool:
- Complex multi-step work requiring planning and tracking
- When user provides multiple tasks or requests (numbered/comma-separated)
- After receiving new instructions that require multiple steps
- BEFORE starting work on any todo (mark as in-progress)
- IMMEDIATELY after completing each todo (mark completed individually)
- When breaking down larger tasks into smaller actionable steps
- To give users visibility into your progress and planning

When NOT to use:
- Single, trivial tasks that can be completed in one step
- Purely conversational/informational requests
- When just reading files or performing simple searches

CRITICAL workflow:
1. Plan tasks by writing todo list with specific, actionable items
2. Mark ONE todo as in-progress before starting work
3. Complete the work for that specific todo
4. Mark that todo as completed IMMEDIATELY
5. Move to next todo and repeat

Todo states:
- not-started: Todo not yet begun
- in-progress: Currently working (limit ONE at a time)
- completed: Finished successfully

IMPORTANT: Mark todos completed as soon as they are done. Do not batch completions.`,source:io.Internal,inputSchema:e}}var Rce=_3(),bS=class extends J{constructor(t,i,s){super(),this.a=t,this.b=i,this.c=s}async invoke(t,i,s,r){const n=t.parameters;let o=t.context?.sessionResource;if(!o&&n.operation==="read"&&n.chatSessionResource)try{o=y.parse(n.chatSessionResource)}catch(a){this.b.error("ManageTodoListTool: Invalid chatSessionResource URI",a)}if(!o)return{content:[{kind:"text",value:"Error: No session resource available"}]};this.b.debug(`ManageTodoListTool: Invoking with options ${JSON.stringify(n)}`);try{return n.operation==="read"?this.h(o):this.j(n,o)}catch(a){return{content:[{kind:"text",value:`Error: ${a instanceof Error?a.message:"Unknown error"}`}]}}}async prepareToolInvocation(t,i){const s=t.parameters,r=t.chatSessionResource;if(!r)return;const n=this.a.getTodos(r);let o;s.operation==="read"?o=d(7204,null):s.todoList&&(o=this.f(n,s.todoList));const c=(s.todoList??n).map(l=>({id:l.id.toString(),title:l.title,status:l.status}));return{pastTenseMessage:new Qn(o??d(7205,null)),toolSpecificData:{kind:"todoList",todoList:c}}}f(t,i){if(t.length===0)return i.length===1?d(7206,null):d(7207,null,i.length);const s=new Map(t.map(a=>[a.id,a])),r=i.filter(a=>{const c=s.get(a.id);return c&&c.status!=="in-progress"&&a.status==="in-progress"});if(r.length>0){const a=r[0],c=i.length,l=i.findIndex(u=>u.id===a.id)+1;return d(7208,null,a.title,l,c)}const n=i.filter(a=>{const c=s.get(a.id);return c&&c.status!=="completed"&&a.status==="completed"});if(n.length>0){const a=n[0],c=i.length,l=i.findIndex(u=>u.id===a.id)+1;return d(7209,null,a.title,l,c)}const o=i.filter(a=>!s.has(a.id));return o.length>0?o.length===1?d(7210,null):d(7211,null,o.length):d(7212,null)}g(t,i){return t.length===0?"No todo list found.":`# Todo List

${this.q(t)}`}h(t){const i=this.a.getTodos(t),s=this.g(i,t),r=this.m(i);return this.c.publicLog2("todoListToolInvoked",{operation:"read",notStartedCount:r.notStartedCount,inProgressCount:r.inProgressCount,completedCount:r.completedCount}),{content:[{kind:"text",value:s}]}}j(t,i){if(!t.todoList)return{content:[{kind:"text",value:"Error: todoList is required for write operation"}]};const s=t.todoList.map(c=>({id:c.id,title:c.title,status:c.status})),r=this.a.getTodos(i),n=this.r(r,s);this.a.setTodos(i,s);const o=this.m(s),a=[];return s.length<3?a.push("Warning: Small todo list (<3 items). This task might not need a todo list."):s.length>10&&a.push("Warning: Large todo list (>10 items). Consider keeping the list focused and actionable."),n>3&&a.push("Warning: Did you mean to update so many todos at the same time? Consider working on them one by one."),this.c.publicLog2("todoListToolInvoked",{operation:"write",notStartedCount:o.notStartedCount,inProgressCount:o.inProgressCount,completedCount:o.completedCount}),{content:[{kind:"text",value:`Successfully wrote todo list${a.length?`

`+a.join(`
`):""}`}],toolMetadata:{warnings:a}}}m(t){const i=t.filter(n=>n.status==="not-started").length,s=t.filter(n=>n.status==="in-progress").length,r=t.filter(n=>n.status==="completed").length;return{notStartedCount:i,inProgressCount:s,completedCount:r}}q(t){return t.length===0?"":t.map(i=>{let s;switch(i.status){case"completed":s="[x]";break;case"in-progress":s="[-]";break;default:s="[ ]";break}return[`- ${s} ${i.title}`].join(`
`)}).join(`
`)}r(t,i){let s=0;const r=Math.min(t.length,i.length);for(let c=0;c<r;c++){const l=t[c],u=i[c];(l.title!==u.title||l.status!==u.status)&&s++}const n=Math.max(0,i.length-t.length),o=Math.max(0,t.length-i.length);return n+o+s}};bS=__decorate([__param(0,MY),__param(1,xe),__param(2,Zu)],bS);var yS;(function(e){e[e.Blur=1]="Blur",e[e.Gesture=2]="Gesture",e[e.Other=3]="Other"})(yS||(yS={}));var B3;(function(e){e.QuickPick="quickPick",e.InputBox="inputBox",e.QuickWidget="quickWidget",e.QuickTree="quickTree"})(B3||(B3={}));var q3;(function(e){e[e.NONE=0]="NONE",e[e.FIRST=1]="FIRST",e[e.SECOND=2]="SECOND",e[e.LAST=3]="LAST"})(q3||(q3={}));var V3;(function(e){e[e.First=1]="First",e[e.Second=2]="Second",e[e.Last=3]="Last",e[e.Next=4]="Next",e[e.Previous=5]="Previous",e[e.NextPage=6]="NextPage",e[e.PreviousPage=7]="PreviousPage",e[e.NextSeparator=8]="NextSeparator",e[e.PreviousSeparator=9]="PreviousSeparator"})(V3||(V3={}));var G3;(function(e){e[e.Title=1]="Title",e[e.Inline=2]="Inline",e[e.Input=3]="Input"})(G3||(G3={}));var NY=class{constructor(e){this.a=e}getItemLabel(e){return e.label}getItemDescription(e){if(!this.a?.skipDescription)return e.description}getItemPath(e){if(!this.a?.skipPath)return e.resource?.scheme===V.file?e.resource.fsPath:e.resource?.path}},Oce=new NY,RY=W("quickInputService"),LY=W("encryptionService"),Fce=W("encryptionMainService"),J3;(function(e){e.kwallet="kwallet",e.kwallet5="kwallet5",e.gnomeLibsecret="gnome-libsecret",e.basic="basic"})(J3||(J3={}));var Z3;(function(e){e.unknown="unknown",e.basicText="basic_text",e.gnomeAny="gnome_any",e.gnomeLibsecret="gnome_libsecret",e.gnomeKeyring="gnome_keyring",e.kwallet="kwallet",e.kwallet5="kwallet5",e.kwallet6="kwallet6",e.dplib="dpapi",e.keychainAccess="keychain_access"})(Z3||(Z3={}));var OY=W("secretStorageService"),Y3=class extends J{constructor(t,i,s,r){super(),this.h=t,this.j=i,this.m=s,this.n=r,this.a="secret://",this.b=this.D(new I),this.onDidChangeSecret=this.b.event,this.c=new i0,this.f="unknown",this.g=this.D(new X),this.q=new Rt(()=>this.s())}get type(){return this.f}get r(){return this.q.value}get(t){return this.c.queue(t,async()=>{const i=await this.r,s=this.w(t);this.n.trace("[secrets] getting secret for key:",s);const r=i.get(s,-1);if(!r){this.n.trace("[secrets] no secret found for key:",s);return}try{this.n.trace("[secrets] decrypting gotten secret for key:",s);const n=this.f==="in-memory"?r:await this.m.decrypt(r);return this.n.trace("[secrets] decrypted secret for key:",s),n}catch(n){this.n.error(n),this.delete(t);return}})}set(t,i){return this.c.queue(t,async()=>{const s=await this.r;this.n.trace("[secrets] encrypting secret for key:",t);let r;try{r=this.f==="in-memory"?i:await this.m.encrypt(i)}catch(o){throw this.n.error(o),o}const n=this.w(t);this.n.trace("[secrets] storing encrypted secret for key:",n),s.store(n,r,-1,1),this.n.trace("[secrets] stored encrypted secret for key:",n)})}delete(t){return this.c.queue(t,async()=>{const i=await this.r,s=this.w(t);this.n.trace("[secrets] deleting secret for key:",s),i.remove(s,-1),this.n.trace("[secrets] deleted secret for key:",s)})}keys(){return this.c.queue("__keys__",async()=>{const t=await this.r;this.n.trace("[secrets] fetching keys of all secrets");const i=t.keys(-1,1);return this.n.trace("[secrets] fetched keys of all secrets"),i.filter(s=>s.startsWith(this.a)).map(s=>s.slice(this.a.length))})}async s(){let t;if(!this.h&&await this.m.isEncryptionAvailable())this.n.trace("[SecretStorageService] Encryption is available, using persisted storage"),this.f="persisted",t=this.j;else{if(this.f==="in-memory")return this.j;this.n.trace("[SecretStorageService] Encryption is not available, falling back to in-memory storage"),this.f="in-memory",t=this.D(new DY)}return this.g.clear(),this.g.add(t.onDidChangeValue(-1,void 0,this.g)(i=>{this.u(i.key)})),t}t(){this.q=new Rt(()=>this.s())}u(t){if(!t.startsWith(this.a))return;const i=t.slice(this.a.length);this.n.trace(`[SecretStorageService] Notifying change in value for secret: ${i}`),this.b.fire(i)}w(t){return`${this.a}${t}`}};Y3=__decorate([__param(1,_a),__param(2,LY),__param(3,xe)],Y3);var Uce=new C("isMac",Nt,d(1863,null)),zce=new C("isLinux",Mt,d(1864,null)),Hce=new C("isWindows",ze,d(1865,null)),FY=new C("isWeb",jo,d(1866,null)),Wce=new C("isMacNative",Nt&&!jo,d(1867,null)),_ce=new C("isIOS",g2,d(1868,null)),Bce=new C("isMobile",m2,d(1869,null)),qce=new C("isDevelopment",!1,!0),Vce=new C("productQualityType","",d(1870,null)),jY="inputFocus",Gce=new C(jY,!1,d(1871,null)),AS=W("languageService"),SS=W("modelService"),Q3=class extends rI{constructor(){super(...arguments),this.f=this.D(new I),this.g=this.D(new I),this.j=this.D(new I),this.n=this.D(new I),this.onDidChangeDirty=this.f.event,this.onDidChangeLabel=this.g.event,this.onDidChangeCapabilities=this.j.event,this.onWillDispose=this.n.event}get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}canReopen(){return!0}matches(e){if(Js(e))return this===e;const t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:hc(this.resource,dw.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this.B.isDisposed}dispose(){this.isDisposed()||this.n.fire(),super.dispose()}},zl,ES=class extends Q3{static{zl=this}static{this.ID="workbench.editorinputs.sidebysideEditorInput"}get typeId(){return zl.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.a)return this.primary.resource}constructor(t,i,s,r,n){super(),this.b=t,this.c=i,this.secondary=s,this.primary=r,this.h=n,this.a=this.primary.matches(this.secondary),this.m()}m(){this.D(Ie.once(Ie.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this.D(this.primary.onDidChangeDirty(()=>this.f.fire())),this.D(this.primary.onDidChangeCapabilities(()=>this.j.fire())),this.D(this.secondary.onDidChangeCapabilities(()=>this.j.fire())),this.D(this.primary.onDidChangeLabel(()=>this.g.fire())),this.D(this.secondary.onDidChangeLabel(()=>this.g.fire()))}getName(){const t=this.getPreferredName();return t||(this.a?this.primary.getName():d(4501,null,this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.b}getDescription(t){const i=this.getPreferredDescription();return i||(this.a?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.c}getTitle(t){let i;this.a?i=this.primary.getTitle(t)??this.getName():i=super.getTitle(t);const s=this.q();return s&&(i=`${s} (${i})`),i}q(){if(this.b&&this.c)return`${this.b} ${this.c}`;if(this.b||this.c)return this.b??this.c}getLabelExtraClasses(){return this.a?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.a?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,i){const s=await this.primary.save(t,i);return this.r(s)}async saveAs(t,i){const s=await this.primary.saveAs(t,i);return this.r(s)}r(t){if(!t||!this.a)return t;if(this.primary.matches(t))return this;if(t instanceof Q3)return new zl(this.b,this.c,t,t,this.h);if(!sn(t)&&!Fu(t)&&!ra(t)&&!na(t))return{primary:t,secondary:t,label:this.b,description:this.c}}revert(t,i){return this.primary.revert(t,i)}async rename(t,i){if(!this.a)return;const s=await this.primary.rename(t,i);if(s){if(Js(s.editor))return{editor:new zl(this.b,this.c,s.editor,s.editor,this.h),options:{...s.options,viewState:hw(this,t,this.h)}};if(lH(s.editor))return{editor:{label:this.b,description:this.c,primary:s.editor,secondary:s.editor,options:{...s.options,viewState:hw(this,t,this.h)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){const i=this.primary.toUntyped(t),s=this.secondary.toUntyped(t);if(i&&s&&!sn(i)&&!sn(s)&&!Fu(i)&&!Fu(s)&&!ra(i)&&!ra(s)&&!na(i)&&!na(s)){const r={label:this.b,description:this.c,primary:i,secondary:s};return typeof t?.preserveViewState=="number"&&(r.options={viewState:hw(this,t.preserveViewState,this.h)}),r}}matches(t){return this===t?!0:nI(t)||sn(t)?!1:t instanceof zl?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):ra(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};ES=zl=__decorate([__param(4,K6)],ES);var X3=class extends J{constructor(){super(...arguments),this.f=this.D(new I),this.onWillDispose=this.f.event,this.h=!1}async resolve(){this.h=!0}isResolved(){return this.h}isDisposed(){return this.B.isDisposed}dispose(){this.f.fire(),super.dispose()}},UY={ModesRegistry:"editor.modesRegistry"},zY=class extends J{constructor(){super(),this.b=this.D(new I),this.onDidChangeLanguages=this.b.event,this.a=[]}registerLanguage(e){return this.a.push(e),this.b.fire(void 0),{dispose:()=>{for(let t=0,i=this.a.length;t<i;t++)if(this.a[t]===e){this.a.splice(t,1);return}}}}getLanguages(){return this.a}},K3=new zY;Qt.add(UY.ModesRegistry,K3);var Iv="plaintext",HY=".txt";K3.registerLanguage({id:Iv,extensions:[HY],aliases:[d(909,null),"text"],mimetypes:[Gs.text]}),Qt.as(oo.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);var WY=W("ILanguageDetectionService"),eT="languageDetection",_Y=W("accessibilityService"),tT;(function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Enabled=2]="Enabled"})(tT||(tT={}));var Zce=new C("accessibilityModeEnabled",!1),xS,Dv=class extends X3{static{xS=this}static{this.a=600}constructor(t,i,s,r,n){super(),this.n=t,this.q=i,this.r=s,this.s=r,this.b=void 0,this.j=this.D(new Hs),this.m=this.D(new gu(xS.a)),this.w=!1,this.y=void 0,n&&this.t(n)}t(t){const i=this.n.getModel(t);if(!i)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.b=t,this.u(i)}u(t){this.j.value=t.onWillDispose(()=>{this.b=void 0,this.dispose()})}get textEditorModel(){return this.b?this.n.getModel(this.b):null}isReadonly(){return!0}get languageChangeSource(){return this.y}get hasLanguageSetExplicitly(){return typeof this.y=="string"}setLanguageId(t,i){this.y="user",this.z(t,i)}z(t,i){if(this.isResolved()&&!(!t||t===this.textEditorModel.getLanguageId())){this.w=!0;try{this.textEditorModel.setLanguage(this.q.createById(t),i)}finally{this.w=!1}}}C(t){const i=this.D(t.onDidChangeLanguage(s=>{s.source===eT||this.w||(this.y="api",i.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}F(){return this.m.trigger(()=>this.G())}async G(){if(this.hasLanguageSetExplicitly||!this.b||!this.r.isEnabledForLanguage(this.getLanguageId()??Iv))return;const t=await this.r.detectLanguage(this.b),i=this.getLanguageId();if(t&&t!==i&&!this.isDisposed()){this.z(t,eT);const s=this.q.getLanguageName(t);this.s.alert(d(4502,null,s??t))}}H(t,i,s){const r=this.J(t),n=this.L(i,this.q,s,r);return this.I(t,n,i)}I(t,i,s){let r=s&&this.n.getModel(s);return r?this.updateTextEditorModel(t,i.languageId):(r=this.n.createModel(t,i,s),this.g=!0,this.u(r)),this.b=r.uri,r}J(t){const i=t;return typeof i.getFirstLineText=="function"?i.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}L(t,i,s,r){return!s||s===Iv?i.createByFilepathOrFirstLine(t??null,r):i.createById(s)}updateTextEditorModel(t,i,s){this.isResolved()&&(t&&this.n.updateModel(this.textEditorModel,t,s),i&&i!==Iv&&this.textEditorModel.getLanguageId()!==i&&this.textEditorModel.setLanguage(this.q.createById(i)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.b}dispose(){this.j.dispose(),this.b&&this.g&&this.n.destroyModel(this.b),this.b=void 0,this.g=!1,super.dispose()}};Dv=xS=__decorate([__param(0,SS),__param(1,AS),__param(2,WY),__param(3,_Y)],Dv);var iT=class extends X3{get originalModel(){return this.a}get modifiedModel(){return this.b}constructor(e,t){super(),this.a=e,this.b=t}async resolve(){await Promise.all([this.a?.resolve(),this.b?.resolve()])}isResolved(){return!!(this.a?.isResolved()&&this.b?.isResolved())}dispose(){super.dispose()}},BY=class extends iT{get originalModel(){return this.a}get modifiedModel(){return this.b}get textDiffEditorModel(){return this.j}constructor(e,t){super(e,t),this.j=void 0,this.a=e,this.b=t,this.m()}async resolve(){await super.resolve(),this.m()}m(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this.j?(this.j.original=this.originalModel.textEditorModel,this.j.modified=this.modifiedModel.textEditorModel):this.j={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this.j}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this.j=void 0,super.dispose()}};function sT(e){const t=e;return typeof t?.resolve=="function"&&typeof t?.isResolved=="function"}var rT;(function(e){e[e.ACTIVATE=1]="ACTIVATE",e[e.RESTORE=2]="RESTORE",e[e.PRESERVE=3]="PRESERVE"})(rT||(rT={}));var nT;(function(e){e[e.PICK=0]="PICK",e[e.EXCLUSIVE_ONLY=1]="EXCLUSIVE_ONLY"})(nT||(nT={}));var oT;(function(e){e[e.API=0]="API",e[e.USER=1]="USER"})(oT||(oT={}));var aT;(function(e){e[e.Center=0]="Center",e[e.CenterIfOutsideViewport=1]="CenterIfOutsideViewport",e[e.NearTop=2]="NearTop",e[e.NearTopIfOutsideViewport=3]="NearTopIfOutsideViewport"})(aT||(aT={}));var cT;(function(e){e.PROGRAMMATIC="api",e.NAVIGATION="code.navigation",e.JUMP="code.jump"})(cT||(cT={}));var Pv,lT=class extends ES{static{Pv=this}static{this.ID="workbench.editors.diffEditorInput"}get typeId(){return Pv.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.t.forceDescription&&(t|=64),t}constructor(t,i,s,r,n,o){super(t,i,s,r,o),this.original=s,this.modified=r,this.u=n,this.s=void 0,this.t=this.w()}w(){let t,i=!1;if(this.b)t=this.b;else{const u=this.original.getName(),h=this.modified.getName();t=d(4500,null,u,h),i=u===h}let s,r,n;if(this.c)s=this.c,r=this.c,n=this.c;else{s=this.y(this.original.getDescription(0),this.modified.getDescription(0)),n=this.y(this.original.getDescription(2),this.modified.getDescription(2));const u=this.original.getDescription(1),h=this.modified.getDescription(1);if(typeof u=="string"&&typeof h=="string"&&(u||h)){const[f,p]=yH([u,h]);r=this.y(f,p)}}let o=this.y(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),a=this.y(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),c=this.y(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 ");const l=this.q();return l&&(o=`${l} (${o})`,a=`${l} (${a})`,c=`${l} (${c})`),{name:t,shortDescription:s,mediumDescription:r,longDescription:n,forceDescription:i,shortTitle:o,mediumTitle:a,longTitle:c}}y(t,i,s=" - "){if(!(!t||!i))return t===i?i:`${t}${s}${i}`}getName(){return this.t.name}getDescription(t=1){switch(t){case 0:return this.t.shortDescription;case 2:return this.t.longDescription;default:return this.t.mediumDescription}}getTitle(t){switch(t){case 0:return this.t.shortTitle;case 2:return this.t.longTitle;default:case 1:return this.t.mediumTitle}}async resolve(){const t=await this.z();return this.s?.dispose(),this.s=t,this.s}prefersEditorPane(t){return this.u?t.find(i=>i.typeId===cH):t.find(i=>i.typeId===aH)}async z(){const[t,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return i instanceof Dv&&t instanceof Dv?new BY(t,i):new iT(sT(t)?t:void 0,sT(i)?i:void 0)}toUntyped(t){const i=super.toUntyped(t);if(i)return{...i,modified:i.primary,original:i.secondary}}matches(t){return this===t?!0:t instanceof Pv?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.u===this.u:sn(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.s&&(this.s.dispose(),this.s=void 0),super.dispose()}};lT=Pv=__decorate([__param(5,K6)],lT);var ur,Xce=new C("workbenchState",void 0,{type:"string",description:d(4420,null)}),Kce=new C("workspaceFolderCount",0,d(4421,null)),ele=new C("openFolderWorkspaceSupport",!0,!0),tle=new C("enterMultiRootWorkspaceSupport",!0,!0),ile=new C("emptyWorkspaceSupport",!0,!0),sle=new C("dirtyWorkingCopies",!1,d(4422,null)),qY=new C("remoteName","",d(4423,null)),rle=new C("virtualWorkspace","",d(4424,null)),nle=new C("temporaryWorkspace",!1,d(4425,null)),ole=new C("isAgentSessionsWorkspace",!1,d(4426,null)),ale=new C("workbenchMode","",d(4427,null)),cle=new C("hasWebFileSystemAccess",!1,!0),lle=new C("embedderIdentifier",void 0,d(4428,null)),ule=new C("inAutomation",!1,d(4429,null)),hle=new C("isFullscreen",!1,d(4430,null)),dle=new C("isAuxiliaryWindowFocusedContext",!1,d(4431,null)),fle=new C("isWindowAlwaysOnTop",!1,d(4432,null)),ple=new C("isAuxiliaryWindow",!1,d(4433,null)),gle=new C("activeEditorIsDirty",!1,d(4434,null)),mle=new C("activeEditorIsNotPreview",!1,d(4435,null)),vle=new C("activeEditorIsFirstInGroup",!1,d(4436,null)),wle=new C("activeEditorIsLastInGroup",!1,d(4437,null)),ble=new C("activeEditorIsPinned",!1,d(4438,null)),yle=new C("activeEditorIsReadonly",!1,d(4439,null)),Ale=new C("activeCompareEditorCanSwap",!1,d(4440,null)),Sle=new C("activeEditorCanToggleReadonly",!0,d(4441,null)),Ele=new C("activeEditorCanRevert",!1,d(4442,null)),xle=new C("activeEditorCanSplitInGroup",!0),Cle=new C("activeEditor",null,{type:"string",description:d(4443,null)}),kle=new C("activeEditorAvailableEditorIds","",d(4444,null)),$le=new C("textCompareEditorVisible",!1,d(4445,null)),Ile=new C("textCompareEditorActive",!1,d(4446,null)),Dle=new C("sideBySideEditorActive",!1,d(4447,null)),Ple=new C("groupEditorsCount",0,d(4448,null)),Tle=new C("activeEditorGroupEmpty",!1,d(4449,null)),Mle=new C("activeEditorGroupIndex",0,d(4450,null)),Nle=new C("activeEditorGroupLast",!1,d(4451,null)),Rle=new C("activeEditorGroupLocked",!1,d(4452,null)),VY=new C("multipleEditorGroups",!1,d(4453,null)),Lle=VY.toNegated(),Ole=new C("multipleEditorsSelectedInGroup",!1,d(4454,null)),Fle=new C("twoEditorsSelectedInGroup",!1,d(4455,null)),jle=new C("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,d(4456,null)),GY=new C("editorPartMultipleEditorGroups",!1,d(4457,null)),Ule=GY.toNegated(),zle=new C("editorPartMaximizedEditorGroup",!1,d(4458,null)),Hle=new C("editorIsOpen",!1,d(4459,null)),Wle=new C("inZenMode",!1,d(4460,null)),_le=new C("isCenteredLayout",!1,d(4461,null)),Ble=new C("splitEditorsVertically",!1,d(4462,null)),qle=new C("mainEditorAreaVisible",!0,d(4463,null)),Vle=new C("editorTabsVisible",!0,d(4464,null)),Gle=new C("sideBarVisible",!1,d(4465,null)),Jle=new C("sideBarFocus",!1,d(4466,null)),Zle=new C("activeViewlet","",d(4467,null)),Yle=new C("statusBarFocused",!1,d(4468,null)),Qle=new C("titleBarStyle","custom",d(4469,null)),Xle=new C("titleBarVisible",!1,d(4470,null)),Kle=new C("isCompactTitleBar",!1,d(4471,null)),eue=new C("bannerFocused",!1,d(4472,null)),tue=new C("notificationFocus",!0,d(4473,null)),iue=new C("notificationCenterVisible",!1,d(4474,null)),sue=new C("notificationToastsVisible",!1,d(4475,null)),rue=new C("activeAuxiliary","",d(4476,null)),nue=new C("auxiliaryBarFocus",!1,d(4477,null)),oue=new C("auxiliaryBarVisible",!1,d(4478,null)),aue=new C("auxiliaryBarMaximized",!1,d(4479,null)),cue=new C("activePanel","",d(4480,null)),lue=new C("panelFocus",!1,d(4481,null)),uue=new C("panelPosition","bottom",d(4482,null)),hue=new C("panelAlignment","center",d(4483,null)),due=new C("panelVisible",!1,d(4484,null)),fue=new C("panelMaximized",!1,d(4485,null)),pue=new C("focusedView","",d(4486,null)),CS=class{static{ur=this}static{this.Scheme=new C("resourceScheme",void 0,{type:"string",description:d(4487,null)})}static{this.Filename=new C("resourceFilename",void 0,{type:"string",description:d(4488,null)})}static{this.Dirname=new C("resourceDirname",void 0,{type:"string",description:d(4489,null)})}static{this.Path=new C("resourcePath",void 0,{type:"string",description:d(4490,null)})}static{this.LangId=new C("resourceLangId",void 0,{type:"string",description:d(4491,null)})}static{this.Resource=new C("resource",void 0,{type:"URI",description:d(4492,null)})}static{this.Extension=new C("resourceExtname",void 0,{type:"string",description:d(4493,null)})}static{this.HasResource=new C("resourceSet",void 0,{type:"boolean",description:d(4494,null)})}static{this.IsFileSystemResource=new C("isFileSystemResource",void 0,{type:"boolean",description:d(4495,null)})}constructor(t,i,s,r){this.l=t,this.m=i,this.n=s,this.o=r,this.c=ur.Scheme.bindTo(this.l),this.d=ur.Filename.bindTo(this.l),this.f=ur.Dirname.bindTo(this.l),this.g=ur.Path.bindTo(this.l),this.h=ur.LangId.bindTo(this.l),this.b=ur.Resource.bindTo(this.l),this.i=ur.Extension.bindTo(this.l),this.j=ur.HasResource.bindTo(this.l),this.k=ur.IsFileSystemResource.bindTo(this.l)}p(){const t=this.get();if(!t){this.h.set(null);return}const i=this.o.getModel(t)?.getLanguageId()??this.n.guessLanguageIdByFilepathOrFirstLine(t);this.h.set(i)}set(t){t=t??void 0,!hc(this.a,t)&&(this.a=t,this.l.bufferChangeEvents(()=>{this.b.set(t?t.toString():null),this.c.set(t?t.scheme:null),this.d.set(t?ji(t):null),this.f.set(t?this.q(dc(t)):null),this.g.set(t?this.q(t):null),this.p(),this.i.set(t?CC(t):null),this.j.set(!!t),this.k.set(t?this.m.hasProvider(t):!1)}))}q(t){return t.scheme===V.file?t.fsPath:t.path}reset(){this.a=void 0,this.l.bufferChangeEvents(()=>{this.b.reset(),this.c.reset(),this.d.reset(),this.f.reset(),this.g.reset(),this.h.reset(),this.i.reset(),this.j.reset(),this.k.reset()})}get(){return this.a}};CS=ur=__decorate([__param(0,Jn),__param(1,Bf),__param(2,AS),__param(3,SS)],CS);var uT=class extends CS{constructor(t,i,s,r){super(t,i,s,r),this.r=new X,this.r.add(i.onDidChangeFileSystemProviderRegistrations(()=>{const n=this.get();this.k.set(!!(n&&i.hasProvider(n)))})),this.r.add(r.onModelAdded(n=>{hc(n.uri,this.get())&&this.p()})),this.r.add(r.onModelLanguageChanged(n=>{hc(n.model.uri,this.get())&&this.p()}))}dispose(){this.r.dispose()}};uT=__decorate([__param(0,Jn),__param(1,Bf),__param(2,AS),__param(3,SS)],uT);var hT=W("dialogService"),dT;(function(e){e[e.Confirmation=1]="Confirmation",e[e.Prompt=2]="Prompt",e[e.Input=3]="Input"})(dT||(dT={}));var vue=W("fileDialogService"),fT;(function(e){e[e.SAVE=0]="SAVE",e[e.DONT_SAVE=1]="DONT_SAVE",e[e.CANCEL=2]="CANCEL"})(fT||(fT={}));var pT=W("requestService"),JY=class{constructor(e){this.b=e}toJSON(){if(!this.a){const e=Object.create(null);for(const t in this.b)t.toLowerCase()==="authorization"||t.toLowerCase()==="proxy-authorization"?e[t]="*****":e[t]=this.b[t];this.a=e}return this.a}},ZY=class extends J{constructor(e){super(),this.b=e,this.a=0}async c(e,t){const i=`#${++this.a}: ${e.url}`;this.b.trace(`${i} - begin`,e.type,new JY(e.headers??{}));try{const s=await t();return this.b.trace(`${i} - end`,e.type,s.res.statusCode,s.res.headers),s}catch(s){throw this.b.error(`${i} - error`,e.type,Xd(s)),s}}};function YY(e){return e.res.statusCode&&e.res.statusCode>=200&&e.res.statusCode<300||e.res.statusCode===1223}function gT(e){return e.res.statusCode===204}async function mT(e){return gT(e)?null:(await BC(e.stream)).toString()}async function QY(e){if(!YY(e))throw new Error("Server returned "+e.res.statusCode);if(gT(e))return null;const i=(await BC(e.stream)).toString();try{return JSON.parse(i)}catch(s){throw s.message+=`:
`+i,s}}var Tv=!1,kS=[],vT=void 0,wT=void 0;function XY(e=!0,t=!0){if(vT===e&&wT===t)return;vT=e,wT=t;const i=Qt.as(oo.Configuration),s=kS;kS=[{id:"http",order:15,title:d(2295,null),type:"object",scope:2,properties:{"http.useLocalProxyConfiguration":{type:"boolean",default:t,markdownDescription:d(2296,null),restricted:!0}}},{id:"http",order:15,title:d(2297,null),type:"object",scope:1,properties:{"http.electronFetch":{type:"boolean",default:!1,description:d(2298,null),restricted:!0}}},{id:"http",order:15,title:d(2299,null),type:"object",scope:e?1:2,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:d(2300,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,markdownDescription:d(2301,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:d(2302,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:d(2303,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:d(2304,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[d(2305,null),d(2306,null),d(2307,null),d(2308,null)],default:"override",markdownDescription:d(2309,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,markdownDescription:d(2310,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificatesNode":{type:"boolean",tags:["experimental"],default:Tv,markdownDescription:d(2311,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0,experiment:{mode:"auto"}},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,markdownDescription:d(2312,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.fetchAdditionalSupport":{type:"boolean",default:!0,markdownDescription:d(2313,null,"`#http.useLocalProxyConfiguration#`","`#http.proxySupport#`","`#http.systemCertificates#`"),restricted:!0},"http.experimental.networkInterfaceCheckInterval":{type:"number",default:300,minimum:-1,tags:["experimental"],markdownDescription:d(2314,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0,experiment:{mode:"auto"}}}}],i.updateConfigurations({add:kS,remove:s})}XY();var KY=W("openerService"),eQ=W("lifecycleService"),bT;(function(e){e[e.Default=1]="Default",e[e.Last=2]="Last"})(bT||(bT={}));var yT;(function(e){e[e.CLOSE=1]="CLOSE",e[e.QUIT=2]="QUIT",e[e.RELOAD=3]="RELOAD",e[e.LOAD=4]="LOAD"})(yT||(yT={}));var AT;(function(e){e[e.NewWindow=1]="NewWindow",e[e.ReloadedWindow=3]="ReloadedWindow",e[e.ReopenedWindow=4]="ReopenedWindow"})(AT||(AT={}));var ST;(function(e){e[e.Starting=1]="Starting",e[e.Ready=2]="Ready",e[e.Restored=3]="Restored",e[e.Eventually=4]="Eventually"})(ST||(ST={}));var tQ=W("defaultAccountService"),Hl,Ee;(function(e){e.Setup={hidden:new C("chatSetupHidden",!1,!0),installed:new C("chatSetupInstalled",!1,!0),disabled:new C("chatSetupDisabled",!1,!0),untrusted:new C("chatSetupUntrusted",!1,!0),later:new C("chatSetupLater",!1,!0),registered:new C("chatSetupRegistered",!1,!0)},e.Entitlement={signedOut:new C("chatEntitlementSignedOut",!1,!0),canSignUp:new C("chatPlanCanSignUp",!1,!0),planFree:new C("chatPlanFree",!1,!0),planPro:new C("chatPlanPro",!1,!0),planProPlus:new C("chatPlanProPlus",!1,!0),planBusiness:new C("chatPlanBusiness",!1,!0),planEnterprise:new C("chatPlanEnterprise",!1,!0),organisations:new C("chatEntitlementOrganisations",void 0,!0),internal:new C("chatEntitlementInternal",!1,!0),sku:new C("chatEntitlementSku",void 0,!0)},e.chatQuotaExceeded=new C("chatQuotaExceeded",!1,!0),e.completionsQuotaExceeded=new C("completionsQuotaExceeded",!1,!0),e.chatAnonymous=new C("chatAnonymous",!1,!0)})(Ee||(Ee={}));var iQ=W("chatEntitlementService"),Ye;(function(e){e[e.Unknown=1]="Unknown",e[e.Unresolved=2]="Unresolved",e[e.Available=3]="Available",e[e.Unavailable=4]="Unavailable",e[e.Free=5]="Free",e[e.Pro=6]="Pro",e[e.ProPlus=7]="ProPlus",e[e.Business=8]="Business",e[e.Enterprise=9]="Enterprise"})(Ye||(Ye={}));function sQ(e){return e===Ye.Pro||e===Ye.ProPlus||e===Ye.Business||e===Ye.Enterprise}var Mv={upgradePlanUrl:qs.defaultChatAgent?.upgradePlanUrl??"",providerUriSetting:qs.defaultChatAgent?.providerUriSetting??"",entitlementSignupLimitedUrl:qs.defaultChatAgent?.entitlementSignupLimitedUrl??"",chatQuotaExceededContext:qs.defaultChatAgent?.chatQuotaExceededContext??"",completionsQuotaExceededContext:qs.defaultChatAgent?.completionsQuotaExceededContext??""},ET="chat.allowAnonymousAccess";function $S(e,t,i){return!(e.getValue(ET)!==!0||t!==Ye.Unknown||i.hidden||i.disabled)}function xT(e,t,i){i.publicLog2("chatEntitlements",{chatHidden:!!e.hidden,chatDisabled:!!e.disabled,chatEntitlement:e.entitlement,chatRegistered:!!e.registered,chatAnonymous:$S(t,e.entitlement,e)})}var IS=class extends J{constructor(t,i,s,r,n,o){if(super(),this.a=r,this.b=n,this.c=o,this.f=this.D(new I),this.onDidChangeQuotaExceeded=this.f.event,this.g=this.D(new I),this.onDidChangeQuotaRemaining=this.g.event,this.h={},this.n={chatQuotaExceeded:Mv.chatQuotaExceededContext,completionsQuotaExceeded:Mv.completionsQuotaExceededContext},this.w=this.D(new I),this.onDidChangeAnonymous=this.w.event,this.anonymousObs=_u(this.onDidChangeAnonymous,()=>this.anonymous),this.j=Ee.chatQuotaExceeded.bindTo(this.a),this.m=Ee.completionsQuotaExceeded.bindTo(this.a),this.u=Ee.chatAnonymous.bindTo(this.a),this.u.set(this.anonymous),this.onDidChangeEntitlement=Ie.map(Ie.filter(this.a.onDidChangeContext,c=>c.affectsSome(new Set([Ee.Entitlement.planPro.key,Ee.Entitlement.planBusiness.key,Ee.Entitlement.planEnterprise.key,Ee.Entitlement.planProPlus.key,Ee.Entitlement.planFree.key,Ee.Entitlement.canSignUp.key,Ee.Entitlement.signedOut.key,Ee.Entitlement.organisations.key,Ee.Entitlement.internal.key,Ee.Entitlement.sku.key])),this.B),()=>{},this.B),this.entitlementObs=_u(this.onDidChangeEntitlement,()=>this.entitlement),this.onDidChangeSentiment=Ie.map(Ie.filter(this.a.onDidChangeContext,c=>c.affectsSome(new Set([Ee.Setup.hidden.key,Ee.Setup.disabled.key,Ee.Setup.untrusted.key,Ee.Setup.installed.key,Ee.Setup.later.key,Ee.Setup.registered.key])),this.B),()=>{},this.B),this.sentimentObs=_u(this.onDidChangeSentiment,()=>this.sentiment),jo&&!s.remoteAuthority){Ee.Setup.hidden.bindTo(this.a).set(!0);return}if(!i.defaultChatAgent)return;const a=this.context=new Rt(()=>this.D(t.createInstance(PS)));this.requests=new Rt(()=>this.D(t.createInstance(DS,a.value,{clearQuotas:()=>this.clearQuotas(),acceptQuotas:c=>this.acceptQuotas(c)}))),this.q()}get entitlement(){return this.a.getContextKeyValue(Ee.Entitlement.planPro.key)===!0?Ye.Pro:this.a.getContextKeyValue(Ee.Entitlement.planBusiness.key)===!0?Ye.Business:this.a.getContextKeyValue(Ee.Entitlement.planEnterprise.key)===!0?Ye.Enterprise:this.a.getContextKeyValue(Ee.Entitlement.planProPlus.key)===!0?Ye.ProPlus:this.a.getContextKeyValue(Ee.Entitlement.planFree.key)===!0?Ye.Free:this.a.getContextKeyValue(Ee.Entitlement.canSignUp.key)===!0?Ye.Available:this.a.getContextKeyValue(Ee.Entitlement.signedOut.key)===!0?Ye.Unknown:Ye.Unresolved}get isInternal(){return this.a.getContextKeyValue(Ee.Entitlement.internal.key)===!0}get organisations(){return this.a.getContextKeyValue(Ee.Entitlement.organisations.key)}get sku(){return this.a.getContextKeyValue(Ee.Entitlement.sku.key)}get quotas(){return this.h}q(){const t=new Set([this.n.chatQuotaExceeded,this.n.completionsQuotaExceeded]),i=this.D(new Hs);this.D(this.a.onDidChangeContext(n=>{n.affectsSome(t)&&(i.value&&i.value.cancel(),i.value=new Ke,this.update(i.value.token))}));let s=this.anonymous;const r=()=>{const n=this.anonymous;n!==s&&(s=n,this.u.set(n),this.context?.hasValue&&xT(this.context.value.state,this.b,this.c),this.w.fire())};this.D(this.b.onDidChangeConfiguration(n=>{n.affectsConfiguration(ET)&&r()})),this.D(this.onDidChangeEntitlement(()=>r())),this.D(this.onDidChangeSentiment(()=>r()))}acceptQuotas(t){const i=this.h;this.h=t,this.t();const{changed:s}=this.r(i.chat,t.chat),{changed:r}=this.r(i.completions,t.completions),{changed:n}=this.r(i.premiumChat,t.premiumChat);(s.exceeded||r.exceeded||n.exceeded)&&this.f.fire(),(s.remaining||r.remaining||n.remaining)&&this.g.fire()}r(t,i){return{changed:{exceeded:t?.percentRemaining===0!=(i?.percentRemaining===0),remaining:t?.percentRemaining!==i?.percentRemaining}}}clearQuotas(){this.acceptQuotas({})}t(){this.j.set(this.h.chat?.percentRemaining===0),this.m.set(this.h.completions?.percentRemaining===0)}get sentiment(){return{installed:this.a.getContextKeyValue(Ee.Setup.installed.key)===!0,hidden:this.a.getContextKeyValue(Ee.Setup.hidden.key)===!0,disabled:this.a.getContextKeyValue(Ee.Setup.disabled.key)===!0,untrusted:this.a.getContextKeyValue(Ee.Setup.untrusted.key)===!0,later:this.a.getContextKeyValue(Ee.Setup.later.key)===!0,registered:this.a.getContextKeyValue(Ee.Setup.registered.key)===!0}}get anonymous(){return $S(this.b,this.entitlement,this.sentiment)}async update(t){await this.requests?.value.forceResolveEntitlement(t)}};IS=__decorate([__param(0,Yo),__param(1,sd),__param(2,GA),__param(3,Jn),__param(4,rs),__param(5,Zu)],IS);var DS=class extends J{constructor(t,i,s,r,n,o,a,c,l,u){super(),this.c=t,this.f=i,this.g=s,this.h=r,this.j=n,this.m=o,this.n=a,this.q=c,this.r=l,this.t=u,this.b=new Ke,this.a={entitlement:this.c.state.entitlement},this.u(),this.w()}u(){this.D(this.r.onDidChangeDefaultAccount(()=>this.w())),this.D(this.c.onDidChange(()=>{(!this.c.state.installed||this.c.state.disabled||this.c.state.entitlement===Ye.Unknown)&&(this.a={entitlement:this.a.entitlement,quotas:void 0},this.f.clearQuotas())}))}async w(){this.b.dispose(!0);const t=this.b=new Ke,i=await this.r.getDefaultAccount();if(t.token.isCancellationRequested)return;let s;i?this.a.entitlement===Ye.Unknown&&(s={entitlement:Ye.Unresolved}):s={entitlement:Ye.Unknown},s&&this.G(s),i&&await this.y(i,t.token)}async y(t,i){const s=await this.z(t,i);return typeof s?.entitlement=="number"&&!i.isCancellationRequested&&this.G(s),s}async z(t,i){if(i.isCancellationRequested)return;const s=t.entitlementsData;if(!s)return this.h.trace("[chat entitlement]: no entitlements data available on default account"),{entitlement:s===null?Ye.Unknown:Ye.Unresolved};let r;s.access_type_sku==="free_limited_copilot"?r=Ye.Free:s.can_signup_for_limited?r=Ye.Available:s.copilot_plan==="individual"?r=Ye.Pro:s.copilot_plan==="individual_pro"?r=Ye.ProPlus:s.copilot_plan==="business"?r=Ye.Business:s.copilot_plan==="enterprise"?r=Ye.Enterprise:r=Ye.Unavailable;const n={entitlement:r,organisations:s.organization_login_list,quotas:this.C(s),sku:s.access_type_sku};return this.h.trace(`[chat entitlement]: resolved to ${n.entitlement}, quotas: ${JSON.stringify(n.quotas)}`),this.g.publicLog2("chatInstallEntitlement",{entitlement:n.entitlement,tid:s.analytics_tracking_id,sku:n.sku,quotaChat:n.quotas?.chat?.remaining,quotaPremiumChat:n.quotas?.premiumChat?.remaining,quotaCompletions:n.quotas?.completions?.remaining,quotaResetDate:n.quotas?.resetDate}),n}C(t){const i={resetDate:t.quota_reset_date_utc??t.quota_reset_date??t.limited_user_reset_date,resetDateHasTime:typeof t.quota_reset_date_utc=="string"};if(t.monthly_quotas?.chat&&typeof t.limited_user_quotas?.chat=="number"&&(i.chat={total:t.monthly_quotas.chat,remaining:t.limited_user_quotas.chat,percentRemaining:Math.min(100,Math.max(0,t.limited_user_quotas.chat/t.monthly_quotas.chat*100)),overageEnabled:!1,overageCount:0,unlimited:!1}),t.monthly_quotas?.completions&&typeof t.limited_user_quotas?.completions=="number"&&(i.completions={total:t.monthly_quotas.completions,remaining:t.limited_user_quotas.completions,percentRemaining:Math.min(100,Math.max(0,t.limited_user_quotas.completions/t.monthly_quotas.completions*100)),overageEnabled:!1,overageCount:0,unlimited:!1}),t.quota_snapshots)for(const s of["chat","completions","premium_interactions"]){const r=t.quota_snapshots[s];if(!r)continue;const n={total:r.entitlement,remaining:r.remaining,percentRemaining:Math.min(100,Math.max(0,r.percent_remaining)),overageEnabled:r.overage_permitted,overageCount:r.overage_count,unlimited:r.unlimited};switch(s){case"chat":i.chat=n;break;case"completions":i.completions=n;break;case"premium_interactions":i.premiumChat=n;break}}return i}async F(t,i,s,r,n){let o;for(const a of r){if(n.isCancellationRequested)return o;try{const c=await this.j.request({type:i,url:t,data:i==="POST"?JSON.stringify(s):void 0,disableCache:!0,headers:{Authorization:`Bearer ${a.accessToken}`}},n),l=c.res.statusCode;if(l&&l!==200){o=c;continue}return c}catch(c){n.isCancellationRequested||this.h.error(`[chat entitlement] request: error ${c}`)}}return o}G(t){this.a=t,this.c.update({entitlement:this.a.entitlement,organisations:this.a.organisations,sku:this.a.sku}),t.quotas&&this.f.acceptQuotas(t.quotas)}async forceResolveEntitlement(t=De.None){const i=await this.r.refresh();if(i)return this.y(i,t)}async signUpFree(){const t=await this.I();if(t.length!==0)return this.H(t)}async H(t){const i={restricted_telemetry:this.g.telemetryLevel===0?"disabled":"enabled",public_code_suggestions:"enabled"},s=await this.F(Mv.entitlementSignupLimitedUrl,"POST",i,t,De.None);if(!s)return await this.J(d(15913,null),"[chat entitlement] sign-up: no response")?this.H(t):{errorCode:1};if(s.res.statusCode&&s.res.statusCode!==200){if(s.res.statusCode===422)try{const a=await mT(s);if(a){const c=JSON.parse(a);if(typeof c.message=="string"&&c.message)return this.L(`[chat entitlement] sign-up: unprocessable entity (${c.message})`,c.message),{errorCode:s.res.statusCode}}}catch{}return await this.J(d(15914,null,s.res.statusCode),`[chat entitlement] sign-up: unexpected status code ${s.res.statusCode}`)?this.H(t):{errorCode:s.res.statusCode}}let r=null;try{r=await mT(s)}catch{}if(!r)return await this.J(d(15915,null),"[chat entitlement] sign-up: response has no content")?this.H(t):{errorCode:2};let n;try{n=JSON.parse(r),this.h.trace(`[chat entitlement] sign-up: response is ${r}`)}catch(o){return await this.J(d(15916,null),`[chat entitlement] sign-up: error parsing response (${o})`)?this.H(t):{errorCode:3}}return this.G({entitlement:Ye.Free}),!!n?.subscribed}async I(){const t=await this.r.getDefaultAccount();if(t){const s=(await this.t.getSessions(t.authenticationProvider.id)).filter(r=>r.id===t.sessionId);if(s.length)return s}return[...await this.t.getSessions(this.r.getDefaultAccountAuthenticationProvider().id)]}async J(t,i){if(this.h.error(i),!this.q.willShutdown){const{confirmed:s}=await this.m.confirm({type:rt.Error,message:d(15917,null),detail:t,primaryButton:d(15918,null)});return s}return!1}L(t,i){this.h.error(t),this.q.willShutdown||this.m.prompt({type:rt.Error,message:d(15919,null),detail:i,buttons:[{label:d(15920,null),run:()=>{}},{label:d(15921,null),run:()=>this.n.open(y.parse(Mv.upgradePlanUrl))}]})}async signIn(t){const i=await this.r.signIn({additionalScopes:t?.additionalScopes,extraAuthorizeParameters:{get_started_with:"copilot-vscode"},provider:t?.useSocialProvider});if(!i)return{};const s=await this.z(i,De.None);return{defaultAccount:i,entitlements:s}}dispose(){this.b.dispose(!0),super.dispose()}};DS=__decorate([__param(2,Zu),__param(3,xe),__param(4,pT),__param(5,hT),__param(6,KY),__param(7,eQ),__param(8,tQ),__param(9,mq)],DS);var PS=class extends J{static{Hl=this}static{this.a="chat.setupContext"}static{this.b="chat.disableAIFeatures"}get state(){return this.Q(this.H??this.G)}constructor(t,i,s,r,n){super(),this.L=i,this.M=s,this.N=r,this.O=n,this.H=void 0,this.I=this.D(new I),this.onDidChange=this.I.event,this.J=void 0,this.c=Ee.Entitlement.canSignUp.bindTo(t),this.f=Ee.Entitlement.signedOut.bindTo(t),this.g=Ee.Entitlement.planFree.bindTo(t),this.h=Ee.Entitlement.planPro.bindTo(t),this.j=Ee.Entitlement.planProPlus.bindTo(t),this.m=Ee.Entitlement.planBusiness.bindTo(t),this.n=Ee.Entitlement.planEnterprise.bindTo(t),this.q=Ee.Entitlement.organisations.bindTo(t),this.r=Ee.Entitlement.internal.bindTo(t),this.t=Ee.Entitlement.sku.bindTo(t),this.u=Ee.Setup.hidden.bindTo(t),this.w=Ee.Setup.later.bindTo(t),this.y=Ee.Setup.installed.bindTo(t),this.z=Ee.Setup.disabled.bindTo(t),this.C=Ee.Setup.untrusted.bindTo(t),this.F=Ee.Setup.registered.bindTo(t),this.G=this.L.getObject(Hl.a,0)??{entitlement:Ye.Unknown,organisations:void 0,sku:void 0},this.S(),this.P()}P(){this.D(this.N.onDidChangeConfiguration(t=>{t.affectsConfiguration(Hl.b)&&this.R()}))}Q(t){return this.N.getValue(Hl.b)===!0?{...t,hidden:!0}:t}async update(t){this.M.trace(`[chat entitlement context] update(): ${JSON.stringify(t)}`);const i=JSON.stringify(this.G);if(typeof t.installed=="boolean"&&typeof t.disabled=="boolean"&&typeof t.untrusted=="boolean"&&(this.G.installed=t.installed,this.G.disabled=t.disabled,this.G.untrusted=t.untrusted,t.installed&&!t.disabled&&(t.hidden=!1)),typeof t.hidden=="boolean"&&(this.G.hidden=t.hidden),typeof t.later=="boolean"&&(this.G.later=t.later),typeof t.entitlement=="number"&&(this.G.entitlement=t.entitlement,this.G.organisations=t.organisations,this.G.sku=t.sku,this.G.entitlement===Ye.Free||sQ(this.G.entitlement)?this.G.registered=!0:this.G.entitlement===Ye.Available&&(this.G.registered=!1)),$S(this.N,this.G.entitlement,this.G)&&(this.G.sku="no_auth_limited_copilot"),i!==JSON.stringify(this.G))return this.L.store(Hl.a,{...this.G,later:void 0},0,1),this.R()}async R(){await this.J?.wait(),this.S()}S(){const t=this.Q(this.G);this.f.set(t.entitlement===Ye.Unknown),this.c.set(t.entitlement===Ye.Available),this.g.set(t.entitlement===Ye.Free),this.h.set(t.entitlement===Ye.Pro),this.j.set(t.entitlement===Ye.ProPlus),this.m.set(t.entitlement===Ye.Business),this.n.set(t.entitlement===Ye.Enterprise),this.q.set(t.organisations),this.r.set(!!t.organisations?.some(i=>i==="github"||i==="microsoft"||i==="ms-copilot"||i==="MicrosoftCopilot")),this.t.set(t.sku),this.u.set(!!t.hidden),this.w.set(!!t.later),this.y.set(!!t.installed),this.z.set(!!t.disabled),this.C.set(!!t.untrusted),this.F.set(!!t.registered),this.M.trace(`[chat entitlement context] updateContext(): ${JSON.stringify(t)}`),xT(t,this.N,this.O),this.I.fire()}suspend(){this.H={...this.G},this.J=new ms}resume(){this.H=void 0,this.J?.open(),this.J=void 0}};PS=Hl=__decorate([__param(0,Jn),__param(1,_a),__param(2,xe),__param(3,rs),__param(4,Zu)],PS),Ne(iQ,IS,0);var jr;(function(e){e.responseVote=new C("chatSessionResponseVote","",{type:"string",description:d(6852,null)}),e.responseDetectedAgentCommand=new C("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:d(6853,null)}),e.responseSupportsIssueReporting=new C("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:d(6854,null)}),e.responseIsFiltered=new C("chatSessionResponseFiltered",!1,{type:"boolean",description:d(6855,null)}),e.responseHasError=new C("chatSessionResponseError",!1,{type:"boolean",description:d(6856,null)}),e.requestInProgress=new C("chatSessionRequestInProgress",!1,{type:"boolean",description:d(6857,null)}),e.currentlyEditing=new C("chatSessionCurrentlyEditing",!1,{type:"boolean",description:d(6858,null)}),e.currentlyEditingInput=new C("chatSessionCurrentlyEditingInput",!1,{type:"boolean",description:d(6859,null)});let t;(function(i){i.Sent="s",i.QueueOrSteer="qs"})(t=e.EditingRequestType||(e.EditingRequestType={})),e.editingRequestType=new C("chatEditingSentRequest",void 0,{type:"string",description:d(6860,null)}),e.isResponse=new C("chatResponse",!1,{type:"boolean",description:d(6861,null)}),e.isRequest=new C("chatRequest",!1,{type:"boolean",description:d(6862,null)}),e.isPendingRequest=new C("chatRequestIsPending",!1,{type:"boolean",description:d(6863,null)}),e.itemId=new C("chatItemId","",{type:"string",description:d(6864,null)}),e.lastItemId=new C("chatLastItemId",[],{type:"string",description:d(6865,null)}),e.editApplied=new C("chatEditApplied",!1,{type:"boolean",description:d(6866,null)}),e.inputHasText=new C("chatInputHasText",!1,{type:"boolean",description:d(6867,null)}),e.inputHasFocus=new C("chatInputHasFocus",!1,{type:"boolean",description:d(6868,null)}),e.inChatInput=new C("inChatInput",!1,{type:"boolean",description:d(6869,null)}),e.inChatSession=new C("inChat",!1,{type:"boolean",description:d(6870,null)}),e.inChatEditor=new C("inChatEditor",!1,{type:"boolean",description:d(6871,null)}),e.inChatTerminalToolOutput=new C("inChatTerminalToolOutput",!1,{type:"boolean",description:d(6872,null)}),e.chatModeKind=new C("chatAgentKind",Zs.Ask,{type:"string",description:d(6873,null)}),e.chatModeName=new C("chatModeName","",{type:"string",description:d(6874,null)}),e.supported=Ot.or(FY.negate(),qY.notEqualsTo(""),Ot.has("config.chat.experimental.serverlessWebEnabled")),e.enabled=new C("chatIsEnabled",!1,{type:"boolean",description:d(6875,null)}),e.lockedToCodingAgent=new C("lockedToCodingAgent",!1,{type:"boolean",description:d(6876,null)}),e.chatSessionHasCustomAgentTarget=new C("chatSessionHasCustomAgentTarget",!1,{type:"boolean",description:d(6877,null)}),e.agentSupportsAttachments=new C("agentSupportsAttachments",!1,{type:"boolean",description:d(6878,null)}),e.withinEditSessionDiff=new C("withinEditSessionDiff",!1,{type:"boolean",description:d(6879,null)}),e.filePartOfEditSession=new C("filePartOfEditSession",!1,{type:"boolean",description:d(6880,null)}),e.extensionParticipantRegistered=new C("chatPanelExtensionParticipantRegistered",!1,{type:"boolean",description:d(6881,null)}),e.panelParticipantRegistered=new C("chatPanelParticipantRegistered",!1,{type:"boolean",description:d(6882,null)}),e.chatEditingCanUndo=new C("chatEditingCanUndo",!1,{type:"boolean",description:d(6883,null)}),e.chatEditingCanRedo=new C("chatEditingCanRedo",!1,{type:"boolean",description:d(6884,null)}),e.languageModelsAreUserSelectable=new C("chatModelsAreUserSelectable",!1,{type:"boolean",description:d(6885,null)}),e.chatSessionHasModels=new C("chatSessionHasModels",!1,{type:"boolean",description:d(6886,null)}),e.chatSessionOptionsValid=new C("chatSessionOptionsValid",!0,{type:"boolean",description:d(6887,null)}),e.extensionInvalid=new C("chatExtensionInvalid",!1,{type:"boolean",description:d(6888,null)}),e.inputCursorAtTop=new C("chatCursorAtTop",!1),e.inputHasAgent=new C("chatInputHasAgent",!1),e.location=new C("chatLocation",void 0),e.inQuickChat=new C("quickChatHasFocus",!1,{type:"boolean",description:d(6889,null)}),e.inAgentSessionsWelcome=new C("inAgentSessionsWelcome",!1,{type:"boolean",description:d(6890,null)}),e.chatSessionType=new C("chatSessionType","",{type:"string",description:d(6891,null)}),e.hasFileAttachments=new C("chatHasFileAttachments",!1,{type:"boolean",description:d(6892,null)}),e.chatSessionIsEmpty=new C("chatSessionIsEmpty",!0,{type:"boolean",description:d(6893,null)}),e.hasPendingRequests=new C("chatHasPendingRequests",!1,{type:"boolean",description:d(6894,null)}),e.remoteJobCreating=new C("chatRemoteJobCreating",!1,{type:"boolean",description:d(6895,null)}),e.hasRemoteCodingAgent=new C("hasRemoteCodingAgent",!1,d(6896,null)),e.hasCanDelegateProviders=new C("chatHasCanDelegateProviders",!1,{type:"boolean",description:d(6897,null)}),e.enableRemoteCodingAgentPromptFileOverlay=new C("enableRemoteCodingAgentPromptFileOverlay",!1,d(6898,null)),e.skipChatRequestInProgressMessage=new C("chatSkipRequestInProgressMessage",!1,{type:"boolean",description:d(6899,null)}),e.Setup=Ee.Setup,e.Entitlement=Ee.Entitlement,e.chatQuotaExceeded=Ee.chatQuotaExceeded,e.completionsQuotaExceeded=Ee.completionsQuotaExceeded,e.Editing={hasToolConfirmation:new C("chatHasToolConfirmation",!1,{type:"boolean",description:d(6900,null)}),hasElicitationRequest:new C("chatHasElicitationRequest",!1,{type:"boolean",description:d(6901,null)})},e.Tools={toolsCount:new C("toolsCount",0,{type:"number",description:d(6902,null)})},e.Modes={hasCustomChatModes:new C("chatHasCustomAgents",!1,{type:"boolean",description:d(6903,null)}),agentModeDisabledByPolicy:new C("chatAgentModeDisabledByPolicy",!1,{type:"boolean",description:d(6904,null)})},e.panelLocation=new C("chatPanelLocation",void 0,{type:"number",description:d(6905,null)}),e.agentSessionsViewerFocused=new C("agentSessionsViewerFocused",!0,{type:"boolean",description:d(6906,null)}),e.agentSessionsViewerOrientation=new C("agentSessionsViewerOrientation",void 0,{type:"number",description:d(6907,null)}),e.agentSessionsViewerPosition=new C("agentSessionsViewerPosition",void 0,{type:"number",description:d(6908,null)}),e.agentSessionsViewerVisible=new C("agentSessionsViewerVisible",void 0,{type:"boolean",description:d(6909,null)}),e.agentSessionType=new C("chatSessionType","",{type:"string",description:d(6910,null)}),e.agentSessionSection=new C("agentSessionSection","",{type:"string",description:d(6911,null)}),e.isArchivedAgentSession=new C("agentSessionIsArchived",!1,{type:"boolean",description:d(6912,null)}),e.isReadAgentSession=new C("agentSessionIsRead",!1,{type:"boolean",description:d(6913,null)}),e.hasMultipleAgentSessionsSelected=new C("agentSessionHasMultipleSelected",!1,{type:"boolean",description:d(6914,null)}),e.hasAgentSessionChanges=new C("agentSessionHasChanges",!1,{type:"boolean",description:d(6915,null)}),e.isKatexMathElement=new C("chatIsKatexMathElement",!1,{type:"boolean",description:d(6916,null)})})(jr||(jr={}));var CT;(function(e){e.inEditingMode=Ot.or(jr.chatModeKind.isEqualTo(Zs.Edit),jr.chatModeKind.isEqualTo(Zs.Agent)),e.chatSetupTriggerContext=Ot.or(jr.Setup.installed.negate(),jr.Entitlement.canSignUp)})(CT||(CT={}));var rQ=W("ILanguageModelsConfigurationService"),Nv,kT;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.Assistant=2]="Assistant"})(kT||(kT={}));var $T;(function(e){e[e.Assistant=0]="Assistant",e[e.User=1]="User",e[e.Extension=2]="Extension"})($T||($T={}));var IT;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(IT||(IT={}));var DT;(function(e){e.Low="low",e.High="high"})(DT||(DT={}));var TS;(function(e){function t(r){return(typeof r.capabilities?.agentMode>"u"||r.capabilities.agentMode)&&!!r.capabilities?.toolCalling}e.suitableForAgentMode=t;function i(r){return`${r.name} (${r.vendor})`}e.asQualifiedName=i;function s(r,n){return n.vendor==="copilot"&&r===n.name?!0:r===i(n)}e.matchesQualifiedName=s})(TS||(TS={}));var nQ=W("ILanguageModelsService"),PT={type:"object",required:["vendor","displayName"],properties:{vendor:{type:"string",description:d(6927,null)},displayName:{type:"string",description:d(6928,null)},configuration:{type:"object",description:d(6929,null),anyOf:[{$ref:"http://json-schema.org/draft-07/schema#"},{properties:{properties:{type:"object",additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#",properties:{secret:{type:"boolean",description:d(6930,null)}}}},additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#",properties:{secret:{type:"boolean",description:d(6931,null)}}}}}]},managementCommand:{type:"string",description:d(6932,null),deprecated:!0,deprecationMessage:d(6933,null)},when:{type:"string",description:d(6934,null)}}},oQ=t7.registerExtensionPoint({extensionPoint:"languageModelChatProviders",jsonSchema:{description:d(6935,null),oneOf:[PT,{type:"array",items:PT}]},activationEventsGenerator:function*(e){for(const t of e)yield`onLanguageModelChatProvider:${t.vendor}`}}),MS="chatModelPickerPreferences",TT=class{static{Nv=this}static{this.a="chat.lm.secret."}static{this.b="${input:{0}}"}constructor(t,i,s,r,n,o,a){this.p=t,this.q=i,this.r=s,this.s=r,this.t=n,this.u=o,this.v=a,this.c=new X,this.d=new Map,this.f=new Map,this.h=this.c.add(new I),this.onDidChangeLanguageModelVendors=this.h.event,this.i=new Map,this.j=new Map,this.k=new i0,this.l={},this.o=this.c.add(new I),this.onDidChangeLanguageModels=this.o.event,this.n=jr.languageModelsAreUserSelectable.bindTo(r),this.l=this.x(),this.c.add(this.r.onDidChangeValue(0,MS,this.c)(()=>this.y())),this.c.add(this.onDidChangeLanguageModels(()=>this.n.set(this.j.size>0&&Array.from(this.j.values()).some(c=>c.isUserSelectable)))),this.c.add(this.t.onDidChangeLanguageModelGroups(c=>this.w(c))),this.c.add(oQ.setHandler((c,{added:l,removed:u})=>{const h=[],f=[];for(const p of l)for(const g of ai.wrap(p.value)){if(this.f.has(g.vendor)){p.collector.error(d(6936,null,g.vendor));continue}if(ac(g.vendor)){p.collector.error(d(6937,null));continue}if(g.vendor.trim()!==g.vendor){p.collector.error(d(6938,null));continue}h.push(g)}for(const p of u)for(const g of ai.wrap(p.value))f.push(g);this.deltaLanguageModelChatProviderDescriptors(h,f)}))}deltaLanguageModelChatProviderDescriptors(t,i){const s=[],r=[];for(const n of t){if(this.f.has(n.vendor)){this.q.error(`The vendor '${n.vendor}' is already registered and cannot be registered twice`);continue}if(ac(n.vendor)){this.q.error("The vendor field cannot be empty.");continue}if(n.vendor.trim()!==n.vendor){this.q.error("The vendor field cannot start or end with whitespace.");continue}const o={vendor:n.vendor,displayName:n.displayName,configuration:n.configuration,managementCommand:n.managementCommand,when:n.when,isDefault:n.vendor==="copilot"};this.f.set(n.vendor,o),s.push(n.vendor),this.z(n.vendor)&&this.p.activateByEvent(`onLanguageModelChatProvider:${n.vendor}`)}for(const n of i)this.f.delete(n.vendor),this.d.delete(n.vendor),this.N(n.vendor),r.push(n.vendor);for(const[n,o]of this.d)this.f.has(n)||this.d.delete(n);if((s.length>0||r.length>0)&&(this.h.fire([...s,...r]),r.length>0))for(const n of r)this.o.fire(n)}async w(t){const i=new Set(t.map(s=>s.vendor));await Promise.all(Array.from(i).map(s=>this.B(s,!0)))}x(){return this.r.getObject(MS,0,{})}y(){const t=this.x(),i=this.l,s=new Set;let r=!1;for(const n in t)if(i[n]!==t[n]){r=!0;const o=this.j.get(n);o&&s.add(o.vendor)}for(const n in i)if(!t.hasOwnProperty(n)){r=!0;const o=this.j.get(n);o&&s.add(o.vendor)}if(r){this.q.trace("[LM] Updated model picker preferences from storage"),this.l=t;for(const n of s)this.o.fire(n)}}z(t){return Object.keys(this.l).some(i=>i.startsWith(t))}A(){this.r.store(MS,this.l,0,0)}updateModelPickerPreference(t,i){const s=this.j.get(t);if(!s){this.q.warn(`[LM] Cannot update model picker preference for unknown model ${t}`);return}this.l[t]=i,i===s.isUserSelectable?(delete this.l[t],this.A()):s.isUserSelectable!==i&&this.A(),this.o.fire(s.vendor),this.q.trace(`[LM] Updated model picker preference for ${t} to ${i}`)}getVendors(){return Array.from(this.f.values()).filter(t=>{if(!t.when)return!0;const i=Ot.deserialize(t.when);return i?this.s.contextMatchesRules(i):!1})}getLanguageModelIds(){return Array.from(this.j.keys())}lookupLanguageModel(t){const i=this.j.get(t);return i&&this.l[t]!==void 0?{...i,isUserSelectable:this.l[t]}:i}lookupLanguageModelByQualifiedName(t){for(const i of this.j.values())if(TS.matchesQualifiedName(t,i))return i}async B(t,i){const s=this.f.get(t);if(!s)return;await this.p.activateByEvent(`onLanguageModelChatProvider:${t}`);const r=this.d.get(t);if(!r){this.q.warn(`[LM] No provider registered for vendor ${t}`);return}return this.k.queue(t,async()=>{const n=[],o=[];try{const u=await r.provideLanguageModelChatInfo({silent:i},De.None);if(u.length){n.push(...u);const h=[];for(const f of u)s.isDefault?f.metadata.isUserSelectable||this.l[f.identifier]===!0?h.push(f.identifier):this.q.trace(`[LM] Skipping model ${f.identifier} from model picker as it is not user selectable.`):h.push(f.identifier);o.push({modelIdentifiers:h})}}catch(u){o.push({modelIdentifiers:[],status:{message:Xd(u),severity:rt.Error}})}const a=this.t.getLanguageModelsProviderGroups();for(const u of a){if(u.vendor!==t)continue;const h=await this.O(u,s.configuration);try{const f=await r.provideLanguageModelChatInfo({group:u.name,silent:i,configuration:h},De.None);f.length&&(n.push(...f),o.push({group:u,modelIdentifiers:f.map(p=>p.identifier)}))}catch(f){o.push({group:u,modelIdentifiers:[],status:{message:Xd(f),severity:rt.Error}})}}this.i.set(t,o);const c=this.N(t);let l=!1;for(const u of n){if(this.j.has(u.identifier)){this.q.warn(`[LM] Model ${u.identifier} is already registered. Skipping.`);continue}this.j.set(u.identifier,u.metadata),l=l||!Ai(c.get(u.identifier),u.metadata),c.delete(u.identifier)}this.q.trace(`[LM] Resolved language models for vendor ${t}`,n),l=l||c.size>0,l?this.o.fire(t):this.q.trace(`[LM] No changes in language models for vendor ${t}`)})}getLanguageModelGroups(t){return this.i.get(t)??[]}async selectLanguageModels(t){if(t.vendor)await this.B(t.vendor,!0);else{const s=Array.from(this.f.keys());await Promise.all(s.map(r=>this.B(r,!0)))}const i=[];for(const[s,r]of this.j)(t.vendor===void 0||r.vendor===t.vendor)&&(t.family===void 0||r.family===t.family)&&(t.version===void 0||r.version===t.version)&&(t.id===void 0||r.id===t.id)&&i.push(s);return this.q.trace("[LM] selected language models",t,i),i}registerLanguageModelProvider(t,i){if(this.q.trace("[LM] registering language model provider",t,i),!this.f.has(t))throw new Error(`Chat model provider uses UNKNOWN vendor ${t}.`);if(this.d.has(t))throw new Error(`Chat model provider for vendor ${t} is already registered.`);this.d.set(t,i),this.z(t)&&this.B(t,!0);const s=i.onDidChange(()=>{this.B(t,!0)});return se(()=>{this.q.trace("[LM] UNregistered language model provider",t),this.N(t),this.d.delete(t),s.dispose()})}async sendChatRequest(t,i,s,r,n){const o=this.d.get(this.j.get(t)?.vendor||"");if(!o)throw new Error(`Chat provider for model ${t} is not registered.`);return o.sendChatRequest(t,s,i,r,n)}computeTokenLength(t,i,s){const r=this.j.get(t);if(!r)throw new Error(`Chat model ${t} could not be found.`);const n=this.d.get(r.vendor);if(!n)throw new Error(`Chat provider for model ${t} is not registered.`);return n.provideTokenCount(t,i,s)}async configureLanguageModelsProviderGroup(t,i){const s=this.getVendors().find(({vendor:c})=>c===t);if(!s)throw new Error(`Vendor ${t} not found.`);if(s.managementCommand){await this.B(s.vendor,!1);return}const r=this.t.getLanguageModelsProviderGroups(),n=r.find(c=>c.vendor===t&&c.name===i),o=await this.E(r,s,n);if(!o)return;const a=n?await this.O(n,s.configuration):void 0;try{const c=s.configuration?await this.F(o,s.configuration,a):void 0;if(s.configuration&&!c)return;const l=await this.P(o,t,c,s.configuration),u=n?await this.t.updateLanguageModelsProviderGroup(n,l):await this.t.addLanguageModelsProviderGroup(l);if(s.configuration&&this.C(s.configuration)){const h=this.D(c??{},s.configuration);await this.t.configureLanguageModels({group:u,snippet:h})}}catch(c){if(ki(c))return;throw c}}async addLanguageModelsProviderGroup(t,i,s){const r=this.getVendors().find(({vendor:o})=>o===i);if(!r)throw new Error(`Vendor ${i} not found.`);const n=await this.P(t,i,s,r.configuration);await this.t.addLanguageModelsProviderGroup(n)}async removeLanguageModelsProviderGroup(t,i){const s=this.getVendors().find(({vendor:o})=>o===t);if(!s)throw new Error(`Vendor ${t} not found.`);const n=this.t.getLanguageModelsProviderGroups().find(o=>o.vendor===t&&o.name===i);if(!n)throw new Error(`Language model provider group ${i} for vendor ${t} not found.`);await this.Q(n,s.configuration),await this.t.removeLanguageModelsProviderGroup(n)}C(t){if(t.additionalProperties)return!0;if(!t.properties)return!1;for(const i of Object.keys(t.properties))if(!this.H(t.properties[i]))return!0;return!1}D(t,i){if(i.properties){for(const s of Object.keys(i.properties))if(t[s]===void 0){const r=i.properties[s];if(r&&typeof r!="boolean"&&r.defaultSnippets?.[0]){const n=r.defaultSnippets[0];let o=n.bodyText??JSON.stringify(n.body,null,"	");return o=o.replace(/"(\^[^"]*)"/g,(a,c)=>c.substring(1)),`"${s}": ${o}`}}}}async E(t,i,s){let r=s?.name;if(!r){r=i.displayName;let a=1;for(;t.some(c=>c.vendor===i.vendor&&c.name===r);)a++,r=`${i.displayName} ${a}`}let n;const o=new X;try{await new Promise(a=>{const c=o.add(this.u.createInputBox());c.title=d(6939,null),c.placeholder=d(6940,null),c.value=r,c.ignoreFocusOut=!0,o.add(c.onDidChangeValue(l=>{if(!l){c.validationMessage=d(6941,null),c.severity=rt.Error;return}if(!s&&t.some(u=>u.name===l)){c.validationMessage=d(6942,null),c.severity=rt.Error;return}c.validationMessage=void 0,c.severity=rt.Ignore})),o.add(c.onDidAccept(async()=>{n=c.value,c.hide()})),o.add(c.onDidHide(()=>a())),c.show()})}finally{o.dispose()}return n}async F(t,i,s){if(!i.properties)return;const r=s?{...s}:{};for(const n of Object.keys(i.properties)){const o=i.properties[n],a=!!i.required?.includes(n),c=await this.G(t,n,o,a,s);c!==void 0&&(r[n]=c)}return r}async G(t,i,s,r,n){if(!s||!this.H(s))return;if(s.type==="array"&&s.items&&!Array.isArray(s.items)&&s.items.enum){const a=await this.I(t,i,s);return a===void 0?void 0:a}const o=await this.J(t,i,s,r,n);if(o!==void 0)return o}H(t){return!t||typeof t=="boolean"?!1:!!(t.type==="array"&&t.items&&!Array.isArray(t.items)&&t.items.enum||t.type==="string"||t.type==="number"||t.type==="integer"||t.type==="boolean")}async I(t,i,s){if(!s.items||Array.isArray(s.items)||!s.items.enum)return;const r=s.items.enum,n=new X;try{return await new Promise(o=>{const a=n.add(this.u.createQuickPick());a.title=`${t}: ${s.title??i}`,a.items=r.map(c=>({label:c})),a.placeholder=s.description??d(6943,null,i),a.canSelectMany=!0,a.ignoreFocusOut=!0,n.add(a.onDidAccept(()=>{o(a.selectedItems.map(c=>c.label)),a.hide()})),n.add(a.onDidHide(()=>{o(void 0)})),a.show()})}finally{n.dispose()}}async J(t,i,s,r,n){const o=new X;try{const a=await new Promise((c,l)=>{const u=o.add(this.u.createInputBox());u.title=`${t}: ${s.title??i}`,u.placeholder=d(6944,null,i),u.password=!!s.secret,u.ignoreFocusOut=!0,n?.[i]?u.value=String(n?.[i]):s.default&&(u.value=String(s.default)),s.description&&(u.prompt=s.description),o.add(u.onDidChangeValue(h=>{if(!h&&r){u.validationMessage=d(6945,null),u.severity=rt.Error;return}if((s.type==="number"||s.type==="integer")&&isNaN(Number(h))){u.validationMessage=d(6946,null),u.severity=rt.Error;return}if(s.type==="boolean"&&h!=="true"&&h!=="false"){u.validationMessage=d(6947,null),u.severity=rt.Error;return}u.validationMessage=void 0,u.severity=rt.Ignore})),o.add(u.onDidAccept(()=>{if(!u.value&&r){u.validationMessage=d(6948,null),u.severity=rt.Error;return}c(u.value),u.hide()})),o.add(u.onDidHide(h=>{h.reason===yS.Gesture?l(new dt):c(void 0)})),u.show()});return a?s.type==="number"||s.type==="integer"?Number(a):s.type==="boolean"?a==="true":a:void 0}finally{o.dispose()}}L(t){return R2(Nv.b,t)}M(t){if(Oe(t))return t.substring(t.indexOf(":")+1,t.length-1)}N(t){const i=new Map;for(const[s,r]of this.j.entries())r.vendor===t&&(i.set(s,r),this.j.delete(s));return i}async O(t,i){if(!i)return{};const s={};for(const r in t){if(r==="vendor"||r==="name"||r==="range")continue;let n=t[r];if(i.properties?.[r]?.secret){const o=this.M(n);n=o?await this.v.get(o):void 0}s[r]=n}return s}async P(t,i,s,r){if(!r)return{name:t,vendor:i};const n={};for(const o in s){let a=s[o];if(r.properties?.[o]?.secret&&Oe(a)){const c=`${Nv.a}${Ar(At()).toString(16)}`;await this.v.set(c,a),a=this.L(c)}n[o]=a}return{name:t,vendor:i,...n}}async Q(t,i){if(!i)return;const{vendor:s,name:r,range:n,...o}=t;for(const a in o){const c=t[a];if(i.properties?.[a]?.secret){const l=this.M(c);l&&await this.v.delete(l)}}}async migrateLanguageModelsProviderGroup(t){const{vendor:i,name:s,...r}=t;if(!this.f.get(i))throw new Error(`Vendor ${i} not found.`);await this.p.activateByEvent(`onLanguageModelChatProvider:${i}`);const n=this.d.get(i);if(!n)throw new Error(`Chat model provider for vendor ${i} is not registered.`);const o=await n.provideLanguageModelChatInfo({group:s,silent:!1,configuration:r},De.None);for(const a of o){const c=`${i}/${a.metadata.id}`;this.l[c]===!0&&(this.l[a.identifier]=!0),delete this.l[c]}this.A(),await this.addLanguageModelsProviderGroup(s,i,r)}dispose(){this.c.dispose(),this.d.clear()}};TT=Nv=__decorate([__param(0,yD),__param(1,xe),__param(2,_a),__param(3,Jn),__param(4,rQ),__param(5,RY),__param(6,OY)],TT);var Ad,aQ=W("chatAgentService"),MT=class extends J{static{this.AGENT_LEADER="@"}constructor(t,i){super(),this.r=t,this.s=i,this.b=new Map,this.f=new I,this.onDidChangeAgents=this.f.event,this.g=new Set,this.n=!1,this.q=new Map,this.w=new Map,this.h=jr.enabled.bindTo(this.r),this.j=jr.extensionParticipantRegistered.bindTo(this.r),this.m=jr.panelParticipantRegistered.bindTo(this.r),this.D(t.onDidChangeContext(s=>{s.affectsSome(this.g)&&this.u()}))}registerAgent(t,i){if(this.getAgent(t))throw new Error(`Agent already registered: ${JSON.stringify(t)}`);const r=this,n=i.slashCommands;i={...i,get slashCommands(){return n.filter(a=>!a.when||r.r.contextMatchesRules(Ot.deserialize(a.when)))}};const o={data:i};return this.b.set(t,o),this.t(),this.u(),this.f.fire(void 0),se(()=>{this.b.delete(t),this.t(),this.u(),this.f.fire(void 0)})}t(){this.g.clear();for(const t of this.b.values())if(t.data.when){const i=Ot.deserialize(t.data.when);for(const s of i?.keys()||[])this.g.add(s)}}u(){let t=!1,i=!1,s=!1;for(const r of this.getAgents())r.isDefault&&(r.isCore||(t=!0),r.id==="chat.setup"||r.id==="github.copilot.editsAgent"?s=!0:i=!0);this.m.set(i),this.j.set(t),s!==this.n&&(this.n=s,this.f.fire(this.getDefaultAgent(ti.Chat,Zs.Agent)))}registerAgentImplementation(t,i){const s=this.b.get(t);if(!s)throw new Error(`Unknown agent: ${JSON.stringify(t)}`);if(s.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(t)}`);return s.data.isDefault&&this.h.set(!0),s.impl=i,this.f.fire(new Rv(s.data,i)),se(()=>{s.impl=void 0,this.f.fire(void 0),s.data.isDefault&&this.h.set(ai.some(this.b.values(),r=>r.data.isDefault&&!!r.impl))})}registerDynamicAgent(t,i){t.isDynamic=!0;const s={data:t,impl:i};return this.b.set(t.id,s),this.f.fire(new Rv(t,i)),se(()=>{this.b.delete(t.id),this.f.fire(void 0)})}registerAgentCompletionProvider(t,i){return this.w.set(t,i),{dispose:()=>{this.w.delete(t)}}}async getAgentCompletionItems(t,i,s){return await this.w.get(t)?.(i,s)??[]}updateAgent(t,i){const s=this.b.get(t);if(!s?.impl)throw new Error(`No activated agent with id ${JSON.stringify(t)} registered`);s.data.metadata={...s.data.metadata,...i},this.f.fire(new Rv(s.data,s.impl))}getDefaultAgent(t,i=Zs.Ask){return this.y(this.getActivatedAgents().filter(s=>i&&!s.modes.includes(i)?!1:!!s.isDefault&&s.locations.includes(t)))}get hasToolsAgent(){return!!this.s.getValue(kc.AgentEnabled)}getContributedDefaultAgent(t){return this.y(this.getAgents().filter(i=>!!i.isDefault&&i.locations.includes(t)))}y(t){return wL(t,i=>!i.isCore)??t.at(-1)}getAgent(t,i=!1){if(!(!this.z(t)&&!i))return this.b.get(t)?.data}z(t){const i=typeof t=="string"?this.b.get(t):t;return!i?.data.when||this.r.contextMatchesRules(Ot.deserialize(i.data.when))}getAgentByFullyQualifiedId(t){const i=ai.find(this.b.values(),s=>cQ(s.data)===t)?.data;if(!(i&&!this.z(i.id)))return i}getAgents(){return Array.from(this.b.values()).map(t=>t.data).filter(t=>this.z(t.id))}getActivatedAgents(){return Array.from(this.b.values()).filter(t=>!!t.impl).filter(t=>this.z(t.data.id)).map(t=>new Rv(t.data,t.impl))}getAgentsByName(t){return this.C(this.getAgents().filter(i=>i.name===t))}C(t){const i=t.filter(s=>!s.isCore);return i.length>0?i:t}agentHasDupeName(t){const i=this.getAgent(t);return i?this.getAgentsByName(i.name).filter(s=>s.extensionId.value!==i.extensionId.value).length>0:!1}async invokeAgent(t,i,s,r,n){const o=this.b.get(t);if(!o?.impl)throw new Error(`No activated agent with id "${t}"`);return await o.impl.invoke(i,s,r,n)}setRequestTools(t,i,s){const r=this.b.get(t);if(!r?.impl)throw new Error(`No activated agent with id "${t}"`);r.impl.setRequestTools?.(i,s)}setYieldRequested(t,i){const s=this.b.get(t);s?.impl&&s.impl.setYieldRequested?.(i)}async getFollowups(t,i,s,r,n){const o=this.b.get(t);return o?.impl?.provideFollowups?o.impl.provideFollowups(i,s,r,n):[]}async getChatTitle(t,i,s){const r=this.b.get(t);if(r?.impl?.provideChatTitle)return r.impl.provideChatTitle(i,s)}async getChatSummary(t,i,s){const r=this.b.get(t);if(r?.impl?.provideChatSummary)return r.impl.provideChatSummary(i,s)}registerChatParticipantDetectionProvider(t,i){return this.q.set(t,i),se(()=>{this.q.delete(t)})}hasChatParticipantDetectionProviders(){return this.q.size>0}async detectAgentOrCommand(t,i,s,r){const n=ai.first(this.q.values());if(!n)return;const o=this.getAgents().reduce((u,h)=>{if(h.locations.includes(s.location)){u.push({participant:h.id,disambiguation:h.disambiguation??[]});for(const f of h.slashCommands)u.push({participant:h.id,command:f.name,disambiguation:f.disambiguation??[]})}return u},[]),a=await n.provideParticipantDetection(t,i,{...s,participants:o},r);if(!a)return;const c=this.getAgent(a.participant);if(!c)return;if(!a.command)return{agent:c};const l=c?.slashCommands.find(u=>u.name===a.command);if(l)return{agent:c,command:l}}};MT=__decorate([__param(0,Jn),__param(1,rs)],MT);var Rv=class{constructor(e,t){this.b=e,this.d=t}get id(){return this.b.id}get name(){return this.b.name??""}get fullName(){return this.b.fullName??""}get description(){return this.b.description??""}get extensionId(){return this.b.extensionId}get extensionVersion(){return this.b.extensionVersion}get extensionPublisherId(){return this.b.extensionPublisherId}get extensionPublisherDisplayName(){return this.b.publisherDisplayName}get extensionDisplayName(){return this.b.extensionDisplayName}get isDefault(){return this.b.isDefault}get isCore(){return this.b.isCore}get metadata(){return this.b.metadata}get slashCommands(){return this.b.slashCommands}get locations(){return this.b.locations}get modes(){return this.b.modes}get disambiguation(){return this.b.disambiguation}async invoke(e,t,i,s){return this.d.invoke(e,t,i,s)}setRequestTools(e,t){this.d.setRequestTools?.(e,t)}setYieldRequested(e){this.d.setYieldRequested?.(e)}async provideFollowups(e,t,i,s){return this.d.provideFollowups?this.d.provideFollowups(e,t,i,s):[]}toJSON(){return this.b}},Eue=W("chatAgentNameService"),NT=class{static{Ad=this}static{this.b="chat.participantNameRegistry"}constructor(t,i,s,r){if(this.h=i,this.i=s,this.j=r,this.f=PI(this,Object.create(null)),this.g=!1,!t.chatParticipantRegistry)return;this.d=t.chatParticipantRegistry;const n=r.get(Ad.b,-1);try{this.f.set(JSON.parse(n??"{}"),void 0)}catch{r.remove(Ad.b,-1)}this.k()}k(){this.g||this.l().catch(t=>this.i.warn("Failed to fetch chat participant registry",t)).then(()=>Kt(300*1e3)).then(()=>this.k())}async l(){const t=await this.h.request({type:"GET",url:this.d},De.None);if(t.res.statusCode!==200)throw new Error("Could not get extensions report.");const i=await QY(t);if(!i||i.version!==1)throw new Error("Unexpected chat participant registry response.");const s=i.restrictedChatParticipants;this.f.set(s,void 0),this.j.store(Ad.b,JSON.stringify(s),-1,1)}getAgentNameRestriction(t){if(t.isCore)return!0;const i=this.m(t.name,t).get(),s=!t.fullName||this.m(t.fullName.replace(/\s/g,""),t).get();return i&&s}m(t,i){return this.f.map(r=>r[t.toLowerCase()]).map(r=>r?r.some(n=>gs(n,n.includes(".")?i.extensionId.value:i.extensionPublisherId)):!0)}dispose(){this.g=!0}};NT=Ad=__decorate([__param(0,sd),__param(1,pT),__param(2,xe),__param(3,_a)],NT);function cQ(e){return`${e.extensionId.value}.${e.id}`}var lQ=W("labelService"),RT;(function(e){e[e.SHORT=0]="SHORT",e[e.MEDIUM=1]="MEDIUM",e[e.LONG=2]="LONG"})(RT||(RT={}));var LT=W("IPromptsService"),ni;(function(e){e.local="local",e.user="user",e.extension="extension"})(ni||(ni={}));var OT;(function(e){e.contribution="contribution",e.provider="provider"})(OT||(OT={}));var FT;(function(e){e.VSCode="vscode",e.GitHubCopilot="github-copilot",e.Claude="claude",e.Undefined="undefined"})(FT||(FT={}));var Lv;(function(e){e.agentsMd="agentsMd",e.claudeMd="claudeMd",e.copilotInstructionsMd="copilotInstructionsMd"})(Lv||(Lv={}));var{basename:uQ,dirname:jT}=_e,hQ=".prompt.md",dQ=".instructions.md",fQ=".chatmode.md",pQ=".agent.md",gQ="SKILL.md",mQ="copilot-instructions.md",vQ=".github/prompts",wQ=".github/instructions",UT=".github/agents",NS=".claude/agents",RS=".claude/rules",ci;(function(e){e.GitHubWorkspace="github-workspace",e.CopilotPersonal="copilot-personal",e.ClaudePersonal="claude-personal",e.ClaudeWorkspace="claude-workspace",e.ClaudeWorkspaceLocal="claude-workspace-local",e.AgentsWorkspace="agents-workspace",e.AgentsPersonal="agents-personal",e.ConfigWorkspace="config-workspace",e.ConfigPersonal="config-personal",e.ExtensionContribution="extension-contribution",e.ExtensionAPI="extension-api"})(ci||(ci={}));var bQ=[{path:".github/skills",source:ci.GitHubWorkspace,storage:ni.local},{path:".agents/skills",source:ci.AgentsWorkspace,storage:ni.local},{path:".claude/skills",source:ci.ClaudeWorkspace,storage:ni.local},{path:"~/.copilot/skills",source:ci.CopilotPersonal,storage:ni.user},{path:"~/.agents/skills",source:ci.AgentsPersonal,storage:ni.user},{path:"~/.claude/skills",source:ci.ClaudePersonal,storage:ni.user}],yQ=[{path:wQ,source:ci.GitHubWorkspace,storage:ni.local},{path:RS,source:ci.ClaudeWorkspace,storage:ni.local},{path:"~/"+RS,source:ci.ClaudePersonal,storage:ni.user}],AQ=[{path:vQ,source:ci.GitHubWorkspace,storage:ni.local}],SQ=[{path:UT,source:ci.GitHubWorkspace,storage:ni.local},{path:NS,source:ci.ClaudeWorkspace,storage:ni.local}],EQ=[{path:".github/hooks",source:ci.GitHubWorkspace,storage:ni.local},{path:".claude/settings.local.json",source:ci.ClaudeWorkspaceLocal,storage:ni.local},{path:".claude/settings.json",source:ci.ClaudeWorkspace,storage:ni.local},{path:"~/.claude/settings.json",source:ci.ClaudePersonal,storage:ni.user}];function xQ(e){const t=jT(e.path);return t.endsWith("/"+UT)||t.endsWith("/"+NS)}function CQ(e){return jT(e.path).endsWith("/"+NS)}function zT(e){return e.path.includes("/"+RS+"/")}function kQ(e){const t=uQ(e.path);if(t.endsWith(hQ))return ft.prompt;if(t.endsWith(dQ)||t===mQ)return ft.instructions;if(t.endsWith(fQ)||t.endsWith(pQ))return ft.agent;if(t.toLowerCase()===gQ.toLowerCase())return ft.skill;if(t.endsWith(".md")&&t!=="README.md"&&xQ(e))return ft.agent;if(t.endsWith(".md")&&t!=="README.md"&&zT(e))return ft.instructions;if(t.toLowerCase().endsWith(".json"))return ft.hook}function HT(e){return kQ(e)!==void 0}function $Q(e){switch(e){case ft.instructions:return yQ;case ft.prompt:return AQ;case ft.agent:return SQ;case ft.skill:return bQ;case ft.hook:return EQ;default:throw new Error("Unknown prompt type")}}var hr;(function(e){e.PROMPT_LOCATIONS_KEY="chat.promptFilesLocations",e.INSTRUCTIONS_LOCATION_KEY="chat.instructionsFilesLocations",e.MODE_LOCATION_KEY="chat.modeFilesLocations",e.AGENTS_LOCATION_KEY="chat.agentFilesLocations",e.SKILLS_LOCATION_KEY="chat.agentSkillsLocations",e.HOOKS_LOCATION_KEY="chat.hookFilesLocations",e.PROMPT_FILES_SUGGEST_KEY="chat.promptFilesRecommendations",e.USE_COPILOT_INSTRUCTION_FILES="github.copilot.chat.codeGeneration.useInstructionFiles",e.USE_AGENT_MD="chat.useAgentsMdFile",e.USE_NESTED_AGENT_MD="chat.useNestedAgentsMdFiles",e.USE_CLAUDE_MD="chat.useClaudeMdFile",e.USE_AGENT_SKILLS="chat.useAgentSkills",e.USE_CHAT_HOOKS="chat.useHooks",e.USE_CLAUDE_HOOKS="chat.useClaudeHooks",e.USE_SKILL_ADHERENCE_PROMPT="chat.experimental.useSkillAdherencePrompt",e.INCLUDE_APPLYING_INSTRUCTIONS="chat.includeApplyingInstructions",e.INCLUDE_REFERENCED_INSTRUCTIONS="chat.includeReferencedInstructions";function t(r,n){const o=IQ(n),a=r.getValue(o);if(!(a==null||Array.isArray(a))&&typeof a=="object"){const c={};for(const[l,u]of Object.entries(a)){const h=l.trim(),f=WT(u);f!==void 0&&h&&(c[h]=f)}return c}}e.getLocationsValue=t;function i(r,n){const o=t(r,n),a=$Q(n);if(o&&typeof o=="object"){const c=[],l=new Set(a.map(u=>u.path));for(const u of a)o[u.path]!==!1&&c.push(u);for(const[u,h]of Object.entries(o)){if(h===!1||l.has(u))continue;const f=DQ(u)?ni.user:ni.local;c.push({path:u,source:f===ni.local?ci.ConfigPersonal:ci.ConfigWorkspace,storage:f})}return c}return[]}e.promptSourceFolders=i;function s(r,n){const o=r.getValue(e.PROMPT_FILES_SUGGEST_KEY,{resource:n});if(!o||typeof o!="object"||Array.isArray(o))return;const a={};for(const[c,l]of Object.entries(o)){const u=c.trim();if(!u)continue;if(typeof l=="boolean"){a[u]=l;continue}if(typeof l=="string"){const f=l.trim();f&&(a[u]=f);continue}const h=WT(l);h!==void 0&&(a[u]=h)}return Object.keys(a).length>0?a:void 0}e.getPromptFilesRecommendationsValue=s})(hr||(hr={}));function IQ(e){switch(e){case ft.instructions:return hr.INSTRUCTIONS_LOCATION_KEY;case ft.prompt:return hr.PROMPT_LOCATIONS_KEY;case ft.agent:return hr.AGENTS_LOCATION_KEY;case ft.skill:return hr.SKILLS_LOCATION_KEY;case ft.hook:return hr.HOOKS_LOCATION_KEY;default:throw new Error("Unknown prompt type")}}function WT(e){if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();return t==="true"?!0:t==="false"?!1:void 0}}function DQ(e){return e.startsWith("~/")}var PQ=class hs{static fromTo(t,i){return new hs(t,i)}static equals(t,i){return t.start===i.start&&t.endExclusive===i.endExclusive}static addRange(t,i){let s=0;for(;s<i.length&&i[s].endExclusive<t.start;)s++;let r=s;for(;r<i.length&&i[r].start<=t.endExclusive;)r++;if(s===r)i.splice(s,0,t);else{const n=Math.min(t.start,i[s].start),o=Math.max(t.endExclusive,i[r-1].endExclusive);i.splice(s,r-s,new hs(n,o))}}static tryCreate(t,i){if(!(t>i))return new hs(t,i)}static ofLength(t){return new hs(0,t)}static ofStartAndLength(t,i){return new hs(t,t+i)}static emptyAt(t){return new hs(t,t)}constructor(t,i){if(this.start=t,this.endExclusive=i,t>i)throw new Jt(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(t){return new hs(this.start+t,this.endExclusive+t)}deltaStart(t){return new hs(this.start+t,this.endExclusive)}deltaEnd(t){return new hs(this.start,this.endExclusive+t)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(t){return this.start===t.start&&this.endExclusive===t.endExclusive}containsRange(t){return this.start<=t.start&&t.endExclusive<=this.endExclusive}contains(t){return this.start<=t&&t<this.endExclusive}join(t){return new hs(Math.min(this.start,t.start),Math.max(this.endExclusive,t.endExclusive))}intersect(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);if(i<=s)return new hs(i,s)}intersectionLength(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);return Math.max(0,s-i)}intersects(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);return i<s}intersectsOrTouches(t){const i=Math.max(this.start,t.start),s=Math.min(this.endExclusive,t.endExclusive);return i<=s}isBefore(t){return this.endExclusive<=t.start}isAfter(t){return this.start>=t.endExclusive}slice(t){return t.slice(this.start,this.endExclusive)}substring(t){return t.substring(this.start,this.endExclusive)}clip(t){if(this.isEmpty)throw new Jt(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,t))}clipCyclic(t){if(this.isEmpty)throw new Jt(`Invalid clipping range: ${this.toString()}`);return t<this.start?this.endExclusive-(this.start-t)%this.length:t>=this.endExclusive?this.start+(t-this.start)%this.length:t}map(t){const i=[];for(let s=this.start;s<this.endExclusive;s++)i.push(t(s));return i}forEach(t){for(let i=this.start;i<this.endExclusive;i++)t(i)}joinRightTouching(t){if(this.endExclusive!==t.start)throw new Jt(`Invalid join: ${this.toString()} and ${t.toString()}`);return new hs(this.start,t.endExclusive)}withMargin(t,i){return i===void 0&&(i=t),new hs(this.start-t,this.endExclusive+i)}};function TQ(){return{applyingInstructionsCount:0,referencedInstructionsCount:0,agentInstructionsCount:0,listedInstructionsCount:0,totalInstructionsCount:0,claudeRulesCount:0,claudeMdCount:0,claudeAgentsCount:0}}var LS=class{constructor(t,i,s,r,n,o,a,c,l,u,h){this.b=t,this.c=i,this.d=s,this.e=r,this._logService=n,this.f=o,this.g=a,this.h=c,this.j=l,this.k=u,this.l=h,this.a=new Ct}async m(t,i){if(this.a.has(t))return this.a.get(t);try{const s=await this.e.parseNew(t,i);return this.a.set(t,s),s}catch(s){this._logService.error(`[InstructionsContextComputer] Failed to parse instruction file: ${t}`,s);return}}async collect(t,i){const s=await this.e.listPromptFiles(ft.instructions,i);this._logService.trace(`[InstructionsContextComputer] ${s.length} instruction files available.`);const r=TQ(),n=this.o(t);await this.addApplyingInstructions(s,n,t,r,i),await this.u(t,r,i),await this.p(t,r,i);const o=await this.t(s,t,r,i);o&&(t.add(o),r.listedInstructionsCount++),this.n(r)}n(t){t.totalInstructionsCount=t.agentInstructionsCount+t.referencedInstructionsCount+t.applyingInstructionsCount+t.listedInstructionsCount,this.k.publicLog2("instructionsCollected",t)}async addApplyingInstructions(t,i,s,r,n){if(!this.g.getValue(hr.INCLUDE_APPLYING_INSTRUCTIONS)&&this.b!==Zs.Edit){this._logService.trace("[InstructionsContextComputer] includeApplyingInstructions is disabled and agent kind is not Edit. No applying instructions will be added.");return}for(const{uri:a}of t){const c=await this.m(a,n);if(!c){this._logService.trace(`[InstructionsContextComputer] Unable to read: ${a}`);continue}const l=c.header?.applyTo,u=c.header?.paths,h=zT(a),f=h?u?.join(", ")??"**":l;if(!f){this._logService.trace(`[InstructionsContextComputer] No 'applyTo' found: ${a}`);continue}if(i.instructions.has(a)){this._logService.trace(`[InstructionsContextComputer] Skipping already processed instruction file: ${a}`);continue}const p=this.r(i.files,f);if(p){this._logService.trace(`[InstructionsContextComputer] Match for ${a} with ${p.pattern}${p.file?` for file ${p.file}`:""}`);const g=p.file?d(6979,null,f,this.f.getUriLabel(p.file,{relative:!0})):d(6978,null);s.add(mw(a,oa.Instruction,g,!0)),r.applyingInstructionsCount++,h&&r.claudeRulesCount++}else this._logService.trace(`[InstructionsContextComputer] No match for ${a} with ${f}`)}}o(t){const i=new cu,s=new cu;for(const r of t.asArray())if(gw(r))s.add(r.value);else{const n=pw.toUri(r);n&&i.add(n)}return{files:i,instructions:s}}async p(t,i,s){const r={logInfo:c=>this._logService.trace(`[InstructionsContextComputer] ${c}`)},n=await this.e.listAgentInstructions(s,r),o=new vw,a=new vw;for(const{uri:c,type:l}of n){const u=mw(c,oa.Instruction,void 0,!0);o.add(u),l===Lv.copilotInstructionsMd&&a.add(u),i.agentInstructionsCount++,l===Lv.claudeMd&&i.claudeMdCount++,r.logInfo(`Agent instruction file added: ${c.toString()}`)}if(a.length>0){await this.u(a,i,s);for(const c of a.asArray())t.add(c)}for(const c of o.asArray())t.add(c)}q(t,i){if(t)return t;if(i&&i.length>0)return i.join(", ")}r(t,i){const s=Mc(i,","),r=n=>{if(n=n.trim(),n.length!==0){if(n==="**"||n==="**/*"||n==="*")return{pattern:n};!n.startsWith("/")&&!n.startsWith("**/")&&(n="**/"+n);for(const o of t)if(la(n,o.path,{ignoreCase:!0}))return{pattern:n,file:o}}};for(const n of s){const o=r(n);if(o)return o}}s(t){if(!this.c)return;const i=this.l.getToolByName(t);if(i&&this.c[i.id])return{tool:i,variable:`#tool:${this.l.getFullReferenceName(i)}`}}async t(t,i,s,r){const n=this.s("readFile"),o=this.s(ep.runSubagent),a=[];if(n){const f=this.g.getValue(hr.USE_NESTED_AGENT_MD)?this.e.listNestedAgentMDs(r):Promise.resolve([]);a.push("<instructions>"),a.push("Here is a list of instruction files that contain rules for working with this codebase."),a.push("These files are important for understanding the codebase structure, conventions, and best practices."),a.push("Please make sure to follow the rules specified in these files when working with the codebase."),a.push(`If the file is not already available as attachment, use the ${n.variable} tool to acquire it.`),a.push("Make sure to acquire the instructions before working with the codebase.");let p=!1;for(const{uri:S}of t){const E=await this.m(S,r);if(E){if(a.push("<instruction>"),E.header){const{description:k,applyTo:O,paths:F}=E.header;k&&a.push(`<description>${k}</description>`),a.push(`<file>${Ov(S)}</file>`);const G=this.q(O,F);G&&a.push(`<applyTo>${G}</applyTo>`)}else a.push(`<file>${Ov(S)}</file>`);a.push("</instruction>"),p=!0}}const g=await f;for(const{uri:S}of g){const E=this.f.getUriLabel(dc(S),{relative:!0}),k=E.trim().length===0?d(6980,null):d(6981,null,E);a.push("<instruction>"),a.push(`<description>${k}</description>`),a.push(`<file>${Ov(S)}</file>`),a.push("</instruction>"),p=!0}p?a.push("</instructions>","",""):a.length=0;const b=(await this.e.findAgentSkills(r))?.filter(S=>!S.disableModelInvocation);if(b&&b.length>0){const S=this.g.getValue(hr.USE_SKILL_ADHERENCE_PROMPT);a.push("<skills>"),S?(a.push("Skills provide specialized capabilities, domain knowledge, and refined workflows for producing high-quality outputs. Each skill folder contains tested instructions for specific domains like testing strategies, API design, or performance optimization. Multiple skills can be combined when a task spans different domains."),a.push(`BLOCKING REQUIREMENT: When a skill applies to the user's request, you MUST load and read the SKILL.md file IMMEDIATELY as your first action, BEFORE generating any other response or taking action on the task. Use ${n.variable} to load the relevant skill(s).`),a.push("NEVER just mention or reference a skill in your response without actually reading it first. If a skill is relevant, load it before proceeding."),a.push("How to determine if a skill applies:"),a.push("1. Review the available skills below and match their descriptions against the user's request"),a.push("2. If any skill's domain overlaps with the task, load that skill immediately"),a.push("3. When multiple skills apply (e.g., a flowchart in documentation), load all relevant skills"),a.push("Examples:"),a.push(`- "Help me write unit tests for this module" -> Load the testing skill via ${n.variable} FIRST, then proceed`),a.push(`- "Optimize this slow function" -> Load the performance-profiling skill via ${n.variable} FIRST, then proceed`),a.push('- "Add a discount code field to checkout" -> Load both the checkout-flow and form-validation skills FIRST'),a.push("Available skills:")):(a.push("Here is a list of skills that contain domain specific knowledge on a variety of topics."),a.push("Each skill comes with a description of the topic and a file path that contains the detailed instructions."),a.push(`When a user asks you to perform a task that falls within the domain of a skill, use the ${n.variable} tool to acquire the full instructions from the file URI.`));for(const E of b)a.push("<skill>"),a.push(`<name>${E.name}</name>`),E.description&&a.push(`<description>${E.description}</description>`),a.push(`<file>${Ov(E.uri)}</file>`),a.push("</skill>");a.push("</skills>","","")}}if(o&&this.g.getValue(kc.SubagentToolCustomAgents)){const h=(()=>{if(!this.d||this.d.includes("*"))return p=>p.visibility.agentInvokable;{const p=this.d;return g=>p.includes(g.name)}})(),f=await this.e.getCustomAgents(r);if(f.length>0){a.push("<agents>"),a.push("Here is a list of agents that can be used when running a subagent."),a.push("Each agent has optionally a description with the agent's purpose and expertise. When asked to run a subagent, choose the most appropriate agent from this list."),a.push(`Use the ${o.variable} tool with the agent name to run the subagent.`);for(const p of f)h(p)&&(a.push("<agent>"),a.push(`<name>${p.name}</name>`),p.description&&a.push(`<description>${p.description}</description>`),p.argumentHint&&a.push(`<argumentHint>${p.argumentHint}</argumentHint>`),a.push("</agent>"),CQ(p.uri)&&s.claudeAgentsCount++);a.push("</agents>","","")}}if(a.length===0)return;const c=a.join(`
`),l=[],u=h=>{if(h){let f=c.indexOf(h.variable);for(;f>=0;)l.push(bH(h.tool,new PQ(f,f+h.variable.length))),f=c.indexOf(h.variable,f+1)}};return u(n),u(o),wH(c,!0,l)}async u(t,i,s){if(!this.g.getValue(hr.INCLUDE_REFERENCED_INSTRUCTIONS)&&this.b!==Zs.Edit){this._logService.trace("[InstructionsContextComputer] includeReferencedInstructions is disabled and agent kind is not Edit. No referenced instructions will be added.");return}const n=new cu,o=[];for(const c of t.asArray())gw(c)&&(n.has(c.value)||(o.push(c.value),n.add(c.value)));let a=o.pop();for(;a;){const c=await this.m(a,s);if(c&&c.body){const l=[];for(const u of c.body.fileReferences){const h=c.body.resolveFilePath(u.content);h&&!n.has(h)&&(HT(h)||this.h.getWorkspaceFolder(h)!==void 0)&&(l.push({resource:h}),n.add(h))}if(l.length>0){const u=await this.j.resolveAll(l);for(let h=0;h<u.length;h++){const f=u[h],p=l[h].resource;if(f.success&&f.stat?.isFile){HT(p)&&o.push(p);const g=d(6982,null,ji(a));t.add(mw(p,oa.InstructionReference,g,!0)),i.referencedInstructionsCount++,this._logService.trace(`[InstructionsContextComputer] ${p.toString()} added, referenced by ${a.toString()}`)}}}}a=o.pop()}}};LS=__decorate([__param(3,LT),__param(4,xe),__param(5,lQ),__param(6,rs),__param(7,Iu),__param(8,Bf),__param(9,Zu),__param(10,Kf)],LS);function Ov(e){return e.scheme===V.file||e.scheme===V.vscodeRemote?e.fsPath:e.toString()}function OS(e){return{content:[{kind:"text",value:e}]}}var Fv;function _T(e){if(!e)return 1e3;const t=/^([\d.]+)\s*[xX]$/i.exec(e.trim());if(!t)return 1;const i=parseFloat(t[1]);return isNaN(i)?1:i}var MQ=`Launch a new agent to handle complex, multi-step tasks autonomously. This tool is good at researching complex questions, searching for code, and executing multi-step tasks. When you are searching for a keyword or file and are not confident that you will find the right match in the first few tries, use this agent to perform the search for you.

- Agents do not run async or in the background, you will wait for the agent's result.
- When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.
- Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.
- The agent's outputs should generally be trusted
- Clearly tell the agent whether you expect it to write code or just to do research (search, file reads, web fetches, etc.), since it is not aware of the user's intent`,FS=class extends J{static{Fv=this}static{this.Id="runSubagent"}constructor(t,i,s,r,n,o,a,c,l){super(),this.b=t,this.c=i,this.f=s,this.g=r,this.h=n,this.j=o,this.m=a,this.n=c,this.q=l,this.a=new Map,this.onDidUpdateToolData=Ie.filter(this.m.onDidChangeConfiguration,u=>u.affectsConfiguration(kc.SubagentToolCustomAgents))}getToolData(){let t=MQ;const i={type:"object",properties:{prompt:{type:"string",description:"A detailed description of the task for the agent to perform"},description:{type:"string",description:"A short (3-5 word) description of the task"}},required:["prompt","description"]};return this.m.getValue(kc.SubagentToolCustomAgents)&&(i.properties.agentName={type:"string",description:"Optional name of a specific agent to invoke. If not provided, uses the current agent."},t+=`
- If the user asks for a certain agent, you MUST provide that EXACT agent name (case-sensitive) to invoke that specific agent.`),{id:Fv.Id,toolReferenceName:ep.runSubagent,icon:Ft.fromId(ce.organization.id),displayName:d(7213,null),userDescription:d(7214,null),modelDescription:t,source:io.Internal,inputSchema:i}}async invoke(t,i,s,r){const n=t.parameters;if(this.h.debug(`RunSubagentTool: Invoking with prompt: ${n.prompt.substring(0,100)}...`),!t.context)throw new Error("toolInvocationToken is required for this tool");const o=this.c.getSession(t.context.sessionResource);if(!o)throw new Error("Chat model not found for session");const a=o.getRequests().at(-1),c=new X;try{const l=this.b.getDefaultAgent(ti.Chat,Zs.Agent);if(!l)return OS("Error: No default agent available");let u=t.modelId,h=t.userSelectedTools,f,p,g;const v=n.agentName;if(v)if(p=await this.r(v),p){const ie=this.a.get(t.callId);if(ie)this.a.delete(t.callId),u=ie.modeModelId,g=ie.resolvedModelName;else{const $e=this.s(p,t.modelId);u=$e.modeModelId,g=$e.resolvedModelName}const Ae=p.tools;if(Ae){const $e=this.f.toToolAndToolSetEnablementMap(Ae,void 0);h={};for(const[Z,z]of $e)hW(Z)||(h[Z.id]=z)}const re=p.agentInstructions;f=re&&{name:v,content:re.content,toolReferences:this.j.toToolReferences(re.toolReferences),metadata:re.metadata}}else throw new Error(`Requested agent '${v}' not found. Try again with the correct agent name, or omit the agentName to use the current agent.`);else{const ie=this.a.get(t.callId);ie?(this.a.delete(t.callId),g=ie.resolvedModelName):g=(u?this.g.lookupLanguageModel(u):void 0)?.name}const b=[],S=t.callId??`subagent-${At()}`;let E=!1;const k=ie=>{for(const Ae of ie)Ae.kind==="textEdit"||Ae.kind==="notebookEdit"||Ae.kind==="codeblockUri"?(Ae.kind==="codeblockUri"&&!E&&(E=!0,o.acceptResponseProgress(a,{kind:"markdownContent",content:new Qn("```\n")})),Ae.kind==="codeblockUri"?o.acceptResponseProgress(a,{...Ae,subAgentInvocationId:S}):o.acceptResponseProgress(a,Ae)):Ae.kind==="hook"?o.acceptResponseProgress(a,{...Ae,subAgentInvocationId:S}):Ae.kind==="markdownContent"&&(E&&(o.acceptResponseProgress(a,{kind:"markdownContent",content:new Qn("\n```\n\n")}),E=!1),b.push(Ae.content.value))};h&&(h[Fv.Id]=!1,h[W3]=!1,h.copilot_askQuestions=!1);const O=new vw;await this.q.createInstance(LS,Zs.Agent,h,void 0).collect(O,r);let G;try{G=(await this.n.getHooks(r))?.hooks}catch(ie){this.h.warn("[ChatService] Failed to collect hooks:",ie)}const j={sessionResource:t.context.sessionResource,requestId:t.callId??`subagent-${Date.now()}`,agentId:l.id,message:n.prompt,variables:{variables:O.asArray()},location:ti.Chat,subAgentInvocationId:t.callId,subAgentName:v,userSelectedModelId:u,userSelectedTools:h,modeInstructions:f,hooks:G,hasHooksEnabled:!!G&&Object.values(G).some(ie=>ie.length>0)};c.add(this.f.onDidInvokeTool(ie=>{ie.subagentInvocationId===S&&(b.length=0)}));const B=await this.b.invokeAgent(l.id,j,k,[],r);if(B.errorDetails)return OS(`Agent error: ${B.errorDetails.message}`);const H=b.join("").replace(/^\n*```\n+```\n*/g,"").trim()||"Agent completed with no output";return t.toolSpecificData?.kind==="subagent"&&(t.toolSpecificData.result=H,t.toolSpecificData.modelName=g),{content:[{kind:"text",value:H}],toolMetadata:{subAgentInvocationId:S,description:n.description,agentName:j.subAgentName,modelName:g}}}catch(l){const u=`Error invoking subagent: ${l instanceof Error?l.message:"Unknown error"}`;return this.h.error(u,l),OS(u)}finally{c.dispose()}}async r(t){return(await this.n.getCustomAgents(De.None)).find(s=>s.name===t)}s(t,i){let s=i;if(t){const n=t.model;if(n)e:for(const o of n){const a=this.g.lookupLanguageModelByQualifiedName(o);for(const c of this.g.getLanguageModelIds()){const l=this.g.lookupLanguageModel(c);if(l&&l?.id===a?.id){s=c;break e}}}if(s&&s!==i){const o=i?this.g.lookupLanguageModel(i):void 0,a=this.g.lookupLanguageModel(s),c=_T(o?.multiplier);_T(a?.multiplier)>c&&(this.h.warn(`[RunSubagentTool] Subagent '${t.name}' requested model '${a?.name}' (multiplier: ${a?.multiplier??"unknown"}) which has a larger multiplier than the main agent model '${o?.name}' (multiplier: ${o?.multiplier??"unknown"}). Falling back to the main agent model.`),s=i)}}const r=s?this.g.lookupLanguageModel(s):void 0;return{modeModelId:s,resolvedModelName:r?.name}}async prepareToolInvocation(t,i){const s=t.parameters,r=s.agentName?await this.r(s.agentName):void 0,n=this.s(r,t.modelId);return this.a.set(t.toolCallId,n),{invocationMessage:s.description,toolSpecificData:{kind:"subagent",description:s.description,agentName:r?.name,prompt:s.prompt,modelName:n.resolvedModelName}}}};FS=Fv=__decorate([__param(0,aQ),__param(1,e3),__param(2,Kf),__param(3,nQ),__param(4,xe),__param(5,Kf),__param(6,rs),__param(7,LT),__param(8,Yo)],FS);var BT=class extends J{static{this.ID="chat.builtinTools"}constructor(t,i){super();const s=i.createInstance(pS);this.D(t.registerTool(yY,s));const r=_3(),n=this.D(i.createInstance(bS));this.D(t.registerTool(r,n));const o=i.createInstance(EY);this.D(t.registerTool(SY,o));const a=this.D(i.createInstance(FS));let c,l;const u=()=>{c?.dispose(),l?.dispose(),t.flushToolUpdates();const h=a.getToolData();c=t.registerTool(h,a),l=t.agentToolSet.addTool(h)};u(),this.D(a.onDidUpdateToolData(u)),this.D({dispose:()=>{c?.dispose(),l?.dispose()}})}};BT=__decorate([__param(0,Kf),__param(1,Yo)],BT);var NQ="vscode_fetchWebPage_internal",qT=W("commandService"),jS=new class{constructor(){this.a=new Map,this.b=new I,this.onDidRegisterCommand=this.b.event}registerCommand(e,t){if(!e)throw new Error("invalid command");if(typeof e=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:e,handler:t})}if(e.metadata&&Array.isArray(e.metadata.args)){const o=[];for(const c of e.metadata.args)o.push(c.constraint);const a=e.handler;e.handler=function(c,...l){return HL(l,o),a(c,...l)}}const{id:i}=e;let s=this.a.get(i);s||(s=new Pn,this.a.set(i,s));const r=s.unshift(e),n=se(()=>{r(),this.a.get(i)?.isEmpty()&&this.a.delete(i)});return this.b.fire(i),O1(n)}registerCommandAlias(e,t){return jS.registerCommand(e,(i,...s)=>i.get(qT).executeCommand(t,...s))}getCommand(e){const t=this.a.get(e);if(!(!t||t.isEmpty()))return ai.first(t)}getCommands(){const e=new Map;for(const t of this.a.keys()){const i=this.getCommand(t);i&&e.set(t,i)}return e}};jS.registerCommand("noop",()=>{});var VT;(function(e){e[e.CtrlCmd=2048]="CtrlCmd",e[e.Shift=1024]="Shift",e[e.Alt=512]="Alt",e[e.WinCtrl=256]="WinCtrl",e[e.KeyCode=255]="KeyCode"})(VT||(VT={}));function GT(e,t){if(typeof e=="number"){if(e===0)return null;const i=(e&65535)>>>0,s=(e&4294901760)>>>16;return s!==0?new Uv([jv(i,t),jv(s,t)]):new Uv([jv(i,t)])}else{const i=[];for(let s=0;s<e.length;s++)i.push(jv(e[s],t));return new Uv(i)}}function jv(e,t){const i=!!(e&2048),s=!!(e&256),r=t===2?s:i,n=!!(e&1024),o=!!(e&512),a=t===2?i:s,c=e&255;return new RQ(r,n,o,a,c)}var RQ=class xR{constructor(t,i,s,r,n){this.ctrlKey=t,this.shiftKey=i,this.altKey=s,this.metaKey=r,this.keyCode=n}equals(t){return t instanceof xR&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){const t=this.ctrlKey?"1":"0",i=this.shiftKey?"1":"0",s=this.altKey?"1":"0",r=this.metaKey?"1":"0";return`K${t}${i}${s}${r}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new Uv([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},Uv=class{constructor(e){if(e.length===0)throw Me("chords");this.chords=e}getHashCode(){let e="";for(let t=0,i=this.chords.length;t<i;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}},JT;(function(e){e[e.EditorCore=0]="EditorCore",e[e.EditorContrib=100]="EditorContrib",e[e.WorkbenchContrib=200]="WorkbenchContrib",e[e.BuiltinExtension=300]="BuiltinExtension",e[e.ExternalExtension=400]="ExternalExtension"})(JT||(JT={}));var LQ=class CR{constructor(){this.c=new Pn,this.d=[],this.e=null}static f(t){if(Nn===1){if(t&&t.win)return t.win}else if(Nn===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){const i=CR.f(t),s=new X;if(i&&i.primary){const r=GT(i.primary,Nn);r&&s.add(this.g(r,t.id,t.args,t.weight,0,t.when))}if(i&&Array.isArray(i.secondary))for(let r=0,n=i.secondary.length;r<n;r++){const o=i.secondary[r],a=GT(o,Nn);a&&s.add(this.g(a,t.id,t.args,t.weight,-r-1,t.when))}return s}setExtensionKeybindings(t){const i=[];let s=0;for(const r of t)r.keybinding&&(i[s++]={keybinding:r.keybinding,command:r.id,commandArgs:r.args,when:r.when,weight1:r.weight,weight2:0,extensionId:r.extensionId||null,isBuiltinExtension:r.isBuiltinExtension||!1});this.d=i,this.e=null}registerCommandAndKeybindingRule(t){return F1(this.registerKeybindingRule(t),jS.registerCommand(t))}g(t,i,s,r,n,o){const a=this.c.push({keybinding:t,command:i,commandArgs:s,when:o,weight1:r,weight2:n,extensionId:null,isBuiltinExtension:!1});return this.e=null,se(()=>{a(),this.e=null})}getDefaultKeybindings(){return this.e||(this.e=Array.from(this.c).concat(this.d),this.e.sort(jQ)),this.e.slice(0)}},OQ=new LQ,FQ={EditorModes:"platform.keybindingsRegistry"};Qt.add(FQ.EditorModes,OQ);function jQ(e,t){if(e.weight1!==t.weight1)return e.weight1-t.weight1;if(e.command&&t.command){if(e.command<t.command)return-1;if(e.command>t.command)return 1}return e.weight2-t.weight2}var zv;function UQ(e){return e.command!==void 0}var Sd=class D{static{this.a=new Map}static{this.CommandPalette=new D("CommandPalette")}static{this.DebugBreakpointsContext=new D("DebugBreakpointsContext")}static{this.DebugCallStackContext=new D("DebugCallStackContext")}static{this.DebugConsoleContext=new D("DebugConsoleContext")}static{this.DebugVariablesContext=new D("DebugVariablesContext")}static{this.NotebookVariablesContext=new D("NotebookVariablesContext")}static{this.DebugHoverContext=new D("DebugHoverContext")}static{this.DebugWatchContext=new D("DebugWatchContext")}static{this.DebugToolBar=new D("DebugToolBar")}static{this.DebugToolBarStop=new D("DebugToolBarStop")}static{this.DebugDisassemblyContext=new D("DebugDisassemblyContext")}static{this.DebugCallStackToolbar=new D("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new D("DebugCreateConfiguration")}static{this.DebugScopesContext=new D("DebugScopesContext")}static{this.EditorContext=new D("EditorContext")}static{this.SimpleEditorContext=new D("SimpleEditorContext")}static{this.EditorContent=new D("EditorContent")}static{this.EditorLineNumberContext=new D("EditorLineNumberContext")}static{this.EditorContextCopy=new D("EditorContextCopy")}static{this.EditorContextPeek=new D("EditorContextPeek")}static{this.EditorContextShare=new D("EditorContextShare")}static{this.EditorTitle=new D("EditorTitle")}static{this.CompactWindowEditorTitle=new D("CompactWindowEditorTitle")}static{this.EditorTitleRun=new D("EditorTitleRun")}static{this.EditorTitleContext=new D("EditorTitleContext")}static{this.EditorTitleContextShare=new D("EditorTitleContextShare")}static{this.EmptyEditorGroup=new D("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new D("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new D("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new D("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new D("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new D("EditorActionsPositionSubmenu")}static{this.EditorSplitMoveSubmenu=new D("EditorSplitMoveSubmenu")}static{this.ExplorerContext=new D("ExplorerContext")}static{this.ExplorerContextShare=new D("ExplorerContextShare")}static{this.ExtensionContext=new D("ExtensionContext")}static{this.ExtensionEditorContextMenu=new D("ExtensionEditorContextMenu")}static{this.GlobalActivity=new D("GlobalActivity")}static{this.CommandCenter=new D("CommandCenter")}static{this.CommandCenterCenter=new D("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new D("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new D("LayoutControlMenu")}static{this.MenubarMainMenu=new D("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new D("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new D("MenubarDebugMenu")}static{this.MenubarEditMenu=new D("MenubarEditMenu")}static{this.MenubarCopy=new D("MenubarCopy")}static{this.MenubarFileMenu=new D("MenubarFileMenu")}static{this.MenubarGoMenu=new D("MenubarGoMenu")}static{this.MenubarHelpMenu=new D("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new D("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new D("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new D("PanelAlignmentMenu")}static{this.PanelPositionMenu=new D("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new D("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new D("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new D("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new D("MenubarSelectionMenu")}static{this.MenubarShare=new D("MenubarShare")}static{this.MenubarSwitchEditorMenu=new D("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new D("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new D("MenubarTerminalMenu")}static{this.MenubarTerminalSuggestStatusMenu=new D("MenubarTerminalSuggestStatusMenu")}static{this.MenubarViewMenu=new D("MenubarViewMenu")}static{this.MenubarHomeMenu=new D("MenubarHomeMenu")}static{this.OpenEditorsContext=new D("OpenEditorsContext")}static{this.OpenEditorsContextShare=new D("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new D("ProblemsPanelContext")}static{this.SCMInputBox=new D("SCMInputBox")}static{this.SCMChangeContext=new D("SCMChangeContext")}static{this.SCMResourceContext=new D("SCMResourceContext")}static{this.SCMResourceContextShare=new D("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new D("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new D("SCMResourceGroupContext")}static{this.SCMSourceControl=new D("SCMSourceControl")}static{this.SCMSourceControlInline=new D("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new D("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new D("SCMHistoryTitle")}static{this.SCMHistoryItemContext=new D("SCMHistoryItemContext")}static{this.SCMHistoryItemChangeContext=new D("SCMHistoryItemChangeContext")}static{this.SCMHistoryItemRefContext=new D("SCMHistoryItemRefContext")}static{this.SCMArtifactGroupContext=new D("SCMArtifactGroupContext")}static{this.SCMArtifactContext=new D("SCMArtifactContext")}static{this.SCMQuickDiffDecorations=new D("SCMQuickDiffDecorations")}static{this.SCMTitle=new D("SCMTitle")}static{this.SearchContext=new D("SearchContext")}static{this.SearchActionMenu=new D("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new D("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new D("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new D("StickyScrollContext")}static{this.TestItem=new D("TestItem")}static{this.TestItemGutter=new D("TestItemGutter")}static{this.TestProfilesContext=new D("TestProfilesContext")}static{this.TestMessageContext=new D("TestMessageContext")}static{this.TestMessageContent=new D("TestMessageContent")}static{this.TestPeekElement=new D("TestPeekElement")}static{this.TestPeekTitle=new D("TestPeekTitle")}static{this.TestCallStack=new D("TestCallStack")}static{this.TestCoverageFilterItem=new D("TestCoverageFilterItem")}static{this.TouchBarContext=new D("TouchBarContext")}static{this.TitleBar=new D("TitleBar")}static{this.TitleBarContext=new D("TitleBarContext")}static{this.TitleBarTitleContext=new D("TitleBarTitleContext")}static{this.TunnelContext=new D("TunnelContext")}static{this.TunnelPrivacy=new D("TunnelPrivacy")}static{this.TunnelProtocol=new D("TunnelProtocol")}static{this.TunnelPortInline=new D("TunnelInline")}static{this.TunnelTitle=new D("TunnelTitle")}static{this.TunnelLocalAddressInline=new D("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new D("TunnelOriginInline")}static{this.ViewItemContext=new D("ViewItemContext")}static{this.ViewContainerTitle=new D("ViewContainerTitle")}static{this.ViewContainerTitleContext=new D("ViewContainerTitleContext")}static{this.ViewTitle=new D("ViewTitle")}static{this.ViewTitleContext=new D("ViewTitleContext")}static{this.CommentEditorActions=new D("CommentEditorActions")}static{this.CommentThreadTitle=new D("CommentThreadTitle")}static{this.CommentThreadActions=new D("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new D("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new D("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new D("CommentThreadCommentContext")}static{this.CommentTitle=new D("CommentTitle")}static{this.CommentActions=new D("CommentActions")}static{this.CommentsViewThreadActions=new D("CommentsViewThreadActions")}static{this.InteractiveToolbar=new D("InteractiveToolbar")}static{this.InteractiveCellTitle=new D("InteractiveCellTitle")}static{this.InteractiveCellDelete=new D("InteractiveCellDelete")}static{this.InteractiveCellExecute=new D("InteractiveCellExecute")}static{this.InteractiveInputExecute=new D("InteractiveInputExecute")}static{this.InteractiveInputConfig=new D("InteractiveInputConfig")}static{this.ReplInputExecute=new D("ReplInputExecute")}static{this.IssueReporter=new D("IssueReporter")}static{this.NotebookToolbar=new D("NotebookToolbar")}static{this.NotebookToolbarContext=new D("NotebookToolbarContext")}static{this.NotebookStickyScrollContext=new D("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new D("NotebookCellTitle")}static{this.NotebookCellDelete=new D("NotebookCellDelete")}static{this.NotebookCellInsert=new D("NotebookCellInsert")}static{this.NotebookCellBetween=new D("NotebookCellBetween")}static{this.NotebookCellListTop=new D("NotebookCellTop")}static{this.NotebookCellExecute=new D("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new D("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new D("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new D("NotebookDiffCellInputTitle")}static{this.NotebookDiffDocumentMetadata=new D("NotebookDiffDocumentMetadata")}static{this.NotebookDiffCellMetadataTitle=new D("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new D("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new D("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new D("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new D("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new D("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new D("NotebookKernelSource")}static{this.BulkEditTitle=new D("BulkEditTitle")}static{this.BulkEditContext=new D("BulkEditContext")}static{this.TimelineItemContext=new D("TimelineItemContext")}static{this.TimelineTitle=new D("TimelineTitle")}static{this.TimelineTitleContext=new D("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new D("TimelineFilterSubMenu")}static{this.AccountsContext=new D("AccountsContext")}static{this.SidebarTitle=new D("SidebarTitle")}static{this.PanelTitle=new D("PanelTitle")}static{this.AuxiliaryBarTitle=new D("AuxiliaryBarTitle")}static{this.TerminalInstanceContext=new D("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new D("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new D("TerminalNewDropdownContext")}static{this.TerminalTabContext=new D("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new D("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new D("TerminalStickyScrollContext")}static{this.WebviewContext=new D("WebviewContext")}static{this.InlineCompletionsActions=new D("InlineCompletionsActions")}static{this.InlineEditsActions=new D("InlineEditsActions")}static{this.NewFile=new D("NewFile")}static{this.MergeInput1Toolbar=new D("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new D("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new D("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new D("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new D("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new D("InlineEditToolbar")}static{this.ChatContext=new D("ChatContext")}static{this.ChatCodeBlock=new D("ChatCodeblock")}static{this.ChatCompareBlock=new D("ChatCompareBlock")}static{this.ChatMessageTitle=new D("ChatMessageTitle")}static{this.ChatWelcomeContext=new D("ChatWelcomeContext")}static{this.ChatMessageFooter=new D("ChatMessageFooter")}static{this.ChatExecute=new D("ChatExecute")}static{this.ChatExecuteQueue=new D("ChatExecuteQueue")}static{this.ChatInput=new D("ChatInput")}static{this.ChatInputSide=new D("ChatInputSide")}static{this.ChatModePicker=new D("ChatModePicker")}static{this.ChatEditingWidgetToolbar=new D("ChatEditingWidgetToolbar")}static{this.ChatEditingSessionChangesToolbar=new D("ChatEditingSessionChangesToolbar")}static{this.ChatEditingEditorContent=new D("ChatEditingEditorContent")}static{this.ChatEditingEditorHunk=new D("ChatEditingEditorHunk")}static{this.ChatEditingDeletedNotebookCell=new D("ChatEditingDeletedNotebookCell")}static{this.ChatInputAttachmentToolbar=new D("ChatInputAttachmentToolbar")}static{this.ChatEditingWidgetModifiedFilesToolbar=new D("ChatEditingWidgetModifiedFilesToolbar")}static{this.ChatInputResourceAttachmentContext=new D("ChatInputResourceAttachmentContext")}static{this.ChatInputSymbolAttachmentContext=new D("ChatInputSymbolAttachmentContext")}static{this.ChatInlineResourceAnchorContext=new D("ChatInlineResourceAnchorContext")}static{this.ChatInlineSymbolAnchorContext=new D("ChatInlineSymbolAnchorContext")}static{this.ChatMessageCheckpoint=new D("ChatMessageCheckpoint")}static{this.ChatMessageRestoreCheckpoint=new D("ChatMessageRestoreCheckpoint")}static{this.ChatNewMenu=new D("ChatNewMenu")}static{this.ChatEditingCodeBlockContext=new D("ChatEditingCodeBlockContext")}static{this.ChatTitleBarMenu=new D("ChatTitleBarMenu")}static{this.ChatAttachmentsContext=new D("ChatAttachmentsContext")}static{this.ChatToolOutputResourceToolbar=new D("ChatToolOutputResourceToolbar")}static{this.ChatTextEditorMenu=new D("ChatTextEditorMenu")}static{this.ChatToolOutputResourceContext=new D("ChatToolOutputResourceContext")}static{this.ChatMultiDiffContext=new D("ChatMultiDiffContext")}static{this.ChatConfirmationMenu=new D("ChatConfirmationMenu")}static{this.ChatEditorInlineGutter=new D("ChatEditorInlineGutter")}static{this.ChatEditorInlineExecute=new D("ChatEditorInputExecute")}static{this.ChatEditorInlineInputSide=new D("ChatEditorInputSide")}static{this.InlineChatEditorAffordance=new D("InlineChatEditorAffordance")}static{this.AccessibleView=new D("AccessibleView")}static{this.MultiDiffEditorContent=new D("MultiDiffEditorContent")}static{this.MultiDiffEditorFileToolbar=new D("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new D("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new D("DiffEditorSelectionToolbar")}static{this.BrowserNavigationToolbar=new D("BrowserNavigationToolbar")}static{this.BrowserActionsToolbar=new D("BrowserActionsToolbar")}static{this.AgentSessionsViewerFilterSubMenu=new D("AgentSessionsViewerFilterSubMenu")}static{this.AgentSessionsContext=new D("AgentSessionsContext")}static{this.AgentSessionSectionContext=new D("AgentSessionSectionContext")}static{this.AgentSessionsCreateSubMenu=new D("AgentSessionsCreateSubMenu")}static{this.AgentSessionsToolbar=new D("AgentSessionsToolbar")}static{this.AgentSessionItemToolbar=new D("AgentSessionItemToolbar")}static{this.AgentSessionSectionToolbar=new D("AgentSessionSectionToolbar")}static{this.AgentsTitleBarControlMenu=new D("AgentsTitleBarControlMenu")}static{this.ChatViewSessionTitleNavigationToolbar=new D("ChatViewSessionTitleNavigationToolbar")}static{this.ChatViewSessionTitleToolbar=new D("ChatViewSessionTitleToolbar")}static{this.ChatContextUsageActions=new D("ChatContextUsageActions")}static for(t){return D.a.get(t)??new D(t)}constructor(t){if(D.a.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);D.a.set(t,this),this.id=t}},Iue=W("menuService"),Ed=class ox{static{this.a=new Map}static for(t){let i=this.a.get(t);return i||(i=new ox(t),this.a.set(t,i)),i}static merge(t){const i=new Set;for(const s of t)s instanceof ox&&i.add(s.b);return i}constructor(t){this.b=t,this.has=i=>i===t}},Due=new class{constructor(){this.a=new Map,this.b=new Map,this.c=new r2({merge:Ed.merge}),this.onDidChangeMenu=this.c.event}addCommand(e){return this.a.set(e.id,e),this.c.fire(Ed.for(Sd.CommandPalette)),O1(se(()=>{this.a.delete(e.id)&&this.c.fire(Ed.for(Sd.CommandPalette))}))}getCommand(e){return this.a.get(e)}getCommands(){const e=new Map;return this.a.forEach((t,i)=>e.set(i,t)),e}appendMenuItem(e,t){let i=this.b.get(e);i||(i=new Pn,this.b.set(e,i));const s=i.push(t);return this.c.fire(Ed.for(e)),O1(se(()=>{s(),this.c.fire(Ed.for(e))}))}appendMenuItems(e){const t=new X;for(const{id:i,item:s}of e)t.add(this.appendMenuItem(i,s));return t}getMenuItems(e){let t;return this.b.has(e)?t=[...this.b.get(e)]:t=[],e===Sd.CommandPalette&&this.d(t),t}d(e){const t=new Set;for(const i of e)UQ(i)&&(t.add(i.command.id),i.alt&&t.add(i.alt.id));this.a.forEach((i,s)=>{t.has(s)||e.push({command:i})})}},ZT=zv=class{static label(t,i){return i?.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}constructor(t,i,s,r,n,o,a){this.hideActions=r,this.menuKeybinding=n,this.b=a,this.id=t.id,this.label=zv.label(t,s),this.tooltip=(typeof t.tooltip=="string"?t.tooltip:t.tooltip?.value)??"",this.enabled=!t.precondition||o.contextMatchesRules(t.precondition),this.checked=void 0;let c;if(t.toggled){const l=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=o.contextMatchesRules(l.condition),this.checked&&l.tooltip&&(this.tooltip=typeof l.tooltip=="string"?l.tooltip:l.tooltip.value),this.checked&&Ft.isThemeIcon(l.icon)&&(c=l.icon),this.checked&&l.title&&(this.label=typeof l.title=="string"?l.title:l.title.value)}c||(c=Ft.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=i?new zv(i,void 0,s,r,void 0,o,a):void 0,this.a=s,this.class=c&&Ft.asClassName(c)}run(...t){let i=[];return this.a?.arg&&(i=[...i,this.a.arg]),this.a?.shouldForwardArgs&&(i=[...i,...t]),this.b.executeCommand(this.id,...i)}};ZT=zv=__decorate([__param(5,Jn),__param(6,qT)],ZT);var Tue=rf(9230,"Extensions"),YT;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(YT||(YT={}));var QT;(function(e){e.ReloadWindow="reloadWindow",e.RestartExtensions="restartExtensions",e.DownloadUpdate="downloadUpdate",e.ApplyUpdate="applyUpdate",e.QuitAndInstall="quitAndInstall"})(QT||(QT={}));var XT=W("extensionsWorkbenchService"),KT;(function(e){e.Readme="readme",e.Features="features",e.Changelog="changelog",e.Dependencies="dependencies",e.ExtensionPack="extensionPack"})(KT||(KT={}));var eM=class extends J{constructor(t,i){super(),this.a=t,this.D(i.onChange(this.b,this))}set extension(t){this.a.forEach(i=>i.extension=t)}b(t){for(const i of this.a)t&&i.extension?h_(i.extension.identifier,t.identifier)&&(i.extension.server&&t.server&&i.extension.server!==t.server?i.updateWhenCounterExtensionChanges&&i.update():i.extension=t):i.update()}};eM=__decorate([__param(1,XT)],eM);var Nue=new C("defaultExtensionViews",!0),Rue=new C("hasOutdatedExtensions",!1),Lue=new C("hasGallery",!1),Oue=new C("extensionsGalleryStatus","unavailable"),Fue=new C("extensionResultListFocused ",!0),jue=new C("searchMcpServers",!1),Uue=new Sd("extensionsSearchActionsMenu"),zue=new Sd("extensionsFilterSubMenu"),tM="vscode_searchExtensions_internal",Hue={id:tM,toolReferenceName:"extensions",legacyToolReferenceFullNames:["extensions"],icon:Ft.fromId(ce.extensions.id),displayName:d(9250,null),modelDescription:"This is a tool for browsing Visual Studio Code Extensions Marketplace. It allows the model to search for extensions and retrieve detailed information about them. The model should use this tool whenever it needs to discover extensions or resolve information about known ones. To use the tool, the model has to provide the category of the extensions, relevant search keywords, or known extension IDs. Note that search results may include false positives, so reviewing and filtering is recommended.",userDescription:d(9251,null),source:io.Internal,inputSchema:{type:"object",properties:{category:{type:"string",description:"The category of extensions to search for",enum:g5},keywords:{type:"array",items:{type:"string"},description:"The keywords to search for"},ids:{type:"array",items:{type:"string"},description:"The ids of the extensions to search for"}}}},iM=class{constructor(t){this.a=t}async invoke(t,i,s,r){const n=t.parameters;if(!n.keywords?.length&&!n.category&&!n.ids?.length)return{content:[{kind:"text",value:d(9252,null)}]};const o=new Map,a=u=>{for(const h of u)h.deprecationInfo||h.isMalicious||o.set(h.identifier.id.toLowerCase(),{id:h.identifier.id,name:h.displayName,description:h.description,installed:h.state===1,installCount:h.installCount??0,rating:h.rating??0,categories:h.categories??[],tags:h.gallery?.tags??[]})},c=async u=>{const h=await this.a.queryGallery({text:u,pageSize:10,sortBy:"InstallCount"},r);h.firstPage.length&&a(h.firstPage)};if(n.ids?.length){const u=await this.a.getExtensions(n.ids.map(h=>({id:h})),r);a(u)}if(n.keywords?.length)for(const u of n.keywords??[])if(u==="featured")await c("featured");else{let h=n.category?`category:"${n.category}"`:"";h=u?`${h} ${u}`.trim():h,await c(h)}else await c(`category:"${n.category}"`);const l=Array.from(o.values());return{content:[{kind:"text",value:`Here are the list of extensions:
${JSON.stringify(l)}
. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.
\`\`\`vscode-extensions
extensionId1,extensionId2
\`\`\`
.`}],toolResultDetails:{input:JSON.stringify(n),output:[{type:"embed",isText:!0,value:JSON.stringify(l.map(u=>u.id))}]}}}};iM=__decorate([__param(0,XT)],iM);var sM=class{constructor(e){this.a=e}update(e){this.a=e,this.b=void 0,this.c=void 0}get data(){return this.a}get apiObject(){return this.b||(this.b=Object.freeze({name:this.a.id,description:this.a.modelDescription,inputSchema:this.a.inputSchema,tags:this.a.tags??[],source:void 0})),this.b}get apiObjectWithChatParticipantAdditions(){return this.c||(this.c=Object.freeze({name:this.a.id,description:this.a.modelDescription,inputSchema:this.a.inputSchema,tags:this.a.tags??[],source:Vy.to(this.a.source)})),this.c}},zQ=class{constructor(e,t){this.e=t,this.a=new Map,this.c=new Map,this.d=new Map,this.b=e.getProxy(Q.MainThreadLanguageModelTools),this.b.$getTools().then(i=>{for(const s of i)this.d.set(s.id,new sM(ei(s)))})}async $countTokensForInvocation(e,t,i){const s=this.c.get(e);if(!s)throw new Error(`Tool invocation call ${e} not found`);return await s(t,i)}async invokeTool(e,t,i,s){const r=typeof t=="string"?t:t.name,n=At();i.tokenizationOptions&&this.c.set(n,i.tokenizationOptions.countTokens);try{if(i.toolInvocationToken&&!uW(i.toolInvocationToken))throw new Error("Invalid tool invocation token");if((r===fS||r===L3)&&!qe(e,"chatParticipantPrivate"))throw new Error(`Invalid tool: ${r}`);const o=await this.b.$invokeTool({toolId:r,callId:n,parameters:i.input,tokenBudget:i.tokenizationOptions?.tokenBudget,context:i.toolInvocationToken,chatRequestId:qe(e,"chatParticipantPrivate")?i.chatRequestId:void 0,chatInteractionId:qe(e,"chatParticipantPrivate")?i.chatInteractionId:void 0,subAgentInvocationId:qe(e,"chatParticipantPrivate")?i.subAgentInvocationId:void 0,chatStreamToolCallId:qe(e,"chatParticipantAdditions")?i.chatStreamToolCallId:void 0,preToolUseResult:qe(e,"chatParticipantPrivate")?i.preToolUseResult:void 0},s),a=o instanceof Si?o.value:o;return um.to(ei(a))}finally{this.c.delete(n)}}$onDidChangeTools(e){const t=new Set(this.d.keys());for(const i of e){t.delete(i.id);const s=this.d.get(i.id);s?s.update(i):this.d.set(i.id,new sM(ei(i)))}for(const i of t)this.d.delete(i)}getTools(e){const t=qe(e,"chatParticipantPrivate");return Array.from(this.d.values()).map(i=>t?i.apiObjectWithChatParticipantAdditions:i.apiObject).filter(i=>{switch(i.name){case fS:case L3:case NQ:case tM:return qe(e,"chatParticipantPrivate");default:return!0}})}async $invokeTool(e,t){const i=this.a.get(e.toolId);if(!i)throw new Error(`Unknown tool ${e.toolId}`);const s={input:e.parameters,toolInvocationToken:ei(e.context)};qe(i.extension,"chatParticipantPrivate")&&(s.chatRequestId=e.chatRequestId,s.chatInteractionId=e.chatInteractionId,s.chatSessionId=e.context?.sessionId,s.chatSessionResource=y.revive(e.context?.sessionResource),s.subAgentInvocationId=e.subAgentInvocationId),qe(i.extension,"chatParticipantAdditions")&&e.modelId&&(s.model=await this.f(e.modelId,i.extension)),qe(i.extension,"chatParticipantAdditions")&&e.chatStreamToolCallId&&(s.chatStreamToolCallId=e.chatStreamToolCallId),e.tokenBudget!==void 0&&(s.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this.c.get(e.callId)||((o,a=De.None)=>this.b.$countTokensForInvocation(e.callId,o,a))});let r;if(qe(i.extension,"toolProgress")){let o;r={report:a=>{a.increment!==void 0&&(o=(o??0)+a.increment),this.b.$acceptToolProgress(e.callId,{message:le.fromStrict(a.message),progress:o===void 0?void 0:o/100})}}}const n=await PC(Promise.resolve(i.tool.invoke(s,t,r)),t);if(!n)throw new dt;return um.from(n,i.extension)}async f(e,t){let i;if(e&&(i=await this.e.getLanguageModelByIdentifier(t,e)),!i&&(i=await this.e.getDefaultLanguageModel(t),!i))throw new Error("Language model unavailable");return i}async $handleToolStream(e,t,i){const s=this.a.get(e);if(!s)throw new Error(`Unknown tool ${e}`);if(!s.tool.handleToolStream)return;T(s.extension,"chatParticipantAdditions");const r={rawInput:t.rawInput,chatRequestId:t.chatRequestId,chatSessionId:t.chatSessionId,chatSessionResource:t.chatSessionResource,chatInteractionId:t.chatInteractionId},n=await s.tool.handleToolStream(r,i);if(n)return{invocationMessage:le.fromStrict(n.invocationMessage)}}async $prepareToolInvocation(e,t,i){const s=this.a.get(e);if(!s)throw new Error(`Unknown tool ${e}`);const r={input:t.parameters,chatRequestId:t.chatRequestId,chatSessionId:t.chatSessionId,chatSessionResource:t.chatSessionResource,chatInteractionId:t.chatInteractionId,forceConfirmationReason:t.forceConfirmationReason};if(t.forceConfirmationReason&&T(s.extension,"chatParticipantPrivate"),s.tool.prepareInvocation){const n=await s.tool.prepareInvocation(r,i);return n?((n.pastTenseMessage||n.presentation)&&T(s.extension,"chatParticipantPrivate"),{confirmationMessages:n.confirmationMessages?{title:typeof n.confirmationMessages.title=="string"?n.confirmationMessages.title:le.from(n.confirmationMessages.title),message:typeof n.confirmationMessages.message=="string"?n.confirmationMessages.message:le.from(n.confirmationMessages.message)}:void 0,invocationMessage:le.fromStrict(n.invocationMessage),pastTenseMessage:le.fromStrict(n.pastTenseMessage),presentation:n.presentation}):void 0}}registerTool(e,t,i){return this.a.set(t,{extension:e,tool:i}),this.b.$registerTool(t,typeof i.handleToolStream=="function"),se(()=>{this.a.delete(t),this.b.$unregisterTool(t)})}registerToolDefinition(e,t,i){T(e,"languageModelToolSupportsModel");const s=t.name,r={id:s,displayName:t.displayName,toolReferenceName:t.toolReferenceName,userDescription:t.userDescription,modelDescription:t.description,inputSchema:t.inputSchema,source:{type:"extension",label:e.displayName??e.name,extensionId:e.identifier},icon:un.from(t.icon),models:t.models,toolSet:t.toolSet};return this.a.set(s,{extension:e,tool:i}),this.b.$registerToolWithDefinition(e.identifier,r,typeof i.handleToolStream=="function"),se(()=>{this.a.delete(s),this.b.$unregisterTool(s)})}},HQ=class{constructor(e,t,i,s){this.c=t,this.d=i,this.e=s,this.b=[],this.f=0,this.g=new Set,this.a=e.getProxy(Q.MainThreadLanguages)}$acceptLanguageIds(e){this.b=e}async getLanguages(){return this.b.slice(0)}async changeLanguage(e,t){await this.a.$changeLanguage(e,t);const i=this.c.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,s=et.from(t),r=await this.a.$tokensAtPosition(e.uri,s),n={type:mo.Other,range:e.getWordRangeAtPosition(t)??new ke(t.line,t.character,t.line,t.character)};if(!r)return n;const o={range:U.to(r.range),type:cy.to(r.type)};return!o.range.contains(t)||i!==e.version?n:o}createLanguageStatusItem(e,t,i){const s=this.f++,r=this.a,n=this.g,o=`${e.identifier.value}/${t}`;if(n.has(o))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);n.add(o);const a={selector:i,id:t,name:e.displayName??e.name,severity:jc.Information,command:void 0,text:"",detail:"",busy:!1};let c;const l=new X,u=()=>{if(c?.dispose(),!n.has(o)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=s0(()=>{l.clear(),this.a.$setLanguageStatus(s,{id:o,name:a.name??e.displayName??e.name,source:e.displayName??e.name,selector:$a.from(a.selector,this.e),label:a.text,detail:a.detail??"",severity:a.severity===jc.Error?rt.Error:a.severity===jc.Warning?rt.Warning:rt.Info,command:a.command&&this.d.toInternal(a.command,l),accessibilityInfo:a.accessibilityInformation,busy:a.busy})},0)},h={dispose(){l.dispose(),c?.dispose(),r.$removeLanguageStatus(s),n.delete(o)},get id(){return a.id},get name(){return a.name},set name(f){a.name=f,u()},get selector(){return a.selector},set selector(f){a.selector=f,u()},get text(){return a.text},set text(f){a.text=f,u()},set text2(f){T(e,"languageStatusText"),a.text=f,u()},get text2(){return T(e,"languageStatusText"),a.text},get detail(){return a.detail},set detail(f){a.detail=f,u()},get severity(){return a.severity},set severity(f){a.severity=f,u()},get accessibilityInformation(){return a.accessibilityInformation},set accessibilityInformation(f){a.accessibilityInformation=f,u()},get command(){return a.command},set command(f){a.command=f,u()},get busy(){return a.busy},set busy(f){a.busy=f,u()}};return u(),h}};function WQ(e){return e&&e.title}var US=class{constructor(t,i){this.b=i,this.a=t.getProxy(Q.MainThreadMessageService)}showMessage(t,i,s,r,n){const o={source:{identifier:t.identifier,label:t.displayName||t.name}};let a;typeof r=="string"||WQ(r)?a=[r,...n]:(o.modal=r?.modal,o.useCustom=r?.useCustom,o.detail=r?.detail,a=n),o.useCustom&&T(t,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const h=a[u];if(typeof h=="string")c.push({title:h,handle:u,isCloseAffordance:!1});else if(typeof h=="object"){const{title:f,isCloseAffordance:p}=h;c.push({title:f,isCloseAffordance:!!p,handle:u}),p&&(l?this.b.warn(`[${t.identifier}] Only one message item can have 'isCloseAffordance':`,h):l=!0)}else this.b.warn(`[${t.identifier}] Invalid message item:`,h)}return this.a.$showMessage(i,s,o,c).then(u=>{if(typeof u=="number")return a[u]})}};US=__decorate([__param(1,xe)],US);var zS=class{constructor(e,t,i,s){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=s}asApiEvent(){return{range:new $r(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}},HS=class{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1,encoding:"utf8"}}constructor(e,t,i){this.notebook=e,this.h=t,this.j=i,this.handle=i.handle,this.uri=y.revive(i.uri),this.cellKind=i.cellKind,this.a=i.outputs.map(bo.to),this.e=i.internalMetadata??{},this.b=Object.freeze(i.metadata??{}),this.d=Object.freeze(gl.to(i.internalMetadata??{}))}get internalMetadata(){return this.e}get apiCell(){if(!this.f){const e=this,t=this.h.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Lh.to(this.j.cellKind),document:t.document,get mime(){return e.g},set mime(s){e.g=s},get outputs(){return e.a.slice(0)},get metadata(){return e.b},get executionSummary(){return e.d}};this.f=Object.freeze(i)}return this.f}setOutputs(e){this.a=e.map(bo.to)}setOutputItems(e,t,i){const s=i.map(vl.to),r=this.a.find(n=>n.id===e);if(r&&(t||(r.items.length=0),r.items.push(...s),r.items.length>1&&r.items.every(n=>S$(n.mime)))){const n=new Map,o=[];r.items.forEach(a=>{let c;n.has(a.mime)?c=n.get(a.mime):(c=[],n.set(a.mime,c),o.push(a.mime)),c.push(a.data)}),r.items.length=0,o.forEach(a=>{const c=LW(n.get(a));r.items.push({mime:a,data:c.data.buffer})})}}setMetadata(e){this.b=Object.freeze(e)}setInternalMetadata(e){this.e=e,this.d=Object.freeze(gl.to(e))}setMime(e){}},_Q=class kR{static{this.a=0}constructor(t,i,s,r,n){this.k=t,this.l=i,this.m=s,this.uri=r,this.handle=kR.a++,this.b=[],this.g=0,this.h=!1,this.j=!1,this.d=n.viewType,this.f=Object.freeze(n.metadata??Object.create(null)),this.r([[0,0,n.cells]],!0,void 0),this.g=n.versionId}dispose(){this.j=!0}get versionId(){return this.g}get apiNotebook(){if(!this.e){const t=this,i={get uri(){return t.uri},get version(){return t.g},get notebookType(){return t.d},get isDirty(){return t.h},get isUntitled(){return t.uri.scheme===V.untitled},get isClosed(){return t.j},get metadata(){return t.f},get cellCount(){return t.b.length},cellAt(s){return s=t.n(s),t.b[s].apiCell},getCells(s){return(s?t.p(s):t.b).map(n=>n.apiCell)},save(){return t.q()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this.e=Object.freeze(i)}return this.e}acceptDocumentPropertiesChanged(t){t.metadata&&(this.f=Object.freeze({...this.f,...t.metadata}))}acceptDirty(t){this.h=t}acceptModelChanged(t,i,s){this.g=t.versionId,this.h=i,this.acceptDocumentPropertiesChanged({metadata:s});const r={notebook:this.apiNotebook,metadata:s,cellChanges:[],contentChanges:[]},n=[];for(const a of t.rawEvents)a.kind===Ks.ModelChange?this.r(a.changes,!1,r.contentChanges):a.kind===Ks.Move?this.s(a.index,a.length,a.newIdx,r.contentChanges):a.kind===Ks.Output?(this.t(a.index,a.outputs),n.push({cell:this.b[a.index].apiCell,outputs:this.b[a.index].apiCell.outputs})):a.kind===Ks.OutputItem?(this.u(a.index,a.outputId,a.append,a.outputItems),n.push({cell:this.b[a.index].apiCell,outputs:this.b[a.index].apiCell.outputs})):a.kind===Ks.ChangeCellLanguage?(this.v(a.index,a.language),n.push({cell:this.b[a.index].apiCell,document:this.b[a.index].apiCell.document})):a.kind===Ks.ChangeCellContent?n.push({cell:this.b[a.index].apiCell,document:this.b[a.index].apiCell.document}):a.kind===Ks.ChangeCellMime?this.w(a.index,a.mime):a.kind===Ks.ChangeCellMetadata?(this.x(a.index,a.metadata),n.push({cell:this.b[a.index].apiCell,metadata:this.b[a.index].apiCell.metadata})):a.kind===Ks.ChangeCellInternalMetadata&&(this.y(a.index,a.internalMetadata),n.push({cell:this.b[a.index].apiCell,executionSummary:this.b[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<n.length;a++){const c=n[a],l=o.get(c.cell);if(l===void 0){const u=r.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});o.set(c.cell,u-1)}else r.cellChanges[l]={...r.cellChanges[l],...c}}return Object.freeze(r),Object.freeze(r.cellChanges),Object.freeze(r.contentChanges),r}n(t){return t=t|0,t<0?0:t>=this.b.length?this.b.length-1:t}o(t){let i=t.start|0,s=t.end|0;return i<0&&(i=0),s>this.b.length&&(s=this.b.length),t.with({start:i,end:s})}p(t){t=this.o(t);const i=[];for(let s=t.start;s<t.end;s++)i.push(this.b[s]);return i}async q(){return this.j?Promise.reject(new Error("Notebook has been closed")):this.k.$trySaveNotebook(this.uri)}r(t,i,s){if(this.j)return;const r=[],n=[],o=[];if(t.reverse().forEach(a=>{const l=a[2].map(f=>{const p=new HS(this,this.l,f);return i||n.push(HS.asModelAddData(f)),p}),u=new zS(a[0],a[1],[],l),h=this.b.splice(a[0],a[1],...l);for(const f of h)o.push(f.uri),u.deletedItems.push(f.apiCell);r.push(u)}),this.l.acceptDocumentsAndEditorsDelta({addedDocuments:n,removedDocuments:o}),s)for(const a of r)s.push(a.asApiEvent())}s(t,i,s,r){const n=this.b.splice(t,i);this.b.splice(s,0,...n);const o=[new zS(t,i,n.map(a=>a.apiCell),[]),new zS(s,0,[],n)];for(const a of o)r.push(a.asApiEvent())}t(t,i){this.b[t].setOutputs(i)}u(t,i,s,r){this.b[t].setOutputItems(i,s,r)}v(t,i){const s=this.b[t];s.apiCell.document.languageId!==i&&this.m.$acceptModelLanguageChanged(s.uri,i)}w(t,i){const s=this.b[t];s.apiCell.mime=i}x(t,i){this.b[t].setMetadata(i)}y(t,i){this.b[t].setInternalMetadata(i)}getCellFromApiCell(t){return this.b.find(i=>i.apiCell===t)}getCellFromIndex(t){return this.b[t]}getCell(t){return this.b.find(i=>i.handle===t)}getCellIndex(t){return this.b.indexOf(t)}},WS=class $R{static{this.apiEditorsToExtHost=new WeakMap}constructor(t,i,s,r,n,o,a){this.id=t,this.c=i,this.notebookData=s,this.d=r,this.e=n,this.f=o,this.g=a,this.a=!1}get apiEditor(){if(!this.b){const t=this;this.b={get notebook(){return t.notebookData.apiNotebook},get selection(){return t.e[0]},set selection(i){this.selections=[i]},get selections(){return t.e},set selections(i){if(!Array.isArray(i)||!i.every($r.isNotebookRange))throw Me("selections");t.e=i.length===0?[new $r(0,0)]:i,t.h(t.e)},get visibleRanges(){return t.d},revealRange(i,s){t.c.$tryRevealRange(t.id,Rr.from(i),s??rg.Default)},get viewColumn(){return t.f},get replOptions(){if(t.g==="repl")return{appendIndex:this.notebook.cellCount-1}},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}},$R.apiEditorsToExtHost.set(this.b,this)}return this.b}get visible(){return this.a}_acceptVisibility(t){this.a=t}_acceptVisibleRanges(t){this.d=t}_acceptSelections(t){this.e=t}h(t){this.c.$trySetSelections(this.id,t.map(Rr.from))}_acceptViewColumn(t){this.f=t}},_S=class{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==ue)return BS(this.right);let e=this;for(;e.parent!==ue&&e.parent.left!==e;)e=e.parent;return e.parent===ue?ue:e.parent}prev(){if(this.left!==ue)return nM(this.left);let e=this;for(;e.parent!==ue&&e.parent.right!==e;)e=e.parent;return e.parent===ue?ue:e.parent}detach(){this.parent=null,this.left=null,this.right=null}},rM;(function(e){e[e.Black=0]="Black",e[e.Red=1]="Red"})(rM||(rM={}));var ue=new _S(null,0);ue.parent=ue,ue.left=ue,ue.right=ue,ue.color=0;function BS(e){for(;e.left!==ue;)e=e.left;return e}function nM(e){for(;e.right!==ue;)e=e.right;return e}function qS(e){return e===ue?0:e.size_left+e.piece.length+qS(e.right)}function VS(e){return e===ue?0:e.lf_left+e.piece.lineFeedCnt+VS(e.right)}function GS(){ue.parent=ue}function xd(e,t){const i=t.right;i.size_left+=t.size_left+(t.piece?t.piece.length:0),i.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=i.left,i.left!==ue&&(i.left.parent=t),i.parent=t.parent,t.parent===ue?e.root=i:t.parent.left===t?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i}function Cd(e,t){const i=t.left;t.left=i.right,i.right!==ue&&(i.right.parent=t),i.parent=t.parent,t.size_left-=i.size_left+(i.piece?i.piece.length:0),t.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0),t.parent===ue?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i}function Hv(e,t){let i,s;if(t.left===ue?(s=t,i=s.right):t.right===ue?(s=t,i=s.left):(s=BS(t.right),i=s.right),s===e.root){e.root=i,i.color=0,t.detach(),GS(),e.root.parent=ue;return}const r=s.color===1;if(s===s.parent.left?s.parent.left=i:s.parent.right=i,s===t?(i.parent=s.parent,kd(e,i)):(s.parent===t?i.parent=s:i.parent=s.parent,kd(e,i),s.left=t.left,s.right=t.right,s.parent=t.parent,s.color=t.color,t===e.root?e.root=s:t===t.parent.left?t.parent.left=s:t.parent.right=s,s.left!==ue&&(s.left.parent=s),s.right!==ue&&(s.right.parent=s),s.size_left=t.size_left,s.lf_left=t.lf_left,kd(e,s)),t.detach(),i.parent.left===i){const o=qS(i),a=VS(i);if(o!==i.parent.size_left||a!==i.parent.lf_left){const c=o-i.parent.size_left,l=a-i.parent.lf_left;i.parent.size_left=o,i.parent.lf_left=a,vn(e,i.parent,c,l)}}if(kd(e,i.parent),r){GS();return}let n;for(;i!==e.root&&i.color===0;)i===i.parent.left?(n=i.parent.right,n.color===1&&(n.color=0,i.parent.color=1,xd(e,i.parent),n=i.parent.right),n.left.color===0&&n.right.color===0?(n.color=1,i=i.parent):(n.right.color===0&&(n.left.color=0,n.color=1,Cd(e,n),n=i.parent.right),n.color=i.parent.color,i.parent.color=0,n.right.color=0,xd(e,i.parent),i=e.root)):(n=i.parent.left,n.color===1&&(n.color=0,i.parent.color=1,Cd(e,i.parent),n=i.parent.left),n.left.color===0&&n.right.color===0?(n.color=1,i=i.parent):(n.left.color===0&&(n.right.color=0,n.color=1,xd(e,n),n=i.parent.left),n.color=i.parent.color,i.parent.color=0,n.left.color=0,Cd(e,i.parent),i=e.root));i.color=0,GS()}function oM(e,t){for(kd(e,t);t!==e.root&&t.parent.color===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,xd(e,t)),t.parent.color=0,t.parent.parent.color=1,Cd(e,t.parent.parent))}else{const i=t.parent.parent.left;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,Cd(e,t)),t.parent.color=0,t.parent.parent.color=1,xd(e,t.parent.parent))}e.root.color=0}function vn(e,t,i,s){for(;t!==e.root&&t!==ue;)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=s),t=t.parent}function kd(e,t){let i=0,s=0;if(t!==e.root){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t!==e.root)for(t=t.parent,i=qS(t.left)-t.size_left,s=VS(t.left)-t.lf_left,t.size_left+=i,t.lf_left+=s;t!==e.root&&(i!==0||s!==0);)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=s),t=t.parent}}var wn=65535;function aM(e){let t;return e[e.length-1]<65536?t=new Uint16Array(e.length):t=new Uint32Array(e.length),t.set(e,0),t}var BQ=class{constructor(e,t,i,s,r){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=s,this.isBasicASCII=r}};function bn(e,t=!0){const i=[0];let s=1;for(let r=0,n=e.length;r<n;r++){const o=e.charCodeAt(r);o===13?r+1<n&&e.charCodeAt(r+1)===10?(i[s++]=r+2,r++):i[s++]=r+1:o===10&&(i[s++]=r+1)}return t?aM(i):i}function qQ(e,t){e.length=0,e[0]=0;let i=1,s=0,r=0,n=0,o=!0;for(let c=0,l=t.length;c<l;c++){const u=t.charCodeAt(c);u===13?c+1<l&&t.charCodeAt(c+1)===10?(n++,e[i++]=c+2,c++):(s++,e[i++]=c+1):u===10?(r++,e[i++]=c+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new BQ(aM(e),s,r,n,o);return e.length=0,a}var Gi=class{constructor(e,t,i,s,r){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=s,this.length=r}},Ba=class{constructor(e,t){this.buffer=e,this.lineStarts=t}},VQ=class{constructor(e,t){this.a=[],this.c=e,this.d=t,this.b=0,e.root!==ue&&e.iterate(e.root,i=>(i!==ue&&this.a.push(i.piece),!0))}read(){return this.a.length===0?this.b===0?(this.b++,this.d):null:this.b>this.a.length-1?null:this.b===0?this.d+this.c.getPieceContent(this.a[this.b++]):this.c.getPieceContent(this.a[this.b++])}},GQ=class{constructor(e){this.a=e,this.b=[]}get(e){for(let t=this.b.length-1;t>=0;t--){const i=this.b[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this.b.length-1;t>=0;t--){const i=this.b[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this.b.length>=this.a&&this.b.shift(),this.b.push(e)}validate(e){let t=!1;const i=this.b;for(let s=0;s<i.length;s++){const r=i[s];if(r.node.parent===null||r.nodeStartOffset>=e){i[s]=null,t=!0;continue}}if(t){const s=[];for(const r of i)r!==null&&s.push(r);this.b=s}}},JQ=class{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this.a=[new Ba("",[0])],this.g={line:0,column:0},this.root=ue,this.b=1,this.c=0,this.d=t,this.e=t.length,this.f=i;let s=null;for(let r=0,n=e.length;r<n;r++)if(e[r].buffer.length>0){e[r].lineStarts||(e[r].lineStarts=bn(e[r].buffer));const o=new Gi(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this.a.push(e[r]),s=this.S(s,o)}this.h=new GQ(1),this.j={lineNumber:0,value:""},this.y()}normalizeEOL(e){const t=wn,i=t-Math.floor(t/3),s=i*2;let r="",n=0;const o=[];if(this.iterate(this.root,a=>{const c=this.R(a),l=c.length;if(n<=i||n+l<s)return r+=c,n+=l,!0;const u=r.replace(/\r\n|\r|\n/g,e);return o.push(new Ba(u,bn(u))),r=c,n=l,!0}),n>0){const a=r.replace(/\r\n|\r|\n/g,e);o.push(new Ba(a,bn(a)))}this.create(o,e,!0)}getEOL(){return this.d}setEOL(e){this.d=e,this.e=this.d.length,this.normalizeEOL(e)}createSnapshot(e){return new VQ(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,s=>{if(s===ue)return!0;const r=this.R(s),n=r.length,o=e.G(t),a=e.G(t+n),c=e.getValueInRange2(o,a);return t+=n,r===c})}getOffsetAt(e,t){let i=0,s=this.root;for(;s!==ue;)if(s.left!==ue&&s.lf_left+1>=e)s=s.left;else if(s.lf_left+s.piece.lineFeedCnt+1>=e){i+=s.size_left;const r=this.B(s,e-s.lf_left-2);return i+=r+t-1}else e-=s.lf_left+s.piece.lineFeedCnt,i+=s.size_left+s.piece.length,s=s.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const s=e;for(;t!==ue;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const r=this.A(t,e-t.size_left);if(i+=t.lf_left+r.index,r.index===0){const n=this.getOffsetAt(i+1,1),o=s-n;return new ws(i+1,o+1)}return new ws(i+1,r.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===ue){const r=this.getOffsetAt(i+1,1),n=s-e-r;return new ws(i+1,n+1)}else t=t.right;return new ws(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.H(e.startLineNumber,e.startColumn),s=this.H(e.endLineNumber,e.endColumn),r=this.getValueInRange2(i,s);return t?t!==this.d||!this.f?r.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this.f?r:r.replace(/\r\n|\r|\n/g,t):r}getValueInRange2(e,t){if(e.node===t.node){const o=e.node,a=this.a[o.piece.bufferIndex].buffer,c=this.u(o.piece.bufferIndex,o.piece.start);return a.substring(c+e.remainder,c+t.remainder)}let i=e.node;const s=this.a[i.piece.bufferIndex].buffer,r=this.u(i.piece.bufferIndex,i.piece.start);let n=s.substring(r+e.remainder,r+i.piece.length);for(i=i.next();i!==ue;){const o=this.a[i.piece.bufferIndex].buffer,a=this.u(i.piece.bufferIndex,i.piece.start);if(i===t.node){n+=o.substring(a,a+t.remainder);break}else n+=o.substr(a,i.piece.length);i=i.next()}return n}getLinesContent(){const e=[];let t=0,i="",s=!1;return this.iterate(this.root,r=>{if(r===ue)return!0;const n=r.piece;let o=n.length;if(o===0)return!0;const a=this.a[n.bufferIndex].buffer,c=this.a[n.bufferIndex].lineStarts,l=n.start.line,u=n.end.line;let h=c[l]+n.start.column;if(s&&(a.charCodeAt(h)===10&&(h++,o--),e[t++]=i,i="",s=!1,o===0))return!0;if(l===u)return!this.f&&a.charCodeAt(h+o-1)===13?(s=!0,i+=a.substr(h,o-1)):i+=a.substr(h,o),!0;i+=this.f?a.substring(h,Math.max(h,c[l+1]-this.e)):a.substring(h,c[l+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=l+1;f<u;f++)i=this.f?a.substring(c[f],c[f+1]-this.e):a.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this.f&&a.charCodeAt(c[u]+n.end.column-1)===13?(s=!0,n.end.column===0?t--:i=a.substr(c[u],n.end.column-1)):i=a.substr(c[u],n.end.column),!0}),s&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this.c}getLineCount(){return this.b}getLineContent(e){return this.j.lineNumber===e?this.j.value:(this.j.lineNumber=e,e===this.b?this.j.value=this.getLineRawContent(e):this.f?this.j.value=this.getLineRawContent(e,this.e):this.j.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this.j.value)}l(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this.a[t.piece.bufferIndex],s=this.u(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(s)}else{const t=this.a[e.node.piece.bufferIndex],s=this.u(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(s)}}getLineCharCode(e,t){const i=this.H(e,t+1);return this.l(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this.e}getCharCode(e){const t=this.G(e);return this.l(t)}getNearestChunk(e){const t=this.G(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===ue)return"";const s=this.a[i.piece.bufferIndex],r=this.u(i.piece.bufferIndex,i.piece.start);return s.buffer.substring(r,r+i.piece.length)}else{const i=this.a[t.node.piece.bufferIndex],s=this.u(t.node.piece.bufferIndex,t.node.piece.start),r=s+t.remainder,n=s+t.node.piece.length;return i.buffer.substring(r,n)}}findMatchesInNode(e,t,i,s,r,n,o,a,c,l,u){const h=this.a[e.piece.bufferIndex],f=this.u(e.piece.bufferIndex,e.piece.start),p=this.u(e.piece.bufferIndex,r),g=this.u(e.piece.bufferIndex,n);let v;const b={line:0,column:0};let S,E;t._wordSeparators?(S=h.buffer.substring(p,g),E=k=>k+p,t.reset(0)):(S=h.buffer,E=k=>k,t.reset(p));do if(v=t.next(S),v){if(E(v.index)>=g)return l;this.s(e,E(v.index)-f,b);const k=this.t(e.piece.bufferIndex,r,b),O=b.line===r.line?b.column-r.column+s:b.column+1,F=O+v[0].length;if(u[l++]=L8(new ot(i+k,O,i+k,F),v,a),E(v.index)+v[0].length>=g||l>=c)return l}while(v);return l}findMatchesLineByLine(e,t,i,s){const r=[];let n=0;const o=new Bq(t.wordSeparators,t.regex);let a=this.H(e.startLineNumber,e.startColumn);if(a===null)return[];const c=this.H(e.endLineNumber,e.endColumn);if(c===null)return[];let l=this.s(a.node,a.remainder);const u=this.s(c.node,c.remainder);if(a.node===c.node)return this.findMatchesInNode(a.node,o,e.startLineNumber,e.startColumn,l,u,t,i,s,n,r),r;let h=e.startLineNumber,f=a.node;for(;f!==c.node;){const g=this.t(f.piece.bufferIndex,l,f.piece.end);if(g>=1){const b=this.a[f.piece.bufferIndex].lineStarts,S=this.u(f.piece.bufferIndex,f.piece.start),E=b[l.line+g],k=h===e.startLineNumber?e.startColumn:1;if(n=this.findMatchesInNode(f,o,h,k,l,this.s(f,E-S),t,i,s,n,r),n>=s)return r;h+=g}const v=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const b=this.getLineContent(h).substring(v,e.endColumn-1);return n=this.n(t,o,b,e.endLineNumber,v,n,r,i,s),r}if(n=this.n(t,o,this.getLineContent(h).substr(v),h,v,n,r,i,s),n>=s)return r;h++,a=this.H(h,1),f=a.node,l=this.s(a.node,a.remainder)}if(h===e.endLineNumber){const g=h===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(h).substring(g,e.endColumn-1);return n=this.n(t,o,v,e.endLineNumber,g,n,r,i,s),r}const p=h===e.startLineNumber?e.startColumn:1;return n=this.findMatchesInNode(c.node,o,h,p,l,u,t,i,s,n,r),r}n(e,t,i,s,r,n,o,a,c){const l=e.wordSeparators;if(!a&&e.simpleSearch){const h=e.simpleSearch,f=h.length,p=i.length;let g=-f;for(;(g=i.indexOf(h,g+f))!==-1;)if((!l||O8(l,i,p,g,f))&&(o[n++]=new qA(new ot(s,g+1+r,s,g+1+f+r),null),n>=c))return n;return n}let u;t.reset(0);do if(u=t.next(i),u&&(o[n++]=L8(new ot(s,u.index+1+r,s,u.index+1+u[0].length+r),u,a),n>=c))return n;while(u);return n}insert(e,t,i=!1){if(this.f=this.f&&i,this.j.lineNumber=0,this.j.value="",this.root!==ue){const{node:s,remainder:r,nodeStartOffset:n}=this.G(e),o=s.piece,a=o.bufferIndex,c=this.s(s,r);if(s.piece.bufferIndex===0&&o.end.line===this.g.line&&o.end.column===this.g.column&&n+o.length===e&&t.length<wn){this.F(s,t),this.y();return}if(n===e)this.o(t,s),this.h.validate(e);else if(n+s.piece.length>e){const l=[];let u=new Gi(o.bufferIndex,c,o.end,this.t(o.bufferIndex,c,o.end),this.u(a,o.end)-this.u(a,c));if(this.K()&&this.M(t)&&this.I(s,r)===10){const g={line:u.start.line+1,column:0};u=new Gi(u.bufferIndex,g,u.end,this.t(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.K()&&this.L(t))if(this.I(s,r-1)===13){const g=this.s(s,r-1);this.C(s,g),t="\r"+t,s.piece.length===0&&l.push(s)}else this.C(s,c);else this.C(s,c);const h=this.w(t);u.length>0&&this.S(s,u);let f=s;for(let p=0;p<h.length;p++)f=this.S(f,h[p]);this.v(l)}else this.q(t,s)}else{const s=this.w(t);let r=this.T(null,s[0]);for(let n=1;n<s.length;n++)r=this.S(r,s[n])}this.y()}delete(e,t){if(this.j.lineNumber=0,this.j.value="",t<=0||this.root===ue)return;const i=this.G(e),s=this.G(e+t),r=i.node,n=s.node;if(r===n){const h=this.s(r,i.remainder),f=this.s(r,s.remainder);if(i.nodeStartOffset===e){if(t===r.piece.length){const p=r.next();Hv(this,r),this.N(p),this.y();return}this.D(r,f),this.h.validate(e),this.N(r),this.y();return}if(i.nodeStartOffset+r.piece.length===e+t){this.C(r,h),this.O(r),this.y();return}this.E(r,h,f),this.y();return}const o=[],a=this.s(r,i.remainder);this.C(r,a),this.h.validate(e),r.piece.length===0&&o.push(r);const c=this.s(n,s.remainder);this.D(n,c),n.piece.length===0&&o.push(n);const l=r.next();for(let h=l;h!==ue&&h!==n;h=h.next())o.push(h);const u=r.piece.length===0?r.prev():r;this.v(o),this.O(u),this.y()}o(e,t){const i=[];if(this.K()&&this.M(e)&&this.L(t)){const n=t.piece,o={line:n.start.line+1,column:0},a=new Gi(n.bufferIndex,o,n.end,this.t(n.bufferIndex,o,n.end),n.length-1);t.piece=a,e+=`
`,vn(this,t,-1,-1),t.piece.length===0&&i.push(t)}const s=this.w(e);let r=this.T(t,s[s.length-1]);for(let n=s.length-2;n>=0;n--)r=this.T(r,s[n]);this.N(r),this.v(i)}q(e,t){this.Q(e,t)&&(e+=`
`);const i=this.w(e),s=this.S(t,i[0]);let r=s;for(let n=1;n<i.length;n++)r=this.S(r,i[n]);this.N(s)}s(e,t,i){const s=e.piece,r=e.piece.bufferIndex,n=this.a[r].lineStarts,a=n[s.start.line]+s.start.column+t;let c=s.start.line,l=s.end.line,u=0,h=0,f=0;for(;c<=l&&(u=c+(l-c)/2|0,f=n[u],u!==l);)if(h=n[u+1],a<f)l=u-1;else if(a>=h)c=u+1;else break;return i?(i.line=u,i.column=a-f,null):{line:u,column:a-f}}t(e,t,i){if(i.column===0)return i.line-t.line;const s=this.a[e].lineStarts;if(i.line===s.length-1)return i.line-t.line;const r=s[i.line+1],n=s[i.line]+i.column;if(r>n+1)return i.line-t.line;const o=n-1;return this.a[e].buffer.charCodeAt(o)===13?i.line-t.line+1:i.line-t.line}u(e,t){return this.a[e].lineStarts[t.line]+t.column}v(e){for(let t=0;t<e.length;t++)Hv(this,e[t])}w(e){if(e.length>wn){const l=[];for(;e.length>wn;){const h=e.charCodeAt(wn-1);let f;h===13||h>=55296&&h<=56319?(f=e.substring(0,wn-1),e=e.substring(wn-1)):(f=e.substring(0,wn),e=e.substring(wn));const p=bn(f);l.push(new Gi(this.a.length,{line:0,column:0},{line:p.length-1,column:f.length-p[p.length-1]},p.length-1,f.length)),this.a.push(new Ba(f,p))}const u=bn(e);return l.push(new Gi(this.a.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this.a.push(new Ba(e,u)),l}let t=this.a[0].buffer.length;const i=bn(e,!1);let s=this.g;if(this.a[0].lineStarts[this.a[0].lineStarts.length-1]===t&&t!==0&&this.L(e)&&this.M(this.a[0].buffer)){this.g={line:this.g.line,column:this.g.column+1},s=this.g;for(let l=0;l<i.length;l++)i[l]+=t+1;this.a[0].lineStarts=this.a[0].lineStarts.concat(i.slice(1)),this.a[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let l=0;l<i.length;l++)i[l]+=t;this.a[0].lineStarts=this.a[0].lineStarts.concat(i.slice(1)),this.a[0].buffer+=e}const r=this.a[0].buffer.length,n=this.a[0].lineStarts.length-1,o=r-this.a[0].lineStarts[n],a={line:n,column:o},c=new Gi(0,s,a,this.t(0,s,a),r-t);return this.g=a,[c]}getLinesRawContent(){return this.U(this.root)}getLineRawContent(e,t=0){let i=this.root,s="";const r=this.h.get2(e);if(r){i=r.node;const n=this.B(i,e-r.nodeStartLineNumber-1),o=this.a[i.piece.bufferIndex].buffer,a=this.u(i.piece.bufferIndex,i.piece.start);if(r.nodeStartLineNumber+i.piece.lineFeedCnt===e)s=o.substring(a+n,a+i.piece.length);else{const c=this.B(i,e-r.nodeStartLineNumber);return o.substring(a+n,a+c-t)}}else{let n=0;const o=e;for(;i!==ue;)if(i.left!==ue&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const a=this.B(i,e-i.lf_left-2),c=this.B(i,e-i.lf_left-1),l=this.a[i.piece.bufferIndex].buffer,u=this.u(i.piece.bufferIndex,i.piece.start);return n+=i.size_left,this.h.set({node:i,nodeStartOffset:n,nodeStartLineNumber:o-(e-1-i.lf_left)}),l.substring(u+a,u+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const a=this.B(i,e-i.lf_left-2),c=this.a[i.piece.bufferIndex].buffer,l=this.u(i.piece.bufferIndex,i.piece.start);s=c.substring(l+a,l+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==ue;){const n=this.a[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const o=this.B(i,0),a=this.u(i.piece.bufferIndex,i.piece.start);return s+=n.substring(a,a+o-t),s}else{const o=this.u(i.piece.bufferIndex,i.piece.start);s+=n.substr(o,i.piece.length)}i=i.next()}return s}y(){let e=this.root,t=1,i=0;for(;e!==ue;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this.b=t,this.c=i,this.h.validate(this.c)}A(e,t){const i=e.piece,s=this.s(e,t),r=s.line-i.start.line;if(this.u(i.bufferIndex,i.end)-this.u(i.bufferIndex,i.start)===t){const n=this.t(e.piece.bufferIndex,i.start,s);if(n!==r)return{index:n,remainder:0}}return{index:r,remainder:s.column}}B(e,t){if(t<0)return 0;const i=e.piece,s=this.a[i.bufferIndex].lineStarts,r=i.start.line+t+1;return r>i.end.line?s[i.end.line]+i.end.column-s[i.start.line]-i.start.column:s[r]-s[i.start.line]-i.start.column}C(e,t){const i=e.piece,s=i.lineFeedCnt,r=this.u(i.bufferIndex,i.end),n=t,o=this.u(i.bufferIndex,n),a=this.t(i.bufferIndex,i.start,n),c=a-s,l=o-r,u=i.length+l;e.piece=new Gi(i.bufferIndex,i.start,n,a,u),vn(this,e,l,c)}D(e,t){const i=e.piece,s=i.lineFeedCnt,r=this.u(i.bufferIndex,i.start),n=t,o=this.t(i.bufferIndex,n,i.end),a=this.u(i.bufferIndex,n),c=o-s,l=r-a,u=i.length+l;e.piece=new Gi(i.bufferIndex,n,i.end,o,u),vn(this,e,l,c)}E(e,t,i){const s=e.piece,r=s.start,n=s.end,o=s.length,a=s.lineFeedCnt,c=t,l=this.t(s.bufferIndex,s.start,c),u=this.u(s.bufferIndex,t)-this.u(s.bufferIndex,r);e.piece=new Gi(s.bufferIndex,s.start,c,l,u),vn(this,e,u-o,l-a);const h=new Gi(s.bufferIndex,i,n,this.t(s.bufferIndex,i,n),this.u(s.bufferIndex,n)-this.u(s.bufferIndex,i)),f=this.S(e,h);this.N(f)}F(e,t){this.Q(t,e)&&(t+=`
`);const i=this.K()&&this.L(t)&&this.M(e),s=this.a[0].buffer.length;this.a[0].buffer+=t;const r=bn(t,!1);for(let f=0;f<r.length;f++)r[f]+=s;if(i){const f=this.a[0].lineStarts[this.a[0].lineStarts.length-2];this.a[0].lineStarts.pop(),this.g={line:this.g.line-1,column:s-f}}this.a[0].lineStarts=this.a[0].lineStarts.concat(r.slice(1));const n=this.a[0].lineStarts.length-1,o=this.a[0].buffer.length-this.a[0].lineStarts[n],a={line:n,column:o},c=e.piece.length+t.length,l=e.piece.lineFeedCnt,u=this.t(0,e.piece.start,a),h=u-l;e.piece=new Gi(e.piece.bufferIndex,e.piece.start,a,u,c),this.g=a,vn(this,e,t.length,h)}G(e){let t=this.root;const i=this.h.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let s=0;for(;t!==ue;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){s+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:s};return this.h.set(r),r}else e-=t.size_left+t.piece.length,s+=t.size_left+t.piece.length,t=t.right;return null}H(e,t){let i=this.root,s=0;for(;i!==ue;)if(i.left!==ue&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const r=this.B(i,e-i.lf_left-2),n=this.B(i,e-i.lf_left-1);return s+=i.size_left,{node:i,remainder:Math.min(r+t-1,n),nodeStartOffset:s}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const r=this.B(i,e-i.lf_left-2);if(r+t-1<=i.piece.length)return{node:i,remainder:r+t-1,nodeStartOffset:s};t-=i.piece.length-r;break}else e-=i.lf_left+i.piece.lineFeedCnt,s+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==ue;){if(i.piece.lineFeedCnt>0){const r=this.B(i,0),n=this.J(i);return{node:i,remainder:Math.min(t-1,r),nodeStartOffset:n}}else if(i.piece.length>=t-1){const r=this.J(i);return{node:i,remainder:t-1,nodeStartOffset:r}}else t-=i.piece.length;i=i.next()}return null}I(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this.a[e.piece.bufferIndex],s=this.u(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(s)}J(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}K(){return!(this.f&&this.d===`
`)}L(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===ue||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this.a[t.bufferIndex].lineStarts,s=t.start.line,r=i[s]+t.start.column;return s===i.length-1||i[s+1]>r+1?!1:this.a[t.bufferIndex].buffer.charCodeAt(r)===10}M(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===ue||e.piece.lineFeedCnt===0?!1:this.I(e,e.piece.length-1)===13}N(e){if(this.K()&&this.L(e)){const t=e.prev();this.M(t)&&this.P(t,e)}}O(e){if(this.K()&&this.M(e)){const t=e.next();this.L(t)&&this.P(e,t)}}P(e,t){const i=[],s=this.a[e.piece.bufferIndex].lineStarts;let r;e.piece.end.column===0?r={line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}:r={line:e.piece.end.line,column:e.piece.end.column-1};const n=e.piece.length-1,o=e.piece.lineFeedCnt-1;e.piece=new Gi(e.piece.bufferIndex,e.piece.start,r,o,n),vn(this,e,-1,-1),e.piece.length===0&&i.push(e);const a={line:t.piece.start.line+1,column:0},c=t.piece.length-1,l=this.t(t.piece.bufferIndex,a,t.piece.end);t.piece=new Gi(t.piece.bufferIndex,a,t.piece.end,l,c),vn(this,t,-1,-1),t.piece.length===0&&i.push(t);const u=this.w(`\r
`);this.S(e,u[0]);for(let h=0;h<i.length;h++)Hv(this,i[h])}Q(e,t){if(this.K()&&this.M(e)){const i=t.next();if(this.L(i)){if(e+=`
`,i.piece.length===1)Hv(this,i);else{const s=i.piece,r={line:s.start.line+1,column:0},n=s.length-1,o=this.t(s.bufferIndex,r,s.end);i.piece=new Gi(s.bufferIndex,r,s.end,o,n),vn(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===ue)return t(ue);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}R(e){if(e===ue)return"";const t=this.a[e.piece.bufferIndex],i=e.piece,s=this.u(i.bufferIndex,i.start),r=this.u(i.bufferIndex,i.end);return t.buffer.substring(s,r)}getPieceContent(e){const t=this.a[e.bufferIndex],i=this.u(e.bufferIndex,e.start),s=this.u(e.bufferIndex,e.end);return t.buffer.substring(i,s)}S(e,t){const i=new _S(t,1);if(i.left=ue,i.right=ue,i.parent=ue,i.size_left=0,i.lf_left=0,this.root===ue)this.root=i,i.color=0;else if(e.right===ue)e.right=i,i.parent=e;else{const r=BS(e.right);r.left=i,i.parent=r}return oM(this,i),i}T(e,t){const i=new _S(t,1);if(i.left=ue,i.right=ue,i.parent=ue,i.size_left=0,i.lf_left=0,this.root===ue)this.root=i,i.color=0;else if(e.left===ue)e.left=i,i.parent=e;else{const s=nM(e.left);s.right=i,i.parent=s}return oM(this,i),i}U(e){let t="";return this.iterate(e,i=>(t+=this.R(i),!0)),t}},cM;(function(e){e[e.Unknown=0]="Unknown",e[e.Invalid=3]="Invalid",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(cM||(cM={}));function JS(e){let t=0,i=0,s=0,r=0;for(let n=0,o=e.length;n<o;n++){const a=e.charCodeAt(n);a===13?(t===0&&(i=n),t++,n+1<o&&e.charCodeAt(n+1)===10?(r|=2,n++):r|=3,s=n+1):a===10&&(r|=1,t===0&&(i=n),t++,s=n+1)}return t===0&&(i=e.length),[t,i,e.length-s,r]}var ZS;function ZQ(){return ZS||(ZS=new TextDecoder("UTF-16LE")),ZS}function YQ(e,t,i){const s=new Uint16Array(e.buffer,t,i);return i>0&&(s[0]===65279||s[0]===65534)?QQ(e,t,i):ZQ().decode(s)}function QQ(e,t,i){const s=[];let r=0;for(let n=0;n<i;n++){const o=JO(e,t);t+=2,s[r++]=String.fromCharCode(o)}return s.join("")}function Wv(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var XQ=class Br{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(t,i,s,r){this.oldPosition=t,this.oldText=i,this.newPosition=s,this.newText=r}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${Wv(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${Wv(this.oldText)}")`:`(replace@${this.oldPosition} "${Wv(this.oldText)}" with "${Wv(this.newText)}")`}static a(t){return 4+2*t.length}static c(t,i,s){const r=i.length;Sf(t,r,s),s+=4;for(let n=0;n<r;n++)ZO(t,i.charCodeAt(n),s),s+=2;return s}static d(t,i){const s=Af(t,i);return i+=4,YQ(t,i,s)}writeSize(){return 8+Br.a(this.oldText)+Br.a(this.newText)}write(t,i){return Sf(t,this.oldPosition,i),i+=4,Sf(t,this.newPosition,i),i+=4,i=Br.c(t,this.oldText,i),i=Br.c(t,this.newText,i),i}static read(t,i,s){const r=Af(t,i);i+=4;const n=Af(t,i);i+=4;const o=Br.d(t,i);i+=Br.a(o);const a=Br.d(t,i);return i+=Br.a(a),s.push(new Br(r,o,n,a)),i}},KQ=class Bd extends J{get onDidChangeContent(){return this.m.event}constructor(t,i,s,r,n,o,a){super(),this.m=this.D(new I),this.f=i,this.j=!o,this.g=r,this.h=n,this.c=new JQ(t,s,a)}equals(t){return!(t instanceof Bd)||this.f!==t.f||this.getEOL()!==t.getEOL()?!1:this.c.equal(t.c)}mightContainRTL(){return this.g}mightContainUnusualLineTerminators(){return this.h}resetMightContainUnusualLineTerminators(){this.h=!1}mightContainNonBasicASCII(){return this.j}getBOM(){return this.f}getEOL(){return this.c.getEOL()}createSnapshot(t){return this.c.createSnapshot(t?this.f:"")}getOffsetAt(t,i){return this.c.getOffsetAt(t,i)}getPositionAt(t){return this.c.getPositionAt(t)}getRangeAt(t,i){const s=t+i,r=this.getPositionAt(t),n=this.getPositionAt(s);return new ot(r.lineNumber,r.column,n.lineNumber,n.column)}getValueInRange(t,i=0){if(t.isEmpty())return"";const s=this.n(i);return this.c.getValueInRange(t,s)}getValueLengthInRange(t,i=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;const s=this.getOffsetAt(t.startLineNumber,t.startColumn),r=this.getOffsetAt(t.endLineNumber,t.endColumn);let n=0;const o=this.n(i),a=this.getEOL();if(o.length!==a.length){const c=o.length-a.length,l=t.endLineNumber-t.startLineNumber;n=c*l}return r-s+n}getCharacterCountInRange(t,i=0){if(this.j){let s=0;const r=t.startLineNumber,n=t.endLineNumber;for(let o=r;o<=n;o++){const a=this.getLineContent(o),c=o===r?t.startColumn-1:0,l=o===n?t.endColumn-1:a.length;for(let u=c;u<l;u++)hf(a.charCodeAt(u))?(s=s+1,u=u+1):s=s+1}return s+=this.n(i).length*(n-r),s}return this.getValueLengthInRange(t,i)}getNearestChunk(t){return this.c.getNearestChunk(t)}getLength(){return this.c.getLength()}getLineCount(){return this.c.getLineCount()}getLinesContent(){return this.c.getLinesContent()}getLineContent(t){return this.c.getLineContent(t)}getLineCharCode(t,i){return this.c.getLineCharCode(t,i)}getCharCode(t){return this.c.getCharCode(t)}getLineLength(t){return this.c.getLineLength(t)}getLineMinColumn(t){return 1}getLineMaxColumn(t){return this.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){const i=q1(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){const i=j2(this.getLineContent(t));return i===-1?0:i+2}n(t){switch(t){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this.c.setEOL(t)}applyEdits(t,i,s){let r=this.g,n=this.h,o=this.j,a=!0,c=[];for(let v=0;v<t.length;v++){const b=t[v];a&&b._isTracked&&(a=!1);const S=b.range;if(b.text){let G=!0;o||(G=!V2(b.text),o=G),!r&&G&&(r=nC(b.text)),!n&&G&&(n=oC(b.text))}let E="",k=0,O=0,F=0;if(b.text){let G;[k,O,F,G]=JS(b.text);const j=this.getEOL();G===0||G===(j===`\r
`?2:1)?E=b.text:E=b.text.replace(/\r\n|\r|\n/g,j)}c[v]={sortIndex:v,identifier:b.identifier||null,range:S,rangeOffset:this.getOffsetAt(S.startLineNumber,S.startColumn),rangeLength:this.getValueLengthInRange(S),text:E,eolCount:k,firstLineLength:O,lastLineLength:F,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}c.sort(Bd.t);let l=!1;for(let v=0,b=c.length-1;v<b;v++){const S=c[v].range.getEndPosition(),E=c[v+1].range.getStartPosition();if(E.isBeforeOrEqual(S)){if(E.isBefore(S))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(c=this.q(c));const u=s||i?Bd._getInverseEditRanges(c):[],h=[];if(i)for(let v=0;v<c.length;v++){const b=c[v],S=u[v];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let E=S.startLineNumber;E<=S.endLineNumber;E++){let k="";E===S.startLineNumber&&(k=this.getLineContent(b.range.startLineNumber),q1(k)!==-1)||h.push({lineNumber:E,oldContent:k})}}let f=null;if(s){let v=0;f=[];for(let b=0;b<c.length;b++){const S=c[b],E=u[b],k=this.getValueInRange(S.range),O=S.rangeOffset+v;v+=S.text.length-k.length,f[b]={sortIndex:S.sortIndex,identifier:S.identifier,range:E,text:k,textChange:new XQ(S.rangeOffset,k,O,S.text)}}l||f.sort((b,S)=>b.sortIndex-S.sortIndex)}this.g=r,this.h=n,this.j=o;const p=this.s(c);let g=null;if(i&&h.length>0){h.sort((v,b)=>b.lineNumber-v.lineNumber),g=[];for(let v=0,b=h.length;v<b;v++){const S=h[v].lineNumber;if(v>0&&h[v-1].lineNumber===S)continue;const E=h[v].oldContent,k=this.getLineContent(S);k.length===0||k===E||q1(k)!==-1||g.push(S)}}return this.m.fire(),new Hq(f,p,g)}q(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let i=!1;const s=t[0].range,r=t[t.length-1].range,n=new ot(s.startLineNumber,s.startColumn,r.endLineNumber,r.endColumn);let o=s.startLineNumber,a=s.startColumn;const c=[];for(let p=0,g=t.length;p<g;p++){const v=t[p],b=v.range;i=i||v.forceMoveMarkers,c.push(this.getValueInRange(new ot(o,a,b.startLineNumber,b.startColumn))),v.text.length>0&&c.push(v.text),o=b.endLineNumber,a=b.endColumn}const l=c.join(""),[u,h,f]=JS(l);return{sortIndex:0,identifier:t[0].identifier,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n,0),text:l,eolCount:u,firstLineLength:h,lastLineLength:f,forceMoveMarkers:i,isAutoWhitespaceEdit:!1}}s(t){t.sort(Bd.u);const i=[];for(let s=0;s<t.length;s++){const r=t[s],n=r.range.startLineNumber,o=r.range.startColumn,a=r.range.endLineNumber,c=r.range.endColumn;if(n===a&&o===c&&r.text.length===0)continue;r.text?(this.c.delete(r.rangeOffset,r.rangeLength),this.c.insert(r.rangeOffset,r.text,!0)):this.c.delete(r.rangeOffset,r.rangeLength);const l=new ot(n,o,a,c);i.push({range:l,rangeLength:r.rangeLength,text:r.text,rangeOffset:r.rangeOffset,forceMoveMarkers:r.forceMoveMarkers})}return i}findMatchesLineByLine(t,i,s,r){return this.c.findMatchesLineByLine(t,i,s,r)}getPieceTree(){return this.c}static _getInverseEditRange(t,i){const s=t.startLineNumber,r=t.startColumn,[n,o,a]=JS(i);let c;if(i.length>0){const l=n+1;l===1?c=new ot(s,r,s,r+o):c=new ot(s,r,s+l-1,a+1)}else c=new ot(s,r,s,r);return c}static _getInverseEditRanges(t){const i=[];let s=0,r=0,n=null;for(let o=0,a=t.length;o<a;o++){const c=t[o];let l,u;n?n.range.endLineNumber===c.range.startLineNumber?(l=s,u=r+(c.range.startColumn-n.range.endColumn)):(l=s+(c.range.startLineNumber-n.range.endLineNumber),u=c.range.startColumn):(l=c.range.startLineNumber,u=c.range.startColumn);let h;if(c.text.length>0){const f=c.eolCount+1;f===1?h=new ot(l,u,l,u+c.firstLineLength):h=new ot(l,u,l+f-1,c.lastLineLength+1)}else h=new ot(l,u,l,u);s=h.endLineNumber,r=h.endColumn,i.push(h),n=c}return i}static t(t,i){const s=ot.compareRangesUsingEnds(t.range,i.range);return s===0?t.sortIndex-i.sortIndex:s}static u(t,i){const s=ot.compareRangesUsingEnds(t.range,i.range);return s===0?i.sortIndex-t.sortIndex:-s}},eX=class{constructor(e,t,i,s,r,n,o,a,c){this.a=e,this.b=t,this.c=i,this.d=s,this.e=r,this.f=n,this.g=o,this.h=a,this.j=c}k(e){const t=this.c+this.d+this.e,i=this.c+this.e;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this.k(e),i=this.a;if(this.j&&(t===`\r
`&&(this.c>0||this.d>0)||t===`
`&&(this.c>0||this.e>0)))for(let r=0,n=i.length;r<n;r++){const o=i[r].buffer.replace(/\r\n|\r|\n/g,t),a=bn(o);i[r]=new Ba(o,a)}const s=new KQ(i,this.b,t,this.f,this.g,this.h,this.j);return{textBuffer:s,disposable:s}}getFirstLineText(e){return this.a[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},lM=class{constructor(){this.a=[],this.b="",this.c=!1,this.d=0,this.e=[],this.f=0,this.g=0,this.h=0,this.j=!1,this.k=!1,this.l=!0}acceptChunk(e){if(e.length===0)return;this.a.length===0&&X2(e)&&(this.b=Q2,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this.m(e.substr(0,e.length-1),!1),this.c=!0,this.d=t):(this.m(e,!1),this.c=!1,this.d=t)}m(e,t){!t&&e.length===0||(this.c?this.n(String.fromCharCode(this.d)+e):this.n(e))}n(e){const t=qQ(this.e,e);this.a.push(new Ba(e,t.lineStarts)),this.f+=t.cr,this.g+=t.lf,this.h+=t.crlf,t.isBasicASCII||(this.l=!1,this.j||(this.j=nC(e)),this.k||(this.k=oC(e)))}finish(e=!0){return this.o(),new eX(this.a,this.b,this.f,this.g,this.h,this.j,this.k,this.l,e)}o(){if(this.a.length===0&&this.m("",!0),this.c){this.c=!1;const e=this.a[this.a.length-1];e.buffer+=String.fromCharCode(this.d);const t=bn(e.buffer);e.lineStarts=t,this.d===13&&this.f++}}},tX=class extends J{constructor(e,t,i){super(),this._source=e,this.b=t,this.c=i,this.a=void 0}f(e){const t=e.getLineCount();return new ot(1,1,t,this.g(e,t))}g(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this.b){const e=new lM;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:s}=t.create(1);this.b=i,this.D(s)}return this.b}get outputTextBuffers(){return this.a||(this.a=this.c.map(e=>{const t=new lM;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:s,disposable:r}=i.create(1);return this.D(r),s})),this.a}findInInputs(e){const i=new N8(e,!1,!1,null).parseSearchRequest();if(!i)return[];const s=this.f(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(s,i,!0,5e3)}findInOutputs(e){const i=new N8(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(s=>{const r=s.findMatchesLineByLine(this.f(s),i,!0,5e3);if(r.length!==0)return{textBuffer:s,matches:r}}).filter(s=>!!s):[]}};function uM(e,t){let i=-1;const s=[];let r=[];return e.forEach(o=>{o.range.startLineNumber!==i&&r.length>0&&(s.push([...r]),r=[]),r.push(o),i=o.range.endLineNumber}),r.length>0&&s.push([...r]),s.map(o=>{const a=[],c=o[0].range.startLineNumber,l=o[o.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(t.getLineContent(u));return new b9(a.join(`
`)+`
`,o.map(u=>new ot(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}var Bue=Object.freeze({id:"application",order:100,title:d(4410,null),type:"object"}),iX=Object.freeze({id:"workbench",order:7,title:d(4411,null),type:"object"}),sX=Object.freeze({id:"security",scope:1,title:d(4412,null),type:"object",order:7}),que=Object.freeze({id:"problems",title:d(4413,null),type:"object",order:101}),rX=Object.freeze({id:"window",order:8,title:d(4414,null),type:"object"}),nX={ConfigurationMigration:"base.contributions.configuration.migration"},oX=class{constructor(){this.migrations=[],this.a=new I,this.onDidRegisterConfigurationMigration=this.a.event}registerConfigurationMigrations(e){this.migrations.push(...e)}},_v=new oX;Qt.add(nX.ConfigurationMigration,_v);var hM=class extends J{static{this.ID="workbench.contrib.configurationMigration"}constructor(t,i){super(),this.a=t,this.b=i,this.D(this.b.onDidChangeWorkspaceFolders(async s=>{for(const r of s.added)await this.f(r,_v.migrations)})),this.c(_v.migrations),this.D(_v.onDidRegisterConfigurationMigration(s=>this.c(s)))}async c(t){await this.f(void 0,t);for(const i of this.b.getWorkspace().folders)await this.f(i,t)}async f(t,i){await Promise.all([i.map(s=>this.g(s,t?.uri))])}async g(t,i){const s=this.a.inspect(t.key,{resource:i}),r=this.b.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[n,o]of r){const a=s[n];if(!a)continue;const c=[];if(a.value!==void 0){const l=await this.h(t,n,a.value,i,void 0);for(const u of l??[])c.push([u,[]])}for(const{identifiers:l,value:u}of a.overrides??[])if(u!==void 0){const h=await this.h(t,n,u,i,l);for(const f of h??[])c.push([f,l])}c.length&&await Promise.allSettled(c.map(async([[l,u],h])=>this.a.updateValue(l,u.value,{resource:i,overrideIdentifiers:h},o)))}}async h(t,i,s,r,n){const o=c=>{const u=this.a.inspect(c,{resource:r})[i];if(u)return n?u.overrides?.find(({identifiers:h})=>Ai(h,n))?.value:u.value},a=await t.migrateFn(s,o);return Array.isArray(a)?a:[[t.key,a]]}};hM=__decorate([__param(0,rs),__param(1,Iu)],hM);var dM=class extends J{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(t){super(),this.b=t,this.a=new Di,this.ready=this.a.p,this.c()}async c(){try{await this.f()}finally{this.a.complete()}}async f(){if(!ze&&(await this.b.getEnvironment())?.os!==1)return;Qt.as(oo.Configuration).registerConfiguration({...sX,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:d(4415,null)},default:[],markdownDescription:d(4416,null),scope:3},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:d(4417,null),scope:3}}})}};dM=__decorate([__param(0,U8)],dM);var $d="window.newWindowProfile",fM=class extends J{static{this.ID="workbench.contrib.dynamicWindowConfiguration"}constructor(t,i){super(),this.c=t,this.f=i,this.g(),this.D(this.c.onDidChangeProfiles(s=>this.g())),this.h(),this.j(),this.D(i.onDidChangeConfiguration(s=>{s.source!==7&&s.affectsConfiguration($d)&&this.h()})),this.D(this.c.onDidChangeProfiles(()=>this.j()))}g(){const t=Qt.as(oo.Configuration),i={...rX,properties:{[$d]:{type:["string","null"],default:null,enum:[...this.c.profiles.map(s=>s.name),null],enumItemLabels:[...this.c.profiles.map(()=>""),d(4418,null)],description:d(4419,null),scope:1}}};this.a?t.updateConfigurations({add:[i],remove:[this.a]}):t.registerConfiguration(i),this.a=i}h(){const t=this.f.getValue($d);this.b=t?this.c.profiles.find(i=>i.name===t):void 0}j(){const t=this.f.getValue($d);if(!t)return;const i=this.b?this.c.profiles.find(s=>s.id===this.b.id):void 0;t!==i?.name&&this.f.updateValue($d,i?.name)}};fM=__decorate([__param(0,CY),__param(1,rs)],fM);var Zue=W("editorResolverService"),aX=Qt.as(oo.Configuration),cX={...iX,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:d(16069,null),additionalProperties:{type:"string"}}}};aX.registerConfiguration(cX);var YS;(function(e){e.builtin="builtin",e.option="option",e.exclusive="exclusive",e.default="default"})(YS||(YS={}));var pM;(function(e){e[e.ABORT=1]="ABORT",e[e.NONE=2]="NONE"})(pM||(pM={}));function lX(e,t){if(new Set([V.extension,V.webviewPanel,V.vscodeWorkspaceTrust,V.vscodeSettings]).has(t.scheme))return!1;const r=typeof e=="string"&&e.indexOf(_e.sep)>=0?`${t.scheme}:${t.path}`:ji(t);return la(e,r,{ignoreCase:!0})}var uX=class qd{static{this.a=0}get activeNotebookEditor(){return this.k?.apiEditor}get visibleNotebookEditors(){return this.l.map(t=>t.apiEditor)}constructor(t,i,s,r,n,o,a){this.q=s,this.r=r,this.s=n,this.t=o,this.u=a,this.f=new Map,this.g=new Ct,this.h=new Map,this.j=new I,this.onDidChangeActiveNotebookEditor=this.j.event,this.l=[],this.m=new I,this.onDidOpenNotebookDocument=this.m.event,this.n=new I,this.onDidCloseNotebookDocument=this.n.event,this.o=new I,this.onDidChangeVisibleNotebookEditors=this.o.event,this.p=new cr("NotebookCellStatusBarCache"),this.x=0,this.y=new Map,this.b=t.getProxy(Q.MainThreadNotebook),this.c=t.getProxy(Q.MainThreadNotebookDocuments),this.d=t.getProxy(Q.MainThreadNotebookEditors),this.i=i.converter,i.registerArgumentProcessor({processArgument:c=>{if(c&&c.$mid===13){const l=c.notebookEditor?.notebookUri,u=c.cell.handle,f=this.g.get(l)?.getCell(u);if(f)return f.apiCell}if(c&&c.$mid===14){const l=c.uri,u=this.g.get(l);if(u)return u.apiNotebook}return c}}),qd.C(i)}getEditorById(t){const i=this.h.get(t);if(!i)throw new Error(`unknown text editor: ${t}. known editors: ${[...this.h.keys()]} `);return i}getIdByEditor(t){for(const[i,s]of this.h)if(s.apiEditor===t)return i}get notebookDocuments(){return[...this.g.values()]}getNotebookDocument(t,i){const s=this.g.get(t);if(!s&&!i)throw new Error(`NO notebook document for '${t}'`);return s}static w(t,i){if(!i)return;const s=i.filenamePattern.map(r=>Bg.from(r)).filter(r=>r!==void 0);if(i.filenamePattern&&!s){console.warn(`Notebook content provider view options file name pattern is invalid ${i.filenamePattern}`);return}return{extension:t.identifier,providerDisplayName:t.displayName||t.name,displayName:i.displayName,filenamePattern:s,priority:i.exclusive?YS.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(t,i,s){const r=qd.a++,n=typeof s.onDidChangeCellStatusBarItems=="function"?qd.a++:void 0;this.f.set(r,s),this.b.$registerNotebookCellStatusBarItemProvider(r,n,i);let o;return n!==void 0&&(o=s.onDidChangeCellStatusBarItems(a=>this.b.$emitCellStatusBarEvent(n))),new Pe(()=>{this.f.delete(r),this.b.$unregisterNotebookCellStatusBarItemProvider(r,n),o?.dispose()})}async createNotebookDocument(t){const i=await this.c.$tryCreateNotebook({viewType:t.viewType,content:t.content&&wo.from(t.content)});return y.revive(i)}async openNotebookDocument(t){const i=this.g.get(t);if(i)return i.apiNotebook;const s=await this.c.$tryOpenNotebook(t),r=this.g.get(y.revive(s));return sc(r?.apiNotebook)}async showNotebookDocument(t,i){let s;typeof i=="object"?s={position:si.from(i.viewColumn),preserveFocus:i.preserveFocus,selections:i.selections&&i.selections.map(Rr.from),pinned:typeof i.preview=="boolean"?!i.preview:void 0,label:typeof i.asRepl=="string"?i.asRepl:typeof i.asRepl=="object"?i.asRepl.label:void 0}:s={preserveFocus:!1,pinned:!0};const r=i?.asRepl?"repl":t.notebookType,n=await this.d.$tryShowNotebookDocument(t.uri,r,s),o=n&&this.h.get(n)?.apiEditor;if(o)return o;throw n?new Error(`Could NOT open editor for "${t.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${t.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(t,i,s,r){const n=this.f.get(t),o=y.revive(i),a=this.g.get(o);if(!a||!n)return;const c=a.getCellFromIndex(s);if(!c)return;const l=await n.provideCellStatusBarItems(c.apiCell,r);if(!l)return;const u=new X,h=this.p.add([u]),p=(Array.isArray(l)?l:[l]).map(g=>xy.from(g,this.i,u));return{cacheId:h,items:p}}$releaseNotebookCellStatusBarItems(t){this.p.delete(t)}registerNotebookSerializer(t,i,s,r,n){if(ac(i))throw new Error("viewType cannot be empty or just whitespace");const o=this.x++;return this.y.set(o,{viewType:i,serializer:s,options:r}),this.b.$registerNotebookSerializer(o,{id:t.identifier,location:t.extensionLocation},i,ky.from(r),qd.w(t,n)),se(()=>{this.b.$unregisterNotebookSerializer(o)})}async $dataToNotebook(t,i,s){const r=this.y.get(t);if(!r)throw new Error("NO serializer found");const n=await r.serializer.deserializeNotebook(i.buffer,s);return new Si(wo.from(n))}async $notebookToData(t,i,s){const r=this.y.get(t);if(!r)throw new Error("NO serializer found");const n=await r.serializer.serializeNotebook(wo.to(i.value),s);return _.wrap(n)}async $saveNotebook(t,i,s,r,n){const o=y.revive(i),a=this.y.get(t);this.D(`enter saveNotebook(versionId: ${s}, ${o.toString()})`);try{if(!a)throw new QS("NO serializer found");const c=this.g.get(o);if(!c)throw new QS("Document NOT found");if(c.versionId!==s)throw new QS("Document version mismatch, expected: "+s+", actual: "+c.versionId);if(!this.s.value.isWritableFileSystem(o.scheme))throw new Gf(d(3047,null,this.A(o)),6);const l={metadata:kk(c.apiNotebook.metadata,g=>!(a.options?.transientDocumentMetadata??{})[g]),cells:[]};for(const g of c.apiNotebook.getCells()){const v=new Ip(g.kind,g.document.getText(),g.document.languageId,g.mime,a.options?.transientOutputs?[]:[...g.outputs],g.metadata,g.executionSummary);v.metadata=kk(g.metadata,b=>!(a.options?.transientCellMetadata??{})[b]),l.cells.push(v)}if(await this.z(o,r),n.isCancellationRequested)throw new dt;const u=await a.serializer.serializeNotebook(l,n);if(n.isCancellationRequested)throw new dt;this.D(`serialized versionId: ${s} ${o.toString()}`),await this.s.value.writeFile(o,u),this.D(`Finished write versionId: ${s} ${o.toString()}`);const h=this.s.getFileSystemProviderExtUri(o.scheme),f=await this.s.value.stat(o),p={name:h.basename(o),isFile:(f.type&ss.File)!==0,isDirectory:(f.type&ss.Directory)!==0,isSymbolicLink:(f.type&ss.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&Er.Readonly)||!this.s.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&Er.Locked),executable:!!((f.permissions??0)&Er.Executable),etag:Q$({mtime:f.mtime,size:f.size})};return this.D(`exit saveNotebook(versionId: ${s}, ${o.toString()})`),p}catch(c){if(c instanceof Gf)return{...c,message:c.message};throw c}}async $searchInNotebooks(t,i,s,r,n){const o=this.y.get(t)?.serializer;if(!o)return{limitHit:!1,results:[]};const a=new cu;await(async(f,p,g)=>{await Promise.all(f.map(async v=>await Promise.all(v.filenamePatterns.map(b=>{const S={_reason:g._reason,folderQueries:g.folderQueries,includePattern:g.includePattern,excludePattern:g.excludePattern,maxResults:g.maxResults,type:1,filePattern:b};return this.t.doInternalFileSearchWithCustomCallback(S,p,E=>{E.forEach(k=>{a.has(k)||r.some(F=>v.isFromSettings&&!F.isFromSettings?!1:F.filenamePatterns.some(G=>lX(G,k)))||a.add(k)})}).catch(E=>{if(E.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw E})}))))})(s,n,i);const l=new Ct;let u=!1;const h=Array.from(a).map(async f=>{const p=[];try{if(n.isCancellationRequested)return;if(i.maxResults&&[...l.values()].reduce((S,E)=>S+E.cellResults.length,0)>i.maxResults){u=!0;return}const g=[],v=this.g.get(f);if(v)v.apiNotebook.getCells().forEach(E=>g.push({input:E.document.getText(),outputs:E.outputs.flatMap(k=>k.items.map(O=>O.data.toString()))}));else{const S=await this.s.value.readFile(f),E=_.fromString(S.toString()),k=await o.deserializeNotebook(E.buffer,n);if(n.isCancellationRequested)return;wo.from(k).cells.forEach(F=>g.push({input:F.source,outputs:F.outputs.flatMap(G=>G.items.map(j=>j.valueBytes.toString()))}))}if(n.isCancellationRequested)return;g.forEach((S,E)=>{const k=i.contentPattern.pattern,O=new tX(S.input,void 0,S.outputs),F=O.findInInputs(k),G=O.findInOutputs(k),j=G.flatMap(B=>uM(B.matches,B.textBuffer)).map((B,H)=>(B.webviewIndex=H,B));if(F.length>0||G.length>0){const B={index:E,contentResults:uM(F,O.inputTextBuffer),webviewResults:j};p.push(B)}});const b={resource:f,cellResults:p};l.set(f,b);return}catch{return}});return await Promise.all(h),{limitHit:u,results:[...l.values()]}}async z(t,i){const s=await this.s.value.stat(t);if(typeof i?.mtime=="number"&&typeof i.etag=="string"&&i.etag!==sH&&typeof s.mtime=="number"&&typeof s.size=="number"&&i.mtime<s.mtime&&i.etag!==Q$({mtime:i.mtime,size:s.size}))throw new Gf(d(3048,null),3,i)}A(t){return t.scheme===V.file?t.fsPath:t.toString()}B(t,i,s){if(this.h.has(i))throw new Error(`editor with id ALREADY EXSIST: ${i}`);const r=new WS(i,this.d,t,s.visibleRanges.map(Rr.to),s.selections.map(Rr.to),typeof s.viewColumn=="number"?si.to(s.viewColumn):void 0,s.viewType);this.h.set(i,r)}$acceptDocumentAndEditorsDelta(t){if(t.value.removedDocuments)for(const s of t.value.removedDocuments){const r=y.revive(s),n=this.g.get(r);n&&(n.dispose(),this.g.delete(r),this.q.$acceptDocumentsAndEditorsDelta({removedDocuments:n.apiNotebook.getCells().map(o=>o.document.uri)}),this.n.fire(n.apiNotebook));for(const o of this.h.values())o.notebookData.uri.toString()===r.toString()&&this.h.delete(o.id)}if(t.value.addedDocuments){const s=[];for(const r of t.value.addedDocuments){const n=y.revive(r.uri);if(this.g.has(n))throw new Error(`adding EXISTING notebook ${n} `);const o=new _Q(this.c,this.q,this.r,n,r);s.push(...r.cells.map(a=>HS.asModelAddData(a))),this.g.get(n)?.dispose(),this.g.set(n,o),this.q.$acceptDocumentsAndEditorsDelta({addedDocuments:s}),this.m.fire(o.apiNotebook)}}if(t.value.addedEditors)for(const s of t.value.addedEditors){if(this.h.has(s.id))return;const r=y.revive(s.documentUri),n=this.g.get(r);n&&this.B(n,s.id,s)}const i=[];if(t.value.removedEditors)for(const s of t.value.removedEditors){const r=this.h.get(s);r&&(this.h.delete(s),this.k?.id===r.id&&(this.k=void 0),i.push(r))}if(t.value.visibleEditors){this.l=t.value.visibleEditors.map(r=>this.h.get(r)).filter(r=>!!r);const s=new Set;this.l.forEach(r=>s.add(r.id));for(const r of this.h.values()){const n=s.has(r.id);r._acceptVisibility(n)}this.l=[...this.h.values()].map(r=>r).filter(r=>r.visible),this.o.fire(this.visibleNotebookEditors)}t.value.newActiveEditor===null?this.k=void 0:t.value.newActiveEditor&&(this.h.get(t.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${t.value.newActiveEditor}`),this.k=this.h.get(t.value.newActiveEditor)),t.value.newActiveEditor!==void 0&&this.j.fire(this.k?.apiEditor)}static C(t){const i=q.String.with("notebookType","A notebook type"),s=new Se("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[i,new q("data","Bytes to convert to data",n=>n instanceof Uint8Array,n=>_.wrap(n))],new ye("Notebook Data",n=>wo.to(n.value))),r=new Se("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[i,new q("NotebookData","Notebook data to convert to bytes",n=>!0,n=>new Si(wo.from(n)))],new ye("Bytes",n=>n.buffer));t.registerApiCommand(s),t.registerApiCommand(r)}D(t){this.u.trace(`[Extension Host Notebook] ${t}`)}},QS=class extends Error{constructor(e){super(e),this.name="NotebookSaveError"}},hX=class{constructor(e,t,i,s={timeout:1500,errors:3}){this.b=e,this.c=t,this.d=i,this.f=s,this.a=new uu}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,s)=>{const r=function(o){t.call(i,o)};return r.extension=e,this.a.event(r,void 0,s)}}async $participateInSave(e,t,i){const s=y.revive(e),r=this.c.getNotebookDocument(s);if(!r)throw new Error("Unable to resolve notebook document");const n=[];if(await this.a.fireAsync({notebook:r.apiNotebook,reason:zg.to(t)},i,async(a,c)=>{const l=Date.now(),u=await await Promise.resolve(a);Date.now()-l>this.f.timeout&&this.b.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier),!i.isCancellationRequested&&u&&(u instanceof va?n.push(u):this.b.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(n.length===0)return!0;const o={edits:[]};for(const a of n){const{edits:c}=as.from(a);o.edits=o.edits.concat(c)}return this.d.$tryApplyWorkspaceEdit(new Si(o))}},dX=class{constructor(e){this.c=e,this.a=new I,this.onDidSaveNotebookDocument=this.a.event,this.b=new I,this.onDidChangeNotebookDocument=this.b.event}$acceptModelChanged(e,t,i,s){const n=this.c.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,i,s);this.b.fire(n)}$acceptDirtyStateChanged(e,t){this.c.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this.c.getNotebookDocument(y.revive(e));this.a.fire(t.apiNotebook)}},XS=class{constructor(t,i){this.c=t,this.d=i,this.a=new I,this.b=new I,this.onDidChangeNotebookEditorSelection=this.a.event,this.onDidChangeNotebookEditorVisibleRanges=this.b.event}$acceptEditorPropertiesChanged(t,i){this.c.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",t,i);const s=this.d.getEditorById(t);i.visibleRanges&&s._acceptVisibleRanges(i.visibleRanges.ranges.map(Rr.to)),i.selections&&s._acceptSelections(i.selections.selections.map(Rr.to)),i.visibleRanges&&this.b.fire({notebookEditor:s.apiEditor,visibleRanges:s.apiEditor.visibleRanges}),i.selections&&this.a.fire(Object.freeze({notebookEditor:s.apiEditor,selections:s.apiEditor.selections}))}$acceptEditorViewColumns(t){for(const i in t)this.d.getEditorById(i)._acceptViewColumn(si.to(t[i]))}};XS=__decorate([__param(0,xe)],XS);var Wl;(function(e){e[e.Output=1]="Output",e[e.OutputItems=2]="OutputItems",e[e.ExecutionState=3]="ExecutionState"})(Wl||(Wl={}));var Que=W("INotebookExecutionService"),fX=100,gM;(function(e){e[e.Disconnected=1]="Disconnected",e[e.Connected=2]="Connected",e[e.Initializing=3]="Initializing"})(gM||(gM={}));var Xue=W("INotebookKernelService"),Kue=W("INotebookKernelHistoryService"),KS=class{constructor(t,i,s,r,n){this.l=i,this.m=s,this.n=r,this.o=n,this.b=new Ct,this.c=new Ct,this.f=new Map,this.g=0,this.h=new Map,this.i=0,this.j=new Map,this.k=0,this.q=0,this.r={},this.a=t.getProxy(Q.MainThreadNotebookKernels);const o=new Se("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new q("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this.m.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this.m.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return"skipIfAlreadySelected"in c?{notebookEditorId:l,skipIfAlreadySelected:c.skipIfAlreadySelected}:{notebookEditorId:l}}return c})],ye.Void),a=new Se("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[q.Uri],new ye("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this.n.registerApiCommand(o),this.n.registerApiCommand(a)}createNotebookController(t,i,s,r,n,o){for(const F of this.j.values())if(F.controller.id===i&&it.equals(t.identifier,F.extensionId))throw new Error(`notebook controller with id '${i}' ALREADY exist`);const a=this.k++,c=this;this.o.trace(`NotebookController[${a}], CREATED by ${t.identifier.value}, ${i}`);const l=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${t.identifier}'`);let u=!1;const h=new I,f=new I,p={id:Bv(t.identifier,i),notebookType:s,extensionId:t.identifier,extensionLocation:t.extensionLocation,label:r||t.identifier.value,preloads:o?o.map(qg.from):[]};let g=n??l,v,b;this.a.$addKernel(a,p).catch(F=>{console.log(F),u=!0});let S=0;const E=()=>{if(u)return;const F=++S;Promise.resolve().then(()=>{F===S&&this.a.$updateKernel(a,p)})},k=new Ct,O={get id(){return i},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:h.event,get label(){return p.label},set label(F){p.label=F??t.displayName??t.name,E()},get detail(){return p.detail??""},set detail(F){p.detail=F,E()},get description(){return p.description??""},set description(F){p.description=F,E()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(F){p.supportedLanguages=F,E()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(F){p.supportsExecutionOrder=F,E()},get rendererScripts(){return p.preloads?p.preloads.map(qg.to):[]},get executeHandler(){return g},set executeHandler(F){g=F??l},get interruptHandler(){return v},set interruptHandler(F){v=F,p.supportsInterrupt=!!F,E()},set variableProvider(F){T(t,"notebookVariableProvider"),b=F,p.hasVariableProvider=!!F,F?.onDidChangeVariables(G=>c.a.$variablesUpdated(G.uri)),E()},get variableProvider(){return b},createNotebookCellExecution(F){if(u)throw new Error("notebook controller is DISPOSED");if(!k.has(F.notebook.uri))throw c.o.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(k.keys()).map(G=>G.toString())),new Error(`notebook controller is NOT associated to notebook: ${F.notebook.uri.toString()}`);return c._createNotebookCellExecution(F,Bv(t.identifier,this.id))},createNotebookExecution(F){if(T(t,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!k.has(F.uri))throw c.o.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(k.keys()).map(G=>G.toString())),new Error(`notebook controller is NOT associated to notebook: ${F.uri.toString()}`);return c._createNotebookExecution(F,Bv(t.identifier,this.id))},dispose:()=>{u||(this.o.trace(`NotebookController[${a}], DISPOSED`),u=!0,this.j.delete(a),h.dispose(),f.dispose(),this.a.$removeKernel(a))},updateNotebookAffinity(F,G){G===ng.Hidden&&T(t,"notebookControllerAffinityHidden"),c.a.$updateNotebookPriority(a,F.uri,G)},onDidReceiveMessage:f.event,postMessage(F,G){return T(t,"notebookMessaging"),c.a.$postMessage(a,G&&c.m.getIdByEditor(G),F)},asWebviewUri(F){return T(t,"notebookMessaging"),pd(F,c.l.remote)}};return this.j.set(a,{extensionId:t.identifier,controller:O,onDidReceiveMessage:f,onDidChangeSelection:h,associatedNotebooks:k}),O}getIdByController(t){for(const[i,s]of this.j)if(s.controller===t)return Bv(s.extensionId,t.id);return null}createNotebookControllerDetectionTask(t,i){const s=this.g++,r=this;this.o.trace(`NotebookControllerDetectionTask[${s}], CREATED by ${t.identifier.value}`),this.a.$addKernelDetectionTask(s,i);const n={dispose:()=>{this.f.delete(s),r.a.$removeKernelDetectionTask(s)}};return this.f.set(s,n),n}registerKernelSourceActionProvider(t,i,s){const r=this.i++,n=typeof s.onDidChangeNotebookKernelSourceActions=="function"?r:void 0,o=this;this.h.set(r,s),this.o.trace(`NotebookKernelSourceActionProvider[${r}], CREATED by ${t.identifier.value}`),this.a.$addKernelSourceActionProvider(r,r,i);let a;return n!==void 0&&(a=s.onDidChangeNotebookKernelSourceActions(c=>this.a.$emitNotebookKernelSourceActionsChangeEvent(n))),{dispose:()=>{this.h.delete(r),o.a.$removeKernelSourceActionProvider(r,r),a?.dispose()}}}async $provideKernelSourceActions(t,i){const s=this.h.get(t);if(s){const r=new X;return(await s.provideNotebookKernelSourceActions(i)??[]).map(o=>Cy.from(o,this.n.converter,r))}return[]}$acceptNotebookAssociation(t,i,s){const r=this.j.get(t);if(r){const n=this.m.getNotebookDocument(y.revive(i));s?r.associatedNotebooks.set(n.uri,!0):r.associatedNotebooks.delete(n.uri),this.o.trace(`NotebookController[${t}] ASSOCIATE notebook`,n.uri.toString(),s),r.onDidChangeSelection.fire({selected:s,notebook:n.apiNotebook})}}async $executeCells(t,i,s){const r=this.j.get(t);if(!r)return;const n=this.m.getNotebookDocument(y.revive(i)),o=[];for(const a of s){const c=n.getCell(a);c&&o.push(c.apiCell)}try{this.o.trace(`NotebookController[${t}] EXECUTE cells`,n.uri.toString(),o.length),await r.controller.executeHandler.call(r.controller,o,n.apiNotebook,r.controller)}catch(a){this.o.error(`NotebookController[${t}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(t,i,s){const r=this.j.get(t);if(!r)return;const n=this.m.getNotebookDocument(y.revive(i));if(r.controller.interruptHandler)await r.controller.interruptHandler.call(r.controller,n.apiNotebook);else for(const o of s){const a=n.getCell(o);a&&this.b.get(a.uri)?.cancel()}if(r.controller.interruptHandler){const o=this.c.get(n.uri);this.c.delete(n.uri),s.length&&Array.isArray(o)&&o.length&&o.forEach(a=>a.dispose())}}async $provideVariables(t,i,s,r,n,o,a){const c=this.j.get(t);if(!c)return;const l=this.m.getNotebookDocument(y.revive(s)),u=c.controller.variableProvider;if(!u)return;let h;if(r!==void 0){if(h=this.r[r],!h)return}else this.r={};const f=n==="named"?Sh.Named:Sh.Indexed,p=u.provideVariables(l.apiNotebook,h,f,o,a);let g=0;for await(const v of p){if(a.isCancellationRequested)return;const b={id:this.q++,name:v.variable.name,value:v.variable.value,type:v.variable.type,interfaces:v.variable.interfaces,language:v.variable.language,expression:v.variable.expression,hasNamedChildren:v.hasNamedChildren,indexedChildrenCount:v.indexedChildrenCount,extensionId:c.extensionId.value};if(this.r[b.id]=v.variable,this.a.$receiveVariable(i,b),g++>=fX)return}}$acceptKernelMessageFromRenderer(t,i,s){const r=this.j.get(t);if(!r)return;const n=this.m.getEditorById(i);r.onDidReceiveMessage.fire(Object.freeze({editor:n.apiEditor,message:s}))}_createNotebookCellExecution(t,i){if(t.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const r=this.m.getNotebookDocument(t.notebook.uri).getCellFromApiCell(t);if(!r)throw new Error("invalid cell");if(this.b.has(r.uri))throw new Error(`duplicate execution for ${r.uri}`);const n=new pX(i,r,this.a);this.b.set(r.uri,n);const o=n.onDidChangeState(()=>{n.state===dr.Resolved&&(n.dispose(),o.dispose(),this.b.delete(r.uri))});return n.asApiObject()}_createNotebookExecution(t,i){const s=this.m.getNotebookDocument(t.uri),r=t.getCells().find(a=>{const c=s.getCellFromApiCell(a);return c&&this.b.has(c.uri)});if(r)throw new Error(`duplicate cell execution for ${r.document.uri}`);if(this.c.has(s.uri))throw new Error(`duplicate notebook execution for ${s.uri}`);const n=new mX(i,s,this.a),o=n.onDidChangeState(()=>{n.state===yn.Resolved&&(n.dispose(),o.dispose(),this.c.delete(s.uri))});return this.c.set(s.uri,[n,o]),n.asApiObject()}};KS=__decorate([__param(4,xe)],KS);var dr;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(dr||(dr={}));var pX=class IR extends J{static{this.a=0}get state(){return this.f}constructor(t,i,s){super(),this.m=i,this.n=s,this.b=IR.a++,this.c=new I,this.onDidChangeState=this.c.event,this.f=dr.Init,this.g=this.D(new Ke),this.h=new vX(10,r=>this.r(r)),this.j=i.internalMetadata.executionOrder,this.n.$createExecution(this.b,t,this.m.notebook.uri,this.m.handle)}cancel(){this.g.cancel()}async q(t){await this.h.addItem(t)}async r(t){const i=Array.isArray(t)?t:[t];return this.n.$updateExecution(this.b,new Si(i))}s(){if(this.f===dr.Init)throw new Error("Must call start before modifying cell output");if(this.f===dr.Resolved)throw new Error("Cannot modify cell output after calling resolve")}t(t){let i=this.m;if(t&&(i=this.m.notebook.getCellFromApiCell(t)),!i)throw new Error("INVALID cell");return i.handle}w(t){return t.map(i=>{const s=Pp.ensureUniqueMimeTypes(i.items,!0);return s===i.items?bo.from(i):bo.from({items:s,id:i.id,metadata:i.metadata})})}async y(t,i,s){const r=this.t(i),n=this.w(Es(t));return this.q({editType:Wl.Output,cellHandle:r,append:s,outputs:n})}async z(t,i,s){return t=Pp.ensureUniqueMimeTypes(Es(t),!0),this.q({editType:Wl.OutputItems,items:t.map(vl.from),outputId:i.id,append:s})}asApiObject(){const t=this;return Object.freeze({get token(){return t.g.token},get cell(){return t.m.apiCell},get executionOrder(){return t.j},set executionOrder(s){t.j=s,t.r([{editType:Wl.ExecutionState,executionOrder:t.j}])},start(s){if(t.f===dr.Resolved||t.f===dr.Started)throw new Error("Cannot call start again");t.f=dr.Started,t.c.fire(),t.r({editType:Wl.ExecutionState,runStartTime:s})},end(s,r,n){if(t.f===dr.Resolved)throw new Error("Cannot call resolve twice");t.f=dr.Resolved,t.c.fire(),t.h.flush();const o=gX(n);t.n.$completeExecution(t.b,new Si({runEndTime:r,lastRunSuccess:s,error:o}))},clearOutput(s){return t.s(),t.y([],s,!1)},appendOutput(s,r){return t.s(),t.y(s,r,!0)},replaceOutput(s,r){return t.s(),t.y(s,r,!1)},appendOutputItems(s,r){return t.s(),t.z(s,r,!0)},replaceOutputItems(s,r){return t.s(),t.z(s,r,!1)}})}};function gX(e){const t=r=>r?{startLineNumber:r.start.line,startColumn:r.start.character,endLineNumber:r.end.line,endColumn:r.end.character}:void 0,i=r=>({uri:r.uri,position:r.position,label:r.label});return e?{name:e.name,message:e.message,stack:e.stack instanceof Array?e.stack.map(r=>i(r)):e.stack,location:t(e.location),uri:e.uri}:void 0}var yn;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(yn||(yn={}));var mX=class DR extends J{static{this.a=0}get state(){return this.f}constructor(t,i,s){super(),this.h=i,this.j=s,this.b=DR.a++,this.c=new I,this.onDidChangeState=this.c.event,this.f=yn.Init,this.g=this.D(new Ke),this.j.$createNotebookExecution(this.b,t,this.h.uri)}cancel(){this.g.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this.f===yn.Resolved||this.f===yn.Started)throw new Error("Cannot call start again");this.f=yn.Started,this.c.fire(),this.j.$beginNotebookExecution(this.b)},end:()=>{if(this.f===yn.Resolved)throw new Error("Cannot call resolve twice");this.f=yn.Resolved,this.c.fire(),this.j.$completeNotebookExecution(this.b)}})}},vX=class{constructor(e,t){this.f=e,this.g=t,this.a=[],this.b=Date.now()}addItem(e){return this.a.push(e),this.c||(this.c=new Di,this.b=Date.now(),Kt(this.f).then(()=>this.flush())),Date.now()-this.b>this.f?this.flush():this.c.p}flush(){if(this.a.length===0||!this.c)return Promise.resolve();const e=this.c;this.c=void 0;const t=this.a;return this.a=[],this.g(t).finally(()=>e.complete())}};function Bv(e,t){return`${e.value}/${t}`}var wX=class{constructor(e,t){this.c=t,this.a=new Map,this.b=e.getProxy(Q.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){const s=this.c.getEditorById(e);this.a.get(t)?.fire({editor:s.apiEditor,message:i})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some(s=>s.id===t))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(s,r,n)=>this.d(t).event(s,r,n),postMessage:(s,r)=>{WS.apiEditorsToExtHost.has(s)&&([s,r]=[r,s]);const n=r&&WS.apiEditorsToExtHost.get(r);return this.b.$postMessage(n?.id,t,s)}}}d(e){let t=this.a.get(e);return t||(t=new I({onDidRemoveLastListener:()=>{t?.dispose(),this.a.delete(e)}}),this.a.set(e,t),t)}},bX=class{constructor(e){this.b=new Map,this.a=e.getProxy(Q.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(T(e,"profileContentHandlers"),this.b.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.b.set(t,i),this.a.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),se(()=>{this.b.delete(t),this.a.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,s){const r=this.b.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.saveProfile(t,i,s)}async $readProfile(e,t,i){const s=this.b.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.readProfile(Oe(t)?t:y.revive(t),i)}},yX=class PR{static{this.a=0}constructor(t,i){this.d=i,this.c=new Map,this.b=t.getProxy(Q.MainThreadQuickDiff)}$provideOriginalResource(t,i,s){const r=y.revive(i),n=this.c.get(t);return n?wi(()=>n.provideOriginalResource(r,s)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(t,i,s,r,n,o){const a=PR.a++;this.c.set(a,s);const c=it.toKey(t.identifier);return this.b.$registerQuickDiffProvider(a,$a.from(i,this.d),`${c}.${r}`,n,o),{dispose:()=>{this.b.$unregisterQuickDiffProvider(a),this.c.delete(a)}}}};function AX(e,t,i){const s=e.getProxy(Q.MainThreadQuickOpen);class r{constructor(l,u){this.e=new Map,this.f=0,this.a=l,this.b=u}showQuickPick(l,u,h,f=De.None){this.c=void 0;const p=Promise.resolve(u),g=++this.f,v=s.$show(g,{title:h?.title,placeHolder:h?.placeHolder,prompt:h?.prompt,matchOnDescription:h?.matchOnDescription,matchOnDetail:h?.matchOnDetail,ignoreFocusLost:h?.ignoreFocusOut,canPickMany:h?.canPickMany},f),b={},S=v.then(()=>b);return Promise.race([S,p]).then(E=>{if(E!==b)return p.then(k=>{const O=[];for(let F=0;F<k.length;F++){const G=k[F];typeof G=="string"?O.push({label:G,handle:F}):G.kind===Ah.Separator?O.push({type:"separator",label:G.label}):(G.tooltip&&T(l,"quickPickItemTooltip"),O.push({label:G.label,iconPathDto:un.from(G.iconPath),description:G.description,detail:G.detail,picked:G.picked,alwaysShow:G.alwaysShow,tooltip:le.fromStrict(G.tooltip),resourceUri:G.resourceUri,handle:F}))}return h&&typeof h.onDidSelectItem=="function"&&(this.c=F=>{h.onDidSelectItem(k[F])}),s.$setItems(g,O),v.then(F=>{if(typeof F=="number")return k[F];if(Array.isArray(F))return F.map(G=>k[G])})})}).then(void 0,E=>{if(!ki(E))return s.$setError(g,E),Promise.reject(E)})}$onItemSelected(l){this.c?.(l)}showInput(l,u=De.None){return this.d=l?.validateInput,s.$input(l,typeof this.d=="function",u).then(void 0,h=>{if(!ki(h))return Promise.reject(h)})}async $validateInput(l){if(!this.d)return;const u=await this.d(l);if(!u||typeof u=="string")return u;let h;switch(u.severity){case rl.Info:h=rt.Info;break;case rl.Warning:h=rt.Warning;break;case rl.Error:h=rt.Error;break;default:h=u.message?rt.Error:rt.Ignore;break}return{content:u.message,severity:h}}async showWorkspaceFolderPick(l,u=De.None){const h=await this.b.executeCommand("_workbench.pickWorkspaceFolder",[l]);if(!h)return;const f=await this.a.getWorkspaceFolders2();if(f)return f.find(p=>p.uri.toString()===h.uri.toString())}createQuickPick(l){const u=new o(l,()=>this.e.delete(u._id));return this.e.set(u._id,u),u}createInputBox(l){const u=new a(l,()=>this.e.delete(u._id));return this.e.set(u._id,u),u}$onDidChangeValue(l,u){this.e.get(l)?._fireDidChangeValue(u)}$onDidAccept(l){this.e.get(l)?._fireDidAccept()}$onDidChangeActive(l,u){const h=this.e.get(l);h instanceof o&&h._fireDidChangeActive(u)}$onDidChangeSelection(l,u){const h=this.e.get(l);h instanceof o&&h._fireDidChangeSelection(u)}$onDidTriggerButton(l,u,h){this.e.get(l)?._fireDidTriggerButton(u,h)}$onDidTriggerItemButton(l,u,h,f){const p=this.e.get(l);p instanceof o&&p._fireDidTriggerItemButton(u,h,f)}$onDidHide(l){this.e.get(l)?._fireDidHide()}}class n{static{this.a=1}constructor(l,u){this.y=l,this.z=u,this._id=o.a++,this.e=!1,this.f=!1,this.g=!0,this.j=!1,this.k=!0,this.l="",this.m=void 0,this.o=[],this.p=new Map,this.q=new I,this.r=new I,this.s=new I,this.t=new I,this.v={id:this._id},this.w=!1,this.x=[this.s,this.t,this.q,this.r],this.onDidChangeValue=this.r.event,this.onDidAccept=this.q.event,this.onDidTriggerButton=this.s.event,this.onDidHide=this.t.event}get title(){return this.b}set title(l){this.b=l,this.A({title:l})}get step(){return this.c}set step(l){this.c=l,this.A({step:l})}get totalSteps(){return this.d}set totalSteps(l){this.d=l,this.A({totalSteps:l})}get enabled(){return this.g}set enabled(l){this.g=l,this.A({enabled:l})}get busy(){return this.j}set busy(l){this.j=l,this.A({busy:l})}get ignoreFocusOut(){return this.k}set ignoreFocusOut(l){this.k=l,this.A({ignoreFocusOut:l})}get value(){return this.l}set value(l){this.l=l,this.A({value:l})}get valueSelection(){return this.m}set valueSelection(l){this.m=l,this.A({valueSelection:l})}get placeholder(){return this.n}set placeholder(l){this.n=l,this.A({placeholder:l})}get buttons(){return this.o}set buttons(l){this.o=l.slice(),this.p.clear(),l.forEach((u,h)=>{const f=u===yh.Back?-1:h;this.p.set(f,u)}),this.A({buttons:l.map((u,h)=>({iconPathDto:un.from(u.iconPath),tooltip:u.tooltip,handle:u===yh.Back?-1:h,location:typeof u.location=="number"?u.location:void 0,toggle:typeof u.toggle=="object"&&typeof u.toggle.checked=="boolean"?{checked:u.toggle.checked}:void 0}))})}show(){this.e=!0,this.f=!0,this.A({visible:!0})}hide(){this.e=!1,this.A({visible:!1})}_fireDidAccept(){this.q.fire()}_fireDidChangeValue(l){this.l=l,this.r.fire(l)}_fireDidTriggerButton(l,u){const h=this.p.get(l);h&&(u!==void 0&&h.toggle&&(h.toggle.checked=u),this.s.fire(h))}_fireDidHide(){this.f&&(this.f=this.e,this.t.fire())}dispose(){this.w||(this.w=!0,this._fireDidHide(),this.x=Yi(this.x),this.u&&(clearTimeout(this.u),this.u=void 0),this.z(),s.$dispose(this._id))}A(l){if(!this.w){for(const u of Object.keys(l)){const h=l[u];this.v[u]=h===void 0?null:h}"visible"in this.v?(this.u&&(clearTimeout(this.u),this.u=void 0),this.B()):this.e&&!this.u&&(this.u=setTimeout(()=>{this.u=void 0,this.B()},0))}}B(){s.$createOrUpdate(this.v),this.v={id:this._id}}}class o extends n{constructor(l,u){super(l,u),this.C=[],this.D=new Map,this.E=new Map,this.F=!1,this.G=!0,this.H=!0,this.I=!0,this.J=!1,this.K=[],this.M=new I,this.N=[],this.O=new I,this.P=new I,this.onDidChangeActive=this.M.event,this.onDidChangeSelection=this.O.event,this.onDidTriggerItemButton=this.P.event,this.x.push(this.M,this.O,this.P),this.A({type:"quickPick"})}get items(){return this.C}set items(l){this.C=l.slice(),this.D.clear(),this.E.clear(),l.forEach((h,f)=>{this.D.set(f,h),this.E.set(h,f)});const u=[];for(let h=0;h<l.length;h++){const f=l[h];f.kind===Ah.Separator?u.push({type:"separator",label:f.label}):(f.tooltip&&T(this.y,"quickPickItemTooltip"),u.push({handle:h,label:f.label,iconPathDto:un.from(f.iconPath),description:f.description,detail:f.detail,picked:f.picked,alwaysShow:f.alwaysShow,tooltip:le.fromStrict(f.tooltip),resourceUri:f.resourceUri,buttons:f.buttons?.map((p,g)=>({iconPathDto:un.from(p.iconPath),tooltip:p.tooltip,handle:g,toggle:typeof p.toggle=="object"&&typeof p.toggle.checked=="boolean"?{checked:p.toggle.checked}:void 0}))}))}this.A({items:u})}get canSelectMany(){return this.F}set canSelectMany(l){this.F=l,this.A({canSelectMany:l})}get matchOnDescription(){return this.G}set matchOnDescription(l){this.G=l,this.A({matchOnDescription:l})}get matchOnDetail(){return this.H}set matchOnDetail(l){this.H=l,this.A({matchOnDetail:l})}get sortByLabel(){return this.I}set sortByLabel(l){this.I=l,this.A({sortByLabel:l})}get keepScrollPosition(){return this.J}set keepScrollPosition(l){this.J=l,this.A({keepScrollPosition:l})}get prompt(){return this.L}set prompt(l){this.L=l,this.A({prompt:l})}get activeItems(){return this.K}set activeItems(l){this.K=l.filter(u=>this.E.has(u)),this.A({activeItems:this.K.map(u=>this.E.get(u))})}get selectedItems(){return this.N}set selectedItems(l){this.N=l.filter(u=>this.E.has(u)),this.A({selectedItems:this.N.map(u=>this.E.get(u))})}_fireDidChangeActive(l){const u=yt(l.map(h=>this.D.get(h)));this.K=u,this.M.fire(u)}_fireDidChangeSelection(l){const u=yt(l.map(h=>this.D.get(h)));this.N=u,this.O.fire(u)}_fireDidTriggerItemButton(l,u,h){const f=this.D.get(l);if(!f||!f.buttons||!f.buttons.length)return;const p=f.buttons[u];p&&(h!==void 0&&p.toggle&&(p.toggle.checked=h),this.P.fire({button:p,item:f}))}}class a extends n{constructor(l,u){super(l,u),this.C=!1,this.A({type:"inputBox"})}get password(){return this.C}set password(l){this.C=l,this.A({password:l})}get prompt(){return this.D}set prompt(l){this.D=l,this.A({prompt:l})}get validationMessage(){return this.E}set validationMessage(l){this.E=l,l?typeof l=="string"?this.A({validationMessage:l,severity:rt.Error}):this.A({validationMessage:l.message,severity:l.severity??rt.Error}):this.A({validationMessage:void 0,severity:rt.Ignore})}}return new r(t,i)}function mM(e){return e instanceof y}function SX(e,t){return e.scheme===V.file&&t.scheme===V.file&&Mt?e.toString()===t.toString():e.toString().toLowerCase()===t.toString().toLowerCase()}function eE(e){if(e)return typeof e.iconPath=="string"?y.file(e.iconPath):y.isUri(e.iconPath)||Ft.isThemeIcon(e.iconPath)?e.iconPath:void 0}function Ur(e){if(e){if(y.isUri(e))return e;if(Ft.isThemeIcon(e))return e;{const t=e;return{light:t.light,dark:t.dark}}}else return}function vM(e){const t=Ur(e.authorIcon),i=Array.isArray(e.tooltip)?le.fromMany(e.tooltip):e.tooltip?le.from(e.tooltip):void 0,s=e.references?.map(r=>({...r,icon:Ur(r.icon)}));return{...e,authorIcon:t,references:s,tooltip:i}}function tE(e){return e?{...e,icon:Ur(e.icon)}:void 0}function iE(e,t){if(!e.iconPath&&!t.iconPath)return 0;if(e.iconPath){if(!t.iconPath)return 1}else return-1;const i=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id,s=typeof t.iconPath=="string"?t.iconPath:y.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;return ov(i,s)}function EX(e,t){let i=0;if(e.strikeThrough!==t.strikeThrough)return e.strikeThrough?1:-1;if(e.faded!==t.faded)return e.faded?1:-1;if(e.tooltip!==t.tooltip)return(e.tooltip||"").localeCompare(t.tooltip||"");if(i=iE(e,t),i!==0)return i;if(e.light&&t.light)i=iE(e.light,t.light);else{if(e.light)return 1;if(t.light)return-1}if(i!==0)return i;if(e.dark&&t.dark)i=iE(e.dark,t.dark);else{if(e.dark)return 1;if(t.dark)return-1}return i}function xX(e,t){if(e.command!==t.command)return e.command<t.command?-1:1;if(e.title!==t.title)return e.title<t.title?-1:1;if(e.tooltip!==t.tooltip){if(e.tooltip!==void 0&&t.tooltip!==void 0)return e.tooltip<t.tooltip?-1:1;if(e.tooltip!==void 0)return 1;if(t.tooltip!==void 0)return-1}if(e.arguments===t.arguments)return 0;if(e.arguments)if(t.arguments){if(e.arguments.length!==t.arguments.length)return e.arguments.length-t.arguments.length}else return 1;else return-1;for(let i=0;i<e.arguments.length;i++){const s=e.arguments[i],r=t.arguments[i];if(s!==r&&!(mM(s)&&mM(r)&&SX(s,r)))return s<r?-1:1}return 0}function wM(e,t){let i=ov(e.resourceUri.fsPath,t.resourceUri.fsPath,!0);if(i!==0)return i;if(e.command&&t.command)i=xX(e.command,t.command);else{if(e.command)return 1;if(t.command)return-1}if(i!==0)return i;if(e.decorations&&t.decorations)i=EX(e.decorations,t.decorations);else{if(e.decorations)return 1;if(t.decorations)return-1}if(i!==0)return i;if(e.multiFileDiffEditorModifiedUri&&t.multiFileDiffEditorModifiedUri)i=ov(e.multiFileDiffEditorModifiedUri.fsPath,t.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(e.multiFileDiffEditorModifiedUri)return 1;if(t.multiFileDiffEditorModifiedUri)return-1}if(i!==0)return i;if(e.multiDiffEditorOriginalUri&&t.multiDiffEditorOriginalUri)i=ov(e.multiDiffEditorOriginalUri.fsPath,t.multiDiffEditorOriginalUri.fsPath,!0);else{if(e.multiDiffEditorOriginalUri)return 1;if(t.multiDiffEditorOriginalUri)return-1}return i}function CX(e,t){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function kX(e,t){return e.command===t.command&&e.title===t.title&&e.tooltip===t.tooltip&&(e.arguments&&t.arguments?CX(e.arguments,t.arguments):e.arguments===t.arguments)}function $X(e,t){return $i(e,t,kX)}var IX=class{#e;#t;get value(){return this.d}set value(e){e=e??"",this.#e.$setInputBoxValue(this.m,e),this.o(e)}get onDidChange(){return this.f.event}get placeholder(){return this.g}set placeholder(e){this.#e.$setInputBoxPlaceholder(this.m,e),this.g=e}get validateInput(){return T(this.l,"scmValidation"),this.h}set validateInput(e){if(T(this.l,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this.l.identifier.value}]: Invalid SCM input box validation function`);this.h=e,this.#e.$setValidationProviderIsEnabled(this.m,!!e)}get enabled(){return this.j}set enabled(e){e=!!e,this.j!==e&&(this.j=e,this.#e.$setInputBoxEnablement(this.m,e))}get visible(){return this.k}set visible(e){e=!!e,this.k!==e&&(this.k=e,this.#e.$setInputBoxVisibility(this.m,e))}get document(){return T(this.l,"scmTextDocument"),this.#t.getDocument(this.n)}constructor(e,t,i,s,r){this.l=e,this.m=s,this.n=r,this.d="",this.f=new I,this.g="",this.j=!0,this.k=!0,this.#t=t,this.#e=i}showValidationMessage(e,t){T(this.l,"scmValidation"),this.#e.$showValidationMessage(this.m,e,Jy.from(t))}$onInputBoxValueChange(e){this.o(e)}o(e){this.d=e,this.f.fire(e)}},DX=class TR{static{this.d=0}get disposed(){return this.m}get id(){return this.x}get label(){return this.y}set label(t){this.y=t,this.u.$updateGroupLabel(this.w,this.handle,t)}get contextValue(){return this.q}set contextValue(t){this.q=t,this.u.$updateGroup(this.w,this.handle,this.features)}get hideWhenEmpty(){return this.t}set hideWhenEmpty(t){this.t=t,this.u.$updateGroup(this.w,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this.g]}set resourceStates(t){this.g=[...t],this.l.fire()}constructor(t,i,s,r,n,o,a){this.u=t,this.v=i,this.w=s,this.x=r,this.y=n,this.multiDiffEditorEnableViewChanges=o,this.z=a,this.f=0,this.g=[],this.h=new Map,this.j=new Map,this.k=new Map,this.l=new I,this.onDidUpdateResourceStates=this.l.event,this.m=!1,this.n=new I,this.onDidDispose=this.n.event,this.o=[],this.p=[],this.q=void 0,this.t=void 0,this.handle=TR.d++}getResourceState(t){return this.h.get(t)}$executeResourceCommand(t,i){const s=this.j.get(t);return s?wi(()=>this.v.executeCommand(s.command,...s.arguments||[],i)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){const t=[...this.g].sort(wM),s=px(this.p,t,wM).map(o=>{const a=o.toInsert.map(c=>{const l=this.f++;this.h.set(l,c);const u=c.resourceUri;let h;if(c.command)if(c.command.command==="vscode.open"||c.command.command==="vscode.diff"||c.command.command==="vscode.changes"){const B=new X;h=this.v.converter.toInternal(c.command,B),this.k.set(l,B)}else this.j.set(l,c.command);const f=qe(this.z,"scmMultiDiffEditor"),p=f?c.multiDiffEditorOriginalUri:void 0,g=f?c.multiFileDiffEditorModifiedUri:void 0,v=eE(c.decorations),b=c.decorations&&eE(c.decorations.light)||v,S=c.decorations&&eE(c.decorations.dark)||v,E=[b,S],k=c.decorations&&c.decorations.tooltip||"",O=c.decorations&&!!c.decorations.strikeThrough,F=c.decorations&&!!c.decorations.faded,G=c.contextValue||"";return{rawResource:[l,u,E,k,O,F,G,h,p,g],handle:l}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}}),r=s.map(({start:o,deleteCount:a,toInsert:c})=>[o,a,c.map(l=>l.rawResource)]),n=s.reverse();for(const{start:o,deleteCount:a,toInsert:c}of n){const l=c.map(h=>h.handle),u=this.o.splice(o,a,...l);for(const h of u)this.h.delete(h),this.j.delete(h),this.k.get(h)?.dispose(),this.k.delete(h)}return this.p=t,r}dispose(){this.m=!0,this.n.fire()}},sE=class MR{static{this.d=0}#e;get id(){return this.F}get label(){return this.G}get rootUri(){return this.H}get contextValue(){return T(this.D,"scmProviderOptions"),this.h}set contextValue(t){T(this.D,"scmProviderOptions"),this.h!==t&&(this.h=t,this.#e.$updateSourceControl(this.handle,{contextValue:t}))}get inputBox(){return this.j}get count(){return this.k}set count(t){this.k!==t&&(this.k=t,this.#e.$updateSourceControl(this.handle,{count:t}))}get quickDiffProvider(){return this.l}set quickDiffProvider(t){this.l=t;let i;qe(this.D,"quickDiffProvider")&&(i=t?.label),this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!t,quickDiffLabel:i})}get secondaryQuickDiffProvider(){return T(this.D,"quickDiffProvider"),this.m}set secondaryQuickDiffProvider(t){T(this.D,"quickDiffProvider"),this.m=t;const i=t?.label;this.#e.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!t,secondaryQuickDiffLabel:i})}get historyProvider(){return T(this.D,"scmHistoryProvider"),this.n}set historyProvider(t){T(this.D,"scmHistoryProvider"),this.n=t,this.o.value=new X,this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!t}),t&&(this.o.value.add(t.onDidChangeCurrentHistoryItemRefs(()=>{const i=tE(t?.currentHistoryItemRef),s=tE(t?.currentHistoryItemRemoteRef),r=tE(t?.currentHistoryItemBaseRef);this.#e.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,i,s,r)})),this.o.value.add(t.onDidChangeHistoryItemRefs(i=>{if(i.added.length===0&&i.modified.length===0&&i.removed.length===0)return;const s=i.added.map(o=>({...o,icon:Ur(o.icon)})),r=i.modified.map(o=>({...o,icon:Ur(o.icon)})),n=i.removed.map(o=>({...o,icon:Ur(o.icon)}));this.#e.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:s,modified:r,removed:n,silent:i.silent})})))}get artifactProvider(){return T(this.D,"scmArtifactProvider"),this.p}set artifactProvider(t){T(this.D,"scmArtifactProvider"),this.p=t,this.q.value=new X,this.#e.$updateSourceControl(this.handle,{hasArtifactProvider:!!t}),t&&this.q.value.add(t.onDidChangeArtifacts(i=>{i.length!==0&&this.#e.$onDidChangeArtifacts(this.handle,i)}))}get commitTemplate(){return this.t}set commitTemplate(t){t!==this.t&&(this.t=t,this.#e.$updateSourceControl(this.handle,{commitTemplate:t}))}get acceptInputCommand(){return this.v}set acceptInputCommand(t){this.u.value=new X,this.v=t;const i=this.E.converter.toInternal(t,this.u.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:i})}get actionButton(){return T(this.D,"scmActionButton"),this.x}set actionButton(t){if(T(this.D,"scmActionButton"),Wu(this.x,t))return;const i=this.w;this.w=new X,this.x=t;const s=t!==void 0?{command:{...this.E.converter.toInternal(t.command,this.w),shortTitle:t.command.shortTitle},secondaryCommands:t.secondaryCommands?.map(r=>r.map(n=>this.E.converter.toInternal(n,this.w))),enabled:t.enabled}:null;this.#e.$updateSourceControl(this.handle,{actionButton:s}).finally(()=>i.dispose())}get statusBarCommands(){return this.z}set statusBarCommands(t){if(this.z&&t&&$X(this.z,t))return;const i=this.y;this.y=new X,this.z=t;const s=(t||[]).map(r=>this.E.converter.toInternal(r,this.y));this.#e.$updateSourceControl(this.handle,{statusBarCommands:s}).finally(()=>i.dispose())}get selected(){return this.A}constructor(t,i,s,r,n,o,a,c,l,u){this.D=t,this.E=r,this.F=n,this.G=o,this.H=a,this.f=new I,this.onDidDispose=this.f.event,this.g=new Map,this.h=void 0,this.k=void 0,this.l=void 0,this.m=void 0,this.o=new Hs,this.q=new Hs,this.t=void 0,this.u=new Hs,this.v=void 0,this.w=new X,this.y=new X,this.z=void 0,this.A=!1,this.B=new I,this.onDidChangeSelection=this.B.event,this.C=new Fo,this.handle=MR.d++,this.I=new Map,this.J=new Set,this.#e=s;const h=y.from({scheme:V.vscodeSourceControl,path:`${n}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this.j=new IX(t,i,this.#e,this.handle,h),this.#e.$registerSourceControl(this.handle,u?.handle,n,o,a,Ur(c),l,h),this.onDidDisposeParent=u?u.onDidDispose:Ie.None}createResourceGroup(t,i,s){const r=qe(this.D,"scmMultiDiffEditor")&&s?.multiDiffEditorEnableViewChanges===!0,n=new DX(this.#e,this.E,this.handle,t,i,r,this.D),o=Ie.once(n.onDidDispose)(()=>this.I.delete(n));return this.I.set(n,o),this.eventuallyAddResourceGroups(),n}eventuallyAddResourceGroups(){const t=[],i=[];for(const[s,r]of this.I){r.dispose();const n=s.onDidUpdateResourceStates(()=>{this.J.add(s),this.eventuallyUpdateResourceStates()});Ie.once(s.onDidDispose)(()=>{this.J.delete(s),n.dispose(),this.g.delete(s.handle),this.#e.$unregisterGroup(this.handle,s.handle)}),t.push([s.handle,s.id,s.label,s.features,s.multiDiffEditorEnableViewChanges]);const o=s._takeResourceStateSnapshot();o.length>0&&i.push([s.handle,o]),this.g.set(s.handle,s)}this.#e.$registerGroups(this.handle,t,i),this.I.clear()}eventuallyUpdateResourceStates(){const t=[];this.J.forEach(i=>{const s=i._takeResourceStateSnapshot();s.length!==0&&t.push([i.handle,s])}),t.length>0&&this.#e.$spliceResourceStates(this.handle,t),this.J.clear()}getResourceGroup(t){return this.g.get(t)}setSelectionState(t){this.A=t,this.B.fire(t)}async provideArtifacts(t,i){const s=new X,n=(await this.artifactProvider?.provideArtifacts(t,i))?.map(o=>({...o,icon:Ur(o.icon),command:o.command?this.E.converter.toInternal(o.command,s):void 0}));return this.C.get(t)?.dispose(),this.C.set(t,s),n}dispose(){this.u.dispose(),this.w.dispose(),this.y.dispose(),this.o.dispose(),this.q.dispose(),this.C.dispose(),this.g.forEach(t=>t.dispose()),this.#e.$unregisterSourceControl(this.handle),this.f.fire(),this.f.dispose()}};__decorate([kf(100)],sE.prototype,"eventuallyAddResourceGroups",null),__decorate([kf(100)],sE.prototype,"eventuallyUpdateResourceStates",null);var rE=class{get onDidChangeActiveProvider(){return this.j.event}constructor(t,i,s,r){this.l=i,this.m=s,this.n=r,this.g=new Map,this.h=new Gn,this.j=new I,this.d=t.getProxy(Q.MainThreadSCM),this.f=t.getProxy(Q.MainThreadTelemetry),i.registerArgumentProcessor({processArgument:n=>{if(n&&n.$mid===3){const o=this.g.get(n.sourceControlHandle);if(!o)return n;const a=o.getResourceGroup(n.groupHandle);return a?a.getResourceState(n.handle):n}else if(n&&n.$mid===4){const o=this.g.get(n.sourceControlHandle);return o?o.getResourceGroup(n.groupHandle):n}else if(n&&n.$mid===5){const o=this.g.get(n.handle);return o||n}return n}})}createSourceControl(t,i,s,r,n,o,a){this.n.trace("ExtHostSCM#createSourceControl",t.identifier.value,i,s,r),this.f.$publicLog2("api/scm/createSourceControl",{extensionId:t.identifier.value});const c=a?ai.find(this.g.values(),h=>h===a):void 0,l=new sE(t,this.m,this.d,this.l,i,s,r,n,o,c);this.g.set(l.handle,l);const u=this.h.get(t.identifier)||[];return u.push(l),this.h.set(t.identifier,u),l}getLastInputBox(t){this.n.trace("ExtHostSCM#getLastInputBox",t.identifier.value);const i=this.h.get(t.identifier),s=i&&i[i.length-1];return s&&s.inputBox}$provideOriginalResource(t,i,s){const r=y.revive(i);this.n.trace("ExtHostSCM#$provideOriginalResource",t,r.toString());const n=this.g.get(t);return!n||!n.quickDiffProvider||!n.quickDiffProvider.provideOriginalResource?Promise.resolve(null):wi(()=>n.quickDiffProvider.provideOriginalResource(r,s)).then(o=>o||null)}$provideSecondaryOriginalResource(t,i,s){const r=y.revive(i);this.n.trace("ExtHostSCM#$provideSecondaryOriginalResource",t,r.toString());const n=this.g.get(t);return!n||!n.secondaryQuickDiffProvider||!n.secondaryQuickDiffProvider.provideOriginalResource?Promise.resolve(null):wi(()=>n.secondaryQuickDiffProvider.provideOriginalResource(r,s)).then(o=>o||null)}$onInputBoxValueChange(t,i){this.n.trace("ExtHostSCM#$onInputBoxValueChange",t);const s=this.g.get(t);return s&&s.inputBox.$onInputBoxValueChange(i),Promise.resolve(void 0)}$executeResourceCommand(t,i,s,r){this.n.trace("ExtHostSCM#$executeResourceCommand",t,i,s);const n=this.g.get(t);if(!n)return Promise.resolve(void 0);const o=n.getResourceGroup(i);return o?o.$executeResourceCommand(s,r):Promise.resolve(void 0)}$validateInput(t,i,s){this.n.trace("ExtHostSCM#$validateInput",t);const r=this.g.get(t);return!r||!r.inputBox.validateInput?Promise.resolve(void 0):wi(()=>r.inputBox.validateInput(i,s)).then(n=>{if(!n)return Promise.resolve(void 0);const o=le.fromStrict(n.message);return o?Promise.resolve([o,n.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(t){return this.n.trace("ExtHostSCM#$setSelectedSourceControl",t),this.k===t||(t!==void 0&&this.g.get(t)?.setSelectionState(!0),this.k!==void 0&&this.g.get(this.k)?.setSelectionState(!1),this.k=t),Promise.resolve(void 0)}async $resolveHistoryItem(t,i,s){try{const n=await this.g.get(t)?.historyProvider?.resolveHistoryItem(i,s);return n?vM(n):void 0}catch(r){this.n.error("ExtHostSCM#$resolveHistoryItem",r);return}}async $resolveHistoryItemChatContext(t,i,s){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemChatContext(i,s)??void 0}catch(r){this.n.error("ExtHostSCM#$resolveHistoryItemChatContext",r);return}}async $resolveHistoryItemChangeRangeChatContext(t,i,s,r,n){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemChangeRangeChatContext?.(i,s,r,n)??void 0}catch(o){this.n.error("ExtHostSCM#$resolveHistoryItemChangeRangeChatContext",o);return}}async $resolveHistoryItemRefsCommonAncestor(t,i,s){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemRefsCommonAncestor(i,s)??void 0}catch(r){this.n.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",r);return}}async $provideHistoryItemRefs(t,i,s){try{return(await this.g.get(t)?.historyProvider?.provideHistoryItemRefs(i,s))?.map(o=>({...o,icon:Ur(o.icon)}))??void 0}catch(r){this.n.error("ExtHostSCM#$provideHistoryItemRefs",r);return}}async $provideHistoryItems(t,i,s){try{return(await this.g.get(t)?.historyProvider?.provideHistoryItems(i,s))?.map(o=>vM(o))??void 0}catch(r){this.n.error("ExtHostSCM#$provideHistoryItems",r);return}}async $provideHistoryItemChanges(t,i,s,r){try{return await this.g.get(t)?.historyProvider?.provideHistoryItemChanges(i,s,r)??void 0}catch(n){this.n.error("ExtHostSCM#$provideHistoryItemChanges",n);return}}async $provideArtifactGroups(t,i){try{return(await this.g.get(t)?.artifactProvider?.provideArtifactGroups(i))?.map(n=>({...n,icon:Ur(n.icon)}))}catch(s){this.n.error("ExtHostSCM#$provideArtifactGroups",s);return}}async $provideArtifacts(t,i,s){try{return this.g.get(t)?.provideArtifacts(i,s)}catch(r){this.n.error("ExtHostSCM#$provideArtifacts",r);return}}};rE=__decorate([__param(3,xe)],rE);var PX=class NR{static{this.a=0}constructor(t,i){this.d=i,this.c=new Map,this.b=t.getProxy(Q.MainThreadShare)}async $provideShare(t,i,s){return await this.c.get(t)?.provideShare({selection:U.to(i.selection),resourceUri:y.revive(i.resourceUri)},s)??void 0}registerShareProvider(t,i){const s=NR.a++;return this.c.set(s,i),this.b.$registerShareProvider(s,$a.from(t,this.d),i.id,i.label,i.priority),{dispose:()=>{this.b.$unregisterShareProvider(s),this.c.delete(s)}}}},TX=class RR{static{this.a=1}constructor(t){this.c=new Map,this.d=new Map,this.f=new Map,this.b=t.getProxy(Q.MainThreadSpeech)}async $createSpeechToTextSession(t,i,s){const r=this.c.get(t);if(!r)return;const n=new X,o=new Ke;this.d.set(i,o);const a=await r.provideSpeechToTextSession(o.token,s?{language:s}:void 0);a&&(n.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.b.$emitSpeechToTextEvent(i,c)})),n.add(o.token.onCancellationRequested(()=>n.dispose())))}async $cancelSpeechToTextSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t)}async $createTextToSpeechSession(t,i,s){const r=this.c.get(t);if(!r)return;const n=new X,o=new Ke;this.d.set(i,o);const a=await r.provideTextToSpeechSession(o.token,s?{language:s}:void 0);a&&(this.f.set(i,a),n.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.b.$emitTextToSpeechEvent(i,c)})),n.add(o.token.onCancellationRequested(()=>n.dispose())))}async $synthesizeSpeech(t,i){this.f.get(t)?.synthesize(i)}async $cancelTextToSpeechSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t),this.f.delete(t)}async $createKeywordRecognitionSession(t,i){const s=this.c.get(t);if(!s)return;const r=new X,n=new Ke;this.d.set(i,n);const o=await s.provideKeywordRecognitionSession(n.token);o&&(r.add(o.onDidChange(a=>{n.token.isCancellationRequested||this.b.$emitKeywordRecognitionEvent(i,a)})),r.add(n.token.onCancellationRequested(()=>r.dispose())))}async $cancelKeywordRecognitionSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t)}registerProvider(t,i,s){const r=RR.a++;return this.c.set(r,s),this.b.$registerProvider(r,i,{extension:t,displayName:t.value}),se(()=>{this.b.$unregisterProvider(r),this.c.delete(r)})}},MX=class w1{static{this.a=0}static{this.b=new Map([["statusBarItem.errorBackground",new hh("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new hh("statusBarItem.warningForeground")]])}#e;#t;constructor(t,i,s,r,n,o=uo.Left,a,c){if(this.v=c,this.i=!1,this.k="",this.r=new X,this.#e=t,this.#t=i,n&&r){this.c=$_(r.identifier,n);const l=s.get(this.c);l&&(o=l.alignLeft?uo.Left:uo.Right,a=l.priority,this.j=!0,this.name=l.name,this.text=l.text,this.tooltip=l.tooltip,this.command=l.command,this.accessibilityInformation=l.accessibilityInformation)}else this.c=String(w1.a++);this.e=r,this.f=n,this.g=o,this.h=this.w(a)}w(t){if(xs(t))return t===Number.POSITIVE_INFINITY?Number.MAX_VALUE:t===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t}get id(){return this.f??this.e.identifier.value}get entryId(){return this.c}get alignment(){return this.g}get priority(){return this.h}get text(){return this.k}get name(){return this.n}get tooltip(){return this.l}get tooltip2(){return this.e&&T(this.e,"statusBarItemTooltip"),this.m}get color(){return this.o}get backgroundColor(){return this.p}get command(){return this.s?.fromApi}get accessibilityInformation(){return this.u}set text(t){this.k=t,this.x()}set name(t){this.n=t,this.x()}set tooltip(t){this.l=t,this.x()}set tooltip2(t){this.e&&T(this.e,"statusBarItemTooltip"),this.m=t,this.x()}set color(t){this.o=t,this.x()}set backgroundColor(t){t&&!w1.b.has(t.id)&&(t=void 0),this.p=t,this.x()}set command(t){this.s?.fromApi!==t&&(this.q&&this.r.add(this.q),this.q=new X,typeof t=="string"?this.s={fromApi:t,internal:this.#t.toInternal({title:"",command:t},this.q)}:t?this.s={fromApi:t,internal:this.#t.toInternal(t,this.q)}:this.s=void 0,this.x())}set accessibilityInformation(t){this.u=t,this.x()}show(){this.j=!0,this.x()}hide(){clearTimeout(this.t),this.j=!1,this.#e.$disposeEntry(this.c)}x(){this.i||!this.j||(clearTimeout(this.t),this.t=setTimeout(()=>{this.t=void 0;let t;this.e?this.f?t=`${this.e.identifier.value}.${this.f}`:t=this.e.identifier.value:t=this.f;let i;this.n?i=this.n:i=d(3049,null,this.e.displayName||this.e.name);let s=this.o;this.p&&(s=w1.b.get(this.p.id));let r,n;typeof this.m=="function"?(r=le.fromStrict(this.l),n=!0):(r=le.fromStrict(this.m??this.l),n=!1),this.#e.$setEntry(this.c,t,this.e?.identifier.value,i,this.k,r,n,this.s?.internal,s,this.p,this.g===uo.Left,this.h,this.u),this.r.clear()},0))}dispose(){this.hide(),this.v?.(),this.i=!0}},NX=class{constructor(e){this.b=[],this.a=e.createStatusBarEntry(void 0,"status.extensionMessage",uo.Left,Number.MIN_VALUE),this.a.name=d(3050,null)}dispose(){this.b.length=0,this.a.dispose()}setMessage(e){const t={message:e};return this.b.unshift(t),this.c(),new Pe(()=>{const i=this.b.indexOf(t);i>=0&&(this.b.splice(i,1),this.c())})}c(){this.b.length>0?(this.a.text=this.b[0].message,this.a.show()):this.a.hide()}},RX=class{constructor(e,t){this.e=new Map,this.f=new Map,this.a=e.getProxy(Q.MainThreadStatusBar),this.b=t,this.c=new NX(this)}$acceptStaticEntries(e){for(const t of e)this.f.set(t.entryId,t)}async $provideTooltip(e,t){const i=this.e.get(e);if(!i)return;const s=typeof i.tooltip2=="function"?await i.tooltip2(t):i.tooltip2;return t.isCancellationRequested?void 0:le.fromStrict(s)}createStatusBarEntry(e,t,i,s){const r=new MX(this.a,this.b,this.f,e,t,i,s,()=>this.e.delete(r.entryId));return this.e.set(r.entryId,r),r}setStatusBarMessage(e,t){const i=this.c.setMessage(e);let s;return typeof t=="number"?s=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new Pe(()=>{i.dispose(),clearTimeout(s)})}},LX=class extends J{constructor(e,t){super(),this.n=t,this.a=new I,this.b=new I,this.c=new I,this.f=new I,this.g=new I,this.h=new I,this.j=new I,this.onDidChangeTextEditorSelection=this.a.event,this.onDidChangeTextEditorOptions=this.b.event,this.onDidChangeTextEditorVisibleRanges=this.c.event,this.onDidChangeTextEditorViewColumn=this.f.event,this.onDidChangeTextEditorDiffInformation=this.g.event,this.onDidChangeActiveTextEditor=this.h.event,this.onDidChangeVisibleTextEditors=this.j.event,this.m=e.getProxy(Q.MainThreadTextEditors),this.D(this.n.onDidChangeVisibleTextEditors(i=>this.j.fire(i))),this.D(this.n.onDidChangeActiveTextEditor(i=>this.h.fire(i)))}getActiveTextEditor(){return this.n.activeEditor()}getVisibleTextEditors(e){const t=this.n.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let s;typeof t=="number"?s={position:si.from(t),preserveFocus:i}:typeof t=="object"?s={position:si.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?U.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:s={preserveFocus:!1};const r=await this.m.$tryShowTextDocument(e.uri,s),n=r&&this.n.getEditor(r);if(n)return n.value;throw r?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new xV(this.m,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this.n.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const s=t.selections.selections.map(sr.to);i._acceptSelections(s)}if(t.visibleRanges){const s=yt(t.visibleRanges.map(U.to));i._acceptVisibleRanges(s)}if(t.options&&this.b.fire({textEditor:i.value,options:{...t.options,lineNumbers:fl.to(t.options.lineNumbers)}}),t.selections){const s=Bc.fromValue(t.selections.source),r=t.selections.selections.map(sr.to);this.a.fire({textEditor:i.value,selections:r,kind:s})}if(t.visibleRanges){const s=yt(t.visibleRanges.map(U.to));this.c.fire({textEditor:i.value,visibleRanges:s})}}$acceptEditorPositionData(e){for(const t in e){const i=this.n.getEditor(t);if(!i)throw new Error("Unknown text editor");const s=si.to(e[t]);i.value.viewColumn!==s&&(i._acceptViewColumn(s),this.f.fire({textEditor:i.value,viewColumn:s}))}}$acceptEditorDiffInformation(e,t){const i=this.n.getEditor(e);if(!i)throw new Error("unknown text editor");if(!t){i._acceptDiffInformation(void 0),this.g.fire({textEditor:i.value,diffInformation:void 0});return}const s=this,r=t.map(n=>{const o=y.revive(n.original),a=y.revive(n.modified),c=n.changes.map(l=>{const[u,h,f,p]=l;let g;return u===h?g=qc.Addition:f===p?g=qc.Deletion:g=qc.Modification,{original:{startLineNumber:u,endLineNumberExclusive:h},modified:{startLineNumber:f,endLineNumberExclusive:p},kind:g}});return Object.freeze({documentVersion:n.documentVersion,original:o,modified:a,changes:c,get isStale(){return s.n.getDocument(a)?.version!==n.documentVersion}})});i._acceptDiffInformation(r),this.g.fire({textEditor:i.value,diffInformation:r})}getDiffInformation(e){return Promise.resolve(this.m.$getDiffInformation(e))}},nE=class{constructor(t){this.a=new ig(go.Dark),this.b=new I}get activeColorTheme(){return this.a}$onColorThemeChange(t){let i;switch(t){case"light":i=go.Light;break;case"hcDark":i=go.HighContrast;break;case"hcLight":i=go.HighContrastLight;break;default:i=go.Dark}this.a=new ig(i),this.b.fire(this.a)}get onDidChangeActiveColorTheme(){return this.b.event}};nE=__decorate([__param(0,Te)],nE);var she=W("IExtHostTimeline"),OX=class{constructor(e,t){this.b=new Map,this.c=new Map,this.a=e.getProxy(Q.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,s)=>{if(i&&i.$mid===12)if(this.b.get(i.source)&&s&&qe(s,"timeline")){const r=i.uri===void 0?void 0:y.revive(i.uri);return this.c.get(i.source)?.get(bM(r))?.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,s){return this.b.get(e)?.provider.provideTimeline(y.revive(t),i,s)}registerTimelineProvider(e,t,i,s){const r=new X,n=this.d(t.id,s,r).bind(this);let o;t.onDidChange&&(o=t.onDidChange(c=>this.a.$emitTimelineChangeEvent({uri:void 0,reset:!0,...c,id:t.id}),this));const a=this.c;return this.f({...t,scheme:e,onDidChange:void 0,async provideTimeline(c,l,u){l?.resetCache&&(r.clear(),a.get(t.id)?.clear());const h=await t.provideTimeline(c,l,u);if(h==null)return;const f=n(c,l);return{...h,source:t.id,items:h.items.map(f)}},dispose(){for(const c of a.values())c.get(t.id)?.clear();o?.dispose(),r.dispose()}},i)}d(e,t,i){return(s,r)=>{let n;if(r?.cacheResults){let o=this.c.get(e);o===void 0&&(o=new Map,this.c.set(e,o));const a=bM(s);n=o.get(a),n===void 0&&(n=new Map,o.set(a,n))}return o=>{const{iconPath:a,...c}=o,l=`${e}|${o.id??o.timestamp}`;n?.set(l,o);let u,h,f;o.iconPath&&(a instanceof Ri?f={id:a.id,color:a.color}:y.isUri(a)?(u=a,h=a):{light:u,dark:h}=a);let p;return Ni.isMarkdownString(c.tooltip)?p=le.from(c.tooltip):Oe(c.tooltip)?p=c.tooltip:Ni.isMarkdownString(c.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=le.from(c.detail)):Oe(c.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=c.detail),{...c,id:c.id??void 0,handle:l,source:e,command:o.command?t.toInternal(o.command,i):void 0,icon:u,iconDark:h,themeIcon:f,tooltip:p,accessibilityInformation:o.accessibilityInformation}}}}f(e,t){if(this.b.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this.a.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this.b.set(e.id,{provider:e,extension:t}),se(()=>{for(const s of this.c.values())s.get(e.id)?.clear();this.b.delete(e.id),this.a.$unregisterTimelineProvider(e.id),e.dispose()})}};function bM(e){return e?.toString()}var rhe=d(4663,null),nhe=rd("default-view-icon",ce.window,d(4664,null)),qv;(function(e){e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"})(qv||(qv={}));var yM;(function(e){e[e.Sidebar=0]="Sidebar",e[e.Panel=1]="Panel",e[e.AuxiliaryBar=2]="AuxiliaryBar"})(yM||(yM={}));var FX=class extends J{constructor(){super(...arguments),this.c=this.D(new I),this.onDidRegister=this.c.event,this.f=this.D(new I),this.onDidDeregister=this.f.event,this.g=new Map,this.h=[]}get all(){return[...this.g.values()].flat()}registerViewContainer(e,t,i){const s=this.get(e.id);if(s)return s;const r=e;return r.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id},PL(this.g,t,[]).push(r),i?.isDefault&&this.h.push(r),this.c.fire({viewContainer:r,viewContainerLocation:t}),r}deregisterViewContainer(e){for(const t of this.g.keys()){const i=this.g.get(t),s=i?.indexOf(e);if(s!==-1){i?.splice(s,1),i.length===0&&this.g.delete(t),this.f.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.g.get(e)||[]]}getViewContainerLocation(e){return[...this.g.keys()].filter(t=>this.getViewContainers(t).filter(i=>i?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.h.find(t=>this.getViewContainerLocation(t)===e)}};Qt.add(qv.ViewContainersRegistry,new FX);var Vv;(function(e){e.Open="2_open",e.Debug="4_debug",e.SCM="5_scm",e.More="9_more"})(Vv||(Vv={}));function jX(e,t){const i=e.group??Vv.More,s=t.group??Vv.More;return i!==s?i.localeCompare(s):(e.order??5)-(t.order??5)}var UX=class extends J{constructor(){super(...arguments),this.c=this.D(new I),this.onViewsRegistered=this.c.event,this.f=this.D(new I),this.onViewsDeregistered=this.f.event,this.g=this.D(new I),this.onDidChangeContainer=this.g.event,this.h=this.D(new I),this.onDidChangeViewWelcomeContent=this.h.event,this.j=[],this.m=new Map,this.n=new Ax}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.q(t,i)),this.c.fire(e)}deregisterViews(e,t){const i=this.r(e,t);i.length&&this.f.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this.m.keys())if(i!==t){const s=this.r(e,i);s.length&&(this.q(s,t),this.g.fire({views:s,from:i,to:t}))}}getViews(e){return this.m.get(e)||[]}getView(e){for(const t of this.j){const i=(this.m.get(t)||[]).filter(s=>s.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this.j)if((this.m.get(t)||[]).filter(s=>s.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this.n.add(e,t),this.h.fire(e),se(()=>{this.n.delete(e,t),this.h.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[s,r]of t)this.n.add(e,r),i.set(s,se(()=>{this.n.delete(e,r),this.h.fire(e)}));return this.h.fire(e),i}getViewWelcomeContent(e){const t=[];return this.n.forEach(e,i=>t.push(i)),t.sort(jX)}q(e,t){let i=this.m.get(t);i||(i=[],this.m.set(t,i),this.j.push(t));for(const s of e){if(this.getView(s.id)!==null)throw new Error(d(4665,null,s.id));i.push(s)}}r(e,t){const i=this.m.get(t);if(!i)return[];const s=[],r=[];for(const n of i)e.includes(n)?s.push(n):r.push(n);return s.length&&(r.length?this.m.set(t,r):(this.m.delete(t),this.j.splice(this.j.indexOf(t),1))),s}};Qt.add(qv.ViewsRegistry,new UX);var ohe=W("viewDescriptorService"),AM;(function(e){e[e.Default=0]="Default",e[e.Expand=1]="Expand"})(AM||(AM={}));var SM;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(SM||(SM={}));var An=class extends Error{constructor(e){super(d(4666,null,e)),this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}},zX=class{constructor(){this.a=new Map}removeDragOperationTransfer(e){if(e&&this.a.has(e)){const t=this.a.get(e);return this.a.delete(e),t}}addDragOperationTransfer(e,t){this.a.set(e,t)}};function EM(e,t){if(Oe(e))return{label:e};if(e&&typeof e=="object"&&e.label){let i;if(Array.isArray(e.highlights)&&(i=e.highlights.filter((s=>s.length===2&&typeof s[0]=="number"&&typeof s[1]=="number")),i=i.length?i:void 0),Oe(e.label))return{label:e.label,highlights:i};if(Ni.isMarkdownString(e.label))return T(t,"treeItemMarkdownLabel"),{label:le.from(e.label),highlights:i}}}var HX=class extends J{constructor(e,t,i){super(),this.f=e,this.g=t,this.h=i,this.a=new Map,this.b=new zX;function s(r){return r&&r.$treeViewId&&(r.$treeItemHandle||r.$selectedTreeItems||r.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:r=>s(r)?this.q(r):Array.isArray(r)&&r.length>0?r.map(n=>s(n)?this.q(n):n):r})}registerTreeDataProvider(e,t,i){const s=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>s.dispose()}}createTreeView(e,t,i){if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const s=t.dragAndDropController?.dropMimeTypes??[],r=t.dragAndDropController?.dragMimeTypes??[],n=!!t.dragAndDropController?.handleDrag,o=!!t.dragAndDropController?.handleDrop,a=this.m(e,t,i),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:s,dragMimeTypes:r,hasHandleDrag:n,hasHandleDrop:o,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},l=this.f.$registerTreeViewDataProvider(e,c),u={get onDidCollapseElement(){return a.onDidCollapseElement},get onDidExpandElement(){return a.onDidExpandElement},get selection(){return a.selectedElements},get onDidChangeSelection(){return a.onDidChangeSelection},get activeItem(){return T(i,"treeViewActiveItem"),a.focusedElement},get onDidChangeActiveItem(){return T(i,"treeViewActiveItem"),a.onDidChangeActiveItem},get visible(){return a.visible},get onDidChangeVisibility(){return a.onDidChangeVisibility},get onDidChangeCheckboxState(){return a.onDidChangeCheckboxState},get message(){return a.message},set message(h){Xn(h)&&T(i,"treeViewMarkdownMessage"),a.message=h},get title(){return a.title},set title(h){a.title=h},get description(){return a.description},set description(h){a.description=h},get badge(){return a.badge},set badge(h){h!==void 0&&pb.isViewBadge(h)?a.badge={value:Math.floor(Math.abs(h.value)),tooltip:h.tooltip}:h===void 0&&(a.badge=void 0)},reveal:(h,f)=>a.reveal(h,f),dispose:async()=>{await l,this.a.delete(e),a.dispose()}};return this.D(u),u}async $getChildren(e,t){const i=this.a.get(e);if(!i)return Promise.reject(new An(e));if(!t){const r=await i.getChildren();return r?[[0,...r]]:void 0}const s=[];for(let r=0;r<t.length;r++){const n=t[r],o=await i.getChildren(n);o&&s.push([r,...o])}return s}async $handleDrop(e,t,i,s,r,n,o,a){const c=this.a.get(e);if(!c)return Promise.reject(new An(e));const l=yl.toDataTransfer(i,async u=>(await this.f.$resolveDropFileData(e,t,u)).buffer);return o===e&&a&&await this.j(l,c,a,r,n),c.onDrop(l,s,r)}async j(e,t,i,s,r){const n=this.b.removeDragOperationTransfer(r);if(n)(await n)?.forEach((o,a)=>{o&&e.set(a,o)});else if(r&&t.handleDrag){const o=t.handleDrag(i,e,s);this.b.addDragOperationTransfer(r,o),await o}return e}async $handleDrag(e,t,i,s){const r=this.a.get(e);if(!r)return Promise.reject(new An(e));const n=await this.j(new Yc,r,t,s,i);if(!(!n||s.isCancellationRequested))return yl.from(n)}async $hasResolve(e){const t=this.a.get(e);if(!t)throw new An(e);return t.hasResolve}$resolve(e,t,i){const s=this.a.get(e);if(!s)throw new An(e);return s.resolveTreeItem(t,i)}$setExpanded(e,t,i){const s=this.a.get(e);if(!s)throw new An(e);s.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const s=this.a.get(e);if(!s)throw new An(e);s.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.a.get(e);if(!i){if(!t)return;throw new An(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.a.get(e);if(!i)throw new An(e);i.setCheckboxState(t)}m(e,t,i){const s=this.D(new WX(e,t,this.f,this.g.converter,this.h,i));return this.a.set(e,s),s}q(e){const t=this.a.get(e.$treeViewId),i=e;return t&&i.$treeItemHandle?t.getExtensionElement(i.$treeItemHandle):t&&e.$focusedTreeItem?t.focusedElement:null}},WX=class Vd extends J{static{this.a="0"}static{this.b="1"}static{this.f=Symbol("extHostTreeViewRoot")}get visible(){return this.u}get selectedElements(){return this.w.map(t=>this.getExtensionElement(t)).filter(t=>!qt(t))}get focusedElement(){return this.y?this.getExtensionElement(this.y):void 0}constructor(t,i,s,r,n,o){if(super(),this.O=t,this.P=s,this.Q=r,this.R=n,this.S=o,this.j=void 0,this.m=new Map,this.q=new Map,this.s=new Map,this.t=0,this.u=!1,this.w=[],this.y=void 0,this.z=this.D(new I),this.onDidExpandElement=this.z.event,this.C=this.D(new I),this.onDidCollapseElement=this.C.event,this.F=this.D(new I),this.onDidChangeSelection=this.F.event,this.G=this.D(new I),this.onDidChangeActiveItem=this.G.event,this.H=this.D(new I),this.onDidChangeVisibility=this.H.event,this.I=this.D(new I),this.onDidChangeCheckboxState=this.I.event,this.J=this.D(new I),this.L=Promise.resolve(),this.M=Promise.resolve(),this.N=new Set,this.Y="",this.Z="",this.hb=new Ke,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const h of o.contributes.views[u])h.id===t&&(this.Z=h.name);this.g=i.treeDataProvider,this.h=i.dragAndDropController,this.g.onDidChangeTreeData&&this.D(this.g.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this.J.fire({message:!1,element:u})}));let a,c;const l=Ie.debounce(this.J.event,(u,h)=>(u||(u={message:!1,elements:[]}),h.element!==!1&&(a||(a=new Promise(f=>c=f),this.L=this.L.then(()=>a)),Array.isArray(h.element)?u.elements.push(...h.element):u.elements.push(h.element)),h.message&&(u.message=!0),u),200,!0);this.D(l(({message:u,elements:h})=>{h.length&&(h=Ro(h),this.M=this.M.then(()=>{const f=c;a=null;const p=Array.from(this.N);return this.N.clear(),this.W("start",h,p),this.ib(h).then(()=>(this.W("done",h,p),this.Cb(p),f())).catch(g=>{const v=g instanceof Error?g.message:JSON.stringify(g);return this.W("error",h,p),this.Cb(p),this.R.error(`Unable to refresh tree view ${this.O}: ${v}`),f()})})),u&&this.P.$setMessage(this.O,le.fromStrict(this.Y)??"")}))}U(t){const i=[];for(const r of t){if(!r){i.push("<root>");continue}const n=this.q.get(r);n&&i.push(n.item.handle)}const s=this.j?.map(r=>r.item.handle)??[];return{changed:i,roots:s}}W(t,i,s){if(this.X())try{const r=this.U(i);r.clearing=s.map(a=>a.item.handle);const n=r.changed.length,o=s.length;this.R.debug(`[TreeView:${this.O}] refresh ${t} changed=${n} nodesToClear=${o} elements.size=${this.m.size} nodes.size=${this.q.size} handles=${JSON.stringify(r)}`)}catch{this.R.debug(`[TreeView:${this.O}] refresh ${t} (snapshot failed)`)}}X(){try{const t=this.R.getLevel();return t===K.Debug||t===K.Trace}catch{return!1}}async getChildren(t){const i=t?this.getExtensionElement(t):void 0;if(t&&!i)return this.R.error(`No tree item with id '${t}' found.`),Promise.resolve([]);let s=this.eb(t);return s||(s=await this.gb(i)),s?s.map(r=>r.item):void 0}getExtensionElement(t){return this.m.get(t)}reveal(t,i){i=i||{select:!0,focus:!1};const s=qt(i.select)?!0:i.select,r=qt(i.focus)?!1:i.focus,n=qt(i.expand)?!1:i.expand;return typeof this.g.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):t?this.L.then(()=>this.bb(t)).then(o=>this.db(t,o[o.length-1]).then(a=>this.P.$reveal(this.O,{item:a.item,parentChain:o.map(c=>c.item)},{select:s,focus:r,expand:n})),o=>this.R.error(o)):this.P.$reveal(this.O,void 0,{select:s,focus:r,expand:n})}get message(){return this.Y}set message(t){this.Y=t,this.J.fire({message:!0,element:!1})}get title(){return this.Z}set title(t){this.Z=t,this.P.$setTitle(this.O,t,this.$)}get description(){return this.$}set description(t){this.$=t,this.P.$setTitle(this.O,this.Z,t)}get badge(){return this.ab}set badge(t){this.ab?.value===t?.value&&this.ab?.tooltip===t?.tooltip||(this.ab=Vg.from(t),this.P.$setBadge(this.O,t))}setExpanded(t,i){const s=this.getExtensionElement(t);s&&(i?this.z.fire(Object.freeze({element:s})):this.C.fire(Object.freeze({element:s})))}setSelectionAndFocus(t,i){const s=!$i(this.w,t);this.w=t;const r=this.y!==i;this.y=i,s&&this.F.fire(Object.freeze({selection:this.selectedElements})),r&&this.G.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(t){t!==this.u&&(this.u=t,this.H.fire(Object.freeze({visible:this.u})))}async setCheckboxState(t){const i=(await Promise.all(t.map(async s=>{const r=this.getExtensionElement(s.treeItemHandle);return r?{extensionItem:r,treeItem:await this.g.getTreeItem(r),newState:s.newState?Tr.Checked:Tr.Unchecked}:Promise.resolve(void 0)}))).filter(s=>s!==void 0);i.forEach(s=>{s.treeItem.checkboxState=s.newState?Tr.Checked:Tr.Unchecked}),this.I.fire({items:i.map(s=>[s.extensionItem,s.newState])})}async handleDrag(t,i,s){const r=[];for(const n of t){const o=this.getExtensionElement(n);o&&r.push(o)}if(!(!this.h?.handleDrag||r.length===0))return await this.h.handleDrag(r,i,s),i}get hasHandleDrag(){return!!this.h?.handleDrag}async onDrop(t,i,s){const r=i?this.getExtensionElement(i):void 0;if(!(!r&&i||!this.h?.handleDrop))return wi(()=>this.h?.handleDrop?this.h.handleDrop(r,t,s):void 0)}get hasResolve(){return!!this.g.resolveTreeItem}async resolveTreeItem(t,i){if(!this.g.resolveTreeItem)return;const s=this.m.get(t);if(s){const r=this.q.get(s);if(r){const n=await this.g.resolveTreeItem(r.extensionItem,s,i)??r.extensionItem;return this.qb(n),r.item.tooltip=this.nb(n.tooltip),r.item.command=this.ob(r.disposableStore,n.command),r.item}}}bb(t){return this.cb(t).then(i=>i?this.bb(i).then(s=>this.db(i,s[s.length-1]).then(r=>(s.push(r),s))):Promise.resolve([]))}cb(t){const i=this.q.get(t);return i?Promise.resolve(i.parent?this.m.get(i.parent.item.handle):void 0):wi(()=>this.g.getParent(t))}async db(t,i){const s=this.q.get(t);if(s)return s;const r=await wi(()=>this.g.getTreeItem(t)),n=this.tb(t,r,i,!0);if(await this.getChildren(i?i.item.handle:void 0)===void 0){this.R.warn(`[${this.O}] Concurrent refresh detected in _resolveTreeNode for element ${n} from extension ${this.S.identifier.value}, waiting for refresh to complete`),this.P.$logResolveTreeNodeRetry(this.S.identifier.value,1,!1),await this.L;const c=this.getExtensionElement(n);if(c){const l=this.q.get(c);if(l)return l}throw this.P.$logResolveTreeNodeRetry(this.S.identifier.value,1,!0),new Error(`Cannot resolve tree item for element ${n} from extension ${this.S.identifier.value}`)}const a=this.getExtensionElement(n);if(a){const c=this.q.get(a);if(c)return c}throw new Error(`Cannot resolve tree item for element ${n} from extension ${this.S.identifier.value}`)}eb(t){if(t){let i;if(typeof t=="string"){const s=this.getExtensionElement(t);i=s?this.q.get(s):void 0}else i=t;return i&&i.children||void 0}return this.j}fb(t){return t??Vd.f}async gb(t){this.Ab(t);const i=this.fb(t),s=++this.t;this.s.set(i,s);const r=new Ke(this.hb.token);try{const n=await this.g.getChildren(t);if(this.s.get(i)!==s)return;const o=t?this.q.get(t):void 0;if(r.token.isCancellationRequested)return;const a=yt(n||[]),c=await Promise.all(yt(a).map(u=>this.g.getTreeItem(u)));if(this.s.get(i)!==s||r.token.isCancellationRequested)return;const l=c.map((u,h)=>u?this.mb(a[h],u,o):null);return this.s.get(i)!==s?void 0:yt(l)}finally{r.dispose()}}ib(t){if(t.some(s=>!s))return this.hb.dispose(!0),this.hb=new Ke,this.Ab(),this.P.$refresh(this.O);{const s=this.jb(t);if(s.length)return this.kb(s)}return Promise.resolve(void 0)}jb(t){const i=new Set,s=t.map(n=>this.q.get(n));for(const n of s)if(n&&!i.has(n.item.handle)){let o=n;for(;o&&o.parent&&s.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.m.get(o.parent.item.handle);o=a?this.q.get(a):void 0}o&&!o.parent&&i.add(n.item.handle)}const r=[];return i.forEach(n=>{const o=this.m.get(n);if(o){const a=this.q.get(o);a&&(!a.parent||!i.has(a.parent.item.handle))&&r.push(n)}}),r}kb(t){const i={};return Promise.all(t.map(s=>this.lb(s).then(r=>{r&&(i[s]=r.item)}))).then(()=>Object.keys(i).length?this.P.$refresh(this.O,i):void 0)}lb(t){const i=this.getExtensionElement(t);if(i){const s=this.q.get(i);if(s)return this.Ab(i),wi(()=>this.g.getTreeItem(i)).then(r=>{if(r){const n=this.rb(i,r,s.parent);return this.yb(i,n,s,s.parent),s.dispose(),n}return null})}return Promise.resolve(null)}mb(t,i,s){const r=i.id?`${Vd.b}/${i.id}`:void 0;if(r){const o=this.m.get(r);if(o){if(o!==t)throw new Error(d(3053,null,i.id));const a=this.q.get(o);if(a){const c=this.rb(t,i,s);return this.yb(t,c,a,s),a.dispose(),c}}}const n=this.rb(t,i,s);return this.xb(t,n),this.zb(n,s),n}nb(t){return Ni.isMarkdownString(t)?le.from(t):t}ob(t,i){return i?{...this.Q.toInternal(i,t),originalId:i.command}:void 0}pb(t){if(t.checkboxState===void 0)return;let i,s,r;return typeof t.checkboxState=="number"?i=t.checkboxState:(i=t.checkboxState.state,s=t.checkboxState.tooltip,r=t.checkboxState.accessibilityInformation),{isChecked:i===Tr.Checked,tooltip:s,accessibilityInformation:r}}qb(t){if(!Vp.isTreeItem(t,this.S))throw new Error(`Extension ${this.S.identifier.value} has provided an invalid tree item.`)}rb(t,i,s){this.qb(i);const r=this.D(new X),n=this.tb(t,i,s),o=this.ub(i);return{item:{handle:n,parentHandle:s?s.item.handle:void 0,label:EM(i.label,this.S),description:i.description,resourceUri:i.resourceUri,tooltip:this.nb(i.tooltip),command:this.ob(r,i.command),contextValue:i.contextValue,icon:o,iconDark:this.vb(i)||o,themeIcon:this.sb(i),collapsibleState:qt(i.collapsibleState)?Aa.None:i.collapsibleState,accessibilityInformation:i.accessibilityInformation,checkbox:this.pb(i)},extensionItem:i,parent:s,children:void 0,disposableStore:r,dispose(){r.dispose()}}}sb(t){return t.iconPath instanceof Ri?t.iconPath:void 0}tb(t,{id:i,label:s,resourceUri:r},n,o){if(i)return`${Vd.b}/${i}`;const a=EM(s,this.S),c=n?n.item.handle:Vd.a;let l="";a&&(Xn(a.label)?l=a.label.value:l=a.label);let u=l||(r?ji(r):"");u=u.indexOf("/")!==-1?u.replace("/","//"):u;const h=this.q.has(t)?this.q.get(t).item.handle:void 0,f=this.eb(n)||[];let p,g=0;do{if(p=`${c}/${g}:${u}`,o||!this.m.has(p)||h===p)break;g++}while(g<=f.length);return p}ub(t){if(t.iconPath&&!(t.iconPath instanceof Ri))return typeof t.iconPath=="string"||y.isUri(t.iconPath)?this.wb(t.iconPath):this.wb(t.iconPath.light)}vb(t){if(t.iconPath&&!(t.iconPath instanceof Ri)&&t.iconPath.dark)return this.wb(t.iconPath.dark)}wb(t){return y.isUri(t)?t:y.file(t)}xb(t,i){this.m.set(i.item.handle,t),this.q.set(t,i)}yb(t,i,s,r){this.m.delete(i.item.handle),this.q.delete(t),i.item.handle!==s.item.handle&&this.m.delete(s.item.handle),this.xb(t,i);const n=this.eb(r)||[],o=n.filter(a=>a.item.handle===s.item.handle)[0];o&&n.splice(n.indexOf(o),1,i)}zb(t,i){i?(i.children||(i.children=[]),i.children.push(t)):(this.j||(this.j=[]),this.j.push(t))}Ab(t){if(t){const i=this.q.get(t);if(i){if(i.children)for(const s of i.children){this.N.add(s);const r=this.m.get(s.item.handle);r&&(this.Ab(r),this.q.delete(r),this.m.delete(s.item.handle))}i.children=void 0}}else this.Bb()}Bb(){this.j=void 0,this.q.forEach(t=>{this.N.add(t)}),this.q.clear(),this.m.clear(),this.s.clear()}Cb(t){Yi(t)}Db(){this.j=void 0,this.m.clear(),Yi(this.q.values()),this.q.clear(),Yi(this.N),this.N.clear(),this.s.clear()}dispose(){super.dispose(),this.hb.dispose(),this.Db(),this.P.$disposeTree(this.O)}},_X=class LR{static{this.a=new Set([V.http,V.https])}constructor(t){this.c=new Map,this.b=t.getProxy(Q.MainThreadUriOpeners)}registerExternalUriOpener(t,i,s,r){if(this.c.has(i))throw new Error(`Opener with id '${i}' already registered`);const n=r.schemes.find(o=>!LR.a.has(o));if(n)throw new Error(`Scheme '${n}' is not supported. Only http and https are currently supported.`);return this.c.set(i,s),this.b.$registerUriOpener(i,r.schemes,t,r.label),se(()=>{this.c.delete(i),this.b.$unregisterUriOpener(i)})}async $canOpenUri(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Unknown opener with id: ${t}`);const n=y.revive(i);return r.canOpenExternalUri(n,s)}async $openUri(t,i,s){const r=this.c.get(t);if(!r)throw new Error(`Unknown opener id: '${t}'`);return r.openExternalUri(y.revive(i.resolvedUri),{sourceUri:y.revive(i.sourceUri)},s)}},BX=class extends J{#e;#t;#i;#s;#o;#n;#c;#a;#l;#u;#r;#d;#h;constructor(e,t,i,s){super(),this.#a=void 0,this.#l=!0,this.#r=!1,this.#d=this.D(new I),this.onDidDispose=this.#d.event,this.#h=this.D(new I),this.onDidChangeViewState=this.#h.event,this.#e=e,this.#t=t,this.#s=i,this.#i=s.viewType,this.#o=s.panelOptions,this.#a=s.viewColumn,this.#n=s.title,this.#u=s.active}dispose(){this.#r||(this.#r=!0,this.#d.fire(),this.#t.$disposeWebview(this.#e),this.#s.dispose(),super.dispose())}get webview(){return this.c(),this.#s}get viewType(){return this.c(),this.#i}get title(){return this.c(),this.#n}set title(e){this.c(),this.#n!==e&&(this.#n=e,this.#t.$setTitle(this.#e,e))}get iconPath(){return this.c(),this.#c}set iconPath(e){this.c(),this.#c!==e&&(this.#c=e,y.isUri(e)?this.#t.$setIconPath(this.#e,{light:e,dark:e}):this.#t.$setIconPath(this.#e,e))}get options(){return this.#o}get viewColumn(){if(this.c(),!(typeof this.#a=="number"&&this.#a<0))return this.#a}get active(){return this.c(),this.#u}get visible(){return this.c(),this.#l}_updateViewState(e){this.#r||(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn)&&(this.#u=e.active,this.#l=e.visible,this.#a=e.viewColumn,this.#h.fire({webviewPanel:this}))}reveal(e,t){this.c(),this.#t.$reveal(this.#e,{viewColumn:typeof e>"u"?void 0:si.from(e),preserveFocus:!!t})}c(){if(this.#r)throw new Error("Webview is disposed")}},qX=class OR extends J{static c(){return At()}constructor(t,i,s){super(),this.j=i,this.m=s,this.g=new Map,this.h=new Map,this.f=t.getProxy(Q.MainThreadWebviewPanels)}dispose(){super.dispose(),this.g.forEach(t=>t.dispose()),this.g.clear()}createWebviewPanel(t,i,s,r,n={}){const o=typeof r=="object"?r.viewColumn:r,a={viewColumn:si.from(o),preserveFocus:typeof r=="object"&&!!r.preserveFocus},c=jl(t),l=OR.c();this.f.$createWebviewPanel(mv(t),l,i,{title:s,panelOptions:VX(n),webviewOptions:a3(t,this.m,n),serializeBuffersForPostMessage:c},a);const u=this.j.createNewWebview(l,n,t);return this.createNewWebviewPanel(l,i,s,o,n,u,!0)}$onDidChangeWebviewPanelViewStates(t){const i=Object.keys(t);i.sort((s,r)=>{const n=t[s],o=t[r];return n.active?1:o.active?-1:+n.visible-+o.visible});for(const s of i){const r=this.getWebviewPanel(s);if(!r)continue;const n=t[s];r._updateViewState({active:n.active,visible:n.visible,viewColumn:si.to(n.position)})}}async $onDidDisposeWebviewPanel(t){this.getWebviewPanel(t)?.dispose(),this.g.delete(t),this.j.deleteWebview(t)}registerWebviewPanelSerializer(t,i,s){if(this.h.has(i))throw new Error(`Serializer for '${i}' already registered`);return this.h.set(i,{serializer:s,extension:t}),this.f.$registerSerializer(i,{serializeBuffersForPostMessage:jl(t)}),new Pe(()=>{this.h.delete(i),this.f.$unregisterSerializer(i)})}async $deserializeWebviewPanel(t,i,s,r){const n=this.h.get(i);if(!n)throw new Error(`No serializer found for '${i}'`);const{serializer:o,extension:a}=n,c=this.j.createNewWebview(t,s.webviewOptions,a),l=this.createNewWebviewPanel(t,i,s.title,r,s.panelOptions,c,s.active);await o.deserializeWebviewPanel(l,s.state)}createNewWebviewPanel(t,i,s,r,n,o,a){const c=new BX(t,this.f,o,{viewType:i,title:s,viewColumn:r,panelOptions:n,active:a});return this.g.set(t,c),c}getWebviewPanel(t){return this.g.get(t)}};function VX(e){return{enableFindWidget:e.enableFindWidget,retainContextWhenHidden:e.retainContextWhenHidden}}var GX=class extends J{#e;#t;#i;#s;#o;#n;#c;#a;#l;constructor(e,t,i,s,r,n){super(),this.#o=!1,this.#u=this.D(new I),this.onDidChangeVisibility=this.#u.event,this.#r=this.D(new I),this.onDidDispose=this.#r.event,this.#i=i,this.#c=s,this.#e=e,this.#t=t,this.#s=r,this.#n=n}dispose(){this.#o||(this.#o=!0,this.#r.fire(),this.#s.dispose(),super.dispose())}#u;#r;get title(){return this.a(),this.#c}set title(e){this.a(),this.#c!==e&&(this.#c=e,this.#t.$setWebviewViewTitle(this.#e,e))}get description(){return this.a(),this.#a}set description(e){this.a(),this.#a!==e&&(this.#a=e,this.#t.$setWebviewViewDescription(this.#e,e))}get visible(){return this.#n}get webview(){return this.#s}get viewType(){return this.#i}_setVisible(e){e===this.#n||this.#o||(this.#n=e,this.#u.fire())}get badge(){return this.a(),this.#l}set badge(e){this.a(),!(e?.value===this.#l?.value&&e?.tooltip===this.#l?.tooltip)&&(this.#l=Vg.from(e),this.#t.$setWebviewViewBadge(this.#e,e))}show(e){this.a(),this.#t.$show(this.#e,!!e)}a(){if(this.#o)throw new Error("Webview is disposed")}},JX=class{constructor(e,t){this.d=t,this.b=new Map,this.c=new Map,this.a=e.getProxy(Q.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,s){if(this.b.has(t))throw new Error(`View provider for '${t}' already registered`);return this.b.set(t,{provider:i,extension:e}),this.a.$registerWebviewViewProvider(mv(e),t,{retainContextWhenHidden:s?.retainContextWhenHidden,serializeBuffersForPostMessage:jl(e)}),new Pe(()=>{this.b.delete(t),this.a.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,s,r){const n=this.b.get(t);if(!n)throw new Error(`No view provider found for '${t}'`);const{provider:o,extension:a}=n,c=this.d.createNewWebview(e,{},a),l=new GX(e,this.a,t,i,c,!0);this.c.set(e,l),await o.resolveWebviewView(l,{state:s},r)}async $onDidChangeWebviewViewVisibility(e,t){this.e(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.e(e);this.c.delete(e),t.dispose(),this.d.deleteWebview(e)}e(e){const t=this.c.get(e);if(!t)throw new Error("No webview found");return t}},oE=class extends J{constructor(t,i){super(),this.j=i,this.b=0,this.c=new Map,this.f=0,this.g=new Map,this.h=new Map,this.a=t.getProxy(Q.MainThreadChatContext)}async $provideWorkspaceChatContext(t,i){this.m(t);const s=this.c.get(t);if(!s||s.type!=="workspace")throw new Error("Workspace context provider not found");const n=await s.provider.provideChatContext(i)??[];return this.q(t,n)}async $provideExplicitChatContext(t,i){this.m(t);const s=this.c.get(t);if(!s||s.type!=="explicit")throw new Error("Explicit context provider not found");const n=await s.provider.provideChatContext(i)??[];return this.q(t,n)}async $resolveExplicitChatContext(t,i,s){const r=this.c.get(t);if(!r||r.type!=="explicit")throw new Error("Explicit context provider not found");const n=r.provider,o=this.g.get(i.handle);if(!o)throw new Error("Chat context item not found");return this.r(n.resolveChatContext.bind(n),i,o,s)}async $provideResourceChatContext(t,i,s){const r=this.c.get(t);if(!r||r.type!=="resource")throw new Error("Resource context provider not found");const n=r.provider,o=await n.provideChatContext({resource:y.revive(i.resource)},s);if(!o)return;const c={handle:this.n(t,o),icon:o.icon,label:o.label,modelDescription:o.modelDescription,tooltip:o.tooltip?le.from(o.tooltip):void 0,value:i.withValue?o.value:void 0,command:o.command?{id:o.command.command}:void 0};if(i.withValue&&!c.value){const l=await n.resolveChatContext(o,s);c.value=l?.value,c.tooltip=l?.tooltip?le.from(l.tooltip):c.tooltip}return c}async $resolveResourceChatContext(t,i,s){const r=this.c.get(t);if(!r||r.type!=="resource")throw new Error("Resource context provider not found");const n=r.provider,o=this.g.get(i.handle);if(!o)throw new Error("Chat context item not found");return this.r(n.resolveChatContext.bind(n),i,o,s)}async $executeChatContextItemCommand(t){const i=this.g.get(t);if(!i)throw new Error("Chat context item not found");if(!i.command)throw new Error("Chat context item has no command");const s=i.command.arguments?[i,...i.command.arguments]:[i];await this.j.executeCommand(i.command.command,...s)}registerChatWorkspaceContextProvider(t,i){const s=this.b++,r=new X;return this.c.set(s,{type:"workspace",provider:i,disposables:r}),this.s(s,i,r),this.a.$registerChatWorkspaceContextProvider(s,t),{dispose:()=>{this.c.delete(s),this.m(s),this.h.delete(s),this.a.$unregisterChatContextProvider(s),r.dispose()}}}registerChatExplicitContextProvider(t,i){const s=this.b++,r=new X;return this.c.set(s,{type:"explicit",provider:i,disposables:r}),this.a.$registerChatExplicitContextProvider(s,t),{dispose:()=>{this.c.delete(s),this.m(s),this.h.delete(s),this.a.$unregisterChatContextProvider(s),r.dispose()}}}registerChatResourceContextProvider(t,i,s){const r=this.b++,n=new X;return this.c.set(r,{type:"resource",provider:s,disposables:n}),this.a.$registerChatResourceContextProvider(r,i,$a.from(t)),{dispose:()=>{this.c.delete(r),this.m(r),this.h.delete(r),this.a.$unregisterChatContextProvider(r),n.dispose()}}}registerChatContextProvider(t,i,s){const r=[];if(s.provideWorkspaceChatContext){const n={onDidChangeWorkspaceChatContext:s.onDidChangeWorkspaceChatContext,provideChatContext:o=>s.provideWorkspaceChatContext(o)};r.push(this.registerChatWorkspaceContextProvider(i,n))}if(s.provideChatContextExplicit){const n={provideChatContext:o=>s.provideChatContextExplicit(o),resolveChatContext:s.resolveChatContext?(o,a)=>s.resolveChatContext(o,a):o=>o};r.push(this.registerChatExplicitContextProvider(i,n))}if(s.provideChatContextForResource&&t){const n={provideChatContext:(o,a)=>s.provideChatContextForResource(o,a),resolveChatContext:s.resolveChatContext?(o,a)=>s.resolveChatContext(o,a):o=>o};r.push(this.registerChatResourceContextProvider(t,i,n))}return{dispose:()=>{for(const n of r)n.dispose()}}}m(t){const i=this.h.get(t);if(i){for(const s of i)this.g.delete(s);i.clear()}}n(t,i){const s=this.f++;return this.g.set(s,i),this.h.has(t)||this.h.set(t,new Set),this.h.get(t).add(s),s}q(t,i){const s=[];for(const r of i){const n=this.n(t,r);s.push({handle:n,icon:r.icon,label:r.label,modelDescription:r.modelDescription,tooltip:r.tooltip?le.from(r.tooltip):void 0,value:r.value,command:r.command?{id:r.command.command}:void 0})}return s}async r(t,i,s,r){const n=await t(s,r);return n?{handle:i.handle,icon:n.icon,label:n.label,modelDescription:n.modelDescription,tooltip:n.tooltip?le.from(n.tooltip):void 0,value:n.value,command:n.command?{id:n.command.command}:void 0}:i}s(t,i,s){if(!i.onDidChangeWorkspaceChatContext)return;const r=async()=>{const n=await i.provideChatContext(De.None),o=this.q(t,n??[]);return this.a.$updateWorkspaceContextItems(t,o)};s.add(i.onDidChangeWorkspaceChatContext(async()=>r())),r()}dispose(){super.dispose();for(const{disposables:t}of this.c.values())t.dispose()}};oE=__decorate([__param(0,Te),__param(1,Ns)],oE);function ZX(e){const t=e.get(Wt),i=e.get(bc),s=e.get(Yh),r=e.get(gn),n=e.get(Ts),o=e.get(Im),a=e.get(bs),c=e.get(ku),l=e.get(Te),u=e.get(vA),h=e.get(bA),f=e.get(Zn),p=e.get(xe),g=e.get(km),v=e.get(Ml),b=e.get(Tm),S=e.get(Mm),E=e.get(QA),k=e.get(Rl),O=e.get(e4),F=e.get(Nm),G=e.get(jA),j=e.get(HA),B=e.get(iv),H=e.get(B7);l.set(oe.ExtHostFileSystemInfo,i),l.set(oe.ExtHostLogLevelServiceShape,f),l.set(oe.ExtHostWorkspace,n),l.set(oe.ExtHostConfiguration,a),l.set(oe.ExtHostExtensionService,r),l.set(oe.ExtHostStorage,u),l.set(oe.ExtHostTunnelService,g),l.set(oe.ExtHostWindow,b),l.set(oe.ExtHostUrls,S),l.set(oe.ExtHostSecretState,E),l.set(oe.ExtHostTelemetry,o),l.set(oe.ExtHostEditorTabs,k),l.set(oe.ExtHostManagedSockets,O),l.set(oe.ExtHostProgress,F),l.set(oe.ExtHostAuthentication,G),l.set(oe.ExtHostChatProvider,j),l.set(oe.ExtHostDataChannels,H);const ie=l.set(oe.ExtHostDecorations,e.get(X8)),Ae=l.set(oe.ExtHostDocumentsAndEditors,e.get(za)),re=l.set(oe.ExtHostCommands,e.get(Ns)),$e=l.set(oe.ExtHostTerminalService,e.get(pn)),Z=l.set(oe.ExtHostTerminalShellIntegration,e.get(P4)),z=l.set(oe.ExtHostDebugService,e.get(k4)),ee=l.set(oe.ExtHostSearch,e.get(D4)),Y=l.set(oe.ExtHostTask,e.get(E4)),ae=l.set(oe.ExtHostOutputService,e.get(Q8)),ge=l.set(oe.ExtHostLocalization,e.get(KA)),we=l.set(oe.ExtHostDocuments,new JZ(l,Ae)),ht=l.set(oe.ExtHostDocumentContentProviders,new VZ(l,Ae,p)),We=l.set(oe.ExtHostDocumentSaveParticipant,new GZ(p,we,l.getProxy(Q.MainThreadBulkEdits))),Le=l.set(oe.ExtHostNotebook,new uX(l,re,Ae,we,s,ee,p)),vt=l.set(oe.ExtHostNotebookDocuments,new dX(Le)),Gt=l.set(oe.ExtHostNotebookEditors,new XS(p,Le)),jt=l.set(oe.ExtHostNotebookKernels,new KS(l,t,Le,re,p)),yi=l.set(oe.ExtHostNotebookRenderers,new wX(l,Le)),$n=l.set(oe.ExtHostNotebookDocumentSaveParticipant,new hX(p,Le,l.getProxy(Q.MainThreadBulkEdits))),ui=l.set(oe.ExtHostEditors,new LX(l,Ae)),eu=l.set(oe.ExtHostTreeViews,new HX(l.getProxy(Q.MainThreadTreeViews),re,p)),qr=l.set(oe.ExtHostEditorInsets,new xZ(l.getProxy(Q.MainThreadEditorInsets),ui,t.remote)),ds=l.set(oe.ExtHostDiagnostics,new rS(l,p,i,Ae)),Xe=l.set(oe.ExtHostLanguages,new HQ(l,we,re.converter,c)),Fe=l.set(oe.ExtHostLanguageFeatures,new vY(l,c,we,re,ds,p,v,o)),In=l.set(oe.ExtHostCodeMapper,new CZ(l)),js=l.set(oe.ExtHostFileSystem,new iY(l,Fe)),As=l.set(oe.ExtHostFileSystemEventService,new dY(l,p,Ae)),gr=l.set(oe.ExtHostQuickOpen,AX(l,n,re)),Xa=l.set(oe.ExtHostSCM,new rE(l,re,we,p)),Jd=l.set(oe.ExtHostQuickDiff,new yX(l,c)),tu=l.set(oe.ExtHostShare,new PX(l,c)),iu=l.set(oe.ExtHostComments,kZ(l,re,we)),Ka=l.set(oe.ExtHostLabelService,new pY(l)),Oi=l.set(oe.ExtHostTheming,new nE(l)),Mo=l.set(oe.ExtHostTimeline,new OX(l,re)),Et=l.set(oe.ExtHostWebviews,new LZ(l,t.remote,n,p,v)),hi=l.set(oe.ExtHostWebviewPanels,new qX(l,Et,n)),y1=l.set(oe.ExtHostCustomEditors,new HZ(l,we,h,Et,hi)),A1=l.set(oe.ExtHostWebviewViews,new JX(l,Et)),Us=l.set(oe.ExtHostTesting,e.get(ud)),su=l.set(oe.ExtHostUriOpeners,new _X(l)),P=l.set(oe.ExtHostProfileContentHandlers,new bX(l)),R=l.set(oe.ExtHostChatOutputRenderer,new gZ(l,Et));l.set(oe.ExtHostInteractive,new fY(l,Le,Ae,re,p));const L=l.set(oe.ExtHostLanguageModelTools,new zQ(l,j)),fe=l.set(oe.ExtHostChatSessions,new iS(re,j,l,p)),ve=l.set(oe.ExtHostChatAgents2,new dZ(l,p,re,we,Ae,j,ds,L)),_t=l.set(oe.ExtHostChatContext,new oE(l,re)),st=l.set(oe.ExtHostAiRelatedInformation,new rZ(l)),xi=l.set(oe.ExtHostAiEmbeddingVector,new YZ(l)),Bt=l.set(oe.ExtHostAiSettingsSearch,new nZ(l)),di=l.set(oe.ExtHostStatusBar,new RX(l,re.converter)),Ss=l.set(oe.ExtHostSpeech,new TX(l)),xt=l.set(oe.ExtHostEmbeddings,new ZZ(l));l.set(oe.ExtHostMcp,e.get(iv));const fi=Object.values(oe);l.assertRegistered(fi);const Ci=new K4(l,Ae),fs=new AZ(l),Ce=new US(l,p),Ue=new qZ(l),bt=new bZ(l);return uZ.register(re),function(x,Tt,ec){function ne(w){return(A,$,me)=>{const Qe=w(Ut=>{try{A.call($,Ut)}catch(iL){Yd(new w5(x.identifier,iL,"FAILED to handle event"))}});return me?.push(Qe),Qe}}const Ve=(function(){let w=!x.isUnderDevelopment;function A(){w||(p.info(`Extension '${x.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),w=!0)}return function $(me){if(Array.isArray(me))me.forEach($);else if(typeof me=="string")A();else{const Qe=me;typeof Qe.scheme>"u"&&A(),typeof Qe.exclusive=="boolean"&&T(x,"documentFiltersExclusive")}return me}})(),UR={getSession(w,A,$){return(typeof $?.forceNewSession=="object"&&$.forceNewSession.learnMore||typeof $?.createIfNone=="object"&&$.createIfNone.learnMore)&&T(x,"authLearnMore"),$?.authorizationServer&&T(x,"authIssuers"),G.getSession(x,w,A,$)},getAccounts(w){return G.getAccounts(w)},async hasSession(w,A){return T(x,"authSession"),!!await G.getSession(x,w,A,{silent:!0})},get onDidChangeSessions(){return ne(G.getExtensionScopedSessionsEvent(x.identifier.value))},registerAuthenticationProvider(w,A,$,me){return me?.supportedAuthorizationServers&&T(x,"authIssuers"),G.registerAuthenticationProvider(w,A,$,me)}},zR={registerCommand(w,A,$){return re.registerCommand(!0,w,A,$,void 0,x)},registerTextEditorCommand(w,A,$){return re.registerCommand(!0,w,(...me)=>{const Qe=ui.getActiveTextEditor();if(!Qe){p.warn("Cannot execute "+w+" because there is no active text editor.");return}return Qe.edit(Ut=>{A.apply($,[Qe,Ut,...me])}).then(Ut=>{Ut||p.warn("Edits from command "+w+" were not applied.")},Ut=>{p.warn("An error occurred while running command "+w,Ut)})},void 0,void 0,x)},registerDiffInformationCommand:(w,A,$)=>(T(x,"diffCommand"),re.registerCommand(!0,w,async(...me)=>{const Qe=Ae.activeEditor(!0);if(!Qe){p.warn("Cannot execute "+w+" because there is no active text editor.");return}const Ut=await ui.getDiffInformation(Qe.id);A.apply($,[Ut,...me])},void 0,void 0,x)),executeCommand(w,...A){return re.executeCommand(w,...A)},getCommands(w=!1){return re.getCommands(w)}},ax={get machineId(){return t.telemetryInfo.machineId},get devDeviceId(){return T(x,"devDeviceId"),t.telemetryInfo.devDeviceId??t.telemetryInfo.machineId},get isAppPortable(){return T(x,"envIsAppPortable"),t.environment.isPortable??!1},get sessionId(){return t.telemetryInfo.sessionId},get language(){return t.environment.appLanguage},get appName(){return t.environment.appName},get appRoot(){return t.environment.appRoot?.fsPath??""},get appHost(){return t.environment.appHost},get uriScheme(){return t.environment.appUriScheme},get clipboard(){return fs.value},get shell(){return $e.getDefaultShell(!1)},get onDidChangeShell(){return ne($e.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return ne(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return T(x,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return T(x,"telemetry"),ne(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return K9(t.telemetryInfo.firstSessionDate)},createTelemetryLogger(w,A){return X9.validateSender(w),o.instantiateLogger(x,w,A)},async openExternal(w,A){return b.openUri(w,{allowTunneling:t.remote.isRemote??(t.remote.authority?await g.hasTunnelProvider():!1),allowContributedOpeners:A?.allowContributedOpeners})},async asExternalUri(w){if(w.scheme===t.environment.appUriScheme)return S.createAppUri(w);try{return await b.asExternalUri(w,{allowTunneling:!!t.remote.authority})}catch(A){if(K1(w,V.http)||K1(w,V.https))return w;throw A}},get remoteName(){return p5(t.remote.authority)},get remoteAuthority(){return T(x,"resolvers"),t.remote.authority},get uiKind(){return t.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return ne(p.onDidChangeLogLevel)},get appQuality(){return T(x,"resolvers"),t.quality},get appCommit(){return T(x,"resolvers"),t.commit},getDataChannel(w){return T(x,"dataChannels"),H.createDataChannel(x,w)}};t.environment.extensionTestsLocationURI||Object.freeze(ax);const HR={createTestController(w,A,$){return Us.createTestController(x,w,A,$)},createTestObserver(){return T(x,"testObserver"),Us.createTestObserver()},runTests(w){return T(x,"testObserver"),Us.runTests(w)},registerTestFollowupProvider(w){return T(x,"testObserver"),Us.registerTestFollowupProvider(w)},get onDidChangeTestResults(){return T(x,"testObserver"),ne(Us.onResultsChanged)},get testResults(){return T(x,"testObserver"),Us.results}},Zd=t.remote.isRemote?xa.Workspace:xa.UI,WR={getExtension(w,A){qe(x,"extensionsAny")||(A=!1);const $=Tt.mine.getExtensionDescription(w);if($)return new ed(r,x.identifier,$,Zd,!1);if(A){const me=Tt.all.getExtensionDescription(w);if(me)return new ed(r,x.identifier,me,Zd,!0)}},get all(){const w=[];for(const A of Tt.mine.getAllExtensionDescriptions())w.push(new ed(r,x.identifier,A,Zd,!1));return w},get allAcrossExtensionHosts(){T(x,"extensionsAny");const w=new Qo(Tt.mine.getAllExtensionDescriptions().map($=>$.identifier)),A=[];for(const $ of Tt.all.getAllExtensionDescriptions()){const me=!w.has($.identifier);A.push(new ed(r,x.identifier,$,Zd,me))}return A},get onDidChange(){return qe(x,"extensionsAny")?ne(Ie.any(Tt.mine.onDidChange,Tt.all.onDidChange)):ne(Tt.mine.onDidChange)}},_R={createDiagnosticCollection(w){return ds.createDiagnosticCollection(x.identifier,w)},get onDidChangeDiagnostics(){return ne(ds.onDidChangeDiagnostics)},getDiagnostics:w=>ds.getDiagnostics(w),getLanguages(){return Xe.getLanguages()},setTextDocumentLanguage(w,A){return Xe.changeLanguage(w.uri,A)},match(w,A){const $=Ey.from(w);let me;return PP($)&&(me=Le.notebookDocuments.find(Qe=>Qe.apiNotebook.getCells().find(Ut=>Ut.document===A))?.apiNotebook),DP($,A.uri,A.languageId,!0,me?.uri,me?.notebookType)},registerCodeActionsProvider(w,A,$){return Fe.registerCodeActionProvider(x,Ve(w),A,$)},registerDocumentPasteEditProvider(w,A,$){return Fe.registerDocumentPasteEditProvider(x,Ve(w),A,$)},registerCodeLensProvider(w,A){return Fe.registerCodeLensProvider(x,Ve(w),A)},registerDefinitionProvider(w,A){return Fe.registerDefinitionProvider(x,Ve(w),A)},registerDeclarationProvider(w,A){return Fe.registerDeclarationProvider(x,Ve(w),A)},registerImplementationProvider(w,A){return Fe.registerImplementationProvider(x,Ve(w),A)},registerTypeDefinitionProvider(w,A){return Fe.registerTypeDefinitionProvider(x,Ve(w),A)},registerHoverProvider(w,A){return Fe.registerHoverProvider(x,Ve(w),A,x.identifier)},registerEvaluatableExpressionProvider(w,A){return Fe.registerEvaluatableExpressionProvider(x,Ve(w),A,x.identifier)},registerInlineValuesProvider(w,A){return Fe.registerInlineValuesProvider(x,Ve(w),A,x.identifier)},registerDocumentHighlightProvider(w,A){return Fe.registerDocumentHighlightProvider(x,Ve(w),A)},registerMultiDocumentHighlightProvider(w,A){return Fe.registerMultiDocumentHighlightProvider(x,Ve(w),A)},registerLinkedEditingRangeProvider(w,A){return Fe.registerLinkedEditingRangeProvider(x,Ve(w),A)},registerReferenceProvider(w,A){return Fe.registerReferenceProvider(x,Ve(w),A)},registerRenameProvider(w,A){return Fe.registerRenameProvider(x,Ve(w),A)},registerNewSymbolNamesProvider(w,A){return T(x,"newSymbolNamesProvider"),Fe.registerNewSymbolNamesProvider(x,Ve(w),A)},registerDocumentSymbolProvider(w,A,$){return Fe.registerDocumentSymbolProvider(x,Ve(w),A,$)},registerWorkspaceSymbolProvider(w){return Fe.registerWorkspaceSymbolProvider(x,w)},registerDocumentFormattingEditProvider(w,A){return Fe.registerDocumentFormattingEditProvider(x,Ve(w),A)},registerDocumentRangeFormattingEditProvider(w,A){return Fe.registerDocumentRangeFormattingEditProvider(x,Ve(w),A)},registerOnTypeFormattingEditProvider(w,A,$,...me){return Fe.registerOnTypeFormattingEditProvider(x,Ve(w),A,[$].concat(me))},registerDocumentSemanticTokensProvider(w,A,$){return Fe.registerDocumentSemanticTokensProvider(x,Ve(w),A,$)},registerDocumentRangeSemanticTokensProvider(w,A,$){return Fe.registerDocumentRangeSemanticTokensProvider(x,Ve(w),A,$)},registerSignatureHelpProvider(w,A,$,...me){return typeof $=="object"?Fe.registerSignatureHelpProvider(x,Ve(w),A,$):Fe.registerSignatureHelpProvider(x,Ve(w),A,typeof $>"u"?[]:[$,...me])},registerCompletionItemProvider(w,A,...$){return Fe.registerCompletionItemProvider(x,Ve(w),A,$)},registerInlineCompletionItemProvider(w,A,$){return A.handleDidShowCompletionItem&&T(x,"inlineCompletionsAdditions"),A.handleDidPartiallyAcceptCompletionItem&&T(x,"inlineCompletionsAdditions"),$&&T(x,"inlineCompletionsAdditions"),Fe.registerInlineCompletionsProvider(x,Ve(w),A,$)},get inlineCompletionsUnificationState(){return T(x,"inlineCompletionsAdditions"),Fe.inlineCompletionsUnificationState},onDidChangeCompletionsUnificationState(w,A,$){return T(x,"inlineCompletionsAdditions"),ne(Fe.onDidChangeInlineCompletionsUnificationState)(w,A,$)},registerDocumentLinkProvider(w,A){return Fe.registerDocumentLinkProvider(x,Ve(w),A)},registerColorProvider(w,A){return Fe.registerColorProvider(x,Ve(w),A)},registerFoldingRangeProvider(w,A){return Fe.registerFoldingRangeProvider(x,Ve(w),A)},registerSelectionRangeProvider(w,A){return Fe.registerSelectionRangeProvider(x,w,A)},registerCallHierarchyProvider(w,A){return Fe.registerCallHierarchyProvider(x,w,A)},registerTypeHierarchyProvider(w,A){return Fe.registerTypeHierarchyProvider(x,w,A)},setLanguageConfiguration:(w,A)=>Fe.setLanguageConfiguration(x,w,A),getTokenInformationAtPosition(w,A){return T(x,"tokenInformation"),Xe.tokenAtPosition(w,A)},registerInlayHintsProvider(w,A){return Fe.registerInlayHintsProvider(x,w,A)},createLanguageStatusItem(w,A){return Xe.createLanguageStatusItem(x,w,A)},registerDocumentDropEditProvider(w,A,$){return Fe.registerDocumentOnDropEditProvider(x,w,A,$)}},BR={get activeTextEditor(){return ui.getActiveTextEditor()},get visibleTextEditors(){return ui.getVisibleTextEditors()},get activeTerminal(){return $e.activeTerminal},get terminals(){return $e.terminals},async showTextDocument(w,A,$){y.isUri(w)&&w.scheme===V.vscodeRemote&&!w.authority&&v.report("workspace.showTextDocument",x,"A URI of 'vscode-remote' scheme requires an authority.");const me=await(y.isUri(w)?Promise.resolve(cx.openTextDocument(w)):Promise.resolve(w));return ui.showTextDocument(me,A,$)},createTextEditorDecorationType(w){return ui.createTextEditorDecorationType(x,w)},onDidChangeActiveTextEditor(w,A,$){return ne(ui.onDidChangeActiveTextEditor)(w,A,$)},onDidChangeVisibleTextEditors(w,A,$){return ne(ui.onDidChangeVisibleTextEditors)(w,A,$)},onDidChangeTextEditorSelection(w,A,$){return ne(ui.onDidChangeTextEditorSelection)(w,A,$)},onDidChangeTextEditorOptions(w,A,$){return ne(ui.onDidChangeTextEditorOptions)(w,A,$)},onDidChangeTextEditorVisibleRanges(w,A,$){return ne(ui.onDidChangeTextEditorVisibleRanges)(w,A,$)},onDidChangeTextEditorViewColumn(w,A,$){return ne(ui.onDidChangeTextEditorViewColumn)(w,A,$)},onDidChangeTextEditorDiffInformation(w,A,$){return T(x,"textEditorDiffInformation"),ne(ui.onDidChangeTextEditorDiffInformation)(w,A,$)},onDidCloseTerminal(w,A,$){return ne($e.onDidCloseTerminal)(w,A,$)},onDidOpenTerminal(w,A,$){return ne($e.onDidOpenTerminal)(w,A,$)},onDidChangeActiveTerminal(w,A,$){return ne($e.onDidChangeActiveTerminal)(w,A,$)},onDidChangeTerminalDimensions(w,A,$){return T(x,"terminalDimensions"),ne($e.onDidChangeTerminalDimensions)(w,A,$)},onDidChangeTerminalState(w,A,$){return ne($e.onDidChangeTerminalState)(w,A,$)},onDidWriteTerminalData(w,A,$){return T(x,"terminalDataWriteEvent"),ne($e.onDidWriteTerminalData)(w,A,$)},onDidExecuteTerminalCommand(w,A,$){return T(x,"terminalExecuteCommandEvent"),ne($e.onDidExecuteTerminalCommand)(w,A,$)},onDidChangeTerminalShellIntegration(w,A,$){return ne(Z.onDidChangeTerminalShellIntegration)(w,A,$)},onDidStartTerminalShellExecution(w,A,$){return ne(Z.onDidStartTerminalShellExecution)(w,A,$)},onDidEndTerminalShellExecution(w,A,$){return ne(Z.onDidEndTerminalShellExecution)(w,A,$)},get state(){return b.getState()},onDidChangeWindowState(w,A,$){return ne(b.onDidChangeWindowState)(w,A,$)},showInformationMessage(w,...A){return Ce.showMessage(x,rt.Info,w,A[0],A.slice(1))},showWarningMessage(w,...A){return Ce.showMessage(x,rt.Warning,w,A[0],A.slice(1))},showErrorMessage(w,...A){return Ce.showMessage(x,rt.Error,w,A[0],A.slice(1))},showQuickPick(w,A,$){return gr.showQuickPick(x,w,A,$)},showWorkspaceFolderPick(w){return gr.showWorkspaceFolderPick(w)},showInputBox(w,A){return gr.showInput(w,A)},showOpenDialog(w){return Ue.showOpenDialog(w)},showSaveDialog(w){return Ue.showSaveDialog(w)},createStatusBarItem(w,A,$){let me,Qe,Ut;return typeof w=="string"?(me=w,Qe=A,Ut=$):(Qe=w,Ut=A),di.createStatusBarEntry(x,me,Qe,Ut)},setStatusBarMessage(w,A){return di.setStatusBarMessage(w,A)},withScmProgress(w){return v.report("window.withScmProgress",x,"Use 'withProgress' instead."),F.withProgress(x,{location:fo.SourceControl},(A,$)=>w({report(me){}}))},withProgress(w,A){return F.withProgress(x,w,A)},createOutputChannel(w,A){return ae.createOutputChannel(w,A,x)},createWebviewPanel(w,A,$,me){return hi.createWebviewPanel(x,w,A,$,me)},createWebviewTextEditorInset(w,A,$,me){return T(x,"editorInsets"),qr.createWebviewEditorInset(w,A,$,me,x)},createTerminal(w,A,$){return typeof w=="object"?"pty"in w?$e.createExtensionTerminal(w):$e.createTerminalFromOptions(w):$e.createTerminal(w,A,$)},registerTerminalLinkProvider(w){return $e.registerLinkProvider(w)},registerTerminalProfileProvider(w,A){return $e.registerProfileProvider(x,w,A)},registerTerminalCompletionProvider(w,...A){return T(x,"terminalCompletionProvider"),$e.registerTerminalCompletionProvider(x,w,...A)},registerTerminalQuickFixProvider(w,A){return T(x,"terminalQuickFixProvider"),$e.registerTerminalQuickFixProvider(w,x.identifier.value,A)},registerTreeDataProvider(w,A){return eu.registerTreeDataProvider(w,A,x)},createTreeView(w,A){return eu.createTreeView(w,A,x)},registerWebviewPanelSerializer:(w,A)=>hi.registerWebviewPanelSerializer(x,w,A),registerCustomEditorProvider:(w,A,$={})=>y1.registerCustomEditorProvider(x,w,A,$),registerFileDecorationProvider(w){return ie.registerFileDecorationProvider(w,x)},registerUriHandler(w){return S.registerUriHandler(x,w)},createQuickPick(){return gr.createQuickPick(x)},createInputBox(){return gr.createInputBox(x)},get activeColorTheme(){return Oi.activeColorTheme},onDidChangeActiveColorTheme(w,A,$){return ne(Oi.onDidChangeActiveColorTheme)(w,A,$)},registerWebviewViewProvider(w,A,$){return A1.registerWebviewViewProvider(x,w,A,$?.webviewOptions)},get activeNotebookEditor(){return Le.activeNotebookEditor},onDidChangeActiveNotebookEditor(w,A,$){return ne(Le.onDidChangeActiveNotebookEditor)(w,A,$)},get visibleNotebookEditors(){return Le.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return ne(Le.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(w,A,$){return ne(Gt.onDidChangeNotebookEditorSelection)(w,A,$)},onDidChangeNotebookEditorVisibleRanges(w,A,$){return ne(Gt.onDidChangeNotebookEditorVisibleRanges)(w,A,$)},showNotebookDocument(w,A){return Le.showNotebookDocument(w,A)},registerExternalUriOpener(w,A,$){return T(x,"externalUriOpener"),su.registerExternalUriOpener(x.identifier,w,A,$)},registerProfileContentHandler(w,A){return T(x,"profileContentHandlers"),P.registerProfileContentHandler(x,w,A)},registerQuickDiffProvider(w,A,$,me,Qe){return T(x,"quickDiffProvider"),Jd.registerQuickDiffProvider(x,Ve(w),A,$,me,Qe)},get tabGroups(){return k.tabGroups},registerShareProvider(w,A){return T(x,"shareProvider"),tu.registerShareProvider(Ve(w),A)},get nativeHandle(){return T(x,"nativeWindowHandle"),b.nativeHandle},createChatStatusItem:w=>(T(x,"chatStatusItem"),bt.createChatStatusItem(x,w))},cx={get rootPath(){return v.report("workspace.rootPath",x,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),n.getPath()},set rootPath(w){throw new No("rootPath")},getWorkspaceFolder(w){return n.getWorkspaceFolder(w)},get workspaceFolders(){return n.getWorkspaceFolders()},get name(){return n.name},set name(w){throw new No("name")},get workspaceFile(){return n.workspaceFile},set workspaceFile(w){throw new No("workspaceFile")},get isAgentSessionsWorkspace(){return T(x,"agentSessionsWorkspace"),n.isAgentSessionsWorkspace},updateWorkspaceFolders:(w,A,...$)=>n.updateWorkspaceFolders(x,w,A||0,...$),onDidChangeWorkspaceFolders:function(w,A,$){return ne(n.onDidChangeWorkspace)(w,A,$)},asRelativePath:(w,A)=>n.getRelativePath(w,A),findFiles:(w,A,$,me)=>n.findFiles(w,A,$,x.identifier,me),findFiles2:(w,A,$)=>(T(x,"findFiles2"),n.findFiles2(w,A,x.identifier,$)),findTextInFiles:(w,A,$,me)=>{T(x,"findTextInFiles");let Qe,Ut;return typeof A=="object"?(Qe=A,Ut=$):(Qe={},Ut=A,me=$),n.findTextInFiles(w,Qe||{},Ut,x.identifier,me)},findTextInFiles2:(w,A,$)=>(T(x,"findTextInFiles2"),T(x,"textSearchProvider2"),n.findTextInFiles2(w,A,x.identifier,$)),save:w=>n.save(w),saveAs:w=>n.saveAs(w),saveAll:w=>n.saveAll(w),applyEdit(w,A){return Ci.applyWorkspaceEdit(w,x,A)},createFileSystemWatcher:(w,A,$,me)=>{const Qe={ignoreCreateEvents:!!A,ignoreChangeEvents:!!$,ignoreDeleteEvents:!!me};return As.createFileSystemWatcher(n,ec,i,x,w,Qe)},get textDocuments(){return we.getAllDocumentData().map(w=>w.document)},set textDocuments(w){throw new No("textDocuments")},openTextDocument(w,A){let $;if(A=A??w,typeof w=="string")$=Promise.resolve(y.file(w));else if(y.isUri(w))$=Promise.resolve(w);else if(!A||typeof A=="object")$=we.createDocumentData(A);else throw new Error("illegal argument - uriOrFileNameOrOptions");return $.then(me=>(p.trace(`openTextDocument from ${x.identifier}`),me.scheme===V.vscodeRemote&&!me.authority&&v.report("workspace.openTextDocument",x,"A URI of 'vscode-remote' scheme requires an authority."),we.ensureDocumentData(me,A).then(Qe=>Qe.document)))},onDidOpenTextDocument:(w,A,$)=>ne(we.onDidAddDocument)(w,A,$),onDidCloseTextDocument:(w,A,$)=>ne(we.onDidRemoveDocument)(w,A,$),onDidChangeTextDocument:(w,A,$)=>qe(x,"textDocumentChangeReason")?ne(we.onDidChangeDocumentWithReason)(w,A,$):ne(we.onDidChangeDocument)(w,A,$),onDidSaveTextDocument:(w,A,$)=>ne(we.onDidSaveDocument)(w,A,$),onWillSaveTextDocument:(w,A,$)=>ne(We.getOnWillSaveTextDocumentEvent(x))(w,A,$),get notebookDocuments(){return Le.notebookDocuments.map(w=>w.apiNotebook)},async openNotebookDocument(w,A){let $;if(y.isUri(w))$=w,await Le.openNotebookDocument(w);else if(typeof w=="string")$=y.revive(await Le.createNotebookDocument({viewType:w,content:A}));else throw new Error("Invalid arguments");return Le.getNotebookDocument($).apiNotebook},onDidSaveNotebookDocument(w,A,$){return ne(vt.onDidSaveNotebookDocument)(w,A,$)},onDidChangeNotebookDocument(w,A,$){return ne(vt.onDidChangeNotebookDocument)(w,A,$)},onWillSaveNotebookDocument(w,A,$){return ne($n.getOnWillSaveNotebookDocumentEvent(x))(w,A,$)},get onDidOpenNotebookDocument(){return ne(Le.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return ne(Le.onDidCloseNotebookDocument)},registerNotebookSerializer(w,A,$,me){return Le.registerNotebookSerializer(x,w,A,$,qe(x,"notebookLiveShare")?me:void 0)},onDidChangeConfiguration:(w,A,$)=>ne(ec.onDidChangeConfiguration)(w,A,$),getConfiguration(w,A){return A=arguments.length===1?void 0:A,ec.getConfiguration(w,A,x)},registerTextDocumentContentProvider(w,A){return ht.registerTextDocumentContentProvider(w,A)},registerTaskProvider:(w,A)=>(v.report("window.registerTaskProvider",x,"Use the corresponding function on the 'tasks' namespace instead"),Y.registerTaskProvider(x,w,A)),registerFileSystemProvider(w,A,$){return F1(js.registerFileSystemProvider(x,w,A,$),s.addFileSystemProvider(w,A,$))},get fs(){return s.value},registerFileSearchProvider:(w,A)=>(T(x,"fileSearchProvider"),ee.registerFileSearchProviderOld(w,A)),registerTextSearchProvider:(w,A)=>(T(x,"textSearchProvider"),ee.registerTextSearchProviderOld(w,A)),registerAITextSearchProvider:(w,A)=>(T(x,"aiTextSearchProvider"),T(x,"textSearchProvider2"),ee.registerAITextSearchProvider(w,A)),registerFileSearchProvider2:(w,A)=>(T(x,"fileSearchProvider2"),ee.registerFileSearchProvider(w,A)),registerTextSearchProvider2:(w,A)=>(T(x,"textSearchProvider2"),ee.registerTextSearchProvider(w,A)),registerRemoteAuthorityResolver:(w,A)=>(T(x,"resolvers"),r.registerRemoteAuthorityResolver(w,A)),registerResourceLabelFormatter:w=>(T(x,"resolvers"),Ka.$registerResourceLabelFormatter(w)),getRemoteExecServer:w=>(T(x,"resolvers"),r.getRemoteExecServer(w)),onDidCreateFiles:(w,A,$)=>ne(As.onDidCreateFile)(w,A,$),onDidDeleteFiles:(w,A,$)=>ne(As.onDidDeleteFile)(w,A,$),onDidRenameFiles:(w,A,$)=>ne(As.onDidRenameFile)(w,A,$),onWillCreateFiles:(w,A,$)=>ne(As.getOnWillCreateFileEvent(x))(w,A,$),onWillDeleteFiles:(w,A,$)=>ne(As.getOnWillDeleteFileEvent(x))(w,A,$),onWillRenameFiles:(w,A,$)=>ne(As.getOnWillRenameFileEvent(x))(w,A,$),openTunnel:w=>(T(x,"tunnels"),g.openTunnel(x,w).then(A=>{if(!A)throw new Error("cannot open tunnel");return A})),get tunnels(){return T(x,"tunnels"),g.getTunnels()},onDidChangeTunnels:(w,A,$)=>(T(x,"tunnels"),ne(g.onDidChangeTunnels)(w,A,$)),registerPortAttributesProvider:(w,A)=>(T(x,"portsAttributes"),g.registerPortsAttributesProvider(w,A)),registerTunnelProvider:(w,A)=>(T(x,"tunnelFactory"),g.registerTunnelProvider(w,A)),registerTimelineProvider:(w,A)=>(T(x,"timeline"),Mo.registerTimelineProvider(w,A,x.identifier,re.converter)),get isTrusted(){return n.trusted},requestResourceTrust:w=>(T(x,"workspaceTrust"),n.requestResourceTrust(w)),requestWorkspaceTrust:w=>(T(x,"workspaceTrust"),n.requestWorkspaceTrust(w)),isResourceTrusted:w=>(T(x,"workspaceTrust"),n.isResourceTrusted(w)),onDidChangeWorkspaceTrustedFolders:(w,A,$)=>(T(x,"workspaceTrust"),ne(n.onDidChangeWorkspaceTrustedFolders)(w,A,$)),onDidGrantWorkspaceTrust:(w,A,$)=>ne(n.onDidGrantWorkspaceTrust)(w,A,$),registerEditSessionIdentityProvider:(w,A)=>(T(x,"editSessionIdentityProvider"),n.registerEditSessionIdentityProvider(w,A)),onWillCreateEditSessionIdentity:(w,A,$)=>(T(x,"editSessionIdentityProvider"),ne(n.getOnWillCreateEditSessionIdentityEvent(x))(w,A,$)),registerCanonicalUriProvider:(w,A)=>(T(x,"canonicalUriProvider"),n.registerCanonicalUriProvider(w,A)),getCanonicalUri:(w,A,$)=>(T(x,"canonicalUriProvider"),n.provideCanonicalUri(w,A,$)),decode(w,A){return n.decode(w,A)},encode(w,A){return n.encode(w,A)}},qR={get inputBox(){return v.report("scm.inputBox",x,"Use 'SourceControl.inputBox' instead"),Xa.getLastInputBox(x)},createSourceControl(w,A,$,me,Qe,Ut){return(me||Qe||Ut)&&T(x,"scmProviderOptions"),Xa.createSourceControl(x,w,A,$,me,Qe,Ut)}},VR={createCommentController(w,A){return iu.createCommentController(x,w,A)}},GR={get activeDebugSession(){return z.activeDebugSession},get activeDebugConsole(){return z.activeDebugConsole},get breakpoints(){return z.breakpoints},get activeStackItem(){return z.activeStackItem},registerDebugVisualizationProvider(w,A){return T(x,"debugVisualization"),z.registerDebugVisualizationProvider(x,w,A)},registerDebugVisualizationTreeProvider(w,A){return T(x,"debugVisualization"),z.registerDebugVisualizationTree(x,w,A)},onDidStartDebugSession(w,A,$){return ne(z.onDidStartDebugSession)(w,A,$)},onDidTerminateDebugSession(w,A,$){return ne(z.onDidTerminateDebugSession)(w,A,$)},onDidChangeActiveDebugSession(w,A,$){return ne(z.onDidChangeActiveDebugSession)(w,A,$)},onDidReceiveDebugSessionCustomEvent(w,A,$){return ne(z.onDidReceiveDebugSessionCustomEvent)(w,A,$)},onDidChangeBreakpoints(w,A,$){return ne(z.onDidChangeBreakpoints)(w,A,$)},onDidChangeActiveStackItem(w,A,$){return ne(z.onDidChangeActiveStackItem)(w,A,$)},registerDebugConfigurationProvider(w,A,$){return z.registerDebugConfigurationProvider(w,A,$||fv.Initial)},registerDebugAdapterDescriptorFactory(w,A){return z.registerDebugAdapterDescriptorFactory(x,w,A)},registerDebugAdapterTrackerFactory(w,A){return z.registerDebugAdapterTrackerFactory(w,A)},startDebugging(w,A,$){return!$||typeof $=="object"&&"configuration"in $?z.startDebugging(w,A,{parentSession:$}):z.startDebugging(w,A,$||{})},stopDebugging(w){return z.stopDebugging(w)},addBreakpoints(w){return z.addBreakpoints(w)},removeBreakpoints(w){return z.removeBreakpoints(w)},asDebugSourceUri(w,A){return z.asDebugSourceUri(w,A)}},JR={registerTaskProvider:(w,A)=>Y.registerTaskProvider(x,w,A),fetchTasks:w=>Y.fetchTasks(w),executeTask:w=>Y.executeTask(x,w),get taskExecutions(){return Y.taskExecutions},onDidStartTask:(w,A,$)=>{const me=Qe=>{qe(x,"taskExecutionTerminal")||Qe?.execution?.terminal!==void 0&&(Qe.execution.terminal=void 0);const Ut={...Qe,execution:Qe.execution};return w.call(A,Ut)};return ne(Y.onDidStartTask)(me,A,$)},onDidEndTask:(w,A,$)=>ne(Y.onDidEndTask)(w,A,$),onDidStartTaskProcess:(w,A,$)=>ne(Y.onDidStartTaskProcess)(w,A,$),onDidEndTaskProcess:(w,A,$)=>ne(Y.onDidEndTaskProcess)(w,A,$),onDidStartTaskProblemMatchers:(w,A,$)=>(T(x,"taskProblemMatcherStatus"),ne(Y.onDidStartTaskProblemMatchers)(w,A,$)),onDidEndTaskProblemMatchers:(w,A,$)=>(T(x,"taskProblemMatcherStatus"),ne(Y.onDidEndTaskProblemMatchers)(w,A,$))},ZR={createNotebookController(w,A,$,me,Qe){return jt.createNotebookController(x,w,A,$,me,qe(x,"notebookMessaging")?Qe:void 0)},registerNotebookCellStatusBarItemProvider:(w,A)=>Le.registerNotebookCellStatusBarItemProvider(x,w,A),createRendererMessaging(w){return yi.createRendererMessaging(x,w)},createNotebookControllerDetectionTask(w){return T(x,"notebookKernelSource"),jt.createNotebookControllerDetectionTask(x,w)},registerKernelSourceActionProvider(w,A){return T(x,"notebookKernelSource"),jt.registerKernelSourceActionProvider(x,w,A)}},YR={t(...w){if(typeof w[0]=="string"){const A=w.shift(),$=!w||typeof w[0]!="object"?w:w[0];return ge.getMessage(x.identifier.value,{message:A,args:$})}return ge.getMessage(x.identifier.value,w[0])},get bundle(){return ge.getBundle(x.identifier.value)},get uri(){return ge.getBundleUri(x.identifier.value)}},QR={transferActiveChat(w){return T(x,"interactive"),ve.transferActiveChat(w)}},XR={getRelatedInformation(w,A){return T(x,"aiRelatedInformation"),st.getRelatedInformation(x,w,A)},registerRelatedInformationProvider(w,A){return T(x,"aiRelatedInformation"),st.registerRelatedInformationProvider(x,w,A)},registerEmbeddingVectorProvider(w,A){return T(x,"aiRelatedInformation"),xi.registerEmbeddingVectorProvider(x,w,A)},registerSettingsSearchProvider(w){return T(x,"aiSettingsSearch"),Bt.registerSettingsSearchProvider(x,w)}},KR={registerMappedEditsProvider(w,A){return T(x,"mappedEditsProvider"),{dispose(){}}},registerMappedEditsProvider2(w){return T(x,"mappedEditsProvider"),In.registerMappedEditsProvider(x,w)},createChatParticipant(w,A){return ve.createChatAgent(x,w,A)},createDynamicChatParticipant(w,A,$){return T(x,"chatParticipantPrivate"),ve.createDynamicChatAgent(x,w,A,$)},registerChatParticipantDetectionProvider(w){return T(x,"chatParticipantPrivate"),ve.registerChatParticipantDetectionProvider(x,w)},onDidDisposeChatSession:(w,A,$)=>(T(x,"chatParticipantPrivate"),ne(ve.onDidDisposeChatSession)(w,A,$)),registerChatSessionItemProvider:(w,A)=>(T(x,"chatSessionsProvider"),fe.registerChatSessionItemProvider(x,w,A)),createChatSessionItemController:(w,A)=>(T(x,"chatSessionsProvider"),fe.createChatSessionItemController(x,w,A)),registerChatSessionContentProvider(w,A,$,me){return T(x,"chatSessionsProvider"),fe.registerChatSessionContentProvider(x,w,$,A,me)},registerChatOutputRenderer:(w,A)=>(T(x,"chatOutputRenderer"),R.registerChatOutputRenderer(x,w,A)),registerChatWorkspaceContextProvider(w,A){return T(x,"chatContextProvider"),_t.registerChatWorkspaceContextProvider(`${x.id}-${w}`,A)},registerChatExplicitContextProvider(w,A){return T(x,"chatContextProvider"),_t.registerChatExplicitContextProvider(`${x.id}-${w}`,A)},registerChatResourceContextProvider(w,A,$){return T(x,"chatContextProvider"),_t.registerChatResourceContextProvider(Ve(w),`${x.id}-${A}`,$)},registerChatContextProvider(w,A,$){return T(x,"chatContextProvider"),_t.registerChatContextProvider(w?Ve(w):void 0,`${x.id}-${A}`,$)},registerCustomAgentProvider(w){return T(x,"chatPromptFiles"),ve.registerPromptFileProvider(x,ft.agent,w)},registerInstructionsProvider(w){return T(x,"chatPromptFiles"),ve.registerPromptFileProvider(x,ft.instructions,w)},registerPromptFileProvider(w){return T(x,"chatPromptFiles"),ve.registerPromptFileProvider(x,ft.prompt,w)},registerSkillProvider(w){return T(x,"chatPromptFiles"),ve.registerPromptFileProvider(x,ft.skill,w)}},eL={selectChatModels:w=>j.selectLanguageModels(x,w??{}),onDidChangeChatModels:(w,A,$)=>j.onDidChangeProviders(w,A,$),registerLanguageModelChatProvider:(w,A)=>j.registerLanguageModelChatProvider(x,w,A),get isModelProxyAvailable(){return T(x,"languageModelProxy"),j.isModelProxyAvailable},onDidChangeModelProxyAvailability:(w,A,$)=>(T(x,"languageModelProxy"),j.onDidChangeModelProxyAvailability(w,A,$)),getModelProxy:()=>(T(x,"languageModelProxy"),j.getModelProxy(x)),registerLanguageModelProxyProvider:w=>(T(x,"chatParticipantPrivate"),j.registerLanguageModelProxyProvider(x,w)),get embeddingModels(){return T(x,"embeddings"),xt.embeddingsModels},onDidChangeEmbeddingModels:(w,A,$)=>(T(x,"embeddings"),xt.onDidChange(w,A,$)),registerEmbeddingsProvider(w,A){return T(x,"embeddings"),xt.registerEmbeddingsProvider(x,w,A)},async computeEmbeddings(w,A,$){return T(x,"embeddings"),xt.computeEmbeddings(w,A,$)},registerTool(w,A){return L.registerTool(x,w,A)},registerToolDefinition(w,A){return L.registerToolDefinition(x,w,A)},invokeTool(w,A,$){return typeof w!="string"&&T(x,"chatParticipantAdditions"),L.invokeTool(x,w,A,$)},get tools(){return L.getTools(x)},fileIsIgnored(w,A){return j.fileIsIgnored(x,w,A)},registerIgnoredFileProvider(w){return j.registerIgnoredFileProvider(x,w)},registerMcpServerDefinitionProvider(w,A){return B.registerMcpConfigurationProvider(x,w,A)},onDidChangeMcpServerDefinitions:(...w)=>(T(x,"mcpServerDefinitions"),ne(B.onDidChangeMcpServerDefinitions)(...w)),get mcpServerDefinitions(){return T(x,"mcpServerDefinitions"),B.mcpServerDefinitions},onDidChangeChatRequestTools(...w){return T(x,"chatParticipantAdditions"),ne(ve.onDidChangeChatRequestTools)(...w)}},tL={registerSpeechProvider(w,A){return T(x,"speech"),Ss.registerProvider(x.identifier,w,A)}};return{version:t.version,ai:XR,authentication:UR,commands:zR,comments:VR,chat:KR,debug:GR,env:ax,extensions:WR,interactive:QR,l10n:YR,languages:_R,lm:eL,notebooks:ZR,scm:qR,speech:tL,tasks:JR,tests:HR,window:BR,workspace:cx,Breakpoint:Kc,TerminalOutputAnchor:Zw,ChatResultFeedbackKind:xh,ChatVariableLevel:Ub,ChatCompletionItem:J_,ChatReferenceDiagnostic:Xb,CallHierarchyIncomingCall:LD,CallHierarchyItem:Qw,CallHierarchyOutgoingCall:OD,CancellationError:dt,CancellationTokenSource:Ke,CandidatePortSource:x0,CodeAction:rh,CodeActionKind:Pt,CodeActionTriggerKind:sh,CodeLens:Fp,Color:Gc,ColorInformation:_p,ColorPresentation:Bp,ColorThemeKind:go,CommentMode:yb,CommentState:Ab,CommentThreadCollapsibleState:mh,CommentThreadState:vh,CommentThreadApplicability:wh,CommentThreadFocus:bh,CompletionItem:zp,CompletionItemKind:be,CompletionItemTag:oh,CompletionList:zc,CompletionTriggerKind:Uc,ConfigurationTarget:Qc,CustomExecution:fb,DebugAdapterExecutable:el,DebugAdapterInlineImplementation:fh,DebugAdapterNamedPipeServer:dh,DebugAdapterServer:tl,DebugConfigurationProviderTriggerKind:fv,DebugConsoleMode:tg,DebugVisualization:H_,DecorationRangeBehavior:ba,Diagnostic:$p,DiagnosticRelatedInformation:Xu,DiagnosticSeverity:bi,DiagnosticTag:da,Disposable:Pe,DocumentHighlight:Lp,DocumentHighlightKind:th,MultiDocumentHighlight:Op,DocumentLink:Wp,DocumentSymbol:ih,EndOfLine:er,EnvironmentVariableMutatorType:Fc,EvaluatableExpression:Yp,InlineValueText:Qp,InlineValueVariableLookup:Xp,InlineValueEvaluatableExpression:Kp,InlineCompletionTriggerKind:ph,InlineCompletionsDisposeReasonKind:on,EventEmitter:I,ExtensionKind:xa,ExtensionMode:nl,ExternalUriOpenerPriority:Db,FileChangeType:il,FileDecoration:xb,FileDecoration2:xb,FileSystemError:ii,FileType:ss,FilePermission:Er,FoldingRange:bb,FoldingRangeKind:an,FunctionBreakpoint:Ea,InlineCompletionItem:sb,InlineCompletionList:rb,Hover:Np,VerboseHover:Rp,HoverVerbosityAction:Yw,IndentAction:Y4,Location:ns,MarkdownString:Ni,OverviewRulerLane:BA,ParameterInformation:Xw,PortAutoForwardAction:Tb,Position:Re,ProcessExecution:Zc,ProgressLocation:fo,QuickInputButtonLocation:Eb,QuickInputButtons:yh,Range:ke,RelativePattern:Xc,Selection:Ir,SelectionRange:nh,SemanticTokens:sl,SemanticTokensBuilder:z_,SemanticTokensEdit:WD,SemanticTokensEdits:eg,SemanticTokensLegend:Sb,ShellExecution:ya,ShellQuoting:db,SignatureHelp:eb,SignatureHelpTriggerKind:tb,SignatureInformation:Kw,SnippetString:ga,SourceBreakpoint:Sa,StandardTokenType:mo,StatusBarAlignment:uo,SymbolInformation:eh,SymbolKind:gt,SymbolTag:Ku,Task:qp,TaskEventKind:ub,TaskGroup:uh,TaskPanelKind:hb,TaskRevealKind:lb,TaskScope:ho,TerminalLink:I_,TerminalQuickFixTerminalCommand:P_,TerminalQuickFixOpener:D_,TerminalLocation:ab,TerminalProfile:T_,TerminalExitReason:nb,TerminalShellExecutionCommandLineConfidence:lh,TerminalCompletionItem:M_,TerminalCompletionItemKind:cb,TerminalCompletionList:N_,TerminalShellType:ob,TextDocumentSaveReason:_c,TextEdit:lo,SnippetTextEdit:Bw,TextEditorCursorStyle:$s,TextEditorChangeKind:qc,TextEditorLineNumbersStyle:tr,TextEditorRevealType:Hp,TextEditorSelectionChangeKind:Bc,SyntaxTokenType:Vc,TextDocumentChangeReason:ch,ThemeColor:hh,ThemeIcon:Ri,TreeItem:Vp,TreeItemCheckboxState:Tr,TreeItemCollapsibleState:Aa,TypeHierarchyItem:Mb,UIKind:Kh,Uri:y,ViewColumn:ah,WorkspaceEdit:va,DocumentPasteTriggerKind:mb,DocumentDropEdit:gb,DocumentDropOrPasteEditKind:po,DocumentPasteEdit:O_,InlayHint:Up,InlayHintLabelPart:jp,InlayHintKind:ib,RemoteAuthorityResolverError:Oc,ResolvedAuthority:k_,ManagedResolvedAuthority:Mp,SourceControlInputBoxValidationType:Jc,ExtensionRuntime:og,TimelineItem:$b,NotebookRange:$r,NotebookCellKind:fa,NotebookCellExecutionState:Cb,NotebookCellData:Ip,NotebookData:PD,NotebookRendererScript:_D,NotebookCellStatusBarAlignment:sg,NotebookEditorRevealType:rg,NotebookCellOutput:Pp,NotebookCellOutputItem:TD,CellErrorStackFrame:W_,NotebookCellStatusBarItem:__,NotebookControllerAffinity:kb,NotebookControllerAffinity2:ng,NotebookEdit:Dp,NotebookKernelSourceAction:B_,NotebookVariablesRequestKind:Sh,PortAttributes:V_,LinkedEditingRanges:q_,TestResultState:Ib,TestRunRequest:ag,TestMessage:cg,TestMessageStackFrame:G_,TestTag:Eh,TestRunProfileKind:ol,TextSearchCompleteMessageType:dm,DataTransfer:Yc,DataTransferItem:Gp,TestCoverageCount:lg,FileCoverage:hg,StatementCoverage:qD,BranchCoverage:VD,DeclarationCoverage:GD,WorkspaceTrustState:Pb,LanguageStatusSeverity:jc,QuickPickItemKind:Ah,InputBoxValidationSeverity:rl,TabInputText:Nb,TabInputTextDiff:dg,TabInputTextMerge:JD,TabInputCustom:Rb,TabInputNotebook:Lb,TabInputNotebookDiff:Ob,TabInputWebview:ZD,TabInputTerminal:YD,TabInputInteractiveWindow:QD,TabInputChat:XD,TabInputTextMultiDiff:KD,TelemetryTrustedValue:Uw,LogLevel:K,EditSessionIdentityMatch:Q4,InteractiveSessionVoteDirection:Fb,ChatCopyKind:jb,ChatSessionChangedFile:Q_,ChatSessionChangedFile2:X_,ChatEditingSessionActionOutcome:Mr,InteractiveEditorResponseFeedbackKind:Hb,DebugStackFrame:zD,DebugThread:HD,RelatedInformationType:ty,SpeechToTextStatus:sy,TextToSpeechStatus:ry,PartialAcceptTriggerKind:wa,InlineCompletionEndOfLifeReasonKind:Hc,InlineCompletionDisplayLocationKind:Wc,KeywordRecognitionStatus:ny,ChatImageMimeType:ey,ChatResponseMarkdownPart:fg,ChatResponseFileTreePart:gg,ChatResponseAnchorPart:kh,ChatResponseProgressPart:Bb,ChatResponseProgressPart2:mg,ChatResponseThinkingProgressPart:al,ChatResponseHookPart:vg,ChatResponseReferencePart:Ca,ChatResponseReferencePart2:Ca,ChatResponseCodeCitationPart:yg,ChatResponseCodeblockUriPart:bg,ChatResponseWarningPart:$h,ChatResponseTextEditPart:Dh,ChatResponseNotebookEditPart:Sg,ChatResponseWorkspaceEditPart:Gb,ChatResponseMarkdownWithVulnerabilitiesPart:Ch,ChatResponseCommandButtonPart:wg,ChatResponseConfirmationPart:pg,ChatQuestion:e9,ChatQuestionType:Nr,ChatResponseQuestionCarouselPart:Ih,ChatResponseMovePart:Ag,ChatResponseExtensionsPart:qb,ChatResponseExternalEditPart:_b,ChatResponsePullRequestPart:Vb,ChatResponseMultiDiffPart:Wb,ChatResponseReferencePartStatusKind:Yb,ChatResponseClearToPreviousToolInvocationReason:Qb,ChatRequestTurn:Eg,ChatRequestTurn2:Eg,ChatResponseTurn:t9,ChatResponseTurn2:Y_,ChatToolInvocationPart:Jb,ChatLocation:ir,ChatSessionStatus:Zb,ChatRequestEditorData:i9,ChatRequestNotebookData:s9,ChatReferenceBinaryData:r9,ChatRequestEditedFileEventKind:zb,LanguageModelChatMessageRole:os,LanguageModelChatMessage:n9,LanguageModelChatMessage2:o9,LanguageModelToolResultPart:cl,LanguageModelToolResultPart2:cl,LanguageModelTextPart:Xt,LanguageModelTextPart2:Xt,LanguageModelPartAudience:xg,ToolResultAudience:xg,LanguageModelToolCallPart:ka,LanguageModelThinkingPart:ll,LanguageModelError:cn,LanguageModelToolResult:Cg,LanguageModelToolResult2:K_,LanguageModelDataPart:Li,LanguageModelDataPart2:Li,LanguageModelToolExtensionSource:a9,LanguageModelToolMCPSource:c9,ExtendedLanguageModelToolResult:eB,LanguageModelChatToolMode:kg,LanguageModelPromptTsxPart:vo,NewSymbolName:j_,NewSymbolNameTag:wb,NewSymbolNameTriggerKind:gh,ExcludeSettingOptions:dn,TextSearchContext2:hm,TextSearchMatch2:hn,AISearchKeyword:Qy,TextSearchCompleteMessageTypeNew:dm,ChatErrorLevel:Kb,McpHttpServerDefinition:ay,McpHttpServerDefinition2:ay,McpStdioServerDefinition:oy,McpStdioServerDefinition2:oy,McpToolAvailability:$g,McpToolInvocationContentData:Z_,SettingsSearchResultKind:iy}}}var Gv,Jv=class{constructor(t,i,s,r,n,o,a){this.c=t,this.d=i,this.f=s,this.g=r,this.h=n,this.i=o,this.j=a,this.a=new Map,this.b=[]}async install(){this.k(),Ht("code/extHost/willWaitForConfig");const t=await this.g.getConfigProvider();Ht("code/extHost/didWaitForConfig");const i=await this.h.getExtensionPathIndex();this.register(new YX(this.c,i,this.d,t,this.j)),this.register(this.f.createInstance(aE)),this.i.remote.isRemote&&this.register(this.f.createInstance(cE,i,this.i.environment.appUriScheme))}register(t){if("nodeModuleName"in t)if(Array.isArray(t.nodeModuleName))for(const i of t.nodeModuleName)this.a.set(i,t);else this.a.set(t.nodeModuleName,t);typeof t.alternativeModuleName=="function"&&this.b.push(i=>t.alternativeModuleName(i))}};Jv=__decorate([__param(2,Yo),__param(3,bs),__param(4,gn),__param(5,Wt),__param(6,xe)],Jv);var aE=class{static{Gv=this}static{this.a=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(t){if(t.environment.appRoot&&Gv.a.size){const i=On(this.c(t.environment.appRoot.fsPath)),s="[a-z0-9_.-]",r=`@${s}+\\/${s}+|${s}+`,n="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.b=new RegExp(`^(${i}/${n}\\/)(${r})(.*)$`,"i")}}alternativeModuleName(t){if(!this.b)return;const i=this.b.exec(this.c(t));if(!i)return;const[,s,r,n]=i,o=Gv.a.get(r);if(o!==void 0)return console.warn(`${r} as been renamed to ${o}, please update your imports`),s+o+n}c(t){return t.replace(/\\/g,"/")}};aE=Gv=__decorate([__param(0,Wt)],aE);var YX=class{constructor(e,t,i,s,r){this.c=e,this.d=t,this.e=i,this.f=s,this.g=r,this.nodeModuleName="vscode",this.a=new Gn}load(e,t){const i=this.d.findSubstr(t);if(i){let s=this.a.get(i.identifier);return s||(s=this.c(i,this.e,this.f),this.a.set(i.identifier,s)),s}if(!this.b){let s="";this.d.forEach((r,n)=>s+=`	${n} -> ${r.identifier.value}
`),this.g.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${s}`),this.b=this.c(p_,this.e,this.f)}return this.b}},cE=class{constructor(t,i,s){this.e=t,this.f=i,this.nodeModuleName=["open","opn"],this.d=s.getProxy(Q.MainThreadTelemetry);const r=s.getProxy(Q.MainThreadWindow);this.c=(n,o)=>{const a=y.parse(n);return o?this.g(n,o):a.scheme==="http"||a.scheme==="https"?r.$openUri(a,n,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this.f?r.$openUri(a,n,{}):this.g(n,o)}}load(t,i,s){const r=this.e.findSubstr(i);return r&&(this.a=r.identifier.value,this.h()),this.b=s(t),this.c}g(t,i){return this.i(),this.b(t,i)}h(){this.a&&this.d.$publicLog2("shimming.open",{extension:this.a})}i(){this.a&&this.d.$publicLog2("shimming.open.call.noForward",{extension:this.a})}};cE=__decorate([__param(2,Te)],cE);import{LogLevel as qa,createHttpPatch as xM,createProxyResolver as QX,createTlsPatch as XX,createNetPatch as KX,loadSystemCertificates as CM}from"@vscode/proxy-agent";import{createRequire as eK}from"node:module";import{parse as kM}from"url";import{spawn as tK}from"child_process";import{userInfo as iK}from"os";import*as $M from"os";var IM=/^\d+$/,sK=/^Microsoft.PowerShell_.*/,rK=/^Microsoft.PowerShellPreview_.*/,DM;(function(e){e[e.x64=0]="x64",e[e.x86=1]="x86",e[e.ARM=2]="ARM"})(DM||(DM={}));var Id;switch(process.arch){case"ia32":Id=1;break;case"arm":case"arm64":Id=2;break;default:Id=0;break}var _l;process.env.PROCESSOR_ARCHITEW6432?_l=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?_l=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?_l=1:_l=0;var Dd=class{constructor(e,t,i){this.exePath=e,this.displayName=t,this.a=i}async exists(){return this.a===void 0&&(this.a=await Ui.existsFile(this.exePath)),this.a}};function nK({useAlternateBitness:e=!1}={}){return e?Id===0?process.env["ProgramFiles(x86)"]||null:_l===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function Zv({useAlternateBitness:e=!1,findPreview:t=!1}={}){const i=nK({useAlternateBitness:e});if(!i)return null;const s=Ge(i,"PowerShell");if(!await Ui.existsDirectory(s))return null;let r=-1,n=null;for(const c of await at.readdir(s)){let l=-1;if(t){const h=c.indexOf("-");if(h<0)continue;const f=c.substring(0,h);if(!IM.test(f)||c.substring(h+1)!=="preview")continue;l=parseInt(f,10)}else{if(!IM.test(c))continue;l=parseInt(c,10)}if(l<=r)continue;const u=Ge(s,c,"pwsh.exe");await Ui.existsFile(u)&&(n=u,r=l)}if(!n)return null;const o=i.includes("x86")?" (x86)":"",a=t?" Preview":"";return new Dd(n,`PowerShell${a}${o}`,!0)}async function PM({findPreview:e}={}){if(!process.env.LOCALAPPDATA)return null;const t=Ge(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await Ui.existsDirectory(t))return null;const{pwshMsixDirRegex:i,pwshMsixName:s}=e?{pwshMsixDirRegex:rK,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:sK,pwshMsixName:"PowerShell (Store)"};for(const r of await at.readdir(t))if(i.test(r)){const n=Ge(t,r,"pwsh.exe");return new Dd(n,s)}return null}function oK(){const e=Ge($M.homedir(),".dotnet","tools","pwsh.exe");return new Dd(e,".NET Core PowerShell Global Tool")}function aK(){const e=Ge($M.homedir(),"scoop","apps"),t=Ge(e,"pwsh","current","pwsh.exe");return new Dd(t,"PowerShell (Scoop)")}function cK(){const e=Ge(process.env.windir,Id===1&&_l!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new Dd(e,"Windows PowerShell",!0)}async function*lK(){let e=await Zv();e&&(yield e),e=await Zv({useAlternateBitness:!0}),e&&(yield e),e=await PM(),e&&(yield e),e=oK(),e&&(yield e),e=await Zv({findPreview:!0}),e&&(yield e),e=await PM({findPreview:!0}),e&&(yield e),e=await Zv({useAlternateBitness:!0,findPreview:!0}),e&&(yield e),e=await aK(),e&&(yield e),e=cK(),e&&(yield e)}async function*uK(){for await(const e of lK())await e.exists()&&(yield e)}async function hK(){for await(const e of uK())return e;return null}async function dK(e,t){return e===1?ze?pK():Z7(t):fK(e,t)}var lE=null;function fK(e,t){if(Mt&&e===2||Nt&&e===3)return"/bin/bash";if(!lE){let i;if(ze)i="/bin/bash";else{if(i=t.SHELL,!i)try{i=iK().shell}catch{}i||(i="sh"),i==="/bin/false"&&(i="/bin/bash")}lE=i}return lE}var uE=null;async function pK(){return uE||(uE=(await hK()).exePath),uE}import"assert";var whe=ux(hx(),1),bhe={o:d(1895,null),e:d(1896,null),t:d(1897,null),m:d(1898,null)},yhe={chat:{type:"subcommand",description:"Pass in a prompt to run in a chat session in the current working directory.",options:{_:{type:"string[]",description:d(1899,null)},mode:{type:"string",cat:"o",alias:"m",args:"mode",description:d(1900,null)},"add-file":{type:"string[]",cat:"o",alias:"a",args:"path",description:d(1901,null)},maximize:{type:"boolean",cat:"o",description:d(1902,null)},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:d(1903,null)},"new-window":{type:"boolean",cat:"o",alias:"n",description:d(1904,null)},profile:{type:"string",cat:"o",args:"profileName",description:d(1905,null)},help:{type:"boolean",alias:"h",description:d(1906,null)}}},"serve-web":{type:"subcommand",description:"Run a server that displays the editor UI in browsers.",options:{"cli-data-dir":{type:"string",args:"dir",description:d(1907,null)},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"}}},tunnel:{type:"subcommand",description:"Make the current machine accessible from vscode.dev or other machines through a secure tunnel.",options:{"cli-data-dir":{type:"string",args:"dir",description:d(1908,null)},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"},user:{type:"subcommand",options:{login:{type:"subcommand",options:{provider:{type:"string"},"access-token":{type:"string"}}}}}}},diff:{type:"boolean",cat:"o",alias:"d",args:["file","file"],description:d(1909,null)},merge:{type:"boolean",cat:"o",alias:"m",args:["path1","path2","base","result"],description:d(1910,null)},add:{type:"boolean",cat:"o",alias:"a",args:"folder",description:d(1911,null)},remove:{type:"boolean",cat:"o",args:"folder",description:d(1912,null)},goto:{type:"boolean",cat:"o",alias:"g",args:"file:line[:character]",description:d(1913,null)},"new-window":{type:"boolean",cat:"o",alias:"n",description:d(1914,null)},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:d(1915,null)},wait:{type:"boolean",cat:"o",alias:"w",description:d(1916,null)},waitMarkerFilePath:{type:"string"},locale:{type:"string",cat:"o",args:"locale",description:d(1917,null)},"user-data-dir":{type:"string",cat:"o",args:"dir",description:d(1918,null)},profile:{type:"string",cat:"o",args:"profileName",description:d(1919,null)},help:{type:"boolean",cat:"o",alias:"h",description:d(1920,null)},"extensions-dir":{type:"string",deprecates:["extensionHomePath"],cat:"e",args:"dir",description:d(1921,null)},"extensions-download-dir":{type:"string"},"builtin-extensions-dir":{type:"string"},"list-extensions":{type:"boolean",cat:"e",description:d(1922,null)},"show-versions":{type:"boolean",cat:"e",description:d(1923,null)},category:{type:"string",allowEmptyValue:!0,cat:"e",description:d(1924,null),args:"category"},"install-extension":{type:"string[]",cat:"e",args:"ext-id | path",description:d(1925,null)},"pre-release":{type:"boolean",cat:"e",description:d(1926,null)},"uninstall-extension":{type:"string[]",cat:"e",args:"ext-id",description:d(1927,null)},"update-extensions":{type:"boolean",cat:"e",description:d(1928,null)},"enable-proposed-api":{type:"string[]",allowEmptyValue:!0,cat:"e",args:"ext-id",description:d(1929,null)},"add-mcp":{type:"string[]",cat:"m",args:"json",description:d(1930,null)},version:{type:"boolean",cat:"t",alias:"v",description:d(1931,null)},verbose:{type:"boolean",cat:"t",global:!0,description:d(1932,null)},log:{type:"string[]",cat:"t",args:"level",global:!0,description:d(1933,null)},status:{type:"boolean",alias:"s",cat:"t",description:d(1934,null)},"prof-startup":{type:"boolean",cat:"t",description:d(1935,null)},"prof-append-timers":{type:"string"},"prof-duration-markers":{type:"string[]"},"prof-duration-markers-file":{type:"string"},"no-cached-data":{type:"boolean"},"prof-startup-prefix":{type:"string"},"prof-v8-extensions":{type:"boolean"},"disable-extensions":{type:"boolean",deprecates:["disableExtensions"],cat:"t",description:d(1936,null)},"disable-extension":{type:"string[]",cat:"t",args:"ext-id",description:d(1937,null)},sync:{type:"string",cat:"t",description:d(1938,null),args:["on | off"]},"inspect-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugPluginHost"],args:"port",cat:"t",description:d(1939,null)},"inspect-brk-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugBrkPluginHost"],args:"port",cat:"t",description:d(1940,null)},"disable-lcd-text":{type:"boolean",cat:"t",description:d(1941,null)},"disable-gpu":{type:"boolean",cat:"t",description:d(1942,null)},"disable-chromium-sandbox":{type:"boolean",cat:"t",description:d(1943,null)},sandbox:{type:"boolean"},"locate-shell-integration-path":{type:"string",cat:"t",args:["shell"],description:d(1944,null)},telemetry:{type:"boolean",cat:"t",description:d(1945,null)},remote:{type:"string",allowEmptyValue:!0},"folder-uri":{type:"string[]",cat:"o",args:"uri"},"file-uri":{type:"string[]",cat:"o",args:"uri"},"locate-extension":{type:"string[]"},extensionDevelopmentPath:{type:"string[]"},extensionDevelopmentKind:{type:"string[]"},extensionTestsPath:{type:"string"},extensionEnvironment:{type:"string"},debugId:{type:"string"},debugRenderer:{type:"boolean"},"inspect-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-brk-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-search":{type:"string",deprecates:["debugSearch"],allowEmptyValue:!0},"inspect-brk-search":{type:"string",deprecates:["debugBrkSearch"],allowEmptyValue:!0},"inspect-sharedprocess":{type:"string",allowEmptyValue:!0},"inspect-brk-sharedprocess":{type:"string",allowEmptyValue:!0},"export-default-configuration":{type:"string"},"export-policy-data":{type:"string",allowEmptyValue:!0},"install-source":{type:"string"},"enable-smoke-test-driver":{type:"boolean"},logExtensionHostCommunication:{type:"boolean"},"skip-release-notes":{type:"boolean"},"skip-welcome":{type:"boolean"},"disable-telemetry":{type:"boolean"},"disable-updates":{type:"boolean"},transient:{type:"boolean",cat:"t",description:d(1946,null)},"use-inmemory-secretstorage":{type:"boolean",deprecates:["disable-keytar"]},"password-store":{type:"string"},"disable-workspace-trust":{type:"boolean"},"disable-crash-reporter":{type:"boolean"},"crash-reporter-directory":{type:"string"},"crash-reporter-id":{type:"string"},"skip-add-to-recently-opened":{type:"boolean"},"open-url":{type:"boolean"},"file-write":{type:"boolean"},"file-chmod":{type:"boolean"},"install-builtin-extension":{type:"string[]"},force:{type:"boolean"},"do-not-sync":{type:"boolean"},"do-not-include-pack-dependencies":{type:"boolean"},trace:{type:"boolean"},"trace-memory-infra":{type:"boolean"},"trace-category-filter":{type:"string"},"trace-options":{type:"string"},"preserve-env":{type:"boolean"},"force-user-env":{type:"boolean"},"force-disable-user-env":{type:"boolean"},"open-devtools":{type:"boolean"},"disable-gpu-sandbox":{type:"boolean"},logsPath:{type:"string"},"__enable-file-policy":{type:"boolean"},editSessionId:{type:"string"},continueOn:{type:"string"},"enable-coi":{type:"boolean"},"unresponsive-sample-interval":{type:"string"},"unresponsive-sample-period":{type:"string"},"enable-rdp-display-tracking":{type:"boolean"},"disable-layout-restore":{type:"boolean"},"disable-experiments":{type:"boolean"},"no-proxy-server":{type:"boolean"},"no-sandbox":{type:"boolean",alias:"sandbox"},"proxy-server":{type:"string"},"proxy-bypass-list":{type:"string"},"proxy-pac-url":{type:"string"},"js-flags":{type:"string"},inspect:{type:"string",allowEmptyValue:!0},"inspect-brk":{type:"string",allowEmptyValue:!0},nolazy:{type:"boolean"},"force-device-scale-factor":{type:"string"},"force-renderer-accessibility":{type:"boolean"},"ignore-certificate-errors":{type:"boolean"},"allow-insecure-localhost":{type:"boolean"},"log-net-log":{type:"string"},vmodule:{type:"string"},_urls:{type:"string[]"},"disable-dev-shm-usage":{type:"boolean"},"profile-temp":{type:"boolean"},"ozone-platform":{type:"string"},"enable-tracing":{type:"string"},"trace-startup-format":{type:"string"},"trace-startup-file":{type:"string"},"trace-startup-duration":{type:"string"},"xdg-portal-required-version":{type:"string"},_:{type:"string[]"}};function TM(e){return e.VSCODE_CLI==="1"}var hE=void 0;async function gK(e,t,i,s){return i["force-disable-user-env"]?(t.trace("resolveShellEnv(): skipped (--force-disable-user-env)"),{}):ze?(t.trace("resolveShellEnv(): skipped (Windows)"),{}):TM(s)&&!i["force-user-env"]?(t.trace("resolveShellEnv(): skipped (VSCODE_CLI is set)"),{}):(TM(s)?t.trace("resolveShellEnv(): running (--force-user-env)"):t.trace("resolveShellEnv(): running (macOS/Linux)"),hE||(hE=Hn.withAsyncBody(async(r,n)=>{const o=new Ke;let a=1e4;const c=e.getValue("application.shellEnvironmentResolutionTimeout");typeof c=="number"&&(a=WU(c,1,120)*1e3);const l=setTimeout(()=>{o.dispose(!0),n(new Error(d(2315,null)))},a);try{r(await mK(t,o.token))}catch(u){!ki(u)&&!o.token.isCancellationRequested?n(new Error(d(2316,null,yr(u)))):r({})}finally{clearTimeout(l),o.dispose()}})),hE)}async function mK(e,t){const i=process.env.ELECTRON_RUN_AS_NODE;e.trace("getUnixShellEnvironment#runAsNode",i);const s=process.env.ELECTRON_NO_ATTACH_CONSOLE;e.trace("getUnixShellEnvironment#noAttach",s);const r=At().replace(/-/g,"").substr(0,12),n=new RegExp(r+"({.*})"+r),o={...process.env,ELECTRON_RUN_AS_NODE:"1",ELECTRON_NO_ATTACH_CONSOLE:"1",VSCODE_RESOLVING_ENVIRONMENT:"1"};e.trace("getUnixShellEnvironment#env",o);const a=await dK(Nn,o);return e.trace("getUnixShellEnvironment#shell",a),new Promise((c,l)=>{if(t.isCancellationRequested)return l(new dt);const u=$t(a);let h,f;const p="";/^(?:pwsh|powershell)(?:-preview)?$/.test(u)?(h=`& '${process.execPath}' ${p} -p '''${r}'' + JSON.stringify(process.env) + ''${r}'''`,f=["-Login","-Command"]):u==="nu"?(h=`^'${process.execPath}' ${p} -p '"${r}" + JSON.stringify(process.env) + "${r}"'`,f=["-i","-l","-c"]):u==="xonsh"?(h=`import os, json; print("${r}", json.dumps(dict(os.environ)), "${r}")`,f=["-i","-l","-c"]):(h=`'${process.execPath}' ${p} -p '"${r}" + JSON.stringify(process.env) + "${r}"'`,u==="tcsh"||u==="csh"?f=["-ic"]:f=["-i","-l","-c"]),e.trace("getUnixShellEnvironment#spawn",JSON.stringify(f),h);const g=tK(a,[...f,h],{detached:!0,stdio:["ignore","pipe","pipe"],env:o});t.onCancellationRequested(()=>(g.kill(),l(new dt))),g.on("error",S=>{e.error("getUnixShellEnvironment#errorChildProcess",yr(S)),l(S)});const v=[];g.stdout.on("data",S=>v.push(S));const b=[];g.stderr.on("data",S=>b.push(S)),g.on("close",(S,E)=>{const k=Buffer.concat(v).toString("utf8");e.trace("getUnixShellEnvironment#raw",k);const O=Buffer.concat(b).toString("utf8");if(O.trim()&&e.trace("getUnixShellEnvironment#stderr",O),S||E)return l(new Error(d(2317,null,S,E)));const F=n.exec(k),G=F?F[1]:"{}";try{const j=JSON.parse(G);i?j.ELECTRON_RUN_AS_NODE=i:delete j.ELECTRON_RUN_AS_NODE,s?j.ELECTRON_NO_ATTACH_CONSOLE=s:delete j.ELECTRON_NO_ATTACH_CONSOLE,delete j.VSCODE_RESOLVING_ENVIRONMENT,delete j.XDG_RUNTIME_DIR,e.trace("getUnixShellEnvironment#result",j),c(j)}catch(j){e.error("getUnixShellEnvironment#errorCaught",yr(j)),l(j)}})})}import{parse as MM}from"url";function vK(e,t){return e.protocol==="http:"?t.HTTP_PROXY||t.http_proxy||null:e.protocol==="https:"&&(t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy)||null}async function wK(e,t,i={}){const s=MM(e),r=i.proxyUrl||vK(s,t);if(!r)return null;const n=MM(r);if(!/^https?:$/.test(n.protocol||""))return null;const o={host:n.hostname||"",port:(n.port?+n.port:0)||(n.protocol==="https"?443:80),auth:n.auth,rejectUnauthorized:Ex(i.strictSSL)?i.strictSSL:!0};if(s.protocol==="http:"){const{default:a}=await import("http-proxy-agent");return new a.HttpProxyAgent(r,o)}else{const{default:a}=await import("https-proxy-agent");return new a.HttpsProxyAgent(r,o)}}import{createGunzip as bK}from"zlib";var yK=new Set(["EAI_AGAIN","ECONNREFUSED","EHOSTDOWN","EHOSTUNREACH","ENETDOWN","ENETUNREACH","EPROTO"]),AK=/^(GET|HEAD|OPTIONS)$/i;function SK(e){if(e instanceof Error){const t=e.code;return!!t&&yK.has(t)}return!1}var NM=class extends ZY{constructor(t,i,s,r){super(r),this.m=t,this.n=i,this.q=s,this.r(),this.D(i.onDidChangeConfiguration(n=>{n.affectsConfiguration("http")&&this.r()}))}r(){this.f=this.s("http.proxy"),this.g=!!this.s("http.proxyStrictSSL"),this.h=this.s("http.proxyAuthorization")}async request(t,i){const{f:s,g:r}=this;let n;try{n=await gK(this.n,this.b,this.q.args,process.env)}catch(c){this.j||(this.j=!0,this.b.error("resolving shell environment failed",Xd(c)))}const o={...process.env,...n},a=t.agent?t.agent:await wK(t.url||"",o,{proxyUrl:s,strictSSL:r});return t.agent=a,t.strictSSL=r,this.h&&(t.headers={...t.headers||{},"Proxy-Authorization":this.h}),this.c(t,()=>LM(t,i))}async resolveProxy(t){}async lookupAuthorization(t){}async lookupKerberosAuthorization(t){try{const i=this.s("http.proxyKerberosServicePrincipal");return"Negotiate "+await RM(t,i,this.b,"RequestService#lookupKerberosAuthorization")}catch(i){this.b.debug("RequestService#lookupKerberosAuthorization Kerberos authentication failed",i);return}}async loadCertificates(){return(await import("@vscode/proxy-agent")).loadSystemCertificates({loadSystemCertificatesFromNode:()=>this.s("http.systemCertificatesNode",Tv),log:this.b})}s(t,i){if(this.m==="remote")return this.n.getValue(t);const s=this.n.inspect(t);return s.userLocalValue??s.defaultValue??i}};NM=__decorate([__param(1,rs),__param(2,Gq),__param(3,xe)],NM);async function RM(e,t,i,s){const r=await import("kerberos"),n=r.default||r,o=new URL(e),a=t||(process.platform==="win32"?`HTTP/${o.hostname}`:`HTTP@${o.hostname}`);return i.debug(`${s} Kerberos authentication lookup`,`proxyURL:${o}`,`spn:${a}`),(await n.initializeClient(a)).step("")}async function EK(e){return(kM(e.url).protocol==="https:"?await import("https"):await import("http")).request}async function LM(e,t){let s;const r=AK.test(e.type||"GET");for(let n=1;n<=3;n++)try{return await xK(e,t)}catch(o){if(s=o,o instanceof dt||!r||!SK(o)||n===3)throw o;await Kt(100*n,t)}throw s}async function xK(e,t){return Hn.withAsyncBody(async(i,s)=>{const r=kM(e.url),n=e.getRawRequest?e.getRawRequest(e):await EK(e),o={hostname:r.hostname,port:r.port?parseInt(r.port):r.protocol==="https:"?443:80,protocol:r.protocol,path:r.path,method:e.type||"GET",headers:e.headers,agent:e.agent,rejectUnauthorized:Ex(e.strictSSL)?e.strictSSL:!0};e.user&&e.password&&(o.auth=e.user+":"+e.password),e.disableCache&&(o.cache="no-store");const a=n(o,l=>{const u=xs(e.followRedirects)?e.followRedirects:3;if(l.statusCode&&l.statusCode>=300&&l.statusCode<400&&u>0&&l.headers.location)LM({...e,url:l.headers.location,followRedirects:u-1},t).then(i,s);else{let h=l;!e.isChromiumNetwork&&l.headers["content-encoding"]==="gzip"&&(h=l.pipe(bK())),i({res:l,stream:iF(h)})}});if(a.on("error",s),e.timeout)if(e.isChromiumNetwork){const l=setTimeout(()=>{a.abort(),s(new Error(`Request timeout after ${e.timeout}ms`))},e.timeout);a.on("response",()=>clearTimeout(l)),a.on("error",()=>clearTimeout(l)),a.on("abort",()=>clearTimeout(l))}else a.setTimeout(e.timeout);e.isChromiumNetwork&&a.removeHeader("Content-Length"),e.data&&typeof e.data=="string"&&a.write(e.data),a.end();const c=t.onCancellationRequested(()=>{c.dispose(),a.abort(),s(new dt)});a.on("response",()=>c.dispose()),a.on("error",()=>c.dispose())})}import*as Yv from"@vscode/proxy-agent";var Bl=eK(import.meta.url),OM=Bl("http"),Qv=Bl("https"),FM=Bl("tls"),jM=Bl("net"),UM=!1,zM=!1;function CK(e,t,i,s,r,n,o){const a=n.remote.isRemote,c=n.environment.useHostProxy??!a,l=c,u=c,h=()=>!a||t.getConfiguration("http").get("useLocalProxyConfiguration",c),p={resolveProxy:TK(e,r),lookupProxyAuthorization:OK.bind(void 0,e,s,r,t,{},{},n.remote.isRemote,l),getProxyURL:()=>Rs(t,a,"http.proxy"),getProxySupport:()=>Rs(t,a,"http.proxySupport")||"off",getNoProxyConfig:()=>Rs(t,a,"http.noProxy")||[],isAdditionalFetchSupportEnabled:()=>Rs(t,a,"http.fetchAdditionalSupport",!0),addCertificatesV1:()=>NK(t,a),addCertificatesV2:()=>RK(t,a),loadSystemCertificatesFromNode:()=>Rs(t,a,"http.systemCertificatesNode",Tv),log:s,getLogLevel:()=>{const E=s.getLevel();switch(E){case K.Trace:return qa.Trace;case K.Debug:return qa.Debug;case K.Info:return qa.Info;case K.Warning:return qa.Warning;case K.Error:return qa.Error;case K.Off:return qa.Off;default:return k(E)}function k(O){return s.error("Unknown log level",O),qa.Debug}},proxyResolveTelemetry:()=>{},isUseHostProxyEnabled:h,getNetworkInterfaceCheckInterval:()=>Rs(t,a,"http.experimental.networkInterfaceCheckInterval",300)*1e3,loadAdditionalCertificates:async()=>{const E=Rs(t,a,"http.systemCertificatesNode",Tv),k=[];if(a&&k.push(CM({loadSystemCertificatesFromNode:()=>E,log:s})),u)if(!a&&E)k.push(CM({loadSystemCertificatesFromNode:()=>E,log:s}));else{s.trace("ProxyResolver#loadAdditionalCertificates: Loading certificates from main process");const F=e.loadCertificates();F.then(G=>s.trace("ProxyResolver#loadAdditionalCertificates: Loaded certificates from main process",G.length)),k.push(F)}n.environment.extensionTestsLocationURI&&Qv.globalAgent.testCertificates?.length&&(s.trace("ProxyResolver#loadAdditionalCertificates: Loading test certificates"),k.push(Promise.resolve(Qv.globalAgent.testCertificates)));const O=(await Promise.all(k)).flat();return r.$publicLog2("additionalCertificates",{count:O.length,isRemote:a,loadLocalCertificates:u,useNodeSystemCerts:E}),O},env:process.env},{resolveProxyWithRequest:g,resolveProxyURL:v}=QX(p),b=Yv.default||Yv;b.resolveProxyURL=v,$K(p,t,r,n,v,o);const S=MK(p,g);return LK(i,S)}var kK=["content-length","host","trailer","te","upgrade","cookie2","keep-alive","transfer-encoding","set-cookie"];function $K(e,t,i,s,r,n){if(!globalThis.__vscodeOriginalFetch){const o=globalThis.fetch;globalThis.__vscodeOriginalFetch=o;const a=Yv.createFetchPatch(e,o,r);globalThis.__vscodePatchedFetch=a;let c=!1;s.remote.isRemote||(c=t.getConfiguration("http").get("electronFetch",zM),n.add(t.onDidChangeConfiguration(l=>{l.affectsConfiguration("http.electronFetch")&&(c=t.getConfiguration("http").get("electronFetch",zM))}))),globalThis.fetch=async function(u,h){function f(F){return h&&F in h?h[F]:typeof u=="object"&&"cache"in u?u[F]:void 0}const p=typeof u=="string"?u:"cache"in u?u.url:u.toString(),g=p.startsWith("data:");g&&ql(i,"data");const v=p.startsWith("blob:");v&&ql(i,"blob");const b=f("redirect")==="manual";b&&ql(i,"manualRedirect");const S=f("integrity");if(S&&ql(i,"integrity"),!c||g||v||b||S){const F=await a(u,h);return HM(i,F,p),F}if(h?.headers){const F=new Headers(h.headers);for(const G of kK)F.delete(G);h={...h,headers:F}}const E=u instanceof URL?u.toString():u,O=await Bl("electron").net.fetch(E,h);return HM(i,O,p),O}}}function HM(e,t,i){const s=t.url;Object.defineProperty(t,"url",{get(){return ql(e,"url"),s||i}});const r=t.type;Object.defineProperty(t,"type",{get(){return ql(e,"typeProperty"),r!=="default"?r:"basic"}})}var WM={url:0,typeProperty:0,data:0,blob:0,integrity:0,manualRedirect:0},Xv,IK=!1;function ql(e,t){IK&&!WM[t]++&&(Xv&&clearTimeout(Xv),Xv=setTimeout(()=>{e.$publicLog2("fetchFeatureUse",WM)},1e4),Xv.unref?.())}var mi={count:0,totalDuration:0,minDuration:Number.MAX_SAFE_INTEGER,maxDuration:0,lastSentTime:0},DK=3600*1e3;function PK(e){if(mi.count>0){const t=mi.totalDuration/mi.count;e.$publicLog2("proxyResolveStats",{count:mi.count,totalDuration:mi.totalDuration,minDuration:mi.minDuration,maxDuration:mi.maxDuration,avgDuration:t}),mi.count=0,mi.totalDuration=0,mi.minDuration=Number.MAX_SAFE_INTEGER,mi.maxDuration=0}mi.lastSentTime=Date.now()}function TK(e,t){return async i=>{const s=performance.now();try{return await e.resolveProxy(i)}finally{const r=performance.now()-s;mi.count++,mi.totalDuration+=r,mi.minDuration=Math.min(mi.minDuration,r),mi.maxDuration=Math.max(mi.maxDuration,r),Date.now()-mi.lastSentTime>=DK&&PK(t)}}}function MK(e,t){function i(s,r){const n=s.default||s;return n.__vscodeOriginal=Object.assign({},n),Object.assign(n,r)}return{http:i(OM,xM(e,OM,t)),https:i(Qv,xM(e,Qv,t)),net:i(jM,KX(e,jM)),tls:i(FM,XX(e,FM))}}function NK(e,t){return!Rs(e,t,"http.experimental.systemCertificatesV2",UM)&&!!Rs(e,t,"http.systemCertificates")}function RK(e,t){return!!Rs(e,t,"http.experimental.systemCertificatesV2",UM)&&!!Rs(e,t,"http.systemCertificates")}var _M=new Map;function LK(e,t){return e.getExtensionPathIndex().then(i=>{const s=Bl("module"),r=s._load;s._load=function(o,a,c){if(o==="net")return t.net;if(o==="tls")return t.tls;if(o!=="http"&&o!=="https"&&o!=="undici")return r.apply(this,arguments);const l=i.findSubstr(y.file(a.filename));let u=_M.get(l);if(u||_M.set(l,u={}),!u[o])if(o==="undici"){const h=r.apply(this,arguments);Yv.patchUndici(h),u[o]=h}else{const h=t[o];u[o]={...h}}return u[o]}})}async function OK(e,t,i,s,r,n,o,a,c,l,u){const h=r[c];l&&(r[c]=l),t.trace("ProxyResolver#lookupProxyAuthorization callback",`proxyURL:${c}`,`proxyAuthenticate:${l}`,`proxyAuthenticateCache:${h}`);const f=l||h,p=Array.isArray(f)?f:typeof f=="string"?[f]:[];if(jK(i,p,o),p.some(v=>/^(Negotiate|Kerberos)( |$)/i.test(v))&&!u.kerberosRequested){u.kerberosRequested=!0;try{const v=Rs(s,o,"http.proxyKerberosServicePrincipal");return"Negotiate "+await RM(c,v,t,"ProxyResolver#lookupProxyAuthorization")}catch(v){t.debug("ProxyResolver#lookupProxyAuthorization Kerberos authentication failed",v)}if(o&&a){t.debug("ProxyResolver#lookupProxyAuthorization Kerberos authentication lookup on host",`proxyURL:${c}`);const v=await e.lookupKerberosAuthorization(c);if(v)return"Negotiate "+v}}const g=p.find(v=>/^Basic( |$)/i.test(v));if(g)try{const v=n[c];if(v)if(u.basicAuthCacheUsed)t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication deleting cached credentials",`proxyURL:${c}`),delete n[c];else return t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication using cached credentials",`proxyURL:${c}`),u.basicAuthCacheUsed=!0,v;u.basicAuthAttempt=(u.basicAuthAttempt||0)+1;const b=/ realm="([^"]+)"/i.exec(g)?.[1];t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication lookup",`proxyURL:${c}`,`realm:${b}`);const S=new URL(c),E={scheme:"basic",host:S.hostname,port:Number(S.port),realm:b||"",isProxy:!0,attempt:u.basicAuthAttempt},k=await e.lookupAuthorization(E);if(k){t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication received credentials",`proxyURL:${c}`,`realm:${b}`);const O="Basic "+Buffer.from(`${k.username}:${k.password}`).toString("base64");return n[c]=O,O}else t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication received no credentials",`proxyURL:${c}`,`realm:${b}`)}catch(v){t.error("ProxyResolver#lookupProxyAuthorization Basic authentication failed",v)}}var BM=!1,FK=!1;function jK(e,t,i){!FK||BM||!t.length||(BM=!0,e.$publicLog2("proxyAuthenticationRequest",{authenticationType:t.map(s=>s.split(" ")[0]).join(","),extensionHostType:i?"remote":"local"}))}function Rs(e,t,i,s){if(t)return e.getConfiguration().get(i)??s;const r=e.getConfiguration().inspect(i);return r?.globalLocalValue??r?.defaultValue??s}import{tmpdir as UK}from"os";var dE=class extends J{constructor(t,i){super();const s=t.getProxy(Q.MainThreadDownloadService);i.registerCommand(!1,"_workbench.downloadResource",async r=>{const n=y.file(Ge(UK(),At()));return await s.$download(r,n),n})}};dE=__decorate([__param(0,Te),__param(1,Ns)],dE);import*as zK from"http";import*as qM from"fs";var HK=class{constructor(e,t,i){this.b=e,this.c=t,this.f=i,this.a=zK.createServer((s,r)=>this.h(s,r)),this.g().catch(s=>(t.error(s),""))}get ipcHandlePath(){return this.f}async g(){try{this.a.listen(this.ipcHandlePath),this.a.on("error",e=>this.c.error(e))}catch{this.c.error("Could not start open from terminal server.")}return this.f}h(e,t){const i=(r,n)=>{t.writeHead(r,{"content-type":"application/json"}),t.end(JSON.stringify(n||null),o=>o&&this.c.error(o))},s=[];e.setEncoding("utf8"),e.on("data",r=>s.push(r)),e.on("end",async()=>{try{const r=JSON.parse(s.join(""));let n;switch(r.type){case"open":n=await this.i(r);break;case"openExternal":n=await this.j(r);break;case"status":n=await this.l(r);break;case"extensionManagement":n=await this.k(r);break;default:i(404,`Unknown message type: ${r.type}`);break}i(200,n)}catch(r){const n=r instanceof Error?r.message:JSON.stringify(r);i(500,n),this.c.error("Error while processing pipe request",r)}})}async i(e){const{fileURIs:t,folderURIs:i,forceNewWindow:s,diffMode:r,mergeMode:n,addMode:o,removeMode:a,forceReuseWindow:c,gotoLineMode:l,waitMarkerFilePath:u,remoteAuthority:h}=e,f=[];if(Array.isArray(i))for(const b of i)try{f.push({folderUri:y.parse(b)})}catch{}if(Array.isArray(t))for(const b of t)try{YU(b)?f.push({workspaceUri:y.parse(b)}):f.push({fileUri:y.parse(b)})}catch{}const p=u?y.file(u):void 0,v={forceNewWindow:s,diffMode:r,mergeMode:n,addMode:o,removeMode:a,gotoLineMode:l,forceReuseWindow:c,preferNewWindow:!c&&!p&&!o&&!a,waitMarkerFileURI:p,remoteAuthority:h};this.b.executeCommand("_remoteCLI.windowOpen",f,v)}async j(e){for(const t of e.uris)y.parse(t).scheme!=="file"&&await this.b.executeCommand("_remoteCLI.openExternal",t)}async k(e){const t=s=>s?.map(r=>/\.vsix$/i.test(r)?y.parse(r):r),i={list:e.list,install:t(e.install),uninstall:t(e.uninstall),force:e.force};return await this.b.executeCommand("_remoteCLI.manageExtensions",i)}async l(e){return await this.b.executeCommand("_remoteCLI.getSystemStatus")}dispose(){this.a.close(),this.f&&process.platform!=="win32"&&qM.existsSync(this.f)&&qM.unlinkSync(this.f)}},fE=class extends HK{constructor(t,i){super(t,i,GF())}};fE=__decorate([__param(0,Ns),__param(1,xe)],fE);var pE=class{constructor(t,i){this.a=t.getProxy(Q.MainThreadConsole),this.b=i.consoleForward.includeStack,this.c=i.consoleForward.logNative,this.d("info","log"),this.d("log","log"),this.d("warn","warn"),this.d("debug","debug"),this.d("error","error")}d(t,i){const s=this,r=console[t];Object.defineProperty(console,t,{set:()=>{},get:()=>function(){s.e(t,i,r,arguments)}})}e(t,i,s,r){this.a.$logExtensionHostMessage({type:"__$console",severity:i,arguments:_K(r,this.b)}),this.c&&this.f(t,s,r)}};pE=__decorate([__param(0,Te),__param(1,Wt)],pE);var WK=1e5;function _K(e,t){const i=[];if(e.length)for(let s=0;s<e.length;s++){let r=e[s];if(typeof r>"u")r="undefined";else if(r instanceof Error){const n=r;n.stack?r=n.stack:r=n.toString()}i.push(r)}if(t){const s=new Error().stack;s&&i.push({__$stack:s.split(`
`).slice(3).join(`
`)})}try{const s=ZF(i);return s.length>WK?"Output omitted for a large object that exceeds the limits":s}catch(s){return`Output omitted for an object that cannot be inspected ('${s.toString()}')`}}var BK=1024*1024,gE=class extends pE{constructor(t,i){super(t,i),this.g=!1,this.j("stderr","error"),this.j("stdout","log")}f(t,i,s){const r=t==="error"||t==="warn"?process.stderr:process.stdout;this.g=!0,r.write(`
START_NATIVE_LOG
`),i.apply(console,s),r.write(`
END_NATIVE_LOG
`),this.g=!1}j(t,i){const s=process[t],r=s.write;let n="";Object.defineProperty(s,"write",{set:()=>{},get:()=>(o,a,c)=>{if(!this.g){n+=o.toString(a);const l=n.length>BK?n.length:n.lastIndexOf(`
`);l!==-1&&(console[i](n.slice(0,l)),n=n.slice(l+1))}r.call(s,o,a,c)}})}};gE=__decorate([__param(0,Te),__param(1,Wt)],gE);import{constants as mE,promises as Va}from"fs";async function qK(e,t,i,s,r,n){let o;try{await VK(e,t,i,s,r,n)}catch(a){o=a}finally{o&&r.errorTransformer&&(o=r.errorTransformer(o)),typeof o<"u"&&i.error(o),i.end()}}async function VK(e,t,i,s,r,n){vE(n);const o=await e.open(t,{create:!1});try{vE(n);let a=0,c=0,l=r&&typeof r.length=="number"?r.length:void 0,u=_.alloc(Math.min(r.bufferSize,typeof l=="number"?l:r.bufferSize)),h=r&&typeof r.position=="number"?r.position:0,f=0;do c=await e.read(o,h,u.buffer,f,u.byteLength-f),h+=c,f+=c,a+=c,typeof l=="number"&&(l-=c),f===u.byteLength&&(await i.write(s(u)),u=_.alloc(Math.min(r.bufferSize,typeof l=="number"?l:r.bufferSize)),f=0);while(c>0&&(typeof l!="number"||l>0)&&vE(n)&&GK(a,r));if(f>0){let p=f;typeof l=="number"&&(p=Math.min(f,l)),i.write(s(u.slice(0,p)))}}catch(a){throw eH(a)}finally{await e.close(o)}}function vE(e){if(e.isCancellationRequested)throw ou();return!0}function GK(e,t){if(typeof t?.limits?.size=="number"&&e>t.limits.size)throw tn(d(2122,null),de.FileTooLarge);return!0}var JK=class extends J{constructor(e,t){super(),this.a=e,this.b=t,this.c=this.D(new I),this.onDidChangeFile=this.c.event,this.g=this.D(new I),this.onDidWatchError=this.g.event,this.m=[],this.n=this.D(new gu(this.h(this.m.length))),this.y=[],this.z=this.D(new gu(this.h(this.y.length)))}watch(e,t){return t.recursive||this.b?.watcher?.forceUniversal?this.q(e,t):this.C(e,t)}h(e){return e>200?500:0}q(e,t){const i=this.r(e,t),s=gx(this.m,i);return this.s(),se(()=>{s(),this.s()})}r(e,t){const i={path:this.M(e),excludes:t.excludes,includes:t.includes,recursive:t.recursive,filter:t.filter,correlationId:t.correlationId};if(sY(i)){const s=this.b?.watcher?.recursive?.usePolling;s===!0?i.pollingInterval=this.b?.watcher?.recursive?.pollingInterval??5e3:Array.isArray(s)&&s.includes(i.path)&&(i.pollingInterval=this.b?.watcher?.recursive?.pollingInterval??5e3)}return i}s(){this.n.trigger(()=>this.t(),this.h(this.m.length)).catch(e=>pt(e))}t(){return this.j||(this.j=this.D(this.u(e=>this.c.fire(g3(e)),e=>this.I(e),this.a.getLevel()===K.Trace)),this.D(this.a.onDidChangeLogLevel(()=>{this.j?.setVerboseLogging(this.a.getLevel()===K.Trace)}))),this.j.watch(this.m)}C(e,t){const i={path:this.M(e),excludes:t.excludes,includes:t.includes,recursive:!1,filter:t.filter,correlationId:t.correlationId},s=gx(this.y,i);return this.F(),se(()=>{s(),this.F()})}F(){this.z.trigger(()=>this.G(),this.h(this.y.length)).catch(e=>pt(e))}G(){return this.w||(this.w=this.D(this.H(e=>this.c.fire(g3(e)),e=>this.I(e),this.a.getLevel()===K.Trace)),this.D(this.a.onDidChangeLogLevel(()=>{this.w?.setVerboseLogging(this.a.getLevel()===K.Trace)}))),this.w.watch(this.y)}I(e){e.type==="error"&&this.g.fire(e.message),this.J(e)}J(e){this.a[e.type](e.message)}L(e){return Yr(e.fsPath)}M(e){const t=this.L(e);return cO(t)}};import{fork as ZK}from"child_process";function YK(e){const t=e;return t&&typeof t.type=="string"&&typeof t.severity=="string"}function QK(e){const t=[];let i;try{const s=JSON.parse(e.arguments),r=s[s.length-1];r&&r.__$stack&&(s.pop(),i=r.__$stack),t.push(...s)}catch{t.push("Unable to log remote console arguments",e.arguments)}return{args:t,stack:i}}function XK(e){if(!e)return e;const t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function KK(e,t){const{args:i,stack:s}=QK(e),r=typeof i[0]=="string"&&i.length===1;let n=XK(s);n&&(n=`(${n.trim()})`);let o=[];if(typeof i[0]=="string"?n&&r?o=[`%c[${t}] %c${i[0]} %c${n}`,Vl("blue"),Vl(""),Vl("grey")]:o=[`%c[${t}] %c${i[0]}`,Vl("blue"),Vl(""),...i.slice(1)]:o=[`%c[${t}]%`,Vl("blue"),...i],n&&!r&&o.push(n),typeof console[e.severity]!="function")throw new Error("Unknown console method");console[e.severity].apply(console,o)}function Vl(e){return`color: ${e}`}var eee=class{constructor(e,t){this.i=e,this.j=t,this.c=new Set,this.g=new Map,this.h=new I,this.onDidProcessExit=this.h.event;const i=t.timeout||6e4;this.b=new MC(i),this.d=null,this.f=null}getChannel(e){const t=this;return{call(i,s,r){return t.k(e,i,s,r)},listen(i,s){return t.l(e,i,s)}}}k(e,t,i,s=De.None){if(!this.b)return Promise.reject(new Error("disposed"));if(s.isCancellationRequested)return Promise.reject(ou());this.b.cancel();const r=this.n(e),n=Qr(c=>r.call(t,i,c)),o=s.onCancellationRequested(()=>n.cancel()),a=se(()=>n.cancel());return this.c.add(a),n.finally(()=>{o.dispose(),this.c.delete(a),this.c.size===0&&this.b&&this.b.trigger(()=>this.o())}),n}l(e,t,i){if(!this.b)return Ie.None;this.b.cancel();let s;const r=new I({onWillAddFirstListener:()=>{s=this.n(e).listen(t,i)(r.fire,r),this.c.add(s)},onDidRemoveLastListener:()=>{this.c.delete(s),s.dispose(),this.c.size===0&&this.b&&this.b.trigger(()=>this.o())}});return r.event}get m(){if(!this.f){const e=this.j.args||[],t=Object.create(null);t.env={...ct(process.env),VSCODE_PARENT_PID:String(process.pid)},this.j.env&&(t.env={...t.env,...this.j.env}),this.j.freshExecArgv&&(t.execArgv=[]),typeof this.j.debug=="number"&&(t.execArgv=["--nolazy","--inspect="+this.j.debug]),typeof this.j.debugBrk=="number"&&(t.execArgv=["--nolazy","--inspect-brk="+this.j.debugBrk]),t.execArgv===void 0&&(t.execArgv=process.execArgv.filter(u=>!/^--inspect(-brk)?=/.test(u)).filter(u=>!u.startsWith("--vscode-"))),VG(t.env),this.d=ZK(this.i,e,t);const i=new I,r=Ie.fromNodeEventEmitter(this.d,"message",u=>u)(u=>{if(YK(u)){KK(u,`IPC Library: ${this.j.serverName}`);return}i.fire(_.wrap(Buffer.from(u,"base64")))}),n=this.j.useQueue?GG(this.d):this.d,o=u=>this.d?.connected&&n.send(u.buffer.toString("base64")),a=i.event,c={send:o,onMessage:a};this.f=new dk(c);const l=()=>this.o();process.once("exit",l),this.d.on("error",u=>console.warn('IPC "'+this.j.serverName+'" errored with '+u)),this.d.on("exit",(u,h)=>{process.removeListener("exit",l),r.dispose(),this.c.forEach(f=>Yi(f)),this.c.clear(),u!==0&&h!=="SIGTERM"&&console.warn('IPC "'+this.j.serverName+'" crashed with exit code '+u+" and signal "+h),this.b?.cancel(),this.o(),this.h.fire({code:u,signal:h})})}return this.f}n(e){let t=this.g.get(e);return t||(t=this.m.getChannel(e),this.g.set(e,t)),t}o(){this.f&&(this.d&&(this.d.kill(),this.d=null),this.f=null,this.g.clear())}dispose(){this.h.dispose(),this.b?.cancel(),this.b=void 0,this.o(),this.c.clear()}},tee=class extends nY{constructor(e,t,i){super(e,t,i),this.r()}q(e){const t=e.add(new eee(vf.asFileUri("bootstrap-fork").fsPath,{serverName:"File Watcher",args:["--type=fileWatcher"],env:{VSCODE_ESM_ENTRYPOINT:"vs/platform/files/node/watcher/watcherMain",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));return e.add(t.onDidProcessExit(({code:i,signal:s})=>this.s(`terminated by itself with code ${i}, signal: ${s} (ETERM)`))),v0.toService(NF(t.getChannel("watcher")))}};import{watchFile as iee,unwatchFile as see}from"fs";var ree=class extends J{constructor(){super(),this.a=this.D(new I),this.onDidChangeFile=this.a.event,this.b=this.D(new I),this.onDidLogMessage=this.b.event,this.c=this.D(new I),this.f=this.c.event,this.g=new Map,this.h=new Map,this.j=this.D(new Fo),this.m=new Set,this.n=this.D(new gu(this.w())),this.q=5007,this.r=new Di,this.R=!1,this.D(this.f(e=>this.y({id:this.t(e),correlationId:this.s(e)?e.correlationId:void 0,path:e.path})))}s(e){return f3(e)}t(e){return this.s(e)?e.correlationId:Ar(e)}async watch(e){this.r.isSettled||this.r.complete(),this.r=new Di;try{this.g.clear(),this.h.clear();for(const t of e)this.s(t)?this.g.set(t.correlationId,t):this.h.set(this.t(t),t);for(const[t]of this.j)!this.h.has(t)&&!this.g.has(t)&&(this.j.deleteAndDispose(t),this.m.delete(t));return await this.u(!1)}finally{this.r.complete()}}u(e){const t=[];for(const[i,s]of[...this.h,...this.g])this.j.has(i)||t.push(s);return this.n.trigger(()=>this.N(t),e?this.w():0).catch(i=>pt(i))}w(){return 800}isSuspended(e){const t=this.t(e);return this.m.has(t)?"polling":this.j.has(t)}async y(e){if(this.j.has(e.id))return;const t=new X;this.j.set(e.id,t),await this.r.p,!t.isDisposed&&(this.C(e,t),this.u(!0))}z(e){this.j.deleteAndDispose(e.id),this.m.delete(e.id),this.u(!1)}C(e,t){this.F(e,t)?(this.P(`reusing an existing recursive watcher to monitor ${e.path}`),this.m.delete(e.id)):(this.G(e,t),this.m.add(e.id))}F(e,t){const i=this.O?.subscribe(e.path,(s,r)=>{t.isDisposed||(s?this.C(e,t):r?.type===1&&this.H(e))});return i?(t.add(i),!0):!1}G(e,t){let i=!1;const s=(r,n)=>{if(t.isDisposed)return;const o=this.I(r),a=this.I(n),c=i;i=o,!o&&(a||c)&&this.H(e)};this.P(`starting fs.watchFile() on ${e.path} (correlationId: ${e.correlationId})`);try{iee(e.path,{persistent:!1,interval:this.q},s)}catch(r){this.Q(`fs.watchFile() failed with error ${r} on path ${e.path} (correlationId: ${e.correlationId})`)}t.add(se(()=>{this.P(`stopping fs.watchFile() on ${e.path} (correlationId: ${e.correlationId})`);try{see(e.path,s)}catch(r){this.Q(`fs.unwatchFile() failed with error ${r} on path ${e.path} (correlationId: ${e.correlationId})`)}}))}H(e){this.P(`detected ${e.path} exists again, resuming watcher (correlationId: ${e.correlationId})`);const t={resource:y.file(e.path),type:1,cId:e.correlationId};this.a.fire([t]),this.J(t,e),this.z(e)}I(e){return e.ctimeMs===0&&e.ino===0}async stop(){this.j.clearAndDisposeAll(),this.m.clear()}J(e,t){if(this.R){const i=` >> normalized ${e.type===1?"[ADDED]":e.type===2?"[DELETED]":"[CHANGED]"} ${e.resource.fsPath}`;this.L(i,t)}}L(e,t){this.R&&this.P(`${e}${typeof t.correlationId=="number"?` <${t.correlationId}> `:""}`)}M(e){return`${e.path} (excludes: ${e.excludes.length>0?e.excludes:"<none>"}, includes: ${e.includes&&e.includes.length>0?JSON.stringify(e.includes):"<all>"}, filter: ${lY(e.filter)}, correlationId: ${typeof e.correlationId=="number"?e.correlationId:"<none>"})`}async setVerboseLogging(e){this.R=e}};import{watch as nee,promises as oee}from"fs";var aee=class b1 extends J{static{this.a=100}static{this.b=75}get isReusingRecursiveWatcher(){return this.q}get failed(){return this.r}constructor(t,i,s,r,n,o){super(),this.s=t,this.t=i,this.u=s,this.w=r,this.y=n,this.z=o,this.c=this.D(new FC({maxWorkChunkSize:100,throttleDelay:200,maxBufferedWork:1e4},c=>this.u(c))),this.f=this.D(new FO(c=>this.M(c),b1.b)),this.m=new Ke,this.n=new Rt(async()=>{let c=this.s.path;try{c=await at.realpath(this.s.path),this.s.path!==c&&this.Q(`correcting a path to watch that seems to be a symbolic link (original: ${this.s.path}, real: ${c})`)}catch{}return c}),this.q=!1,this.r=!1;const a=!Mt;this.g=v3(this.s.path,this.s.excludes,a),this.h=this.s.includes?v3(this.s.path,this.s.includes,a):void 0,this.j=f3(this.s)?this.s.filter:void 0,this.ready=this.C()}async C(){try{const t=await oee.stat(this.s.path);if(this.m.token.isCancellationRequested)return;this.D(await this.G(t.isDirectory()))}catch(t){t.code!=="ENOENT"?this.O(t):this.Q(`ignoring a path for watching who's stat info failed to resolve: ${this.s.path} (error: ${t})`),this.F()}}F(){this.r=!0,this.w?.()}async G(t){const i=new X;return this.H(t,i)?(this.Q(`reusing an existing recursive watcher for ${this.s.path}`),this.q=!0):(this.q=!1,await this.I(t,i)),i}H(t,i){if(t)return!1;const s=y.file(this.s.path),r=this.t?.subscribe(this.s.path,async(n,o)=>{i.isDisposed||(n?await VL(this.G(t),i):o&&(typeof o.cId=="number"||typeof this.s.correlationId=="number")&&this.L({resource:s,type:o.type,cId:this.s.correlationId},!0))});return r?(i.add(r),!0):!1}async I(t,i){const s=await this.n.value;if(this.m.token.isCancellationRequested)return;if(Nt&&Bo(s,"/Volumes/",!0)){this.O(`Refusing to watch ${s} for changes using fs.watch() for possibly being a network share where watching is unreliable and unstable.`);return}const r=new Ke(this.m.token);i.add(se(()=>r.dispose(!0)));const n=new X;i.add(n);try{const o=y.file(this.s.path),a=$t(s),c=nee(s);n.add(se(()=>{c.removeAllListeners(),c.close()})),this.Q(`Started watching: '${s}'`);const l=new Set;if(t)try{for(const h of await at.readdir(s))l.add(h)}catch(h){this.O(h)}if(r.token.isCancellationRequested)return;const u=new Map;n.add(se(()=>{for(const[,h]of u)h.dispose();u.clear()})),c.on("error",(h,f)=>{r.token.isCancellationRequested||(this.O(`Failed to watch ${s} for changes using fs.watch() (${h}, ${f})`),this.F())}),c.on("change",(h,f)=>{if(r.token.isCancellationRequested)return;this.z&&this.R(`[raw] ["${h}"] ${f}`);let p="";if(f&&(p=f.toString(),Nt&&(p=xf(p))),!(!p||h!=="change"&&h!=="rename"))if(t)if(h==="rename"){u.get(p)?.dispose();const g=setTimeout(async()=>{if(u.delete(p),ff(p,a,!Mt)&&!await at.exists(s)){this.J(o);return}if(r.token.isCancellationRequested)return;const v=await this.N(Ge(s,p));if(r.token.isCancellationRequested)return;let b;v?l.has(p)?b=0:(b=1,l.add(p)):(l.delete(p),b=2),this.L({resource:Lt(o,p),type:b,cId:this.s.correlationId})},b1.a);u.set(p,se(()=>clearTimeout(g)))}else{let g;l.has(p)?g=0:(g=1,l.add(p)),this.L({resource:Lt(o,p),type:g,cId:this.s.correlationId})}else if(h==="rename"||!ff(p,a,!Mt)){const g=setTimeout(async()=>{const v=await at.exists(s);r.token.isCancellationRequested||(v?(this.L({resource:o,type:0,cId:this.s.correlationId},!0),n.add(await this.G(!1))):this.J(o))},b1.a);n.clear(),n.add(se(()=>clearTimeout(g)))}else this.L({resource:o,type:0,cId:this.s.correlationId},!0)})}catch(o){if(r.token.isCancellationRequested)return;this.O(`Failed to watch ${s} for changes using fs.watch() (${o.toString()})`),this.F()}}J(t){this.P("Watcher shutdown because watched path got deleted"),this.L({resource:t,type:2,cId:this.s.correlationId},!0),this.f.flush(),this.F()}L(t,i=!1){this.m.token.isCancellationRequested||(this.z&&this.R(`${t.type===1?"[ADDED]":t.type===2?"[DELETED]":"[CHANGED]"} ${t.resource.fsPath}`),!i&&this.g.some(s=>s(t.resource.fsPath))?this.z&&this.R(` >> ignored (excluded) ${t.resource.fsPath}`):!i&&this.h&&this.h.length>0&&!this.h.some(s=>s(t.resource.fsPath))?this.z&&this.R(` >> ignored (not included) ${t.resource.fsPath}`):this.f.work(t))}M(t){const i=oY(t),s=[];for(const n of i){if(cY(n,this.j)){this.z&&this.R(` >> ignored (filtered) ${n.resource.fsPath}`);continue}s.push(n)}if(s.length===0)return;if(this.z)for(const n of s)this.R(` >> normalized ${n.type===1?"[ADDED]":n.type===2?"[DELETED]":"[CHANGED]"} ${n.resource.fsPath}`);this.c.work(s)?this.c.pending>0&&this.Q(`started throttling events due to large amount of file change events at once (pending: ${this.c.pending}, most recent change: ${s[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`):this.P(`started ignoring events due to too many file change events at once (incoming: ${s.length}, most recent change: ${s[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`)}async N(t){if(Mt)return at.exists(t);try{const i=$t(t);return(await at.readdir(Fi(t))).some(r=>r===i)}catch(i){return this.Q(i),!1}}setVerboseLogging(t){this.z=t}O(t){this.m.token.isCancellationRequested||this.y?.({type:"error",message:`[File Watcher (node.js)] ${t}`})}P(t){this.m.token.isCancellationRequested||this.y?.({type:"warn",message:`[File Watcher (node.js)] ${t}`})}Q(t){!this.m.token.isCancellationRequested&&this.z&&this.y?.({type:"trace",message:`[File Watcher (node.js)] ${t}`})}R(t){!this.m.token.isCancellationRequested&&this.z&&this.Q(`${t}${typeof this.s.correlationId=="number"?` <${this.s.correlationId}> `:""}`)}dispose(){this.m.dispose(!0),super.dispose()}},cee=class extends ree{get watchers(){return this.S.values()}constructor(e){super(),this.O=e,this.onDidError=Ie.None,this.S=new Map,this.U=this.D(new Hs)}async N(e){e=this.cb(e);const t=[],i=new Set(Array.from(this.watchers));for(const s of e){const r=this.S.get(this.Z(s));r&&v6(r.request.excludes,s.excludes)&&v6(r.request.includes,s.includes)?i.delete(r):t.push(s)}t.length&&this.P(`Request to start watching: ${t.map(s=>this.M(s)).join(",")}`),i.size&&this.P(`Request to stop watching: ${Array.from(i).map(s=>this.M(s.request)).join(",")}`),this.U.clear();for(const s of i)this.bb(s);this.Y().work(t)}Y(){return this.U.value=new FC({maxWorkChunkSize:100,throttleDelay:100,maxBufferedWork:Number.MAX_VALUE},e=>{for(const t of e)this.ab(t)}),this.U.value}Z(e){return typeof e.correlationId=="number"?e.correlationId:this.$(e.path)}$(e){return Mt?e:e.toLowerCase()}ab(e){const t=new aee(e,this.O,s=>this.a.fire(s),()=>this.c.fire(e),s=>this.b.fire(s),this.R),i={request:e,instance:t};this.S.set(this.Z(e),i)}async stop(){await super.stop();for(const e of this.watchers)this.bb(e)}bb(e){this.P("stopping file watcher",e),this.S.delete(this.Z(e.request)),e.instance.dispose()}cb(e){const t=new Map;for(const i of e){let s=t.get(i.correlationId);s||(s=new Map,t.set(i.correlationId,s));const r=this.$(i.path);s.has(r)&&this.P(`ignoring a request for watching who's path is already watched: ${this.M(i)}`),s.set(r,i)}return Array.from(t.values()).flatMap(i=>Array.from(i.values()))}async setVerboseLogging(e){super.setVerboseLogging(e);for(const t of this.watchers)t.instance.setVerboseLogging(e)}P(e,t){this.R&&this.b.fire({type:"trace",message:this.fb(e,t)})}Q(e){this.b.fire({type:"warn",message:this.fb(e)})}fb(e,t){return t?`[File Watcher (node.js)] ${e} (${this.M(t.request)})`:`[File Watcher (node.js)] ${e}`}},lee=class extends rY{constructor(e,t,i){super(e,t,i),this.r()}q(e){return e.add(new cee(void 0))}},uee=class Gd extends JK{constructor(){super(...arguments),this.onDidChangeCapabilities=Ie.None,this.R=new Ct(t=>e0.getComparisonKey(t)),this.Z=new Map,this.$=new Map,this.ab=new Map}static{this.N=!1}get capabilities(){return this.O||(this.O=1040414,Mt&&(this.O|=1024)),this.O}async stat(t){try{const{stat:i,symbolicLink:s}=await Ui.stat(this.L(t));let r;return(i.mode&128)===0&&(r=Er.Locked),(i.mode&mE.S_IXUSR||i.mode&mE.S_IXGRP||i.mode&mE.S_IXOTH)&&(r=(r??0)|Er.Executable),{type:this.Q(i,s),ctime:i.birthtime.getTime(),mtime:i.mtime.getTime(),size:i.size,permissions:r}}catch(i){throw this.jb(i)}}async P(t){try{return await this.stat(t)}catch{return}}async realpath(t){const i=this.L(t);return at.realpath(i)}async readdir(t){try{const i=await at.readdir(this.L(t),{withFileTypes:!0}),s=[];return await Promise.all(i.map(async r=>{try{let n;r.isSymbolicLink()?n=(await this.stat(Lt(t,r.name))).type:n=this.Q(r),s.push([r.name,n])}catch(n){this.a.trace(n)}})),s}catch(i){throw this.jb(i)}}Q(t,i){let s;return i?.dangling?s=ss.Unknown:t.isFile()?s=ss.File:t.isDirectory()?s=ss.Directory:s=ss.Unknown,i&&(s|=ss.SymbolicLink),s}async S(t){const i=this.L(t);this.U(`[Disk FileSystemProvider]: createResourceLock() - request to acquire resource lock (${i})`);let s;for(;s=this.R.get(t);)this.U(`[Disk FileSystemProvider]: createResourceLock() - waiting for resource lock to be released (${i})`),await s.wait();const r=new ms;return this.R.set(t,r),this.U(`[Disk FileSystemProvider]: createResourceLock() - new resource lock created (${i})`),se(()=>{this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock dispose() (${i})`),this.R.get(t)===r&&(this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock removed from resource-lock map (${i})`),this.R.delete(t)),this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock barrier open() (${i})`),r.open()})}async readFile(t,i){let s;try{i?.atomic&&(this.U(`[Disk FileSystemProvider]: atomic read operation started (${this.L(t)})`),s=await this.S(t));const r=this.L(t);return await Va.readFile(r)}catch(r){throw this.jb(r)}finally{s?.dispose()}}U(t){Gd.N&&this.a.trace(t)}readFileStream(t,i,s){const r=yf(n=>_.concat(n.map(o=>_.wrap(o))).buffer);return qK(this,t,r,n=>n.buffer,{...i,bufferSize:256*1024},s),r}async writeFile(t,i,s){return s?.atomic!==!1&&s?.atomic?.postfix&&await this.W(t)?this.X(t,Lt(dc(t),`${ji(t)}${s.atomic.postfix}`),i,s):this.Y(t,i,s)}async W(t){try{const i=this.L(t),{symbolicLink:s}=await Ui.stat(i);if(s)return!1}catch{}return!0}async X(t,i,s,r){const n=new X;try{n.add(await this.S(t)),n.add(await this.S(i)),await this.Y(i,s,{...r,create:!0,overwrite:!0},!0);try{await this.rename(i,t,{overwrite:!0})}catch(o){try{await this.delete(i,{recursive:!1,useTrash:!1,atomic:!1})}catch{}throw o}}finally{n.dispose()}}async Y(t,i,s,r){let n;try{const o=this.L(t);if(!s.create||!s.overwrite){if(await at.exists(o)){if(!s.overwrite)throw tn(d(2125,null),de.FileExists)}else if(!s.create)throw tn(d(2126,null),de.FileNotFound)}n=await this.open(t,{create:!0,append:s.append,unlock:s.unlock},r),await this.write(n,0,i,0,i.byteLength)}catch(o){throw await this.kb(t,o)}finally{typeof n=="number"&&await this.close(n)}}static{this.bb=!0}static configureFlushOnWrite(t){Gd.bb=t}async open(t,i,s){const r=this.L(t);let n;xc(i)&&!s&&(n=await this.S(t));let o;try{if(xc(i)&&i.unlock)try{const{stat:a}=await Ui.stat(r);a.mode&128||await Va.chmod(r,a.mode|128)}catch(a){a.code!=="ENOENT"&&this.a.trace(a)}if(ze&&xc(i)&&!i.append)try{o=await at.open(r,"r+"),await at.ftruncate(o,0)}catch(a){if(a.code!=="ENOENT"&&this.a.trace(a),typeof o=="number"){try{await at.close(o)}catch(c){this.a.trace(c)}o=void 0}}typeof o!="number"&&(o=await at.open(r,xc(i)?i.append?"a":"w":"r"))}catch(a){throw n?.dispose(),xc(i)?await this.kb(t,a):this.jb(a)}if(this.Z.set(o,0),xc(i)&&this.ab.set(o,t),n){const a=this.$.get(o);this.U(`[Disk FileSystemProvider]: open() - storing lock for handle ${o} (${r})`),this.$.set(o,n),a&&(this.U(`[Disk FileSystemProvider]: open() - disposing a previous lock that was still stored on same handle ${o} (${r})`),a.dispose())}return o}async close(t){const i=this.$.get(t);try{if(this.Z.delete(t),this.ab.delete(t)&&Gd.bb)try{await at.fdatasync(t)}catch(s){Gd.configureFlushOnWrite(!1),this.a.error(s)}return await at.close(t)}catch(s){throw this.jb(s)}finally{i&&(this.$.get(t)===i&&(this.U(`[Disk FileSystemProvider]: close() - resource lock removed from handle-lock map ${t}`),this.$.delete(t)),this.U(`[Disk FileSystemProvider]: close() - disposing lock for handle ${t}`),i.dispose())}}async read(t,i,s,r,n){const o=this.cb(t,i);let a=null;try{a=(await at.read(t,s,r,n,o)).bytesRead}catch(c){throw this.jb(c)}finally{this.db(t,o,a)}return a}cb(t,i){return i===this.Z.get(t)?null:i}db(t,i,s){const r=this.Z.get(t);typeof r=="number"&&(typeof i=="number"||(typeof s=="number"?this.Z.set(t,r+s):this.Z.delete(t)))}async write(t,i,s,r,n){return zO(()=>this.eb(t,i,s,r,n),100,3)}async eb(t,i,s,r,n){const o=this.cb(t,i);let a=null;try{a=(await at.write(t,s,r,n,o)).bytesWritten}catch(c){throw await this.kb(this.ab.get(t),c)}finally{this.db(t,o,a)}return a}async mkdir(t){try{await Va.mkdir(this.L(t))}catch(i){throw this.jb(i)}}async delete(t,i){try{const s=this.L(t);if(i.recursive){let r;i?.atomic!==!1&&i.atomic.postfix&&(r=Ge(Fi(s),`${$t(s)}${i.atomic.postfix}`)),await at.rm(s,qo.MOVE,r)}else try{await Va.unlink(s)}catch(r){if(r.code==="EPERM"||r.code==="EISDIR"){let n=!1;try{const{stat:o,symbolicLink:a}=await Ui.stat(s);n=o.isDirectory()&&!a}catch{}if(n)await Va.rmdir(s);else throw r}else throw r}}catch(s){throw this.jb(s)}}async rename(t,i,s){const r=this.L(t),n=this.L(i);if(r!==n)try{await this.fb(t,i,"move",s.overwrite),await at.rename(r,n)}catch(o){throw(o.code==="EINVAL"||o.code==="EBUSY"||o.code==="ENAMETOOLONG")&&(o=new Error(d(2127,null,$t(r),$t(Fi(n)),o.toString()))),this.jb(o)}}async copy(t,i,s){const r=this.L(t),n=this.L(i);if(r!==n)try{await this.fb(t,i,"copy",s.overwrite),await at.copy(r,n,{preserveSymlinks:!0})}catch(o){throw(o.code==="EINVAL"||o.code==="EBUSY"||o.code==="ENAMETOOLONG")&&(o=new Error(d(2128,null,$t(r),$t(Fi(n)),o.toString()))),this.jb(o)}}async fb(t,i,s,r){const n=this.L(t),o=this.L(i);let a=!1;if(this.capabilities&1024||(a=ff(n,o,!0)),a){if(s==="copy")throw tn(d(2129,null),de.FileExists);if(s==="move")return}const l=await this.P(t);if(!l)throw tn(d(2130,null),de.FileNotFound);const u=await this.P(i);if(u){if(!r)throw tn(d(2131,null),de.FileExists);(l.type&ss.File)!==0&&(u.type&ss.File)!==0||await this.delete(i,{recursive:!0,useTrash:!1,atomic:!1})}}async cloneFile(t,i){return this.gb(t,i,!1)}async gb(t,i,s){const r=this.L(t),n=this.L(i),o=!!(this.capabilities&1024);if(ff(r,n,!o))return;const a=new X;try{a.add(await this.S(t)),a.add(await this.S(i)),s&&await Va.mkdir(Fi(n),{recursive:!0}),await Va.copyFile(r,n)}catch(c){if(c.code==="ENOENT"&&!s)return this.gb(t,i,!0);throw this.jb(c)}finally{a.dispose()}}u(t,i,s){return new tee(r=>t(r),r=>i(r),s)}H(t,i,s){return new lee(r=>t(r),r=>i(r),s)}jb(t){if(t instanceof qf)return t;let i=t,s;switch(t.code){case"ENOENT":s=de.FileNotFound;break;case"EISDIR":s=de.FileIsADirectory;break;case"ENOTDIR":s=de.FileNotADirectory;break;case"EEXIST":s=de.FileExists;break;case"EPERM":case"EACCES":s=de.NoPermissions;break;case"ERR_UNC_HOST_NOT_ALLOWED":i=`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`,s=de.Unknown;break;default:s=de.Unknown}return tn(i,s)}async kb(t,i){let s=this.jb(i);if(t&&s.code===de.NoPermissions)try{const{stat:r}=await Ui.stat(this.L(t));r.mode&128||(s=tn(i,de.FileWriteLocked))}catch(r){this.a.trace(r)}return s}},wE=class{constructor(t,i){t.addFileSystemProvider(V.file,new hee(i),{isCaseSensitive:Mt})}};wE=__decorate([__param(0,Yh),__param(1,xe)],wE);var hee=class{constructor(e){this.a=new uee(e)}async stat(e){const t=await this.a.stat(e);return{type:t.type,ctime:t.ctime,mtime:t.mtime,size:t.size,permissions:t.permissions===Er.Readonly?1:void 0}}readDirectory(e){return this.a.readdir(e)}createDirectory(e){return this.a.mkdir(e)}readFile(e){return this.a.readFile(e)}writeFile(e,t,i){return this.a.writeFile(e,t,{...i,unlock:!1,atomic:!1})}delete(e,t){return this.a.delete(e,{...t,useTrash:!1,atomic:!1})}rename(e,t,i){return this.a.rename(e,t,i)}copy(e,t,i){return this.a.copy(e,t,i)}get onDidChangeFile(){throw new Error("Method not implemented.")}watch(e,t){throw new Error("Method not implemented.")}};import VM from"node:module";var GM=VM.createRequire(import.meta.url),dee=class extends Jv{k(){const e=this,t=GM("module"),i=t._load;t._load=function(a,c,l){return a=n(a),e.a.has(a)?e.a.get(a).load(a,y.file(ik(c.filename)),u=>i.apply(this,[u,c,l])):i.apply(this,arguments)};const s=t._resolveLookupPaths;t._resolveLookupPaths=(o,a)=>s.call(this,n(o),a);const r=t._resolveFilename;t._resolveFilename=function(a,c,l,u){return a==="vsda"&&Array.isArray(u?.paths)&&u.paths.length===0&&(u.paths=t._nodeModulePaths(import.meta.dirname)),r.call(this,a,c,l,u)};const n=o=>{for(const a of e.b){const c=a(o);if(c){o=c;break}}return o}}},fee=class Kl extends Jv{constructor(){super(...arguments),this.o=new X}static l(t){return`data:text/javascript;base64,${Buffer.from(t).toString("base64")}`}static{this.m=`
	let lookup;
	export const initialize = async (context) => {
		let requestIds = 0;
		const { port } = context;
		const pendingRequests = new Map();
		port.onmessage = (event) => {
			const { id, url } = event.data;
			pendingRequests.get(id)?.(url);
		};
		lookup = url => {
			// debugger;
			const myId = requestIds++;
			return new Promise((resolve) => {
				pendingRequests.set(myId, resolve);
				port.postMessage({ id: myId, url, });
			});
		};
	};
	export const resolve = async (specifier, context, nextResolve) => {
		if (specifier !== 'vscode' || !context.parentURL) {
			return nextResolve(specifier, context);
		}
		const otherUrl = await lookup(context.parentURL);
		return {
			url: otherUrl,
			shortCircuit: true,
		};
	};`}static{this.n="_VSCODE_IMPORT_VSCODE_API"}dispose(){this.o.dispose()}k(){const t=new LL,i=new Map;Object.defineProperty(globalThis,Kl.n,{enumerable:!1,configurable:!1,writable:!1,value:a=>t.getKey(a)});const{port1:s,port2:r}=new MessageChannel;let n;const o=s;o.onmessage=a=>{n||(n=this.a.get("vscode"),R1(n));const{id:c,url:l}=a.data,u=y.parse(l),h=n.load("_not_used",u,()=>{throw new Error("CANNOT LOAD MODULE from here.")});let f=t.get(h);f||(f=At(),t.set(h,f));let p=i.get(f);if(!p){const g=`const _vscodeInstance = globalThis.${Kl.n}('${f}');

${Object.keys(h).map((v=>`export const ${v} = _vscodeInstance['${v}'];`)).join(`
`)}`;p=Kl.l(g),i.set(f,p)}s.postMessage({id:c,url:p})},VM.register(Kl.l(Kl.m),{parentURL:import.meta.url,data:{port:r},transferList:[r]}),this.o.add(se(()=>{s.close(),r.close()}))}},pee=class extends s4{constructor(){super(...arguments),this.extensionRuntime=og.Node}async wb(){this.h.createInstance(gE);const e=this.h.invokeFunction(ZX);if(this.h.createInstance(dE),this.f.remote.isRemote&&this.f.remote.authority){const i=this.h.createInstance(fE);process.env.VSCODE_IPC_HOOK_CLI=i.ipcHandlePath}this.h.createInstance(wE),await this.h.createInstance(dee,e,{mine:this.J,all:this.L}).install(),await this.B.add(this.h.createInstance(fee,e,{mine:this.J,all:this.L})).install(),Ht("code/extHost/didInitAPI");const t=await this.m.getConfigProvider();await CK(this.j,t,this,this.q,this.y,this.f,this.B),Ht("code/extHost/didInitProxyResolver")}xb(e){return e.main}async Cb(e,t,i,s){if(t.scheme!==V.file)throw new Error(`Cannot load URI: '${t}', must be of file-scheme`);let r=null;i.codeLoadingStart(),this.q.trace(`ExtensionService#loadModule [${s}] -> ${t.toString(!0)}`),this.q.flush();const n=e?.identifier.value;e&&await this.u.initializeLocalizedMessages(e);try{n&&Ht(`code/extHost/willLoadExtensionCode/${n}`),s==="esm"?r=await import(t.toString(!0)):r=GM(t.fsPath)}finally{n&&Ht(`code/extHost/didLoadExtensionCode/${n}`),i.codeLoadingStop()}return r}async yb(e,t,i){return this.Cb(e,t,i,"cjs")}async zb(e,t,i){return this.Cb(e,t,i,"esm")}async $setRemoteEnvironment(e){if(this.f.remote.isRemote)for(const t in e){const i=e[t];i===null?delete process.env[t]:process.env[t]=i}}};import*as Pd from"fs";import{exec as JM}from"child_process";var gee=(e,t,i)=>{const s=new Uint8Array(16);for(let o=0;o<16;o++)s[o]=Math.round(Math.random()*256);const r=_n(_.wrap(s));return[`GET ws://localhost${e}?${t}&skipWebSocketFrames=true HTTP/1.1`,"Connection: Upgrade","Upgrade: websocket",`Sec-WebSocket-Key: ${r}`].join(`\r
`)+`\r
\r
`},ZM=_.fromString(`\r
\r
`);async function mee(e,t,i,s,r){e.write(_.fromString(gee(t,i,s)));const n=new X;try{return await new Promise((o,a)=>{let c;n.add(e.onData(l=>{c?c=_.concat([c,l],c.byteLength+l.byteLength):c=l;const u=c.indexOf(ZM);if(u===-1)return;o(e),e.pauseData();const h=c.slice(u+ZM.byteLength);h.byteLength&&r.onData.fire(h)})),n.add(e.onClose(l=>a(l??new Error("socket closed")))),n.add(e.onEnd(()=>a(new Error("socket ended"))))})}catch(o){throw e.dispose(),o}finally{n.dispose()}}var vee=class extends J{constructor(e,t){super(),this.g=e,this.a=this.D(new hu),this.onData=(...i)=>(this.a.isPaused&&queueMicrotask(()=>this.a.resume()),this.a.event(...i)),this.b=this.D(new I),this.onDidDispose=this.b.event,this.f=!1,this.D(t.onData),this.D(t.onData.event(i=>this.a.fire(i))),this.onClose=this.D(t.onClose).event,this.onEnd=this.D(t.onEnd).event}pauseData(){this.a.pause()}drain(){return Promise.resolve()}end(){this.f=!0,this.h()}traceSocketEvent(e,t){$f.traceSocketEvent(this,this.g,e,t)}dispose(){this.f||this.h(),this.b.fire(),super.dispose()}},wee="signService",Td=W(wee);import*as bee from"net";import*as yee from"os";import*as Aee from"net";var YM={1:!0,7:!0,9:!0,11:!0,13:!0,15:!0,17:!0,19:!0,20:!0,21:!0,22:!0,23:!0,25:!0,37:!0,42:!0,43:!0,53:!0,69:!0,77:!0,79:!0,87:!0,95:!0,101:!0,102:!0,103:!0,104:!0,109:!0,110:!0,111:!0,113:!0,115:!0,117:!0,119:!0,123:!0,135:!0,137:!0,139:!0,143:!0,161:!0,179:!0,389:!0,427:!0,465:!0,512:!0,513:!0,514:!0,515:!0,526:!0,530:!0,531:!0,532:!0,540:!0,548:!0,554:!0,556:!0,563:!0,587:!0,601:!0,636:!0,989:!0,990:!0,993:!0,995:!0,1719:!0,1720:!0,1723:!0,2049:!0,3659:!0,4045:!0,5060:!0,5061:!0,6e3:!0,6566:!0,6665:!0,6666:!0,6667:!0,6668:!0,6669:!0,6697:!0,10080:!0};function See(e,t,i,s="127.0.0.1"){let r=!1,n,o=1;const a=Aee.createServer({pauseOnConnect:!0});function c(l,u){r||(r=!0,a.removeAllListeners(),a.close(),n&&clearTimeout(n),u(l))}return new Promise(l=>{n=setTimeout(()=>{c(0,l)},i),a.on("listening",()=>{c(e,l)}),a.on("error",u=>{u&&(u.code==="EADDRINUSE"||u.code==="EACCES")&&o<t?(e++,o++,a.listen(e,s)):c(0,l)}),a.on("close",()=>{c(0,l)}),a.listen(e,s)})}var Eee=30*1e3,QM;(function(e){e[e.Management=1]="Management",e[e.ExtensionHost=2]="ExtensionHost",e[e.Tunnel=3]="Tunnel"})(QM||(QM={}));function bE(e){switch(e){case 1:return"Management";case 2:return"ExtensionHost";case 3:return"Tunnel"}}function XM(e){const t=new Ke;return setTimeout(()=>t.cancel(),e),t.token}function xee(e,t){if(e.isCancellationRequested||t.isCancellationRequested)return De.Cancelled;const i=new Ke;return e.onCancellationRequested(()=>i.cancel()),t.onCancellationRequested(()=>i.cancel()),i.token}var yE=class{get didTimeout(){return this.c==="timedout"}constructor(e){this.c="pending",this.d=new X,{promise:this.promise,resolve:this.f,reject:this.g}=TC(),e.isCancellationRequested?this.h():this.d.add(e.onCancellationRequested(()=>this.h()))}registerDisposable(e){this.c==="pending"?this.d.add(e):e.dispose()}h(){this.c==="pending"&&(this.d.dispose(),this.c="timedout",this.g(this.i()))}i(){const e=new Error("Time limit reached");return e.code="ETIMEDOUT",e.syscall="connect",e}resolve(e){this.c==="pending"&&(this.d.dispose(),this.c="resolved",this.f(e))}reject(e){this.c==="pending"&&(this.d.dispose(),this.c="rejected",this.g(e))}};function Cee(e,t){const i=new yE(t);return i.registerDisposable(e.onControlMessage(s=>{const r=JSON.parse(s.toString()),n=Lee(r);n?i.reject(n):i.resolve(r)})),i.promise}function kee(e,t,i,s,r,n,o,a){const c=new yE(a),l=Qi.create(!1);return e.info(`Creating a socket (${o})...`),Ht(`code/willCreateSocket/${n}`),t.connect(i,s,r,o).then(u=>{c.didTimeout?(Ht(`code/didCreateSocketError/${n}`),e.info(`Creating a socket (${o}) finished after ${l.elapsed()} ms, but this is too late and has timed out already.`),u?.dispose()):(Ht(`code/didCreateSocketOK/${n}`),e.info(`Creating a socket (${o}) was successful after ${l.elapsed()} ms.`),c.resolve(u))},u=>{Ht(`code/didCreateSocketError/${n}`),e.info(`Creating a socket (${o}) returned an error after ${l.elapsed()} ms.`),e.error(u),c.reject(u)}),c.promise}function AE(e,t){const i=new yE(t);return e.then(s=>{i.didTimeout||i.resolve(s)},s=>{i.didTimeout||i.reject(s)}),i.promise}async function $ee(e,t,i,s){const r=sN(e,t);e.logService.trace(`${r} 1/6. invoking socketFactory.connect().`);let n;try{n=await kee(e.logService,e.remoteSocketFactoryService,e.connectTo,SC.getServerRootPath(),`reconnectionToken=${e.reconnectionToken}&reconnection=${e.reconnectionProtocol?"true":"false"}`,bE(t),`renderer-${bE(t)}-${e.reconnectionToken}`,s)}catch(u){throw e.logService.error(`${r} socketFactory.connect() failed or timed out. Error:`),e.logService.error(u),u}e.logService.trace(`${r} 2/6. socketFactory.connect() was successful.`);let o,a;e.reconnectionProtocol?(e.reconnectionProtocol.beginAcceptReconnection(n,null),o=e.reconnectionProtocol,a=!1):(o=new b0({socket:n}),a=!0),e.logService.trace(`${r} 3/6. sending AuthRequest control message.`);const c=await AE(e.signService.createNewMessage(At()),s),l={type:"auth",auth:e.connectionToken||"00000000000000000000",data:c.data};o.sendControl(_.fromString(JSON.stringify(l)));try{const u=await Cee(o,xee(s,XM(1e4)));if(u.type!=="sign"||typeof u.data!="string"){const g=new Error("Unexpected handshake message");throw g.code="VSCODE_CONNECTION_ERROR",g}if(e.logService.trace(`${r} 4/6. received SignRequest control message.`),!await AE(e.signService.validate(c,u.signedData),s)){const g=new Error("Refused to connect to unsupported server");throw g.code="VSCODE_CONNECTION_ERROR",g}const f=await AE(e.signService.sign(u.data),s),p={type:"connectionType",commit:e.commit,signedData:f,desiredConnectionType:t};return i&&(p.args=i),e.logService.trace(`${r} 5/6. sending ConnectionTypeRequest control message.`),o.sendControl(_.fromString(JSON.stringify(p))),{protocol:o,ownsProtocol:a}}catch(u){throw u&&u.code==="ETIMEDOUT"&&(e.logService.error(`${r} the handshake timed out. Error:`),e.logService.error(u)),u&&u.code==="VSCODE_CONNECTION_ERROR"&&(e.logService.error(`${r} received error control message when negotiating connection. Error:`),e.logService.error(u)),a&&iN(o),u}}async function Iee(e,t,i){const s=Date.now(),r=sN(e,3),{protocol:n}=await $ee(e,3,t,i);return e.logService.trace(`${r} 6/6. handshake finished, connection is up and running after ${Uee(s)}!`),n}async function KM(e,t,i){const{connectTo:s,connectionToken:r}=await e.addressProvider.getAddress();return{commit:e.commit,quality:e.quality,connectTo:s,connectionToken:r,reconnectionToken:t,reconnectionProtocol:i,remoteSocketFactoryService:e.remoteSocketFactoryService,signService:e.signService,logService:e.logService}}async function Dee(e,t,i){const s=await KM(e,At(),null);return await Iee(s,{host:t,port:i},De.None)}function Pee(e){return Qr(t=>new Promise((i,s)=>{const r=setTimeout(i,e*1e3);t.onCancellationRequested(()=>{clearTimeout(r),i()})}))}var eN;(function(e){e[e.ConnectionLost=0]="ConnectionLost",e[e.ReconnectionWait=1]="ReconnectionWait",e[e.ReconnectionRunning=2]="ReconnectionRunning",e[e.ReconnectionPermanentFailure=3]="ReconnectionPermanentFailure",e[e.ConnectionGain=4]="ConnectionGain"})(eN||(eN={}));var Tee=class{constructor(e,t){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.type=0}},Mee=class{constructor(e,t,i,s){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.durationSeconds=i,this.c=s,this.type=1}skipWait(){this.c.cancel()}},Nee=class{constructor(e,t,i){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.type=2}},tN=class{constructor(e,t,i){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.type=4}},Ree=class{constructor(e,t,i,s){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.handled=s,this.type=3}},Ohe=class kn extends J{static triggerPermanentFailure(t,i,s){this._permanentFailure=!0,this.f=t,this.g=i,this.h=s,this.j.forEach(r=>r.F(this.f,this.g,this.h))}static debugTriggerReconnection(){this.j.forEach(t=>t.y())}static debugPauseSocketWriting(){this.j.forEach(t=>t.G())}static{this._permanentFailure=!1}static{this.f=0}static{this.g=0}static{this.h=!1}static{this.j=[]}get n(){return this.c||kn._permanentFailure}constructor(t,i,s,r,n){super(),this.t=t,this.u=i,this.reconnectionToken=s,this.protocol=r,this.w=n,this.m=this.D(new I),this.onDidStateChange=this.m.event,this.c=!1,this.q=!1,this.r=!1,this.s=108e5,this.m.fire(new tN(this.reconnectionToken,0,0)),this.D(r.onSocketClose(o=>{const a=Md(this.t,this.reconnectionToken,!0);o?o.type===0?(this.u.logService.info(`${a} received socket close event (hadError: ${o.hadError}).`),o.error&&this.u.logService.error(o.error)):(this.u.logService.info(`${a} received socket close event (wasClean: ${o.wasClean}, code: ${o.code}, reason: ${o.reason}).`),o.event&&this.u.logService.error(o.event)):this.u.logService.info(`${a} received socket close event.`),this.y()})),this.D(r.onSocketTimeout(o=>{const a=Md(this.t,this.reconnectionToken,!0);this.u.logService.info(`${a} received socket timeout event (unacknowledgedMsgCount: ${o.unacknowledgedMsgCount}, timeSinceOldestUnacknowledgedMsg: ${o.timeSinceOldestUnacknowledgedMsg}, timeSinceLastReceivedSomeData: ${o.timeSinceLastReceivedSomeData}).`),this.y()})),kn.j.push(this),this.D(se(()=>{const o=kn.j.indexOf(this);o>=0&&kn.j.splice(o,1)})),this.n&&this.F(kn.f,kn.g,kn.h)}updateGraceTime(t){const i=Oee(t,108e5),s=Md(this.t,this.reconnectionToken,!1);this.u.logService.trace(`${s} Applying reconnection grace time: ${i}ms (${Math.floor(i/1e3)}s)`),this.s=i}dispose(){super.dispose(),this.r=!0}async y(){if(!this.q)try{this.q=!0,await this.z()}finally{this.q=!1}}async z(){if(this.n||this.r)return;const t=Md(this.t,this.reconnectionToken,!0);this.u.logService.info(`${t} starting reconnecting loop. You can get more information with the trace log level.`),this.m.fire(new Tee(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData()));const i=[0,5,5,10,10,10,10,10,30],s=this.s;if(this.u.logService.info(`${t} starting reconnection with grace time: ${s}ms (${Math.floor(s/1e3)}s)`),s<=0){this.u.logService.error(`${t} reconnection grace time is set to 0ms, will not attempt to reconnect.`),this.C(this.protocol.getMillisSinceLastIncomingData(),0,!1);return}const r=Date.now();let n=-1;do{n++;const o=n<i.length?i[n]:i[i.length-1];try{if(o>0){const c=Pee(o);this.m.fire(new Mee(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),o,c)),this.u.logService.info(`${t} waiting for ${o} seconds before reconnecting...`);try{await c}catch{}}if(this.n){this.u.logService.error(`${t} permanent failure occurred while running the reconnecting loop.`);break}this.m.fire(new Nee(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1)),this.u.logService.info(`${t} resolving connection...`);const a=await KM(this.u,this.reconnectionToken,this.protocol);this.u.logService.info(`${t} connecting to ${a.connectTo}...`),await this.H(a,XM(Eee)),this.u.logService.info(`${t} reconnected!`),this.m.fire(new tN(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1));break}catch(a){if(a.code==="VSCODE_CONNECTION_ERROR"){this.u.logService.error(`${t} A permanent error occurred in the reconnecting loop! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(Date.now()-r>=s){const c=Math.round(s/1e3);this.u.logService.error(`${t} An error occurred while reconnecting, but it will be treated as a permanent error because the reconnection grace time (${c}s) has expired! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(zw.isTemporarilyNotAvailable(a)){this.u.logService.info(`${t} A temporarily not available error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if((a.code==="ETIMEDOUT"||a.code==="ENETUNREACH"||a.code==="ECONNREFUSED"||a.code==="ECONNRESET")&&a.syscall==="connect"){this.u.logService.info(`${t} A network error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if(ki(a)){this.u.logService.info(`${t} A promise cancelation error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if(a instanceof zw){this.u.logService.error(`${t} A RemoteAuthorityResolverError occurred while trying to reconnect. Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,zw.isHandled(a));break}this.u.logService.error(`${t} An unknown error occurred while trying to reconnect, since this is an unknown case, it will be treated as a permanent error! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}}while(!this.n&&!this.r)}C(t,i,s){this.w?kn.triggerPermanentFailure(t,i,s):this.F(t,i,s)}F(t,i,s){this.m.fire(new Ree(this.reconnectionToken,t,i,s)),iN(this.protocol)}G(){this.protocol.pauseSocketWriting()}};function iN(e){try{e.acceptDisconnect();const t=e.getSocket();e.dispose(),t.dispose()}catch(t){pt(t)}}function Lee(e){if(e&&e.type==="error"){const t=new Error(`Connection error: ${e.reason}`);return t.code="VSCODE_CONNECTION_ERROR",t}return null}function Oee(e,t){return typeof e!="number"||!isFinite(e)||e<0?t:e>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:Math.floor(e)}function Fee(e,t){for(;e.length<t;)e+=" ";return e}function jee(e,t){return`[remote-connection][${Fee(bE(e),13)}][${t.substr(0,5)}\u2026]`}function Md(e,t,i){return`${jee(e,t)}[${i?"reconnect":"initial"}]`}function sN(e,t){return`${Md(t,e.reconnectionToken,!!e.reconnectionProtocol)}[${e.connectTo}]`}function Uee(e){return`${Date.now()-e} ms`}var SE=W("remoteSocketFactoryService");async function zee(e,t,i,s,r){let n;for(let o=3;o&&(n?.dispose(),n=await new rN(e,t,i,s,r).waitForReady(),!(r&&YM[r]||!YM[n.tunnelLocalPort]));o--);return n}var rN=class extends J{constructor(e,t,i,s,r){super(),this.m=t,this.n=r,this.privacy=Or.Private,this.j=new Map,this.a=e,this.b=bee.createServer(),this.c=new ms,this.f=()=>this.c.open(),this.b.on("listening",this.f),this.g=n=>this.q(n),this.b.on("connection",this.g),this.h=()=>{},this.b.on("error",this.h),this.tunnelRemotePort=s,this.tunnelRemoteHost=i}async dispose(){super.dispose(),this.b.removeListener("listening",this.f),this.b.removeListener("connection",this.g),this.b.removeListener("error",this.h),this.b.close(),Array.from(this.j.values()).forEach(t=>{t()})}async waitForReady(){const e=this.n??this.tunnelRemotePort,t=fn(this.m)?"0.0.0.0":"127.0.0.1";let i=await See(e,2,1e3,t),s=null;return this.b.listen(i,this.m),await this.c.wait(),s=this.b.address(),s||(i=0,this.b.listen(i,this.m),await this.c.wait(),s=this.b.address()),this.tunnelLocalPort=s.port,this.localAddress=`${this.tunnelRemoteHost==="127.0.0.1"?"127.0.0.1":"localhost"}:${s.port}`,this}async q(e){e.pause();const t=ja(this.tunnelRemoteHost)||fn(this.tunnelRemoteHost)?"localhost":this.tunnelRemoteHost,i=await Dee(this.a,t,this.tunnelRemotePort),s=i.getSocket(),r=i.readEntireBuffer();i.dispose(),r.byteLength>0&&e.write(r.buffer),e.on("end",()=>{e.localAddress&&this.j.delete(e.localAddress),s.end()}),e.on("close",()=>s.end()),e.on("error",()=>{e.localAddress&&this.j.delete(e.localAddress),s instanceof wu?s.socket.destroy():s.end()}),s instanceof wu?this.s(e,s):this.r(e,s),e.localAddress&&this.j.set(e.localAddress,()=>{e.end(),s.end()})}r(e,t){t.onClose(()=>e.destroy()),t.onEnd(()=>e.end()),t.onData(i=>e.write(i.buffer)),e.on("data",i=>t.write(_.wrap(i))),e.resume()}s(e,t){const i=t.socket;i.on("end",()=>e.end()),i.on("close",()=>e.end()),i.on("error",()=>{e.destroy()}),i.pipe(e),e.pipe(i)}},EE=class extends AA{constructor(t,i,s,r,n){super(i,n),this.H=t,this.I=s,this.J=r}isPortPrivileged(t){return KB(t,this.s,Nn,yee.release())}F(t,i,s,r,n,o,a,c){const l=this.C(i,s);if(l)return++l.refcount,l.value;if(QB(t))return this.G(t,i,s,n,o,a,c);{this.q.trace(`ForwardedPorts: (TunnelService) Creating tunnel without provider ${i}:${s} on local port ${n}.`);const u={commit:this.J.commit,quality:this.J.quality,addressProvider:t,remoteSocketFactoryService:this.H,signService:this.I,logService:this.q,ipcLogger:null},h=zee(u,r,i,s,n);return this.q.trace("ForwardedPorts: (TunnelService) Tunnel created without provider."),this.y(i,s,h),h}}};EE=__decorate([__param(0,SE),__param(1,xe),__param(2,Td),__param(3,sd),__param(4,rs)],EE);var xE=class extends EE{constructor(t,i,s,r,n){super(t,i,s,r,n)}};xE=__decorate([__param(0,SE),__param(1,xe),__param(2,Td),__param(3,sd),__param(4,rs)],xE);var nN=class extends J{constructor(t,i,s,r,n){super(),this.b=t,this.c=i,this.f=s,this.g=r,this.h=n,this.a=new Map}async openTunnel(t,i,s,r,n,o,a,c,l){if(this.c.trace(`ForwardedPorts: (SharedTunnelService) openTunnel request for ${s}:${r} on local port ${o}.`),!this.a.has(t)){const u=new xE(this.b,this.c,this.g,this.f,this.h);this.D(u),this.a.set(t,u),u.onTunnelClosed(async()=>{(await u.tunnels).length===0&&(u.dispose(),this.a.delete(t))})}return this.a.get(t).openTunnel(i,s,r,n,o,a,c,l)}};nN=__decorate([__param(0,SE),__param(1,xe),__param(2,sd),__param(3,Td),__param(4,rs)],nN);var Hee=10*1e3,Kv="remote.tunnels.toRestore",CE="remote.tunnels.toRestoreExpiration",Wee=1e3*60*60*24*14,oN="onTunnel",zhe=new C("forwardedPortsViewEnabled",!1,d(16501,null)),_ee=new C("forwardedPortsViewOnlyEnabled",!1,d(16502,null));function aN(e){const t=e.match(/^([a-zA-Z0-9_-]+(?:\.[a-zA-Z0-9_-]+)*:)?([0-9]+)$/);if(t)return{host:t[1]?.substring(0,t[1].length-1)||"localhost",port:Number(t[2])}}var Nd;(function(e){e.Other="Other",e.User="User",e.AutoForwardEnd="AutoForwardEnd"})(Nd||(Nd={}));var Sn;(function(e){e[e.User=0]="User",e[e.Auto=1]="Auto",e[e.Extension=2]="Extension"})(Sn||(Sn={}));var kE={source:Sn.User,description:d(16503,null)},Hhe={source:Sn.Auto,description:d(16504,null)};function cN(e,t,i){const s=e.get(cs(t,i));if(s)return s;if(ja(t))for(const r of Qh){const n=cs(r,i);if(e.has(n))return e.get(n)}else if(fn(t))for(const r of Cm){const n=cs(r,i);if(e.has(n))return e.get(n)}}function Ji(e,t,i){const s=cN(e,t,i);if(s)return s;const r=fn(t)?"localhost":ja(t)?"0.0.0.0":void 0;if(r)return cN(e,r,i)}function cs(e,t){return e+":"+t}var Io;(function(e){e.Notify="notify",e.OpenBrowser="openBrowser",e.OpenBrowserOnce="openBrowserOnce",e.OpenPreview="openPreview",e.Silent="silent",e.Ignore="ignore"})(Io||(Io={}));function Bee(e){return e&&"host"in e&&typeof e.host=="string"&&"port"in e&&typeof e.port=="number"&&(!("detail"in e)||typeof e.detail=="string")&&(!("pid"in e)||typeof e.pid=="string")}var lN=class pr extends J{static{this.c="remote.portsAttributes"}static{this.f="remote.otherPortsAttributes"}static{this.g=/^(\d+)\-(\d+)$/}static{this.h=/^([a-z0-9\-]+):(\d{1,5})$/}constructor(t){super(),this.q=t,this.j=[],this.n=new I,this.onDidChangeAttributes=this.n.event,this.D(t.onDidChangeConfiguration(i=>{(i.affectsConfiguration(pr.c)||i.affectsConfiguration(pr.f))&&this.r()})),this.r()}r(){this.j=this.w(),this.n.fire()}getAttributes(t,i,s){let r=this.u(t,i,s,this.j,0);const n={label:void 0,onAutoForward:void 0,elevateIfNeeded:void 0,requireLocalPort:void 0,protocol:void 0};for(;r>=0;){const o=this.j[r];o.key===t?(n.onAutoForward=o.onAutoForward??n.onAutoForward,n.elevateIfNeeded=o.elevateIfNeeded!==void 0?o.elevateIfNeeded:n.elevateIfNeeded,n.label=o.label??n.label,n.requireLocalPort=o.requireLocalPort,n.protocol=o.protocol):(n.onAutoForward=n.onAutoForward??o.onAutoForward,n.elevateIfNeeded=n.elevateIfNeeded!==void 0?n.elevateIfNeeded:o.elevateIfNeeded,n.label=n.label??o.label,n.requireLocalPort=n.requireLocalPort!==void 0?n.requireLocalPort:void 0,n.protocol=n.protocol??o.protocol),r=this.u(t,i,s,this.j,r+1)}return n.onAutoForward!==void 0||n.elevateIfNeeded!==void 0||n.label!==void 0||n.requireLocalPort!==void 0||n.protocol!==void 0?n:this.z()}s(t){return t.start!==void 0&&t.end!==void 0}t(t){return t.host!==void 0&&t.port!==void 0&&Oe(t.host)&&xs(t.port)}u(t,i,s,r,n){if(n>=r.length)return-1;const o=!ja(i)&&!fn(i),c=r.slice(n).findIndex(l=>xs(l.key)?o?!1:l.key===t:this.s(l.key)?o?!1:t>=l.key.start&&t<=l.key.end:this.t(l.key)?t===l.key.port&&i===l.key.host:s?l.key.test(s):!1);return c>=0?c+n:-1}w(){const t=this.q.getValue(pr.c);if(!t||!kt(t))return[];const i=[];for(const r in t){if(r===void 0)continue;const n=t[r];let o;if(Number(r))o=Number(r);else if(Oe(r))if(pr.g.test(r)){const a=r.match(pr.g);o={start:Number(a[1]),end:Number(a[2])}}else if(pr.h.test(r)){const a=r.match(pr.h);o={host:a[1],port:Number(a[2])}}else{let a;try{a=RegExp(r)}catch{}a&&(o=a)}o&&i.push({key:o,elevateIfNeeded:n.elevateIfNeeded,onAutoForward:n.onAutoForward,label:n.label,requireLocalPort:n.requireLocalPort,protocol:n.protocol})}const s=this.q.getValue(pr.f);return s&&(this.m={elevateIfNeeded:s.elevateIfNeeded,label:s.label,onAutoForward:s.onAutoForward,requireLocalPort:s.requireLocalPort,protocol:s.protocol}),this.y(i)}y(t){function i(s,r){return xs(s.key)?s.key:r.s(s.key)?s.key.start:r.t(s.key)?s.key.port:Number.MAX_VALUE}return t.sort((s,r)=>i(s,this)-i(r,this))}z(){return this.m}static providedActionToAction(t){switch(t){case Eo.Notify:return Io.Notify;case Eo.OpenBrowser:return Io.OpenBrowser;case Eo.OpenBrowserOnce:return Io.OpenBrowserOnce;case Eo.OpenPreview:return Io.OpenPreview;case Eo.Silent:return Io.Silent;case Eo.Ignore:return Io.Ignore;default:return}}async addAttributes(t,i,s){const n=this.q.inspect(pr.c).userRemoteValue;let o;!n||!kt(n)?o={}:o=ct(n),o[`${t}`]||(o[`${t}`]={});for(const a in i)o[`${t}`][a]=i[a];return this.q.updateValue(pr.c,o,s)}},$E=class extends J{constructor(t,i,s,r,n,o,a,c,l,u){super(),this.H=t,this.I=i,this.J=s,this.L=r,this.M=n,this.N=o,this.O=a,this.P=c,this.Q=l,this.R=u,this.c=new Map,this.g=new I,this.onForwardPort=this.g.event,this.h=new I,this.onClosePort=this.h.event,this.j=new I,this.onPortName=this.j.event,this.n=new I,this.onCandidatesChanged=this.n.event,this.s=new I,this.onEnvironmentTunnelsSet=this.s.event,this.t=!1,this.u=void 0,this.y=!1,this.z=new I,this.C=new Map,this.F=new Map,this.G=[],this.U=!1,this.eb=new Date,this.configPortsAttributes=new lN(s),this.r=this.bb(),this.D(this.configPortsAttributes.onDidChangeAttributes(this.kb,this)),this.forwarded=new Map,this.f=new Map,this.H.tunnels.then(async h=>{const f=await this.getAttributes(h.map(p=>({port:p.tunnelRemotePort,host:p.tunnelRemoteHost})));for(const p of h)if(p.localAddress){const g=cs(p.tunnelRemoteHost,p.tunnelRemotePort),v=Ji(this.m??new Map,p.tunnelRemoteHost,p.tunnelRemotePort);this.forwarded.set(g,{remotePort:p.tunnelRemotePort,remoteHost:p.tunnelRemoteHost,localAddress:p.localAddress,protocol:f?.get(p.tunnelRemotePort)?.protocol??Ms.Http,localUri:await this.Y(p.localAddress,f?.get(p.tunnelRemotePort)),localPort:p.tunnelLocalPort,name:f?.get(p.tunnelRemotePort)?.label,runningProcess:v?.detail,hasRunningProcess:!!v,pid:v?.pid,privacy:p.privacy,source:kE}),this.f.set(g,p)}}),this.detected=new Map,this.D(this.H.onTunnelOpened(async h=>{const f=cs(h.tunnelRemoteHost,h.tunnelRemotePort);if(!Ji(this.forwarded,h.tunnelRemoteHost,h.tunnelRemotePort)&&!Ji(this.detected,h.tunnelRemoteHost,h.tunnelRemotePort)&&!Ji(this.c,h.tunnelRemoteHost,h.tunnelRemotePort)&&h.localAddress){const p=Ji(this.m??new Map,h.tunnelRemoteHost,h.tunnelRemotePort),g=(await this.getAttributes([{port:h.tunnelRemotePort,host:h.tunnelRemoteHost}]))?.get(h.tunnelRemotePort);this.forwarded.set(f,{remoteHost:h.tunnelRemoteHost,remotePort:h.tunnelRemotePort,localAddress:h.localAddress,protocol:g?.protocol??Ms.Http,localUri:await this.Y(h.localAddress,g),localPort:h.tunnelLocalPort,name:g?.label,closeable:!0,runningProcess:p?.detail,hasRunningProcess:!!p,pid:p?.pid,privacy:h.privacy,source:kE})}await this.db(),this.W(!0),this.f.set(f,h),this.g.fire(this.forwarded.get(f))})),this.D(this.H.onTunnelClosed(h=>this.X(h,Nd.Other))),this.W(!1)}S(){return this.Q.extensions.find(t=>t.activationEvents?.includes(oN))?(this.R.createKey(_ee.key,!0),!0):!1}W(t){if(this.U||(t&&(this.U=!0),this.L.remoteAuthority!==void 0&&!t)||this.S())return;const s=this.D(this.Q.onDidRegisterExtensions(()=>{this.S()&&s.dispose()}))}async X(t,i){const s=cs(t.host,t.port);this.forwarded.delete(s)&&(await this.db(),this.h.fire(t))}Y(t,i){if(t.startsWith("http"))return y.parse(t);const s=i?.protocol??"http";return y.parse(`${s}://${t}`)}async Z(t){const i=this.N.getWorkspace(),s=i.configuration?Ar(i.configuration.path):i.folders.length>0?Ar(i.folders[0].uri.path):void 0;if(s===void 0){this.O.debug("Could not get workspace hash for forwarded ports storage key.");return}return`${t}.${this.L.remoteAuthority}.${s}`}async $(){return this.Z(Kv)}async ab(){return this.Z(CE)}async bb(){const t=this.I.get(Kv,1);if(t)return this.I.remove(Kv,1),await this.db(),t;const i=await this.$();if(i)return this.I.get(i,0)}async restoreForwarded(){if(this.cb(),this.J.getValue("remote.restoreForwardedPorts")){const t=await this.r;if(t&&t!==this.w){const i=JSON.parse(t)??[];this.O.trace(`ForwardedPorts: (TunnelModel) restoring ports ${i.map(s=>s.remotePort).join(", ")}`);for(const s of i){const r=Ji(this.detected,s.remoteHost,s.remotePort);s.source.source!==Sn.Extension&&!r||s.source.source===Sn.Extension&&r?await this.gb({remote:{host:s.remoteHost,port:s.remotePort},local:s.localPort,name:s.name,elevateIfNeeded:!0,source:s.source}):s.source.source===Sn.Extension&&!r&&this.C.set(cs(s.remoteHost,s.remotePort),s)}}}if(this.y=!0,this.z.fire(),!this.u){const t=await this.$();this.u=this.D(new X),this.u.add(this.I.onDidChangeValue(0,void 0,this.u)(async i=>{i.key===t&&(this.r=Promise.resolve(this.I.get(t,0)),await this.restoreForwarded())}))}}cb(){const t=this.I.keys(0,0).filter(i=>i.startsWith(CE));for(const i of t){const s=this.I.getNumber(i,0);if(s&&s<Date.now()){this.r=Promise.resolve(void 0);const r=i.replace(CE,Kv);this.I.remove(i,0),this.I.remove(r,0)}}}async db(){if(this.J.getValue("remote.restoreForwardedPorts")){const t=Array.from(this.forwarded.values()),i=t.map(o=>({remoteHost:o.remoteHost,remotePort:o.remotePort,localPort:o.localPort,name:o.name,localAddress:o.localAddress,localUri:o.localUri,protocol:o.protocol,source:o.source}));let s;t.length>0&&(s=JSON.stringify(i));const r=await this.$(),n=await this.ab();!s&&r&&n?(this.I.remove(r,0),this.I.remove(n,0)):s!==this.w&&r&&n&&(this.I.store(r,s,0,0),this.I.store(n,Date.now()+Wee,0,0)),this.w=s}}async fb(t,i,s){if(!t.tunnelLocalPort||!s?.requireLocalPort||t.tunnelLocalPort===i)return;const r=new Date;if(this.eb.getTime()+Hee>r.getTime())return;this.eb=r;const n=d(16505,null,i,t.tunnelRemotePort,t.tunnelLocalPort);return this.P.info(n)}async forward(t,i){return!this.y&&this.L.remoteAuthority&&await Ie.toPromise(this.z.event),this.gb(t,i)}async gb(t,i){await this.Q.activateByEvent(oN);const s=Ji(this.forwarded,t.remote.host,t.remote.port);i=i??(i!==null?(await this.getAttributes([t.remote]))?.get(t.remote.port):void 0);const r=t.local!==void 0?t.local:t.remote.port;let n;if(s)return this.ib(s,t,i);{const o=this.L.remoteAuthority,a=o?{getAddress:async()=>(await this.M.resolveAuthority(o)).authority}:void 0,c=cs(t.remote.host,t.remote.port);this.c.set(c,!0),t=this.hb(c,t);const l=await this.H.openTunnel(a,t.remote.host,t.remote.port,void 0,r,t.elevateIfNeeded?t.elevateIfNeeded:i?.elevateIfNeeded,t.privacy,i?.protocol);if(typeof l=="string")n=l;else if(l&&l.localAddress){const u=Ji(this.m??new Map,t.remote.host,t.remote.port),h=l.protocol?l.protocol===Ms.Https?Ms.Https:Ms.Http:i?.protocol??Ms.Http,f={remoteHost:l.tunnelRemoteHost,remotePort:l.tunnelRemotePort,localPort:l.tunnelLocalPort,name:i?.label??t.name,closeable:!0,localAddress:l.localAddress,protocol:h,localUri:await this.Y(l.localAddress,i),runningProcess:u?.detail,hasRunningProcess:!!u,pid:u?.pid,source:t.source??kE,privacy:l.privacy};return this.forwarded.set(c,f),this.f.set(c,l),this.c.delete(c),await this.db(),await this.fb(l,r,i),this.g.fire(f),l}this.c.delete(c)}return n}hb(t,i){const s=this.C.has(t)?this.C:this.F.has(t)?this.F:void 0;if(s){const r=s.get(t);s.delete(t),r&&(i.name=r.name??i.name,i.local=("local"in r?r.local:"localPort"in r?r.localPort:void 0)??i.local,i.privacy=i.privacy)}return i}async ib(t,i,s){const r=s?.label??i.name;let n;(function(a){a[a.None=0]="None",a[a.Fire=1]="Fire",a[a.Reopen=2]="Reopen"})(n||(n={}));let o=n.None;switch(r!==t.name&&(t.name=r,o=n.Fire),(s?.protocol||t.protocol!==Ms.Http)&&s?.protocol!==t.protocol&&(i.source=t.source,o=n.Reopen),i.privacy&&t.privacy!==i.privacy&&(o=n.Reopen),o){case n.Fire:{this.g.fire();break}case n.Reopen:await this.close(t.remoteHost,t.remotePort,Nd.User),await this.gb(i,s)}return Ji(this.f,i.remote.host,i.remote.port)}async name(t,i,s){const r=Ji(this.forwarded,t,i),n=cs(t,i);if(r){r.name=s,await this.db(),this.j.fire({host:t,port:i});return}else this.detected.has(n)&&(this.detected.get(n).name=s,this.j.fire({host:t,port:i}))}async close(t,i,s){const r=cs(t,i),n=this.forwarded.get(r);return s===Nd.AutoForwardEnd&&n&&n.source.source===Sn.Auto&&this.F.set(r,{local:n.localPort,name:n.name,privacy:n.privacy}),await this.H.closeTunnel(t,i),this.X({host:t,port:i},s)}address(t,i){const s=cs(t,i);return(this.forwarded.get(s)||this.detected.get(s))?.localAddress}get environmentTunnelsSet(){return this.t}addEnvironmentTunnels(t){if(t)for(const i of t){const s=Ji(this.m??new Map,i.remoteAddress.host,i.remoteAddress.port),r=typeof i.localAddress=="string"?i.localAddress:cs(i.localAddress.host,i.localAddress.port);this.detected.set(cs(i.remoteAddress.host,i.remoteAddress.port),{remoteHost:i.remoteAddress.host,remotePort:i.remoteAddress.port,localAddress:r,protocol:Ms.Http,localUri:this.Y(r),closeable:!1,runningProcess:s?.detail,hasRunningProcess:!!s,pid:s?.pid,privacy:Or.ConstantPrivate,source:{source:Sn.Extension,description:d(16506,null)}}),this.H.setEnvironmentTunnel(i.remoteAddress.host,i.remoteAddress.port,r,Or.ConstantPrivate,Ms.Http)}this.t=!0,this.s.fire(),this.g.fire()}setCandidateFilter(t){this.q=t}async setCandidates(t){let i=t;this.q&&(i=await this.q(t));const s=this.jb(i);this.O.trace(`ForwardedPorts: (TunnelModel) removed candidates ${Array.from(s.values()).map(r=>r.port).join(", ")}`),this.n.fire(s)}jb(t){const i=this.m??new Map,s=new Map;return this.m=s,t.forEach(r=>{const n=cs(r.host,r.port);s.set(n,{host:r.host,port:r.port,detail:r.detail,pid:r.pid}),i.delete(n);const o=Ji(this.forwarded,r.host,r.port);o&&(o.runningProcess=r.detail,o.hasRunningProcess=!0,o.pid=r.pid)}),i.forEach((r,n)=>{const o=aN(n);if(!o)return;const a=Ji(this.forwarded,o.host,o.port);a&&(a.runningProcess=void 0,a.hasRunningProcess=!1,a.pid=void 0);const c=Ji(this.detected,o.host,o.port);c&&(c.runningProcess=void 0,c.hasRunningProcess=!1,c.pid=void 0)}),i}get candidates(){return this.m?Array.from(this.m.values()):[]}get candidatesOrUndefined(){return this.m?this.candidates:void 0}async kb(){const t=Array.from(this.forwarded.values()),i=await this.getAttributes(t.map(s=>({port:s.remotePort,host:s.remoteHost})),!1);if(i)for(const s of t){const r=i.get(s.remotePort);(r?.protocol||s.protocol!==Ms.Http)&&r?.protocol!==s.protocol&&await this.gb({remote:{host:s.remoteHost,port:s.remotePort},local:s.localPort,name:s.name,source:s.source},r),r&&r.label&&r.label!==s.name&&await this.name(s.remoteHost,s.remotePort,r.label)}}async getAttributes(t,i=!0){const s=new Map,r=new Map;t.forEach(l=>{const u=Ji(this.m??new Map,Qh[0],l.port)??l;if(u){s.set(l.port,u);const h=Bee(u)?u.pid:void 0;r.has(h)||r.set(h,[]),r.get(h)?.push(l.port)}});const n=new Map;if(t.forEach(l=>{const u=this.configPortsAttributes.getAttributes(l.port,l.host,s.get(l.port)?.detail);u&&n.set(l.port,u)}),this.G.length===0||!i)return n.size>0?n:void 0;const o=await Promise.all(this.G.flatMap(l=>Array.from(r.entries()).map(u=>{const h=u[1],f=s.get(h[0]);return l.providePortAttributes(h,f?.pid,f?.detail,De.None)}))),a=new Map;if(o.forEach(l=>l.forEach(u=>{u&&a.set(u.port,u)})),!n&&!a)return;const c=new Map;return t.forEach(l=>{const u=n.get(l.port),h=a.get(l.port);c.set(l.port,{elevateIfNeeded:u?.elevateIfNeeded,label:u?.label,onAutoForward:u?.onAutoForward??lN.providedActionToAction(h?.autoForwardAction),requireLocalPort:u?.requireLocalPort,protocol:u?.protocol})}),c}addAttributesProvider(t){this.G.push(t)}};__decorate([kf(1e3)],$E.prototype,"db",null),$E=__decorate([__param(0,YB),__param(1,_a),__param(2,rs),__param(3,GA),__param(4,E_),__param(5,Iu),__param(6,xe),__param(7,hT),__param(8,yD),__param(9,Jn)],$E);function qee(e){const t=e.trim().split(`
`),i=[];return t.forEach(r=>{const n=/\/proc\/(\d+)\/fd\/\d+ -> socket:\[(\d+)\]/.exec(r);n&&n.length>=3&&i.push({pid:parseInt(n[1],10),socket:parseInt(n[2],10)})}),i.reduce((r,n)=>(r[n.socket]=n,r),{})}function Vee(...e){const t=[].concat(...e.map(Jee));return[...new Map(t.filter(i=>i.st==="0A").map(i=>{const s=i.local_address.split(":");return{socket:parseInt(i.inode,10),ip:Gee(s[0]),port:parseInt(s[1],16)}}).map(i=>[i.ip+":"+i.port,i])).values()]}function Gee(e){let t="";if(e.length===8)for(let i=e.length-2;i>=0;i-=2)t+=parseInt(e.substr(i,2),16),i!==0&&(t+=".");else for(let i=0;i<e.length;i+=8){const s=e.substring(i,i+8);let r="";for(let n=8;n>=2;n-=2)r+=s.substring(n-2,n),(n===6||n===2)&&(r=parseInt(r,16).toString(16),t+=`${r}`,r="",i+n!==e.length-6&&(t+=":"))}return t}function Jee(e){const t=e.trim().split(`
`),i=t.shift().trim().split(/\s+/).filter(r=>r!=="rx_queue"&&r!=="tm->when");return t.map(r=>r.trim().split(/\s+/).reduce((n,o,a)=>(n[i[a]||a]=o,n),{}))}function Zee(e){return e.length>500?!1:!!e.match(/.*\.vscode-server-[a-zA-Z]+\/bin.*/)||e.indexOf("out/server-main.js")!==-1||e.indexOf("_productName=VSCode")!==-1}function Yee(e){const t=e.trim().split(`
`),i=[];return t.forEach(s=>{const r=/^\d+\s+\D+\s+root\s+(\d+)\s+(\d+).+\d+\:\d+\:\d+\s+(.+)$/.exec(s);r&&r.length>=4&&i.push({pid:parseInt(r[1],10),ppid:parseInt(r[2]),cmd:r[3]})}),i}async function Qee(e,t,i){const s=i.reduce((n,o)=>(n[o.pid]=o,n),{}),r=[];return e.forEach(({socket:n,ip:o,port:a})=>{const c=t[n]?t[n].pid:void 0,l=c?s[c]?.cmd:void 0;c&&l&&!Zee(l)&&r.push({host:o,port:a,detail:l,pid:c})}),r}function Xee(e,t,i){const s=new Map,r=Yee(t);for(const n of e){const o=i.get(n.port);if(o){s.set(n.port,o);continue}const a=r.find(c=>c.cmd.includes(`${n.port}`));if(a){let c=a,l;do l=r.find(u=>u.ppid===c.pid),l&&(c=l);while(l);s.set(n.port,{host:n.ip,port:n.port,pid:c.pid,detail:c.cmd,ppid:c.ppid})}else s.set(n.port,{host:n.ip,port:n.port,ppid:Number.MAX_VALUE})}return s}var IE=class extends $m{constructor(t,i,s,r,n){super(t,i,s),this.C=i,this.F=r,this.G=n,this.w=void 0,this.y=new Map,this.z=!1,Mt&&i.remote.isRemote&&i.remote.authority&&(this.a.$setRemoteTunnelService(process.pid),this.I())}async $registerCandidateFinder(t){if(t&&this.z)return;this.z=t;let i;this.w&&(i=this.w,await this.a.$onFoundNewCandidates(this.w));const s=new BU;let r=0;for(;this.z;){const n=new Date().getTime(),o=(await this.J()).filter(l=>ja(l.host)||fn(l.host));this.r.trace(`ForwardedPorts: (ExtHostTunnelService) found candidate ports ${o.map(l=>l.port).join(", ")}`);const a=new Date().getTime()-n;this.r.trace(`ForwardedPorts: (ExtHostTunnelService) candidate port scan took ${a} ms.`),r++>3&&s.update(a),(!i||JSON.stringify(i)!==JSON.stringify(o))&&(i=o,await this.a.$onFoundNewCandidates(i));const c=this.H(s.value);this.r.trace(`ForwardedPorts: (ExtHostTunnelService) next candidate port scan in ${c} ms.`),await new Promise(l=>setTimeout(()=>l(),c))}}H(t){return Math.max(t*20,2e3)}async I(){this.w=await this.J(),this.r.trace(`ForwardedPorts: (ExtHostTunnelService) Initial candidates found: ${this.w.map(t=>t.port).join(", ")}`)}async J(){let t="",i="";try{t=await Pd.promises.readFile("/proc/net/tcp","utf8"),i=await Pd.promises.readFile("/proc/net/tcp6","utf8")}catch{}const s=Vee(t,i),r=await new Promise(f=>{JM("ls -l /proc/[0-9]*/fd/[0-9]* | grep socket:",(p,g,v)=>{f(g)})}),n=qee(r),o=await at.readdir("/proc"),a=[];for(const f of o)try{const p=Number(f),g=Lt(y.file("/proc"),f);if((await Pd.promises.stat(g.fsPath)).isDirectory()&&!isNaN(p)){const b=await Pd.promises.readlink(Lt(g,"cwd").fsPath),S=await Pd.promises.readFile(Lt(g,"cmdline").fsPath,"utf8");a.push({pid:p,cwd:b,cmd:S})}}catch{}const c=[],l=s.filter((f=>{const p=n[f.socket];return p||c.push(f),p})),u=Qee(l,n,a);let h;if(this.r.trace(`ForwardedPorts: (ExtHostTunnelService) number of possible root ports ${c.length}`),c.length>0){const f=await new Promise(p=>{JM("ps -F -A -l | grep root",(g,v,b)=>{p(v)})});this.y=Xee(c,f,this.y),h=Array.from(this.y.values()),this.r.trace(`ForwardedPorts: (ExtHostTunnelService) heuristic ports ${h.map(p=>p.port).join(", ")}`)}return u.then(f=>h?f.concat(h):f)}async L(){const t=(await this.G.getConfigProvider()).getConfiguration("remote").get("localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}u(t){return async i=>{const s=new rN({commit:this.C.commit,quality:this.C.quality,logService:this.r,ipcLogger:null,remoteSocketFactoryService:{_serviceBrand:void 0,async connect(n,o,a,c){const l=await t.makeConnection();return Kee.connect(l,o,a,c)},register(){throw new Error("not implemented")}},addressProvider:{getAddress(){return Promise.resolve({connectTo:new $D(0),connectionToken:t.connectionToken})}},signService:this.F},await this.L(),i.remoteAddress.host||"localhost",i.remoteAddress.port,i.localAddressPort);await s.waitForReady();const r=new I;return{localAddress:aN(s.localAddress)??s.localAddress,remoteAddress:{port:s.tunnelRemotePort,host:s.tunnelRemoteHost},onDidDispose:r.event,dispose:()=>{s.dispose(),r.fire(),r.dispose()}}}}};IE=__decorate([__param(0,Te),__param(1,Wt),__param(2,xe),__param(3,Td),__param(4,bs)],IE);var Kee=class FR extends vee{static connect(t,i,s,r){const n=new X,o={onClose:n.add(new I),onData:n.add(new I),onEnd:n.add(new I)};n.add(t.onDidReceiveMessage(c=>o.onData.fire(_.wrap(c)))),n.add(t.onDidEnd(()=>o.onEnd.fire())),n.add(t.onDidClose(c=>o.onClose.fire({type:0,error:c,hadError:!!c})));const a=new FR(t,r,o);return a.D(n),mee(a,i,s,r,o)}constructor(t,i,s){super(i,s),this.n=t}write(t){this.n.send(t.buffer)}h(){this.n.end()}async drain(){await this.n.drain?.()}};import*as Ga from"fs";var ete=class extends yA{constructor(){super(...arguments),this.i=null}async g(e){const t=await super.g(e);if(t.scheme!==V.file)return t;if(this.b.skipWorkspaceStorageLock)return this.d.info(`Skipping acquiring lock for ${t.fsPath}.`),t;const i=t.fsPath;let s=0;do{let r;s===0?r=i:r=/[/\\]$/.test(i)?`${i.substr(0,i.length-1)}-${s}`:`${i}-${s}`,await tte(r);const n=Ge(r,"vscode.lock"),o=await hN(this.d,n,!1);if(o)return this.i=o,process.on("exit",()=>{o.dispose()}),y.file(r);s++}while(s<10);return t}onWillDeactivateAll(){this.i?.setWillRelease(6e3)}};async function tte(e){try{await Ga.promises.stat(e);return}catch{}try{await Ga.promises.mkdir(e,{recursive:!0})}catch{}}var ite=1e3,uN=600*1e3,ste=class extends J{constructor(e,t){super(),this.b=e,this.c=t,this.a=this.D(new LC),this.a.cancelAndSet(async()=>{const i=await DE(e,t);(!i||i.pid!==process.pid)&&(e.info(`Lock '${t}': The lock was lost unexpectedly.`),this.a.cancel());try{await Ga.promises.utimes(t,new Date,new Date)}catch(s){e.error(s),e.info(`Lock '${t}': Could not update mtime.`)}},ite)}dispose(){super.dispose();try{Ga.unlinkSync(this.c)}catch{}}async setWillRelease(e){this.b.info(`Lock '${this.c}': Marking the lockfile as scheduled to be released in ${e} ms.`);try{const t={pid:process.pid,willReleaseAt:Date.now()+e};await at.writeFile(this.c,JSON.stringify(t),{flag:"w"})}catch(t){this.b.error(t)}}};async function hN(e,t,i){try{const r={pid:process.pid,willReleaseAt:0};await at.writeFile(t,JSON.stringify(r),{flag:"wx"})}catch(r){e.error(r)}const s=await DE(e,t);return!s||s.pid!==process.pid?i?(e.info(`Lock '${t}': Could not acquire lock, giving up.`),null):(e.info(`Lock '${t}': Could not acquire lock, checking if the file is stale.`),nte(e,t)):(e.info(`Lock '${t}': Lock acquired.`),new ste(e,t))}async function DE(e,t){let i;try{i=await Ga.promises.readFile(t)}catch(s){return e.error(s),null}try{return JSON.parse(String(i))}catch(s){return e.error(s),null}}async function PE(e,t){let i;try{i=await Ga.promises.stat(t)}catch(s){return e.error(s),0}return i.mtime.getTime()}function rte(e){try{return process.kill(e,0),!0}catch{return!1}}async function nte(e,t){const i=await DE(e,t);if(!i)return e.info(`Lock '${t}': Could not read pid of lock holder.`),Rd(e,t);if(i.willReleaseAt){let a=i.willReleaseAt-Date.now();if(a<5e3){for(a>0?e.info(`Lock '${t}': The lockfile is scheduled to be released in ${a} ms.`):e.info(`Lock '${t}': The lockfile is scheduled to have been released.`);a>0;){if(await Kt(Math.min(100,a)),await PE(e,t)===0)return Rd(e,t);a=i.willReleaseAt-Date.now()}return Rd(e,t)}}if(!rte(i.pid))return e.info(`Lock '${t}': The pid ${i.pid} appears to be gone.`),Rd(e,t);const s=await PE(e,t),r=Date.now()-s;if(r<=uN)return e.info(`Lock '${t}': The lock does not look stale, elapsed: ${r} ms, giving up.`),null;e.info(`Lock '${t}': The lock looks stale, waiting for 2s.`),await Kt(2e3);const n=await PE(e,t),o=Date.now()-n;return o<=uN?(e.info(`Lock '${t}': The lock does not look stale, elapsed: ${o} ms, giving up.`),null):(e.info(`Lock '${t}': The lock looks stale even after waiting for 2s.`),Rd(e,t))}async function Rd(e,t){e.info(`Lock '${t}': Deleting a stale lock.`);try{await Ga.promises.unlink(t)}catch{}return hN(e,t,!0)}var En;(function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.Off=6]="Off"})(En||(En={}));async function ote(e,t,i,s,r){try{const n=await import("@vscode/spdlog");n.setFlushOn(En.Trace);const o=await n.createAsyncRotatingLogger(e,t,i,s);return r?o.clearFormatters():o.setPattern("%Y-%m-%d %H:%M:%S.%e [%l] %v"),o}catch(n){console.error(n)}return null}function dN(e,t,i){switch(t){case K.Trace:e.trace(i);break;case K.Debug:e.debug(i);break;case K.Info:e.info(i);break;case K.Warning:e.warn(i);break;case K.Error:e.error(i);break;case K.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function fN(e,t){switch(t){case K.Trace:e.setLevel(En.Trace);break;case K.Debug:e.setLevel(En.Debug);break;case K.Info:e.setLevel(En.Info);break;case K.Warning:e.setLevel(En.Warning);break;case K.Error:e.setLevel(En.Error);break;case K.Off:e.setLevel(En.Off);break;default:throw new Error(`Invalid log level ${t}`)}}var ate=class extends z0{constructor(e,t,i,s,r){super(),this.n=[],this.setLevel(r),this.q=this.s(e,t,i,s),this.D(this.onDidChangeLogLevel(n=>{this.r&&fN(this.r,n)}))}async s(e,t,i,s){const r=i?6:1,n=30/r*X$.MB,o=await ote(e,t,n,r,s);if(o){this.r=o,fN(this.r,this.getLevel());for(const{level:a,message:c}of this.n)dN(this.r,a,c);this.n=[]}}m(e,t){this.r?dN(this.r,e,t):this.getLevel()<=e&&this.n.push({level:e,message:t})}flush(){this.r?this.u():this.q.then(()=>this.u())}dispose(){this.r?this.w():this.q.then(()=>this.w()),super.dispose()}u(){this.r&&this.r.flush()}w(){this.r&&(this.r.drop(),this.r=void 0)}},cte=class extends Qm{s(e,t,i){return e.scheme===V.file?new ate(i?.name||At(),e.fsPath,!i?.donotRotate,!!i?.donotUseFormatters,t):super.s(e,t,i)}registerLogger(e){super.registerLogger(e),this.c.$registerLogger(e)}deregisterLogger(e){super.deregisterLogger(e),this.c.$deregisterLogger(e)}};import{homedir as lte}from"os";var ute=class extends Gm{m(){return lte()}},hte=class extends J{constructor(e,t=[]){super(),this.a=new TU([e,...t]),this.D(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.a.onDidChangeLogLevel}setLevel(e){this.a.setLevel(e)}getLevel(){return this.a.getLevel()}trace(e,...t){this.a.trace(e,...t)}debug(e,...t){this.a.debug(e,...t)}info(e,...t){this.a.info(e,...t)}warn(e,...t){this.a.warn(e,...t)}error(e,...t){this.a.error(e,...t)}flush(){this.a.flush()}},TE=class extends hte{constructor(t,i,s){const r=s.remote.isRemote?"remoteexthost":t?"workerexthost":"exthost",n=s.remote.isRemote?d(3044,null):d(t?3045:3046,null);super(i.createLogger(r,{name:n}))}};TE=__decorate([__param(1,Zn),__param(2,Wt)],TE);import{spawn as dte}from"child_process";import{readFile as fte}from"fs/promises";import{homedir as pte}from"os";function gte(e){const t=new Map,s=e.replace(/\r\n?/g,`
`).split(`
`);for(let o of s){if(o=o.trim(),!o||o.startsWith("#"))continue;const[a,c]=r(o);a&&t.set(a,c)}return t;function r(o){o.startsWith("export ")&&(o=o.substring(7).trim());const a=n(o,h=>h==="="||h===":");if(a===-1)return[null,null];const c=o.substring(0,a).trim();let l=o.substring(a+1).trim();const u=n(l,h=>h==="#");if(u!==-1&&(l=l.substring(0,u).trim()),l.length>=2){const h=l[0],f=l[l.length-1];(h==='"'&&f==='"'||h==="'"&&f==="'"||h==="`"&&f==="`")&&(l=l.substring(1,l.length-1),h==='"'&&(l=l.replace(/\\n/g,`
`).replace(/\\r/g,"\r")))}return[c,l]}function n(o,a){let c=!1,l="";for(let u=0;u<o.length;u++){const h=o[u];if(c)h===l&&o[u-1]!=="\\"&&(c=!1);else if(h==='"'||h==="'"||h==="`")c=!0,l=h;else if(a(h))return u}return-1}}import{Transform as mte}from"stream";var pN=class extends mte{constructor(e){if(super(),typeof e=="number")this.b=e,this.c=1;else{const t=Buffer.isBuffer(e)?e:Buffer.from(e);this.b=t.length===1?t[0]:t,this.c=t.length}}_transform(e,t,i){this.a?this.a=Buffer.concat([this.a,e]):this.a=e;let s=0;for(;s<this.a.length;){const r=typeof this.b=="number"?this.a.indexOf(this.b,s):_C(this.a,this.b,s);if(r===-1)break;this.push(this.a.slice(s,r+this.c)),s=r+this.c}this.a=s===this.a.length?void 0:this.a.slice(s),i()}_flush(e){this.a&&this.push(this.a),e()}},gN;(function(e){e[e.Running=0]="Running",e[e.StdinEnded=1]="StdinEnded",e[e.KilledPolite=2]="KilledPolite",e[e.KilledForceful=3]="KilledForceful"})(gN||(gN={}));var vte=class jR{static{this.a=1e4}get stopped(){return this.b!==0}constructor(t,i=jR.a){this.d=t,this.e=i,this.b=0}stop(){if(this.b===0){let t=this.e;try{this.d.stdin.end()}catch{t=1}this.b=1,this.c=new RC(()=>this.f(),t)}else this.c?.dispose(),this.g()}async f(){this.b=2,this.c=new RC(()=>this.g(),this.e),this.d.pid?ze||await j4(this.d.pid,!1).catch(()=>{this.d.kill("SIGTERM")}):this.d.kill("SIGTERM")}async g(){this.b=3,this.d.pid?await j4(this.d.pid,!0).catch(()=>{this.d.kill("SIGKILL")}):this.d.kill()}write(t){this.stopped||this.d.stdin.write(t+`
`)}dispose(){this.c?.dispose()}},wte=class extends sv{constructor(){super(...arguments),this.z=this.D(new Fo)}w(e,t,i,s){t.type===1?this.F(e,t,i):t.type===2?this.f.set(e,new bte(e,t,this.b,this.n,s)):super.w(e,t,i,s)}$stopMcp(e){const t=this.z.get(e);t?t.stop():super.$stopMcp(e)}$sendMessage(e,t){const i=this.z.get(e);i?i.write(t):super.$sendMessage(e,t)}async F(e,t,i){const s=a=>this.b.$onDidChangeState(e,{state:3,code:a.hasOwnProperty("code")?String(a.code):void 0,message:typeof a=="string"?a:a.message}),r={...process.env};if(t.envFile)try{for(const[a,c]of gte(await fte(t.envFile,"utf-8")))r[a]=c}catch(a){s(`Failed to read envFile '${t.envFile}': ${a.message}`);return}for(const[a,c]of Object.entries(t.env))r[a]=c===null?void 0:String(c);let n;try{const a=pte();let c=t.cwd?Jf(t.cwd,a):i?.fsPath||a;Cs(c)||(c=Ge(i?i.fsPath:a,c));const{executable:l,args:u,shell:h}=await Ate(Jf(t.command,a),t.args.map(f=>Jf(f,a)),c,r);this.b.$onDidPublishLog(e,K.Debug,`Server command line: ${l} ${u.join(" ")}`),n=dte(l,u,{stdio:"pipe",cwd:c,env:r,shell:h})}catch(a){s(a);return}const o=new vte(n);this.b.$onDidChangeState(e,{state:1}),n.stdout.pipe(new pN(`
`)).on("data",a=>this.b.$onDidReceiveMessage(e,a.toString())),n.stdin.on("error",s),n.stdout.on("error",s),n.stderr.pipe(new pN(`
`)).on("data",a=>this.b.$onDidPublishLog(e,K.Warning,`[server stderr] ${a.toString().trimEnd()}`)),n.on("spawn",()=>this.b.$onDidChangeState(e,{state:2})),n.on("error",a=>{s(a)}),n.on("exit",a=>{this.z.deleteAndDispose(e),a===0||o.stopped?this.b.$onDidChangeState(e,{state:0}):this.b.$onDidChangeState(e,{state:3,message:`Process exited with code ${a}`})}),this.z.set(e,o)}},bte=class extends W7{constructor(){super(...arguments),this.U=new Rt(()=>import("undici"))}async S(e,t){const{fetch:i,Agent:s}=await this.U.value,r={...t};let n=e;const o=y.parse(e);if(o.scheme==="unix"||o.scheme==="pipe")r.dispatcher=new s({socketPath:o.path}),n=o.with({scheme:"http",authority:"localhost",path:o.fragment}).toString(!0);else return super.S(e,t);const a=await i(n,r);return{status:a.status,statusText:a.statusText,headers:a.headers,body:a.body,url:a.url,json:()=>a.json(),text:()=>a.text()}}},yte=/\.(bat|cmd)$/i,Ate=async(e,t,i,s)=>{if(process.platform!=="win32")return{executable:e,args:t,shell:!1};const r=await rv(e,i,void 0,s);if(r&&yte.test(r)){const n=o=>o.includes(" ")?`"${o}"`:o;return{executable:n(r),args:t.map(n),shell:!0}}return{executable:e,args:t,shell:!1}};import{URL as Ste}from"url";import{randomBytes as Ete}from"crypto";import*as xte from"http";import{URL as Cte}from"url";var kte=class{constructor(e,t,i){this.e=e,this.f=t,this.g=i,this.c=Ete(16).toString("base64");const s=new Di;this.b=s.p,this.a=xte.createServer((r,n)=>{const o=new Cte(r.url,`http://${r.headers.host}`);switch(o.pathname){case"/":{const a=o.searchParams.get("code")??void 0,c=o.searchParams.get("state")??void 0,l=o.searchParams.get("error")??void 0;if(l){n.writeHead(302,{location:`/done?error=${o.searchParams.get("error_description")||l}`}),n.end(),s.error(new Error(l));break}if(!a||!c){n.writeHead(400),n.end();break}if(this.state!==c){n.writeHead(302,{location:`/done?error=${encodeURIComponent("State does not match.")}`}),n.end(),s.error(new Error("State does not match."));break}s.complete({code:a,state:c}),n.writeHead(302,{location:"/done"}),n.end();break}case"/done":this.h(n);break;default:n.writeHead(404),n.end();break}})}get state(){return this.c}get redirectUri(){if(this.d===void 0)throw new Error("Server is not started yet");return`http://127.0.0.1:${this.d}/`}h(e){const t=this.getHtml();e.writeHead(200,{"Content-Type":"text/html","Content-Length":Buffer.byteLength(t,"utf8")}),e.end(t)}start(){const e=new Di;if(this.a.listening)throw new Error("Server is already started");const t=setTimeout(()=>{e.error(new Error("Timeout waiting for port"))},5e3);return this.a.on("listening",()=>{const i=this.a.address();if(typeof i=="string")this.d=parseInt(i);else if(i instanceof Object)this.d=i.port;else throw new Error("Unable to determine port");clearTimeout(t),e.complete()}),this.a.on("error",i=>{if("code"in i&&i.code==="EADDRINUSE"){this.e.error("Address in use, retrying with a different port..."),this.a.listen(0,"127.0.0.1");return}clearTimeout(t),e.error(new Error(`Error listening to server: ${i}`))}),this.a.on("close",()=>{e.error(new Error("Closed"))}),this.a.listen(h8,"127.0.0.1"),e.p}stop(){const e=new Di;return this.a.listening?(this.a.close(t=>{t?e.error(t):e.complete()}),setTimeout(()=>{e.isResolved||e.error(new Error("Timeout waiting for server to close"))},5e3),e.p):(e.complete(),e.p)}waitForOAuthResponse(){return this.b}getHtml(){let e="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQABAMAAACNMzawAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAJ1BMVEUAAAD///9Qm8+ozed8tNsWer+Lvd9trNfF3u9Ck8slgsMzi8eZxeM/Qa6mAAAAAXRSTlMAQObYZgAAAAFiS0dEAf8CLd4AAAAHdElNRQfiCwYULRt0g+ZLAAAJRUlEQVR42u3SUY0CQRREUSy0hSZtBA+wfOwv4wAPYwAJSMAfAthkB6YD79HnKqikzmYjSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk6cmKhg4AAASAABAAAkAACAABIAAEgAAQAAJAAAgAAaBvBVAjtV2wfFe1ogcA+0gdFgBoe60IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAjAP/1MkWoAvBvAsUTqBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJAAgAASAABIAAEAACQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7gDlbFwC6AijZagAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQDM2boA0BXAqAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIATARAAAkAAvF7N1hWArgBKthoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfBrAlK0bAF0BjBoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4EQABIAAEwOtN2boB0BVAyVYDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgE8DqNm6AtAVwKgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEwEQAAJAAPzd7xypMwDvBnAskToBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAIAAkAACAABIAAEgAAQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBKBGarsAwK5qRQ8ANGYAACAABIAAEAACQAAIAAEgAASAABAAAkDfCUCSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJC3uDtO80OSql+i8AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTA2VDIwOjQ1OjI3KzAwOjAwEjLurQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wNlQyMDo0NToyNyswMDowMGNvVhEAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAAElFTkSuQmCC')";return this.g==="Visual Studio Code"?e="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtYXNrIGlkPSJtYXNrMCIgbWFzay10eXBlPSJhbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MS41MzQgMjU0LjI1MkMxODUuNTY2IDI1NS44MjMgMTkwLjE2NCAyNTUuNzIyIDE5NC4yMzQgMjUzLjc2NEwyNDYuOTQgMjI4LjQwM0MyNTIuNDc4IDIyNS43MzggMjU2IDIyMC4xMzIgMjU2IDIxMy45ODNWNDIuMDE4MUMyNTYgMzUuODY4OSAyNTIuNDc4IDMwLjI2MzggMjQ2Ljk0IDI3LjU5ODhMMTk0LjIzNCAyLjIzNjgxQzE4OC44OTMgLTAuMzMzMTMyIDE4Mi42NDIgMC4yOTYzNDQgMTc3Ljk1NSAzLjcwNDE4QzE3Ny4yODUgNC4xOTEgMTc2LjY0NyA0LjczNDU0IDE3Ni4wNDkgNS4zMzM1NEw3NS4xNDkgOTcuMzg2MkwzMS4xOTkyIDY0LjAyNDdDMjcuMTA3OSA2MC45MTkxIDIxLjM4NTMgNjEuMTczNSAxNy41ODU1IDY0LjYzTDMuNDg5MzYgNzcuNDUyNUMtMS4xNTg1MyA4MS42ODA1IC0xLjE2Mzg2IDg4Ljk5MjYgMy40Nzc4NSA5My4yMjc0TDQxLjU5MjYgMTI4TDMuNDc3ODUgMTYyLjc3M0MtMS4xNjM4NiAxNjcuMDA4IC0xLjE1ODUzIDE3NC4zMiAzLjQ4OTM2IDE3OC41NDhMMTcuNTg1NSAxOTEuMzdDMjEuMzg1MyAxOTQuODI3IDI3LjEwNzkgMTk1LjA4MSAzMS4xOTkyIDE5MS45NzZMNzUuMTQ5IDE1OC42MTRMMTc2LjA0OSAyNTAuNjY3QzE3Ny42NDUgMjUyLjI2NCAxNzkuNTE5IDI1My40NjcgMTgxLjUzNCAyNTQuMjUyWk0xOTIuMDM5IDY5Ljg4NTNMMTE1LjQ3OSAxMjhMMTkyLjAzOSAxODYuMTE1VjY5Ljg4NTNaIiBmaWxsPSJ3aGl0ZSIvPgo8L21hc2s+CjxnIG1hc2s9InVybCgjbWFzazApIj4KPHBhdGggZD0iTTI0Ni45NCAyNy42MzgzTDE5NC4xOTMgMi4yNDEzOEMxODguMDg4IC0wLjY5ODMwMiAxODAuNzkxIDAuNTQxNzIxIDE3NS45OTkgNS4zMzMzMkwzLjMyMzcxIDE2Mi43NzNDLTEuMzIwODIgMTY3LjAwOCAtMS4zMTU0OCAxNzQuMzIgMy4zMzUyMyAxNzguNTQ4TDE3LjQzOTkgMTkxLjM3QzIxLjI0MjEgMTk0LjgyNyAyNi45NjgyIDE5NS4wODEgMzEuMDYxOSAxOTEuOTc2TDIzOS4wMDMgMzQuMjI2OUMyNDUuOTc5IDI4LjkzNDcgMjU1Ljk5OSAzMy45MTAzIDI1NS45OTkgNDIuNjY2N1Y0Mi4wNTQzQzI1NS45OTkgMzUuOTA3OCAyNTIuNDc4IDMwLjMwNDcgMjQ2Ljk0IDI3LjYzODNaIiBmaWxsPSIjMDA2NUE5Ii8+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2QpIj4KPHBhdGggZD0iTTI0Ni45NCAyMjguMzYyTDE5NC4xOTMgMjUzLjc1OUMxODguMDg4IDI1Ni42OTggMTgwLjc5MSAyNTUuNDU4IDE3NS45OTkgMjUwLjY2N0wzLjMyMzcxIDkzLjIyNzJDLTEuMzIwODIgODguOTkyNSAtMS4zMTU0OCA4MS42ODAyIDMuMzM1MjMgNzcuNDUyM0wxNy40Mzk5IDY0LjYyOThDMjEuMjQyMSA2MS4xNzMzIDI2Ljk2ODIgNjAuOTE4OCAzMS4wNjE5IDY0LjAyNDVMMjM5LjAwMyAyMjEuNzczQzI0NS45NzkgMjI3LjA2NSAyNTUuOTk5IDIyMi4wOSAyNTUuOTk5IDIxMy4zMzNWMjEzLjk0NkMyNTUuOTk5IDIyMC4wOTIgMjUyLjQ3OCAyMjUuNjk1IDI0Ni45NCAyMjguMzYyWiIgZmlsbD0iIzAwN0FDQyIvPgo8L2c+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIxX2QpIj4KPHBhdGggZD0iTTE5NC4xOTYgMjUzLjc2M0MxODguMDg5IDI1Ni43IDE4MC43OTIgMjU1LjQ1OSAxNzYgMjUwLjY2N0MxODEuOTA0IDI1Ni41NzEgMTkyIDI1Mi4zODkgMTkyIDI0NC4wMzlWMTEuOTYwNkMxOTIgMy42MTA1NyAxODEuOTA0IC0wLjU3MTE3NSAxNzYgNS4zMzMyMUMxODAuNzkyIDAuNTQxMTY2IDE4OC4wODkgLTAuNzAwNjA3IDE5NC4xOTYgMi4yMzY0OEwyNDYuOTM0IDI3LjU5ODVDMjUyLjQ3NiAzMC4yNjM1IDI1NiAzNS44Njg2IDI1NiA0Mi4wMTc4VjIxMy45ODNDMjU2IDIyMC4xMzIgMjUyLjQ3NiAyMjUuNzM3IDI0Ni45MzQgMjI4LjQwMkwxOTQuMTk2IDI1My43NjNaIiBmaWxsPSIjMUY5Q0YwIi8+CjwvZz4KPGcgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm92ZXJsYXkiIG9wYWNpdHk9IjAuMjUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MS4zNzggMjU0LjI1MkMxODUuNDEgMjU1LjgyMiAxOTAuMDA4IDI1NS43MjIgMTk0LjA3NyAyNTMuNzY0TDI0Ni43ODMgMjI4LjQwMkMyNTIuMzIyIDIyNS43MzcgMjU1Ljg0NCAyMjAuMTMyIDI1NS44NDQgMjEzLjk4M1Y0Mi4wMTc5QzI1NS44NDQgMzUuODY4NyAyNTIuMzIyIDMwLjI2MzYgMjQ2Ljc4NCAyNy41OTg2TDE5NC4wNzcgMi4yMzY2NUMxODguNzM3IC0wLjMzMzI5OSAxODIuNDg2IDAuMjk2MTc3IDE3Ny43OTggMy43MDQwMUMxNzcuMTI5IDQuMTkwODMgMTc2LjQ5MSA0LjczNDM3IDE3NS44OTIgNS4zMzMzN0w3NC45OTI3IDk3LjM4NkwzMS4wNDI5IDY0LjAyNDVDMjYuOTUxNyA2MC45MTg5IDIxLjIyOSA2MS4xNzM0IDE3LjQyOTIgNjQuNjI5OEwzLjMzMzExIDc3LjQ1MjNDLTEuMzE0NzggODEuNjgwMyAtMS4zMjAxMSA4OC45OTI1IDMuMzIxNiA5My4yMjczTDQxLjQzNjQgMTI4TDMuMzIxNiAxNjIuNzczQy0xLjMyMDExIDE2Ny4wMDggLTEuMzE0NzggMTc0LjMyIDMuMzMzMTEgMTc4LjU0OEwxNy40MjkyIDE5MS4zN0MyMS4yMjkgMTk0LjgyNyAyNi45NTE3IDE5NS4wODEgMzEuMDQyOSAxOTEuOTc2TDc0Ljk5MjcgMTU4LjYxNEwxNzUuODkyIDI1MC42NjdDMTc3LjQ4OCAyNTIuMjY0IDE3OS4zNjMgMjUzLjQ2NyAxODEuMzc4IDI1NC4yNTJaTTE5MS44ODMgNjkuODg1MUwxMTUuMzIzIDEyOEwxOTEuODgzIDE4Ni4xMTVWNjkuODg1MVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcikiLz4KPC9nPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2QiIHg9Ii0yMS40ODk2IiB5PSI0MC41MjI1IiB3aWR0aD0iMjk4LjgyMiIgaGVpZ2h0PSIyMzYuMTQ5IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIi8+CjxmZU9mZnNldC8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEwLjY2NjciLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJvdmVybGF5IiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3ciIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjxmaWx0ZXIgaWQ9ImZpbHRlcjFfZCIgeD0iMTU0LjY2NyIgeT0iLTIwLjY3MzUiIHdpZHRoPSIxMjIuNjY3IiBoZWlnaHQ9IjI5Ny4zNDciIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTAuNjY2NyIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im92ZXJsYXkiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyIiB4MT0iMTI3Ljg0NCIgeTE9IjAuNjU5OTg4IiB4Mj0iMTI3Ljg0NCIgeTI9IjI1NS4zNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSJ3aGl0ZSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K')":this.g==="Visual Studio Code - Insiders"&&(e="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtYXNrIGlkPSJtYXNrMCIgbWFzay10eXBlPSJhbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgo8cGF0aCBkPSJNMTc2LjA0OSAyNTAuNjY5QzE4MC44MzggMjU1LjQ1OSAxODguMTMgMjU2LjcgMTk0LjIzNCAyNTMuNzY0TDI0Ni45NCAyMjguNDE5QzI1Mi40NzggMjI1Ljc1NSAyNTYgMjIwLjE1NCAyNTYgMjE0LjAwOFY0Mi4xNDc5QzI1NiAzNi4wMDI1IDI1Mi40NzggMzAuNDAwOCAyNDYuOTQgMjcuNzM3NEwxOTQuMjM0IDIuMzkwODlDMTg4LjEzIC0wLjU0NDQxNiAxODAuODM4IDAuNjk2NjA3IDE3Ni4wNDkgNS40ODU3MkMxODEuOTUgLTAuNDE1MDYgMTkyLjAzOSAzLjc2NDEzIDE5Mi4wMzkgMTIuMTA5MVYyNDQuMDQ2QzE5Mi4wMzkgMjUyLjM5MSAxODEuOTUgMjU2LjU3IDE3Ni4wNDkgMjUwLjY2OVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xODEuMzc5IDE4MC42NDZMMTE0LjMzIDEyOC42MzNMMTgxLjM3OSA3NS41MTE0VjE3Ljc5NEMxODEuMzc5IDEwLjg0NzcgMTczLjEyOCA3LjIwNjczIDE2Ny45OTYgMTEuODg2Mkw3NC42NTE0IDk3Ljg1MThMMzEuMTk5NCA2NC4xNDM4QzI3LjEwODEgNjEuMDM5IDIxLjM4NTEgNjEuMjk0IDE3LjU4NTMgNjQuNzQ3NkwzLjQ4OTc0IDc3LjU2MjdDLTEuMTU4NDcgODEuNzg5MyAtMS4xNjM2NyA4OS4wOTQ4IDMuNDc2NzIgOTMuMzI5MkwxNjcuOTggMjQ0LjE4NUMxNzMuMTA3IDI0OC44ODcgMTgxLjM3OSAyNDUuMjQ5IDE4MS4zNzkgMjM4LjI5MlYxODAuNjQ2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTM2LjY5MzcgMTM0LjE5NUwzLjQ3NjcyIDE2Mi44MjhDLTEuMTYzNjcgMTY3LjA2MiAtMS4xNTg0NyAxNzQuMzcgMy40ODk3NCAxNzguNTk0TDE3LjU4NTMgMTkxLjQwOUMyMS4zODUxIDE5NC44NjMgMjcuMTA4MSAxOTUuMTE4IDMxLjE5OTQgMTkyLjAxM0w2OS40NDcyIDE2NC4wNTdMMzYuNjkzNyAxMzQuMTk1WiIgZmlsbD0id2hpdGUiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swKSI+CjxwYXRoIGQ9Ik0xNjcuOTk2IDExLjg4NTdDMTczLjEyOCA3LjIwNjI3IDE4MS4zNzkgMTAuODQ3MyAxODEuMzc5IDE3Ljc5MzZWNzUuNTEwOUwxMDQuOTM4IDEzNi4wNzNMNjUuNTc0MiAxMDYuMjExTDE2Ny45OTYgMTEuODg1N1oiIGZpbGw9IiMwMDlBN0MiLz4KPHBhdGggZD0iTTM2LjY5MzcgMTM0LjE5NEwzLjQ3NjcyIDE2Mi44MjdDLTEuMTYzNjcgMTY3LjA2MiAtMS4xNTg0NyAxNzQuMzcgMy40ODk3NCAxNzguNTk0TDE3LjU4NTMgMTkxLjQwOUMyMS4zODUxIDE5NC44NjMgMjcuMTA4MSAxOTUuMTE4IDMxLjE5OTQgMTkyLjAxM0w2OS40NDcyIDE2NC4wNTZMMzYuNjkzNyAxMzQuMTk0WiIgZmlsbD0iIzAwOUE3QyIvPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMF9kKSI+CjxwYXRoIGQ9Ik0xODEuMzc5IDE4MC42NDVMMzEuMTk5NCA2NC4xNDI3QzI3LjEwODEgNjEuMDM3OSAyMS4zODUxIDYxLjI5MjkgMTcuNTg1MyA2NC43NDY1TDMuNDg5NzQgNzcuNTYxNkMtMS4xNTg0NyA4MS43ODgyIC0xLjE2MzY3IDg5LjA5MzcgMy40NzY3MiA5My4zMjgxTDE2Ny45NzIgMjQ0LjE3NkMxNzMuMTAyIDI0OC44ODEgMTgxLjM3OSAyNDUuMjQxIDE4MS4zNzkgMjM4LjI4VjE4MC42NDVaIiBmaWxsPSIjMDBCMjk0Ii8+CjwvZz4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjFfZCkiPgo8cGF0aCBkPSJNMTk0LjIzMyAyNTMuNzY2QzE4OC4xMyAyNTYuNzAxIDE4MC44MzcgMjU1LjQ2IDE3Ni4wNDggMjUwLjY3MUMxODEuOTQ5IDI1Ni41NzEgMTkyLjAzOSAyNTIuMzkyIDE5Mi4wMzkgMjQ0LjA0N1YxMi4xMTAzQzE5Mi4wMzkgMy43NjUzNSAxODEuOTQ5IC0wLjQxMzgzOSAxNzYuMDQ4IDUuNDg2OTRDMTgwLjgzNyAwLjY5NzgyNCAxODguMTI5IC0wLjU0MzE5MSAxOTQuMjMzIDIuMzkyMUwyNDYuOTM5IDI3LjczODZDMjUyLjQ3OCAzMC40MDIgMjU2IDM2LjAwMzcgMjU2IDQyLjE0OTFWMjE0LjAwOUMyNTYgMjIwLjE1NSAyNTIuNDc4IDIyNS43NTcgMjQ2LjkzOSAyMjguNDJMMTk0LjIzMyAyNTMuNzY2WiIgZmlsbD0iIzI0QkZBNSIvPgo8L2c+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iLTIxLjMzMzMiIHk9IjQwLjY0MTMiIHdpZHRoPSIyMjQuMDQ1IiBoZWlnaHQ9IjIyNi45ODgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTAuNjY2NyIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4xNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8ZmlsdGVyIGlkPSJmaWx0ZXIxX2QiIHg9IjE1NC43MTUiIHk9Ii0yMC41MTY5IiB3aWR0aD0iMTIyLjYxOCIgaGVpZ2h0PSIyOTcuMTkxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIi8+CjxmZU9mZnNldC8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEwLjY2NjciLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJvdmVybGF5IiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3ciIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==')"),`<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>GitHub Authentication - Sign In</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		html {
			height: 100%;
		}

		body {
			box-sizing: border-box;
			min-height: 100%;
			margin: 0;
			padding: 15px 30px;
			display: flex;
			flex-direction: column;
			color: white;
			font-family: "Segoe UI","Helvetica Neue","Helvetica",Arial,sans-serif;
			background-color: #2C2C32;
		}

		.branding {
			background-image: ${e};
			background-size: 24px;
			background-repeat: no-repeat;
			background-position: left center;
			padding-left: 36px;
			font-size: 20px;
			letter-spacing: -0.04rem;
			font-weight: 400;
			color: white;
			text-decoration: none;
		}

		.message-container {
			flex-grow: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 0 30px;
		}

		.message {
			font-weight: 300;
			font-size: 1.4rem;
		}

		body.error .message {
			display: none;
		}

		body.error .error-message {
			display: block;
		}

		.error-message {
			display: none;
			font-weight: 300;
			font-size: 1.3rem;
		}

		.error-text {
			color: red;
			font-size: 1rem;
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Light"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.svg#web") format("svg");
			font-weight: 200
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Semilight"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.svg#web") format("svg");
			font-weight: 300
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.svg#web") format("svg");
			font-weight: 400
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Semibold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.svg#web") format("svg");
			font-weight: 600
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Bold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.svg#web") format("svg");
			font-weight: 700
		}
	</style>
</head>

<body>
	<a class="branding" href="https://code.visualstudio.com/">
		${this.g}
	</a>
	<div class="message-container">
		<div class="message">
			Sign-in successful! Returning to ${this.g}...
			<br><br>
			If you're not redirected automatically, <a href="${this.f.toString(!0)}" style="color: #85CEFF;">click here</a> or close this page.
		</div>
		<div class="error-message">
			An error occurred while signing in:
			<div class="error-text"></div>
		</div>
	</div>
	<script>
		const search = window.location.search;
		const error = (/[?&^]error=([^&]+)/.exec(search) || [])[1];
		if (error) {
			document.querySelector('.error-text')
				.textContent = decodeURIComponent(error);
			document.querySelector('body')
				.classList.add('error');
		} else {
			// Redirect to the app URI after a 1-second delay to allow page to load
			setTimeout(function() {
				window.location.href = '${this.f.toString(!0)}';
			}, 1000);
		}
	</script>
</body>
</html>`}},$te=class extends Rm{constructor(e,t,i,s,r,n,o,a,c,l,u,h,f){super(e,t,i,s,r,n,o,a,c,l,u,h,f),!i.remote.isRemote&&a.authorization_endpoint&&this.g.unshift({label:d(3069,null),handler:(p,g,v)=>this.B(p,g,v)}),a.device_authorization_endpoint&&this.g.push({label:d(3070,null),handler:(p,g,v)=>this.C(p,g,v)})}async B(e,t,i){if(!this.p.authorization_endpoint)throw new Error("Authorization Endpoint required");if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const s=this.v(64),r=await this.w(s),n=this.v(32),o=y.parse(`${this.m.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/redirect?nonce=${n}`);let a;try{a=await this.l.createAppUri(o)}catch(f){throw new Error(`Failed to create external URI: ${f}`)}const c=new Ste(this.p.authorization_endpoint);c.searchParams.append("client_id",this.r),c.searchParams.append("response_type","code"),c.searchParams.append("code_challenge",r),c.searchParams.append("code_challenge_method","S256");const l=e.join(" ");l&&c.searchParams.append("scope",l),this.q?.resource&&c.searchParams.append("resource",this.q.resource);const u=new kte(this.h,a,this.m.environment.appName);try{await u.start()}catch(f){throw new Error(`Failed to start loopback server: ${f}`)}c.searchParams.set("redirect_uri",u.redirectUri),c.searchParams.set("state",u.state);const h=u.waitForOAuthResponse();this.o.$waitForUriHandler(a);try{if(this.h.info(`Opening authorization URL for scopes: ${l}`),this.h.trace(`Authorization URL: ${c.toString()}`),!await this.k.openUri(c.toString(),{}))throw new dt;t.report({message:d(3071,null)});let p;try{p=(await wf(h,i)).code}catch(v){throw ki(v)?(this.h.info("Authorization code request was cancelled by the user."),v):(this.h.error(`Failed to receive authorization code: ${v}`),new Error(`Failed to receive authorization code: ${v}`))}return this.h.info(`Authorization code received for scopes: ${l}`),await this.y(p,s,u.redirectUri)}finally{setTimeout(()=>{u.stop()},5e3)}}async C(e,t,i){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");if(!this.p.device_authorization_endpoint)throw new Error("Device authorization endpoint not available in server metadata");const s=this.p.device_authorization_endpoint,r=e.join(" ");this.h.info(`Starting device code flow for scopes: ${r}`);const n=new URLSearchParams;n.append("client_id",this.r),r&&n.append("scope",r),this.q?.resource&&n.append("resource",this.q.resource);let o;try{o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:n.toString()})}catch(h){throw this.h.error(`Failed to request device code: ${h}`),new Error(`Failed to request device code: ${h}`)}if(!o.ok){const h=await o.text();throw new Error(`Device code request failed: ${o.status} ${o.statusText} - ${h}`)}const a=await o.json();if(!Eq(a))throw this.h.error("Invalid device code response received from server"),new Error("Invalid device code response received from server");if(this.h.info(`Device code received: ${a.user_code}`),!await this.o.$showDeviceCodeModal(a.user_code,a.verification_uri))throw new dt;t.report({message:d(3072,null,a.verification_uri,a.user_code)});const l=(a.interval||5)*1e3,u=Date.now()+a.expires_in*1e3;for(;Date.now()<u;){if(i.isCancellationRequested)throw new dt;if(await new Promise(f=>setTimeout(f,l)),i.isCancellationRequested)throw new dt;const h=new URLSearchParams;h.append("grant_type","urn:ietf:params:oauth:grant-type:device_code"),h.append("device_code",a.device_code),h.append("client_id",this.r),this.q?.resource&&h.append("resource",this.q.resource);try{const f=await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:h.toString()});if(f.ok){const p=await f.json();if(!MA(p))throw this.h.error("Invalid token response received from server"),new Error("Invalid token response received from server");return this.h.info(`Device code flow completed successfully for scopes: ${r}`),p}else{let p;try{p=await f.json()}catch(g){throw this.h.error(`Failed to parse error response: ${g}`),new Error(`Token request failed with status ${f.status}: ${f.statusText}`)}if(p.error==="authorization_pending")continue;if(p.error==="slow_down"){await new Promise(g=>setTimeout(g,l));continue}else throw p.error==="expired_token"?new Error("Device code expired. Please try again."):p.error==="access_denied"?new dt:p.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Token request failed: ${p.error_description||p.error||"Unknown error"}`)}}catch(f){throw ki(f)?f:new Error(`Error polling for token: ${f}`)}}throw new Error("Device code flow timed out. Please try again.")}},Ite=class extends UA{constructor(e,t,i,s,r,n,o){super(e,t,i,s,r,n,o),this.c=$te}};Ne(gn,pee,0),Ne(Zn,cte,1),Ne(xe,new Sr(TE,[!1],!0)),Ne(Td,X7,1),Ne(bA,ete,0),Ne(Im,new Sr(xA,[!1],!0)),Ne(jA,Ite,0),Ne(k4,_4,0),Ne(D4,Z4,0),Ne(E4,U4,0),Ne(pn,F4,0),Ne(km,IE,0),Ne(Ha,ute,0),Ne(iv,wte,0);import{createRequire as Dte}from"node:module";var mN=Dte(import.meta.url);if(process.env.VSCODE_DEV){const e=process.listeners("warning");process.removeAllListeners("warning"),process.on("warning",t=>{if(t.code==="ExperimentalWarning"||t.name==="ExperimentalWarning"||t.name==="DeprecationWarning"){console.debug(t);return}e[0](t)})}(function(){for(let t=0;t<process.execArgv.length;t++)process.execArgv[t]==="--inspect-port=0"&&(process.execArgv.splice(t,1),t--)})();var Ld=(0,dL.default)(process.argv.slice(2),{boolean:["transformURIs","skipWorkspaceStorageLock","supportGlobalNavigator"],string:["useHostProxy"]});(function(){const e=mN("module"),t=e._load;e._load=function(i){if(i==="natives")throw new Error('Either the extension or an NPM dependency is using the [unsupported "natives" node module](https://go.microsoft.com/fwlink/?linkid=871887).');return t.apply(this,arguments)}})();var e1=process.exit.bind(process),Pte=process.on.bind(process);function Tte(e){process.exit=function(t){if(e)e1(t);else{const i=new Error("An extension called process.exit() and this was prevented.");console.warn(i.stack)}},process.crash=function(){const t=new Error("An extension called process.crash() and this was prevented.");console.warn(t.stack)},process.env.ELECTRON_RUN_AS_NODE="1",process.on=function(t,i){if(t==="uncaughtException"){const s=i;i=function(...r){try{return s.apply(void 0,r)}catch{}}}Pte(t,i)}}Ld.supportGlobalNavigator||Object.defineProperty(globalThis,"navigator",{get:()=>{Yd(new k1("navigator is now a global in nodejs, please see https://aka.ms/vscode-extensions/navigator for additional info on this error."))}});var zr=function(e){e1()};function Mte(e,t){const i=process.env[e];if(typeof i!="string"||i.trim().length===0)return console.log(`[reconnection-grace-time] Extension host: env var ${e} not set, using default: ${t}ms (${Math.floor(t/1e3)}s)`),t;const s=Number(i);if(!isFinite(s)||s<0)return console.log(`[reconnection-grace-time] Extension host: env var ${e} invalid value '${i}', using default: ${t}ms (${Math.floor(t/1e3)}s)`),t;const r=Math.floor(s),n=r>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r;return console.log(`[reconnection-grace-time] Extension host: read ${e}=${i}ms (${Math.floor(n/1e3)}s)`),n}function Nte(){const e=dV(process.env);if(e.type===3)return new Promise((t,i)=>{const s=r=>{const n=r[0],o=new Jo;n.on("message",a=>o.fire(_.wrap(a.data))),n.on("close",()=>{zr("renderer closed the MessagePort")}),n.start(),t({onMessage:o.event,send:a=>n.postMessage(a.buffer)})};process.parentPort.on("message",r=>s(r.ports))});if(e.type===2)return new Promise((t,i)=>{let s=null;const r=setTimeout(()=>{zr("VSCODE_EXTHOST_IPC_SOCKET timeout")},6e4),n=Mte("VSCODE_RECONNECTION_GRACE_TIME",108e5),o=n>0?Math.min(3e5,n):0,a=new OC(()=>zr("renderer disconnected for too long (1)"),n),c=new OC(()=>zr("renderer disconnected for too long (2)"),o);process.on("message",(u,h)=>{if(u&&u.type==="VSCODE_EXTHOST_IPC_SOCKET"){h.setNoDelay(!0);const f=_.wrap(Buffer.from(u.initialDataChunk,"base64"));let p;if(u.skipWebSocketFrames)p=new wu(h,"extHost-socket");else{const g=_.wrap(Buffer.from(u.inflateBytes,"base64"));p=new HF(new wu(h,"extHost-socket"),u.permessageDeflate,g,!1)}s?(a.cancel(),c.cancel(),s.beginAcceptReconnection(p,f),s.endAcceptReconnection(),s.sendResume()):(clearTimeout(r),s=new b0({socket:p,initialChunk:f}),s.sendResume(),s.onDidDispose(()=>zr("renderer disconnected")),t(s),s.onSocketClose(()=>{a.schedule()}))}if(u&&u.type==="VSCODE_EXTHOST_IPC_REDUCE_GRACE_TIME"){if(c.isScheduled())return;a.isScheduled()&&c.schedule()}});const l={type:"VSCODE_EXTHOST_IPC_READY"};process.send?.(l)});{const t=e.pipeName;return new Promise((i,s)=>{const r=fL.createConnection(t,()=>{r.removeListener("error",s);const n=new b0({socket:new wu(r,"extHost-renderer")});n.sendResume(),i(n)});r.once("error",s),r.on("close",()=>{zr("renderer closed the socket")})})}}async function Rte(){const e=await Nte();return new class{constructor(){this.a=new Jo,this.onMessage=this.a.event,this.b=!1,this.d=e.onMessage(t=>{cq(t,2)?(this.b=!0,this.d.dispose(),zr("received terminate message from renderer")):this.a.fire(t)})}send(t){this.b||e.send(t)}async drain(){if(e.drain)return e.drain()}}}function Lte(e){return new Promise(t=>{const i=e.onMessage(s=>{i.dispose();const r=JSON.parse(s.toString()),n=r.commit,o=qs.commit;if(n&&o&&n!==o&&e1(55),r.parentPid){let a=0;setInterval(function(){try{process.kill(r.parentPid,0),a=0}catch(l){l&&l.code==="EPERM"?(a++,a>=3&&zr(`parent process ${r.parentPid} does not exist anymore (3 x EPERM): ${l.message} (code: ${l.code}) (errno: ${l.errno})`)):zr(`parent process ${r.parentPid} does not exist anymore: ${l.message} (code: ${l.code}) (errno: ${l.errno})`)}},1e3);let c;try{c=mN("@vscode/native-watchdog"),c.start(r.parentPid)}catch(l){pt(l)}}e.send(Y9(0)),t({protocol:e,initData:r})});e.send(Y9(1))})}async function Ote(){const e=[];process.on("unhandledRejection",(a,c)=>{e.push(c),setTimeout(()=>{const l=e.indexOf(c);l>=0&&c.catch(u=>{e.splice(l,1),ki(u)||(console.warn(`rejected promise not handled within 1 second: ${u}`),u&&u.stack&&console.warn(`stack trace: ${u.stack}`),a&&pt(a))})},1e3)}),process.on("rejectionHandled",a=>{const c=e.indexOf(a);c>=0&&e.splice(c,1)}),process.on("uncaughtException",function(a){mL(a)||pt(a)}),Ht("code/extHost/willConnectToRenderer");const t=await Rte();Ht("code/extHost/didConnectToRenderer");const i=await Lte(t);Ht("code/extHost/didWaitForInitData");const{initData:s}=i;Tte(!!s.environment.extensionTestsLocationURI),s.environment.useHostProxy=Ld.useHostProxy!==void 0?Ld.useHostProxy!=="false":void 0,s.environment.skipWorkspaceStorageLock=te(Ld.skipWorkspaceStorageLock,!1);const r=new class{constructor(){this.pid=process.pid}exit(c){e1(c)}fsExists(c){return at.exists(c)}fsRealpath(c){return at.realpath(c)}};let n=null;s.remote.authority&&Ld.transformURIs&&(n=uV(s.remote.authority));const o=new cV(i.protocol,s,r,n);zr=a=>o.terminate(a)}Ote().catch(e=>console.log(e));

//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/b6a47e94e326b5c209d118cf0f994d6065585705/core/vs/workbench/api/node/extensionHostProcess.js.map
